var N1=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var j1=N1((exports,module)=>{(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))h(d);new MutationObserver(d=>{for(const g of d)if(g.type==="childList")for(const _ of g.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&h(_)}).observe(document,{childList:!0,subtree:!0});function s(d){const g={};return d.integrity&&(g.integrity=d.integrity),d.referrerPolicy&&(g.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?g.credentials="include":d.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function h(d){if(d.ep)return;d.ep=!0;const g=s(d);fetch(d.href,g)}})();function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$1=Symbol.for("react.element"),n$1=Symbol.for("react.portal"),p$2=Symbol.for("react.fragment"),q$1=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),t=Symbol.for("react.provider"),u=Symbol.for("react.context"),v$1=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$1=Symbol.iterator;function A$1(e){return e===null||typeof e!="object"?null:(e=z$1&&e[z$1]||e["@@iterator"],typeof e=="function"?e:null)}var B$1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$1={};function E$1(e,o,s){this.props=e,this.context=o,this.refs=D$1,this.updater=s||B$1}E$1.prototype.isReactComponent={};E$1.prototype.setState=function(e,o){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,o,"setState")};E$1.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function F(){}F.prototype=E$1.prototype;function G$1(e,o,s){this.props=e,this.context=o,this.refs=D$1,this.updater=s||B$1}var H$3=G$1.prototype=new F;H$3.constructor=G$1;C$1(H$3,E$1.prototype);H$3.isPureReactComponent=!0;var I$1=Array.isArray,J=Object.prototype.hasOwnProperty,K$1={current:null},L$1={key:!0,ref:!0,__self:!0,__source:!0};function M$1(e,o,s){var h,d={},g=null,_=null;if(o!=null)for(h in o.ref!==void 0&&(_=o.ref),o.key!==void 0&&(g=""+o.key),o)J.call(o,h)&&!L$1.hasOwnProperty(h)&&(d[h]=o[h]);var j=arguments.length-2;if(j===1)d.children=s;else if(1<j){for(var $=Array(j),_t=0;_t<j;_t++)$[_t]=arguments[_t+2];d.children=$}if(e&&e.defaultProps)for(h in j=e.defaultProps,j)d[h]===void 0&&(d[h]=j[h]);return{$$typeof:l$1,type:e,key:g,ref:_,props:d,_owner:K$1.current}}function N$1(e,o){return{$$typeof:l$1,type:e.type,key:o,ref:e.ref,props:e.props,_owner:e._owner}}function O$1(e){return typeof e=="object"&&e!==null&&e.$$typeof===l$1}function escape(e){var o={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return o[s]})}var P$1=/\/+/g;function Q$1(e,o){return typeof e=="object"&&e!==null&&e.key!=null?escape(""+e.key):o.toString(36)}function R$1(e,o,s,h,d){var g=typeof e;(g==="undefined"||g==="boolean")&&(e=null);var _=!1;if(e===null)_=!0;else switch(g){case"string":case"number":_=!0;break;case"object":switch(e.$$typeof){case l$1:case n$1:_=!0}}if(_)return _=e,d=d(_),e=h===""?"."+Q$1(_,0):h,I$1(d)?(s="",e!=null&&(s=e.replace(P$1,"$&/")+"/"),R$1(d,o,s,"",function(_t){return _t})):d!=null&&(O$1(d)&&(d=N$1(d,s+(!d.key||_&&_.key===d.key?"":(""+d.key).replace(P$1,"$&/")+"/")+e)),o.push(d)),1;if(_=0,h=h===""?".":h+":",I$1(e))for(var j=0;j<e.length;j++){g=e[j];var $=h+Q$1(g,j);_+=R$1(g,o,s,$,d)}else if($=A$1(e),typeof $=="function")for(e=$.call(e),j=0;!(g=e.next()).done;)g=g.value,$=h+Q$1(g,j++),_+=R$1(g,o,s,$,d);else if(g==="object")throw o=String(e),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return _}function S$1(e,o,s){if(e==null)return e;var h=[],d=0;return R$1(e,h,"","",function(g){return o.call(s,g,d++)}),h}function T$1(e){if(e._status===-1){var o=e._result;o=o(),o.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=o)}if(e._status===1)return e._result.default;throw e._result}var U$1={current:null},V$1={transition:null},W$1={ReactCurrentDispatcher:U$1,ReactCurrentBatchConfig:V$1,ReactCurrentOwner:K$1};function X$1(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(e,o,s){S$1(e,function(){o.apply(this,arguments)},s)},count:function(e){var o=0;return S$1(e,function(){o++}),o},toArray:function(e){return S$1(e,function(o){return o})||[]},only:function(e){if(!O$1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};react_production_min.Component=E$1;react_production_min.Fragment=p$2;react_production_min.Profiler=r;react_production_min.PureComponent=G$1;react_production_min.StrictMode=q$1;react_production_min.Suspense=w;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$1;react_production_min.act=X$1;react_production_min.cloneElement=function(e,o,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var h=C$1({},e.props),d=e.key,g=e.ref,_=e._owner;if(o!=null){if(o.ref!==void 0&&(g=o.ref,_=K$1.current),o.key!==void 0&&(d=""+o.key),e.type&&e.type.defaultProps)var j=e.type.defaultProps;for($ in o)J.call(o,$)&&!L$1.hasOwnProperty($)&&(h[$]=o[$]===void 0&&j!==void 0?j[$]:o[$])}var $=arguments.length-2;if($===1)h.children=s;else if(1<$){j=Array($);for(var _t=0;_t<$;_t++)j[_t]=arguments[_t+2];h.children=j}return{$$typeof:l$1,type:e.type,key:d,ref:g,props:h,_owner:_}};react_production_min.createContext=function(e){return e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:t,_context:e},e.Consumer=e};react_production_min.createElement=M$1;react_production_min.createFactory=function(e){var o=M$1.bind(null,e);return o.type=e,o};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(e){return{$$typeof:v$1,render:e}};react_production_min.isValidElement=O$1;react_production_min.lazy=function(e){return{$$typeof:y,_payload:{_status:-1,_result:e},_init:T$1}};react_production_min.memo=function(e,o){return{$$typeof:x,type:e,compare:o===void 0?null:o}};react_production_min.startTransition=function(e){var o=V$1.transition;V$1.transition={};try{e()}finally{V$1.transition=o}};react_production_min.unstable_act=X$1;react_production_min.useCallback=function(e,o){return U$1.current.useCallback(e,o)};react_production_min.useContext=function(e){return U$1.current.useContext(e)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(e){return U$1.current.useDeferredValue(e)};react_production_min.useEffect=function(e,o){return U$1.current.useEffect(e,o)};react_production_min.useId=function(){return U$1.current.useId()};react_production_min.useImperativeHandle=function(e,o,s){return U$1.current.useImperativeHandle(e,o,s)};react_production_min.useInsertionEffect=function(e,o){return U$1.current.useInsertionEffect(e,o)};react_production_min.useLayoutEffect=function(e,o){return U$1.current.useLayoutEffect(e,o)};react_production_min.useMemo=function(e,o){return U$1.current.useMemo(e,o)};react_production_min.useReducer=function(e,o,s){return U$1.current.useReducer(e,o,s)};react_production_min.useRef=function(e){return U$1.current.useRef(e)};react_production_min.useState=function(e){return U$1.current.useState(e)};react_production_min.useSyncExternalStore=function(e,o,s){return U$1.current.useSyncExternalStore(e,o,s)};react_production_min.useTransition=function(){return U$1.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$1={key:!0,ref:!0,__self:!0,__source:!0};function q(e,o,s){var h,d={},g=null,_=null;s!==void 0&&(g=""+s),o.key!==void 0&&(g=""+o.key),o.ref!==void 0&&(_=o.ref);for(h in o)m$1.call(o,h)&&!p$1.hasOwnProperty(h)&&(d[h]=o[h]);if(e&&e.defaultProps)for(h in o=e.defaultProps,o)d[h]===void 0&&(d[h]=o[h]);return{$$typeof:k,type:e,key:g,ref:_,props:d,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function o(ky,Dy){var Gy=ky.length;ky.push(Dy);t:for(;0<Gy;){var Ky=Gy-1>>>1,sv=ky[Ky];if(0<d(sv,Dy))ky[Ky]=Dy,ky[Gy]=sv,Gy=Ky;else break t}}function s(ky){return ky.length===0?null:ky[0]}function h(ky){if(ky.length===0)return null;var Dy=ky[0],Gy=ky.pop();if(Gy!==Dy){ky[0]=Gy;t:for(var Ky=0,sv=ky.length,Hy=sv>>>1;Ky<Hy;){var vv=2*(Ky+1)-1,_v=ky[vv],Av=vv+1,Mv=ky[Av];if(0>d(_v,Gy))Av<sv&&0>d(Mv,_v)?(ky[Ky]=Mv,ky[Av]=Gy,Ky=Av):(ky[Ky]=_v,ky[vv]=Gy,Ky=vv);else if(Av<sv&&0>d(Mv,Gy))ky[Ky]=Mv,ky[Av]=Gy,Ky=Av;else break t}}return Dy}function d(ky,Dy){var Gy=ky.sortIndex-Dy.sortIndex;return Gy!==0?Gy:ky.id-Dy.id}if(typeof performance=="object"&&typeof performance.now=="function"){var g=performance;e.unstable_now=function(){return g.now()}}else{var _=Date,j=_.now();e.unstable_now=function(){return _.now()-j}}var $=[],_t=[],_e=1,_r=null,_i=3,_n=!1,_s=!1,_l=!1,Ap=typeof setTimeout=="function"?setTimeout:null,_h=typeof clearTimeout=="function"?clearTimeout:null,_p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ty(ky){for(var Dy=s(_t);Dy!==null;){if(Dy.callback===null)h(_t);else if(Dy.startTime<=ky)h(_t),Dy.sortIndex=Dy.expirationTime,o($,Dy);else break;Dy=s(_t)}}function ry(ky){if(_l=!1,ty(ky),!_s)if(s($)!==null)_s=!0,qy(ly);else{var Dy=s(_t);Dy!==null&&_m(ry,Dy.startTime-ky)}}function ly(ky,Dy){_s=!1,_l&&(_l=!1,_h(fy),fy=-1),_n=!0;var Gy=_i;try{for(ty(Dy),_r=s($);_r!==null&&(!(_r.expirationTime>Dy)||ky&&!Ly());){var Ky=_r.callback;if(typeof Ky=="function"){_r.callback=null,_i=_r.priorityLevel;var sv=Ky(_r.expirationTime<=Dy);Dy=e.unstable_now(),typeof sv=="function"?_r.callback=sv:_r===s($)&&h($),ty(Dy)}else h($);_r=s($)}if(_r!==null)var Hy=!0;else{var vv=s(_t);vv!==null&&_m(ry,vv.startTime-Dy),Hy=!1}return Hy}finally{_r=null,_i=Gy,_n=!1}}var uy=!1,py=null,fy=-1,my=5,xy=-1;function Ly(){return!(e.unstable_now()-xy<my)}function My(){if(py!==null){var ky=e.unstable_now();xy=ky;var Dy=!0;try{Dy=py(!0,ky)}finally{Dy?Ry():(uy=!1,py=null)}}else uy=!1}var Ry;if(typeof _p=="function")Ry=function(){_p(My)};else if(typeof MessageChannel<"u"){var Sy=new MessageChannel,Zy=Sy.port2;Sy.port1.onmessage=My,Ry=function(){Zy.postMessage(null)}}else Ry=function(){Ap(My,0)};function qy(ky){py=ky,uy||(uy=!0,Ry())}function _m(ky,Dy){fy=Ap(function(){ky(e.unstable_now())},Dy)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ky){ky.callback=null},e.unstable_continueExecution=function(){_s||_n||(_s=!0,qy(ly))},e.unstable_forceFrameRate=function(ky){0>ky||125<ky?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):my=0<ky?Math.floor(1e3/ky):5},e.unstable_getCurrentPriorityLevel=function(){return _i},e.unstable_getFirstCallbackNode=function(){return s($)},e.unstable_next=function(ky){switch(_i){case 1:case 2:case 3:var Dy=3;break;default:Dy=_i}var Gy=_i;_i=Dy;try{return ky()}finally{_i=Gy}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ky,Dy){switch(ky){case 1:case 2:case 3:case 4:case 5:break;default:ky=3}var Gy=_i;_i=ky;try{return Dy()}finally{_i=Gy}},e.unstable_scheduleCallback=function(ky,Dy,Gy){var Ky=e.unstable_now();switch(typeof Gy=="object"&&Gy!==null?(Gy=Gy.delay,Gy=typeof Gy=="number"&&0<Gy?Ky+Gy:Ky):Gy=Ky,ky){case 1:var sv=-1;break;case 2:sv=250;break;case 5:sv=1073741823;break;case 4:sv=1e4;break;default:sv=5e3}return sv=Gy+sv,ky={id:_e++,callback:Dy,priorityLevel:ky,startTime:Gy,expirationTime:sv,sortIndex:-1},Gy>Ky?(ky.sortIndex=Gy,o(_t,ky),s($)===null&&ky===s(_t)&&(_l?(_h(fy),fy=-1):_l=!0,_m(ry,Gy-Ky))):(ky.sortIndex=sv,o($,ky),_s||_n||(_s=!0,qy(ly))),ky},e.unstable_shouldYield=Ly,e.unstable_wrapCallback=function(ky){var Dy=_i;return function(){var Gy=_i;_i=Dy;try{return ky.apply(this,arguments)}finally{_i=Gy}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p(e){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)o+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(e,o){ha(e,o),ha(e+"Capture",o)}function ha(e,o){for(ea[e]=o,e=0;e<o.length;e++)da.add(o[e])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(e){return ja.call(ma,e)?!0:ja.call(la,e)?!1:ka.test(e)?ma[e]=!0:(la[e]=!0,!1)}function pa(e,o,s,h){if(s!==null&&s.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qa(e,o,s,h){if(o===null||typeof o>"u"||pa(e,o,s,h))return!0;if(h)return!1;if(s!==null)switch(s.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function v(e,o,s,h,d,g,_){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=d,this.mustUseProperty=s,this.propertyName=e,this.type=o,this.sanitizeURL=g,this.removeEmptyString=_}var z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){z[e]=new v(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var o=e[0];z[o]=new v(o,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){z[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){z[e]=new v(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){z[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){z[e]=new v(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){z[e]=new v(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){z[e]=new v(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){z[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var o=e.replace(ra,sa);z[o]=new v(o,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var o=e.replace(ra,sa);z[o]=new v(o,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var o=e.replace(ra,sa);z[o]=new v(o,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)});z.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){z[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)});function ta(e,o,s,h){var d=z.hasOwnProperty(o)?z[o]:null;(d!==null?d.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(qa(o,s,d,h)&&(s=null),h||d===null?oa(o)&&(s===null?e.removeAttribute(o):e.setAttribute(o,""+s)):d.mustUseProperty?e[d.propertyName]=s===null?d.type===3?!1:"":s:(o=d.attributeName,h=d.attributeNamespace,s===null?e.removeAttribute(o):(d=d.type,s=d===3||d===4&&s===!0?"":""+s,h?e.setAttributeNS(h,o,s):e.setAttribute(o,s))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(e){return e===null||typeof e!="object"?null:(e=Ja&&e[Ja]||e["@@iterator"],typeof e=="function"?e:null)}var A=Object.assign,La;function Ma(e){if(La===void 0)try{throw Error()}catch(s){var o=s.stack.trim().match(/\n( *(at )?)/);La=o&&o[1]||""}return`
`+La+e}var Na=!1;function Oa(e,o){if(!e||Na)return"";Na=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(_t){var h=_t}Reflect.construct(e,[],o)}else{try{o.call()}catch(_t){h=_t}e.call(o.prototype)}else{try{throw Error()}catch(_t){h=_t}e()}}catch(_t){if(_t&&h&&typeof _t.stack=="string"){for(var d=_t.stack.split(`
`),g=h.stack.split(`
`),_=d.length-1,j=g.length-1;1<=_&&0<=j&&d[_]!==g[j];)j--;for(;1<=_&&0<=j;_--,j--)if(d[_]!==g[j]){if(_!==1||j!==1)do if(_--,j--,0>j||d[_]!==g[j]){var $=`
`+d[_].replace(" at new "," at ");return e.displayName&&$.includes("<anonymous>")&&($=$.replace("<anonymous>",e.displayName)),$}while(1<=_&&0<=j);break}}}finally{Na=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?Ma(e):""}function Pa(e){switch(e.tag){case 5:return Ma(e.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return e=Oa(e.type,!1),e;case 11:return e=Oa(e.type.render,!1),e;case 1:return e=Oa(e.type,!0),e;default:return""}}function Qa(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ca:return(e.displayName||"Context")+".Consumer";case Ba:return(e._context.displayName||"Context")+".Provider";case Da:var o=e.render;return e=e.displayName,e||(e=o.displayName||o.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ga:return o=e.displayName||null,o!==null?o:Qa(e.type)||"Memo";case Ha:o=e._payload,e=e._init;try{return Qa(e(o))}catch{}}return null}function Ra(e){var o=e.type;switch(e.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=o.render,e=e.displayName||e.name||"",o.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(o);case 8:return o===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Sa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ta(e){var o=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ua(e){var o=Ta(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,o),h=""+e[o];if(!e.hasOwnProperty(o)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var d=s.get,g=s.set;return Object.defineProperty(e,o,{configurable:!0,get:function(){return d.call(this)},set:function(_){h=""+_,g.call(this,_)}}),Object.defineProperty(e,o,{enumerable:s.enumerable}),{getValue:function(){return h},setValue:function(_){h=""+_},stopTracking:function(){e._valueTracker=null,delete e[o]}}}}function Va(e){e._valueTracker||(e._valueTracker=Ua(e))}function Wa(e){if(!e)return!1;var o=e._valueTracker;if(!o)return!0;var s=o.getValue(),h="";return e&&(h=Ta(e)?e.checked?"true":"false":e.value),e=h,e!==s?(o.setValue(e),!0):!1}function Xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ya(e,o){var s=o.checked;return A({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function Za(e,o){var s=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;s=Sa(o.value!=null?o.value:s),e._wrapperState={initialChecked:h,initialValue:s,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function ab(e,o){o=o.checked,o!=null&&ta(e,"checked",o,!1)}function bb(e,o){ab(e,o);var s=Sa(o.value),h=o.type;if(s!=null)h==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(h==="submit"||h==="reset"){e.removeAttribute("value");return}o.hasOwnProperty("value")?cb(e,o.type,s):o.hasOwnProperty("defaultValue")&&cb(e,o.type,Sa(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(e.defaultChecked=!!o.defaultChecked)}function db(e,o,s){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+e._wrapperState.initialValue,s||o===e.value||(e.value=o),e.defaultValue=o}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function cb(e,o,s){(o!=="number"||Xa(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var eb=Array.isArray;function fb(e,o,s,h){if(e=e.options,o){o={};for(var d=0;d<s.length;d++)o["$"+s[d]]=!0;for(s=0;s<e.length;s++)d=o.hasOwnProperty("$"+e[s].value),e[s].selected!==d&&(e[s].selected=d),d&&h&&(e[s].defaultSelected=!0)}else{for(s=""+Sa(s),o=null,d=0;d<e.length;d++){if(e[d].value===s){e[d].selected=!0,h&&(e[d].defaultSelected=!0);return}o!==null||e[d].disabled||(o=e[d])}o!==null&&(o.selected=!0)}}function gb(e,o){if(o.dangerouslySetInnerHTML!=null)throw Error(p(91));return A({},o,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function hb(e,o){var s=o.value;if(s==null){if(s=o.children,o=o.defaultValue,s!=null){if(o!=null)throw Error(p(92));if(eb(s)){if(1<s.length)throw Error(p(93));s=s[0]}o=s}o==null&&(o=""),s=o}e._wrapperState={initialValue:Sa(s)}}function ib(e,o){var s=Sa(o.value),h=Sa(o.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),o.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),h!=null&&(e.defaultValue=""+h)}function jb(e){var o=e.textContent;o===e._wrapperState.initialValue&&o!==""&&o!==null&&(e.value=o)}function kb(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(e,o){return e==null||e==="http://www.w3.org/1999/xhtml"?kb(o):e==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mb,nb=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,s,h,d){MSApp.execUnsafeLocalFunction(function(){return e(o,s,h,d)})}:e}(function(e,o){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=o;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=mb.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;o.firstChild;)e.appendChild(o.firstChild)}});function ob(e,o){if(o){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=o;return}}e.textContent=o}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(e){qb.forEach(function(o){o=o+e.charAt(0).toUpperCase()+e.substring(1),pb[o]=pb[e]})});function rb(e,o,s){return o==null||typeof o=="boolean"||o===""?"":s||typeof o!="number"||o===0||pb.hasOwnProperty(e)&&pb[e]?(""+o).trim():o+"px"}function sb(e,o){e=e.style;for(var s in o)if(o.hasOwnProperty(s)){var h=s.indexOf("--")===0,d=rb(s,o[s],h);s==="float"&&(s="cssFloat"),h?e.setProperty(s,d):e[s]=d}}var tb=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(e,o){if(o){if(tb[e]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(p(137,e));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(p(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(p(61))}if(o.style!=null&&typeof o.style!="object")throw Error(p(62))}}function vb(e,o){if(e.indexOf("-")===-1)return typeof o.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var yb=null,zb=null,Ab=null;function Bb(e){if(e=Cb(e)){if(typeof yb!="function")throw Error(p(280));var o=e.stateNode;o&&(o=Db(o),yb(e.stateNode,e.type,o))}}function Eb(e){zb?Ab?Ab.push(e):Ab=[e]:zb=e}function Fb(){if(zb){var e=zb,o=Ab;if(Ab=zb=null,Bb(e),o)for(e=0;e<o.length;e++)Bb(o[e])}}function Gb(e,o){return e(o)}function Hb(){}var Ib=!1;function Jb(e,o,s){if(Ib)return e(o,s);Ib=!0;try{return Gb(e,o,s)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(e,o){var s=e.stateNode;if(s===null)return null;var h=Db(s);if(h===null)return null;s=h[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(e=e.type,h=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!h;break t;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(p(231,o,typeof s));return s}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(e,o,s,h,d,g,_,j,$){var _t=Array.prototype.slice.call(arguments,3);try{o.apply(s,_t)}catch(_e){this.onError(_e)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(e){Ob=!0,Pb=e}};function Tb(e,o,s,h,d,g,_,j,$){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(e,o,s,h,d,g,_,j,$){if(Tb.apply(this,arguments),Ob){if(Ob){var _t=Pb;Ob=!1,Pb=null}else throw Error(p(198));Qb||(Qb=!0,Rb=_t)}}function Vb(e){var o=e,s=e;if(e.alternate)for(;o.return;)o=o.return;else{e=o;do o=e,o.flags&4098&&(s=o.return),e=o.return;while(e)}return o.tag===3?s:null}function Wb(e){if(e.tag===13){var o=e.memoizedState;if(o===null&&(e=e.alternate,e!==null&&(o=e.memoizedState)),o!==null)return o.dehydrated}return null}function Xb(e){if(Vb(e)!==e)throw Error(p(188))}function Yb(e){var o=e.alternate;if(!o){if(o=Vb(e),o===null)throw Error(p(188));return o!==e?null:e}for(var s=e,h=o;;){var d=s.return;if(d===null)break;var g=d.alternate;if(g===null){if(h=d.return,h!==null){s=h;continue}break}if(d.child===g.child){for(g=d.child;g;){if(g===s)return Xb(d),e;if(g===h)return Xb(d),o;g=g.sibling}throw Error(p(188))}if(s.return!==h.return)s=d,h=g;else{for(var _=!1,j=d.child;j;){if(j===s){_=!0,s=d,h=g;break}if(j===h){_=!0,h=d,s=g;break}j=j.sibling}if(!_){for(j=g.child;j;){if(j===s){_=!0,s=g,h=d;break}if(j===h){_=!0,h=g,s=d;break}j=j.sibling}if(!_)throw Error(p(189))}}if(s.alternate!==h)throw Error(p(190))}if(s.tag!==3)throw Error(p(188));return s.stateNode.current===s?e:o}function Zb(e){return e=Yb(e),e!==null?$b(e):null}function $b(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var o=$b(e);if(o!==null)return o;e=e.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,e,void 0,(e.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(e){return e>>>=0,e===0?32:31-(pc(e)/qc|0)|0}var rc=64,sc=4194304;function tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function uc(e,o){var s=e.pendingLanes;if(s===0)return 0;var h=0,d=e.suspendedLanes,g=e.pingedLanes,_=s&268435455;if(_!==0){var j=_&~d;j!==0?h=tc(j):(g&=_,g!==0&&(h=tc(g)))}else _=s&~d,_!==0?h=tc(_):g!==0&&(h=tc(g));if(h===0)return 0;if(o!==0&&o!==h&&!(o&d)&&(d=h&-h,g=o&-o,d>=g||d===16&&(g&4194240)!==0))return o;if(h&4&&(h|=s&16),o=e.entangledLanes,o!==0)for(e=e.entanglements,o&=h;0<o;)s=31-oc(o),d=1<<s,h|=e[s],o&=~d;return h}function vc(e,o){switch(e){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(e,o){for(var s=e.suspendedLanes,h=e.pingedLanes,d=e.expirationTimes,g=e.pendingLanes;0<g;){var _=31-oc(g),j=1<<_,$=d[_];$===-1?(!(j&s)||j&h)&&(d[_]=vc(j,o)):$<=o&&(e.expiredLanes|=j),g&=~j}}function xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function yc(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function zc(e){for(var o=[],s=0;31>s;s++)o.push(e);return o}function Ac(e,o,s){e.pendingLanes|=o,o!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,o=31-oc(o),e[o]=s}function Bc(e,o){var s=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;var h=e.eventTimes;for(e=e.expirationTimes;0<s;){var d=31-oc(s),g=1<<d;o[d]=0,h[d]=-1,e[d]=-1,s&=~g}}function Cc(e,o){var s=e.entangledLanes|=o;for(e=e.entanglements;s;){var h=31-oc(s),d=1<<h;d&o|e[h]&o&&(e[h]|=o),s&=~d}}var C=0;function Dc(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(e,o){switch(e){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(o.pointerId)}}function Tc(e,o,s,h,d,g){return e===null||e.nativeEvent!==g?(e={blockedOn:o,domEventName:s,eventSystemFlags:h,nativeEvent:g,targetContainers:[d]},o!==null&&(o=Cb(o),o!==null&&Fc(o)),e):(e.eventSystemFlags|=h,o=e.targetContainers,d!==null&&o.indexOf(d)===-1&&o.push(d),e)}function Uc(e,o,s,h,d){switch(o){case"focusin":return Lc=Tc(Lc,e,o,s,h,d),!0;case"dragenter":return Mc=Tc(Mc,e,o,s,h,d),!0;case"mouseover":return Nc=Tc(Nc,e,o,s,h,d),!0;case"pointerover":var g=d.pointerId;return Oc.set(g,Tc(Oc.get(g)||null,e,o,s,h,d)),!0;case"gotpointercapture":return g=d.pointerId,Pc.set(g,Tc(Pc.get(g)||null,e,o,s,h,d)),!0}return!1}function Vc(e){var o=Wc(e.target);if(o!==null){var s=Vb(o);if(s!==null){if(o=s.tag,o===13){if(o=Wb(s),o!==null){e.blockedOn=o,Ic(e.priority,function(){Gc(s)});return}}else if(o===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xc(e){if(e.blockedOn!==null)return!1;for(var o=e.targetContainers;0<o.length;){var s=Yc(e.domEventName,e.eventSystemFlags,o[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var h=new s.constructor(s.type,s);wb=h,s.target.dispatchEvent(h),wb=null}else return o=Cb(s),o!==null&&Fc(o),e.blockedOn=s,!1;o.shift()}return!0}function Zc(e,o,s){Xc(e)&&s.delete(o)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(e,o){e.blockedOn===o&&(e.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(e){function o(d){return ad(d,e)}if(0<Kc.length){ad(Kc[0],e);for(var s=1;s<Kc.length;s++){var h=Kc[s];h.blockedOn===e&&(h.blockedOn=null)}}for(Lc!==null&&ad(Lc,e),Mc!==null&&ad(Mc,e),Nc!==null&&ad(Nc,e),Oc.forEach(o),Pc.forEach(o),s=0;s<Qc.length;s++)h=Qc[s],h.blockedOn===e&&(h.blockedOn=null);for(;0<Qc.length&&(s=Qc[0],s.blockedOn===null);)Vc(s),s.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(e,o,s,h){var d=C,g=cd.transition;cd.transition=null;try{C=1,fd(e,o,s,h)}finally{C=d,cd.transition=g}}function gd(e,o,s,h){var d=C,g=cd.transition;cd.transition=null;try{C=4,fd(e,o,s,h)}finally{C=d,cd.transition=g}}function fd(e,o,s,h){if(dd){var d=Yc(e,o,s,h);if(d===null)hd(e,o,h,id,s),Sc(e,h);else if(Uc(d,e,o,s,h))h.stopPropagation();else if(Sc(e,h),o&4&&-1<Rc.indexOf(e)){for(;d!==null;){var g=Cb(d);if(g!==null&&Ec(g),g=Yc(e,o,s,h),g===null&&hd(e,o,h,id,s),g===d)break;d=g}d!==null&&h.stopPropagation()}else hd(e,o,h,null,s)}}var id=null;function Yc(e,o,s,h){if(id=null,e=xb(h),e=Wc(e),e!==null)if(o=Vb(e),o===null)e=null;else if(s=o.tag,s===13){if(e=Wb(o),e!==null)return e;e=null}else if(s===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;e=null}else o!==e&&(e=null);return id=e,null}function jd(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var e,o=ld,s=o.length,h,d="value"in kd?kd.value:kd.textContent,g=d.length;for(e=0;e<s&&o[e]===d[e];e++);var _=s-e;for(h=1;h<=_&&o[s-h]===d[g-h];h++);return md=d.slice(e,1<h?1-h:void 0)}function od(e){var o=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&o===13&&(e=13)):e=o,e===10&&(e=13),32<=e||e===13?e:0}function pd(){return!0}function qd(){return!1}function rd(e){function o(s,h,d,g,_){this._reactName=s,this._targetInst=d,this.type=h,this.nativeEvent=g,this.target=_,this.currentTarget=null;for(var j in e)e.hasOwnProperty(j)&&(s=e[j],this[j]=s?s(g):g[j]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),o}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yd&&(yd&&e.type==="mousemove"?(wd=e.screenX-yd.screenX,xd=e.screenY-yd.screenY):xd=wd=0,yd=e),wd)},movementY:function(e){return"movementY"in e?e.movementY:xd}}),Bd=rd(Ad),Cd=A({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A({},sd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(e){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(e):(e=Od[e])?!!o[e]:!1}function zd(){return Pd}var Qd=A({},ud,{key:function(e){if(e.key){var o=Md[e.key]||e.key;if(o!=="Unidentified")return o}return e.type==="keypress"?(e=od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Nd[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(e){return e.type==="keypress"?od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Rd=rd(Qd),Sd=A({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A({},Ad,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae=ia&&"CompositionEvent"in window,be=null;ia&&"documentMode"in document&&(be=document.documentMode);var ce=ia&&"TextEvent"in window&&!be,de=ia&&(!ae||be&&8<be&&11>=be),ee=" ",fe=!1;function ge(e,o){switch(e){case"keyup":return $d.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ie=!1;function je(e,o){switch(e){case"compositionend":return he(o);case"keypress":return o.which!==32?null:(fe=!0,ee);case"textInput":return e=o.data,e===ee&&fe?null:e;default:return null}}function ke(e,o){if(ie)return e==="compositionend"||!ae&&ge(e,o)?(e=nd(),md=ld=kd=null,ie=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return de&&o.locale!=="ko"?null:o.data;default:return null}}var le={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me(e){var o=e&&e.nodeName&&e.nodeName.toLowerCase();return o==="input"?!!le[e.type]:o==="textarea"}function ne(e,o,s,h){Eb(h),o=oe(o,"onChange"),0<o.length&&(s=new td("onChange","change",null,s,h),e.push({event:s,listeners:o}))}var pe=null,qe=null;function re(e){se(e,0)}function te(e){var o=ue(e);if(Wa(o))return e}function ve(e,o){if(e==="change")return o}var we=!1;if(ia){var xe;if(ia){var ye="oninput"in document;if(!ye){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye=typeof ze.oninput=="function"}xe=ye}else xe=!1;we=xe&&(!document.documentMode||9<document.documentMode)}function Ae(){pe&&(pe.detachEvent("onpropertychange",Be),qe=pe=null)}function Be(e){if(e.propertyName==="value"&&te(qe)){var o=[];ne(o,qe,e,xb(e)),Jb(re,o)}}function Ce(e,o,s){e==="focusin"?(Ae(),pe=o,qe=s,pe.attachEvent("onpropertychange",Be)):e==="focusout"&&Ae()}function De(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return te(qe)}function Ee(e,o){if(e==="click")return te(o)}function Fe(e,o){if(e==="input"||e==="change")return te(o)}function Ge(e,o){return e===o&&(e!==0||1/e===1/o)||e!==e&&o!==o}var He=typeof Object.is=="function"?Object.is:Ge;function Ie(e,o){if(He(e,o))return!0;if(typeof e!="object"||e===null||typeof o!="object"||o===null)return!1;var s=Object.keys(e),h=Object.keys(o);if(s.length!==h.length)return!1;for(h=0;h<s.length;h++){var d=s[h];if(!ja.call(o,d)||!He(e[d],o[d]))return!1}return!0}function Je(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ke(e,o){var s=Je(e);e=0;for(var h;s;){if(s.nodeType===3){if(h=e+s.textContent.length,e<=o&&h>=o)return{node:s,offset:o-e};e=h}t:{for(;s;){if(s.nextSibling){s=s.nextSibling;break t}s=s.parentNode}s=void 0}s=Je(s)}}function Le(e,o){return e&&o?e===o?!0:e&&e.nodeType===3?!1:o&&o.nodeType===3?Le(e,o.parentNode):"contains"in e?e.contains(o):e.compareDocumentPosition?!!(e.compareDocumentPosition(o)&16):!1:!1}function Me(){for(var e=window,o=Xa();o instanceof e.HTMLIFrameElement;){try{var s=typeof o.contentWindow.location.href=="string"}catch{s=!1}if(s)e=o.contentWindow;else break;o=Xa(e.document)}return o}function Ne(e){var o=e&&e.nodeName&&e.nodeName.toLowerCase();return o&&(o==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||o==="textarea"||e.contentEditable==="true")}function Oe(e){var o=Me(),s=e.focusedElem,h=e.selectionRange;if(o!==s&&s&&s.ownerDocument&&Le(s.ownerDocument.documentElement,s)){if(h!==null&&Ne(s)){if(o=h.start,e=h.end,e===void 0&&(e=o),"selectionStart"in s)s.selectionStart=o,s.selectionEnd=Math.min(e,s.value.length);else if(e=(o=s.ownerDocument||document)&&o.defaultView||window,e.getSelection){e=e.getSelection();var d=s.textContent.length,g=Math.min(h.start,d);h=h.end===void 0?g:Math.min(h.end,d),!e.extend&&g>h&&(d=h,h=g,g=d),d=Ke(s,g);var _=Ke(s,h);d&&_&&(e.rangeCount!==1||e.anchorNode!==d.node||e.anchorOffset!==d.offset||e.focusNode!==_.node||e.focusOffset!==_.offset)&&(o=o.createRange(),o.setStart(d.node,d.offset),e.removeAllRanges(),g>h?(e.addRange(o),e.extend(_.node,_.offset)):(o.setEnd(_.node,_.offset),e.addRange(o)))}}for(o=[],e=s;e=e.parentNode;)e.nodeType===1&&o.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<o.length;s++)e=o[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pe=ia&&"documentMode"in document&&11>=document.documentMode,Qe=null,Re=null,Se=null,Te=!1;function Ue(e,o,s){var h=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Te||Qe==null||Qe!==Xa(h)||(h=Qe,"selectionStart"in h&&Ne(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Se&&Ie(Se,h)||(Se=h,h=oe(Re,"onSelect"),0<h.length&&(o=new td("onSelect","select",null,o,s),e.push({event:o,listeners:h}),o.target=Qe)))}function Ve(e,o){var s={};return s[e.toLowerCase()]=o.toLowerCase(),s["Webkit"+e]="webkit"+o,s["Moz"+e]="moz"+o,s}var We={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe={},Ye={};ia&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We.animationend.animation,delete We.animationiteration.animation,delete We.animationstart.animation),"TransitionEvent"in window||delete We.transitionend.transition);function Ze(e){if(Xe[e])return Xe[e];if(!We[e])return e;var o=We[e],s;for(s in o)if(o.hasOwnProperty(s)&&s in Ye)return Xe[e]=o[s];return e}var $e=Ze("animationend"),af=Ze("animationiteration"),bf=Ze("animationstart"),cf=Ze("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(e,o){df.set(e,o),fa(o,[e])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(e,o,s){var h=e.type||"unknown-event";e.currentTarget=s,Ub(h,o,void 0,e),e.currentTarget=null}function se(e,o){o=(o&4)!==0;for(var s=0;s<e.length;s++){var h=e[s],d=h.event;h=h.listeners;t:{var g=void 0;if(o)for(var _=h.length-1;0<=_;_--){var j=h[_],$=j.instance,_t=j.currentTarget;if(j=j.listener,$!==g&&d.isPropagationStopped())break t;nf(d,j,_t),g=$}else for(_=0;_<h.length;_++){if(j=h[_],$=j.instance,_t=j.currentTarget,j=j.listener,$!==g&&d.isPropagationStopped())break t;nf(d,j,_t),g=$}}}if(Qb)throw e=Rb,Qb=!1,Rb=null,e}function D(e,o){var s=o[of];s===void 0&&(s=o[of]=new Set);var h=e+"__bubble";s.has(h)||(pf(o,e,2,!1),s.add(h))}function qf(e,o,s){var h=0;o&&(h|=4),pf(s,e,h,o)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[rf]){e[rf]=!0,da.forEach(function(s){s!=="selectionchange"&&(mf.has(s)||qf(s,!1,e),qf(s,!0,e))});var o=e.nodeType===9?e:e.ownerDocument;o===null||o[rf]||(o[rf]=!0,qf("selectionchange",!1,o))}}function pf(e,o,s,h){switch(jd(o)){case 1:var d=ed;break;case 4:d=gd;break;default:d=fd}s=d.bind(null,o,s,e),d=void 0,!Lb||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(d=!0),h?d!==void 0?e.addEventListener(o,s,{capture:!0,passive:d}):e.addEventListener(o,s,!0):d!==void 0?e.addEventListener(o,s,{passive:d}):e.addEventListener(o,s,!1)}function hd(e,o,s,h,d){var g=h;if(!(o&1)&&!(o&2)&&h!==null)t:for(;;){if(h===null)return;var _=h.tag;if(_===3||_===4){var j=h.stateNode.containerInfo;if(j===d||j.nodeType===8&&j.parentNode===d)break;if(_===4)for(_=h.return;_!==null;){var $=_.tag;if(($===3||$===4)&&($=_.stateNode.containerInfo,$===d||$.nodeType===8&&$.parentNode===d))return;_=_.return}for(;j!==null;){if(_=Wc(j),_===null)return;if($=_.tag,$===5||$===6){h=g=_;continue t}j=j.parentNode}}h=h.return}Jb(function(){var _t=g,_e=xb(s),_r=[];t:{var _i=df.get(e);if(_i!==void 0){var _n=td,_s=e;switch(e){case"keypress":if(od(s)===0)break t;case"keydown":case"keyup":_n=Rd;break;case"focusin":_s="focus",_n=Fd;break;case"focusout":_s="blur",_n=Fd;break;case"beforeblur":case"afterblur":_n=Fd;break;case"click":if(s.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_n=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_n=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_n=Vd;break;case $e:case af:case bf:_n=Hd;break;case cf:_n=Xd;break;case"scroll":_n=vd;break;case"wheel":_n=Zd;break;case"copy":case"cut":case"paste":_n=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_n=Td}var _l=(o&4)!==0,Ap=!_l&&e==="scroll",_h=_l?_i!==null?_i+"Capture":null:_i;_l=[];for(var _p=_t,ty;_p!==null;){ty=_p;var ry=ty.stateNode;if(ty.tag===5&&ry!==null&&(ty=ry,_h!==null&&(ry=Kb(_p,_h),ry!=null&&_l.push(tf(_p,ry,ty)))),Ap)break;_p=_p.return}0<_l.length&&(_i=new _n(_i,_s,null,s,_e),_r.push({event:_i,listeners:_l}))}}if(!(o&7)){t:{if(_i=e==="mouseover"||e==="pointerover",_n=e==="mouseout"||e==="pointerout",_i&&s!==wb&&(_s=s.relatedTarget||s.fromElement)&&(Wc(_s)||_s[uf]))break t;if((_n||_i)&&(_i=_e.window===_e?_e:(_i=_e.ownerDocument)?_i.defaultView||_i.parentWindow:window,_n?(_s=s.relatedTarget||s.toElement,_n=_t,_s=_s?Wc(_s):null,_s!==null&&(Ap=Vb(_s),_s!==Ap||_s.tag!==5&&_s.tag!==6)&&(_s=null)):(_n=null,_s=_t),_n!==_s)){if(_l=Bd,ry="onMouseLeave",_h="onMouseEnter",_p="mouse",(e==="pointerout"||e==="pointerover")&&(_l=Td,ry="onPointerLeave",_h="onPointerEnter",_p="pointer"),Ap=_n==null?_i:ue(_n),ty=_s==null?_i:ue(_s),_i=new _l(ry,_p+"leave",_n,s,_e),_i.target=Ap,_i.relatedTarget=ty,ry=null,Wc(_e)===_t&&(_l=new _l(_h,_p+"enter",_s,s,_e),_l.target=ty,_l.relatedTarget=Ap,ry=_l),Ap=ry,_n&&_s)e:{for(_l=_n,_h=_s,_p=0,ty=_l;ty;ty=vf(ty))_p++;for(ty=0,ry=_h;ry;ry=vf(ry))ty++;for(;0<_p-ty;)_l=vf(_l),_p--;for(;0<ty-_p;)_h=vf(_h),ty--;for(;_p--;){if(_l===_h||_h!==null&&_l===_h.alternate)break e;_l=vf(_l),_h=vf(_h)}_l=null}else _l=null;_n!==null&&wf(_r,_i,_n,_l,!1),_s!==null&&Ap!==null&&wf(_r,Ap,_s,_l,!0)}}t:{if(_i=_t?ue(_t):window,_n=_i.nodeName&&_i.nodeName.toLowerCase(),_n==="select"||_n==="input"&&_i.type==="file")var ly=ve;else if(me(_i))if(we)ly=Fe;else{ly=De;var uy=Ce}else(_n=_i.nodeName)&&_n.toLowerCase()==="input"&&(_i.type==="checkbox"||_i.type==="radio")&&(ly=Ee);if(ly&&(ly=ly(e,_t))){ne(_r,ly,s,_e);break t}uy&&uy(e,_i,_t),e==="focusout"&&(uy=_i._wrapperState)&&uy.controlled&&_i.type==="number"&&cb(_i,"number",_i.value)}switch(uy=_t?ue(_t):window,e){case"focusin":(me(uy)||uy.contentEditable==="true")&&(Qe=uy,Re=_t,Se=null);break;case"focusout":Se=Re=Qe=null;break;case"mousedown":Te=!0;break;case"contextmenu":case"mouseup":case"dragend":Te=!1,Ue(_r,s,_e);break;case"selectionchange":if(Pe)break;case"keydown":case"keyup":Ue(_r,s,_e)}var py;if(ae)t:{switch(e){case"compositionstart":var fy="onCompositionStart";break t;case"compositionend":fy="onCompositionEnd";break t;case"compositionupdate":fy="onCompositionUpdate";break t}fy=void 0}else ie?ge(e,s)&&(fy="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(fy="onCompositionStart");fy&&(de&&s.locale!=="ko"&&(ie||fy!=="onCompositionStart"?fy==="onCompositionEnd"&&ie&&(py=nd()):(kd=_e,ld="value"in kd?kd.value:kd.textContent,ie=!0)),uy=oe(_t,fy),0<uy.length&&(fy=new Ld(fy,e,null,s,_e),_r.push({event:fy,listeners:uy}),py?fy.data=py:(py=he(s),py!==null&&(fy.data=py)))),(py=ce?je(e,s):ke(e,s))&&(_t=oe(_t,"onBeforeInput"),0<_t.length&&(_e=new Ld("onBeforeInput","beforeinput",null,s,_e),_r.push({event:_e,listeners:_t}),_e.data=py))}se(_r,o)})}function tf(e,o,s){return{instance:e,listener:o,currentTarget:s}}function oe(e,o){for(var s=o+"Capture",h=[];e!==null;){var d=e,g=d.stateNode;d.tag===5&&g!==null&&(d=g,g=Kb(e,s),g!=null&&h.unshift(tf(e,g,d)),g=Kb(e,o),g!=null&&h.push(tf(e,g,d))),e=e.return}return h}function vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function wf(e,o,s,h,d){for(var g=o._reactName,_=[];s!==null&&s!==h;){var j=s,$=j.alternate,_t=j.stateNode;if($!==null&&$===h)break;j.tag===5&&_t!==null&&(j=_t,d?($=Kb(s,g),$!=null&&_.unshift(tf(s,$,j))):d||($=Kb(s,g),$!=null&&_.push(tf(s,$,j)))),s=s.return}_.length!==0&&e.push({event:o,listeners:_})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(e){return(typeof e=="string"?e:""+e).replace(xf,`
`).replace(yf,"")}function Af(e,o,s){if(o=zf(o),zf(e)!==o&&s)throw Error(p(425))}function Bf(){}var Cf=null,Df=null;function Ef(e,o){return e==="textarea"||e==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(e){return Hf.resolve(null).then(e).catch(If)}:Ff;function If(e){setTimeout(function(){throw e})}function Kf(e,o){var s=o,h=0;do{var d=s.nextSibling;if(e.removeChild(s),d&&d.nodeType===8)if(s=d.data,s==="/$"){if(h===0){e.removeChild(d),bd(o);return}h--}else s!=="$"&&s!=="$?"&&s!=="$!"||h++;s=d}while(s);bd(o)}function Lf(e){for(;e!=null;e=e.nextSibling){var o=e.nodeType;if(o===1||o===3)break;if(o===8){if(o=e.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return e}function Mf(e){e=e.previousSibling;for(var o=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(o===0)return e;o--}else s==="/$"&&o++}e=e.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(e){var o=e[Of];if(o)return o;for(var s=e.parentNode;s;){if(o=s[uf]||s[Of]){if(s=o.alternate,o.child!==null||s!==null&&s.child!==null)for(e=Mf(e);e!==null;){if(s=e[Of])return s;e=Mf(e)}return o}e=s,s=e.parentNode}return null}function Cb(e){return e=e[Of]||e[uf],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ue(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(p(33))}function Db(e){return e[Pf]||null}var Sf=[],Tf=-1;function Uf(e){return{current:e}}function E(e){0>Tf||(e.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G(e,o){Tf++,Sf[Tf]=e.current,e.current=o}var Vf={},H$2=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(e,o){var s=e.type.contextTypes;if(!s)return Vf;var h=e.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var d={},g;for(g in s)d[g]=o[g];return h&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=d),d}function Zf(e){return e=e.childContextTypes,e!=null}function $f(){E(Wf),E(H$2)}function ag(e,o,s){if(H$2.current!==Vf)throw Error(p(168));G(H$2,o),G(Wf,s)}function bg(e,o,s){var h=e.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return s;h=h.getChildContext();for(var d in h)if(!(d in o))throw Error(p(108,Ra(e)||"Unknown",d));return A({},s,h)}function cg(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$2.current,G(H$2,e),G(Wf,Wf.current),!0}function dg(e,o,s){var h=e.stateNode;if(!h)throw Error(p(169));s?(e=bg(e,o,Xf),h.__reactInternalMemoizedMergedChildContext=e,E(Wf),E(H$2),G(H$2,e)):E(Wf),G(Wf,s)}var eg=null,fg=!1,gg=!1;function hg(e){eg===null?eg=[e]:eg.push(e)}function ig(e){fg=!0,hg(e)}function jg(){if(!gg&&eg!==null){gg=!0;var e=0,o=C;try{var s=eg;for(C=1;e<s.length;e++){var h=s[e];do h=h(!0);while(h!==null)}eg=null,fg=!1}catch(d){throw eg!==null&&(eg=eg.slice(e+1)),ac(fc,jg),d}finally{C=o,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(e,o){kg[lg++]=ng,kg[lg++]=mg,mg=e,ng=o}function ug(e,o,s){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=e;var h=rg;e=sg;var d=32-oc(h)-1;h&=~(1<<d),s+=1;var g=32-oc(o)+d;if(30<g){var _=d-d%5;g=(h&(1<<_)-1).toString(32),h>>=_,d-=_,rg=1<<32-oc(o)+d|s<<d|h,sg=g+e}else rg=1<<g|s<<d|h,sg=e}function vg(e){e.return!==null&&(tg(e,1),ug(e,1,0))}function wg(e){for(;e===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;e===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I=!1,zg=null;function Ag(e,o){var s=Bg(5,null,null,0);s.elementType="DELETED",s.stateNode=o,s.return=e,o=e.deletions,o===null?(e.deletions=[s],e.flags|=16):o.push(s)}function Cg(e,o){switch(e.tag){case 5:var s=e.type;return o=o.nodeType!==1||s.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(e.stateNode=o,xg=e,yg=Lf(o.firstChild),!0):!1;case 6:return o=e.pendingProps===""||o.nodeType!==3?null:o,o!==null?(e.stateNode=o,xg=e,yg=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(s=qg!==null?{id:rg,overflow:sg}:null,e.memoizedState={dehydrated:o,treeContext:s,retryLane:1073741824},s=Bg(18,null,null,0),s.stateNode=o,s.return=e,e.child=s,xg=e,yg=null,!0):!1;default:return!1}}function Dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Eg(e){if(I){var o=yg;if(o){var s=o;if(!Cg(e,o)){if(Dg(e))throw Error(p(418));o=Lf(s.nextSibling);var h=xg;o&&Cg(e,o)?Ag(h,s):(e.flags=e.flags&-4097|2,I=!1,xg=e)}}else{if(Dg(e))throw Error(p(418));e.flags=e.flags&-4097|2,I=!1,xg=e}}}function Fg(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;xg=e}function Gg(e){if(e!==xg)return!1;if(!I)return Fg(e),I=!0,!1;var o;if((o=e.tag!==3)&&!(o=e.tag!==5)&&(o=e.type,o=o!=="head"&&o!=="body"&&!Ef(e.type,e.memoizedProps)),o&&(o=yg)){if(Dg(e))throw Hg(),Error(p(418));for(;o;)Ag(e,o),o=Lf(o.nextSibling)}if(Fg(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(p(317));t:{for(e=e.nextSibling,o=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(o===0){yg=Lf(e.nextSibling);break t}o--}else s!=="$"&&s!=="$!"&&s!=="$?"||o++}e=e.nextSibling}yg=null}}else yg=xg?Lf(e.stateNode.nextSibling):null;return!0}function Hg(){for(var e=yg;e;)e=Lf(e.nextSibling)}function Ig(){yg=xg=null,I=!1}function Jg(e){zg===null?zg=[e]:zg.push(e)}var Kg=ua.ReactCurrentBatchConfig;function Lg(e,o,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(p(309));var h=s.stateNode}if(!h)throw Error(p(147,e));var d=h,g=""+e;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===g?o.ref:(o=function(_){var j=d.refs;_===null?delete j[g]:j[g]=_},o._stringRef=g,o)}if(typeof e!="string")throw Error(p(284));if(!s._owner)throw Error(p(290,e))}return e}function Mg(e,o){throw e=Object.prototype.toString.call(o),Error(p(31,e==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":e))}function Ng(e){var o=e._init;return o(e._payload)}function Og(e){function o(_h,_p){if(e){var ty=_h.deletions;ty===null?(_h.deletions=[_p],_h.flags|=16):ty.push(_p)}}function s(_h,_p){if(!e)return null;for(;_p!==null;)o(_h,_p),_p=_p.sibling;return null}function h(_h,_p){for(_h=new Map;_p!==null;)_p.key!==null?_h.set(_p.key,_p):_h.set(_p.index,_p),_p=_p.sibling;return _h}function d(_h,_p){return _h=Pg(_h,_p),_h.index=0,_h.sibling=null,_h}function g(_h,_p,ty){return _h.index=ty,e?(ty=_h.alternate,ty!==null?(ty=ty.index,ty<_p?(_h.flags|=2,_p):ty):(_h.flags|=2,_p)):(_h.flags|=1048576,_p)}function _(_h){return e&&_h.alternate===null&&(_h.flags|=2),_h}function j(_h,_p,ty,ry){return _p===null||_p.tag!==6?(_p=Qg(ty,_h.mode,ry),_p.return=_h,_p):(_p=d(_p,ty),_p.return=_h,_p)}function $(_h,_p,ty,ry){var ly=ty.type;return ly===ya?_e(_h,_p,ty.props.children,ry,ty.key):_p!==null&&(_p.elementType===ly||typeof ly=="object"&&ly!==null&&ly.$$typeof===Ha&&Ng(ly)===_p.type)?(ry=d(_p,ty.props),ry.ref=Lg(_h,_p,ty),ry.return=_h,ry):(ry=Rg(ty.type,ty.key,ty.props,null,_h.mode,ry),ry.ref=Lg(_h,_p,ty),ry.return=_h,ry)}function _t(_h,_p,ty,ry){return _p===null||_p.tag!==4||_p.stateNode.containerInfo!==ty.containerInfo||_p.stateNode.implementation!==ty.implementation?(_p=Sg(ty,_h.mode,ry),_p.return=_h,_p):(_p=d(_p,ty.children||[]),_p.return=_h,_p)}function _e(_h,_p,ty,ry,ly){return _p===null||_p.tag!==7?(_p=Tg(ty,_h.mode,ry,ly),_p.return=_h,_p):(_p=d(_p,ty),_p.return=_h,_p)}function _r(_h,_p,ty){if(typeof _p=="string"&&_p!==""||typeof _p=="number")return _p=Qg(""+_p,_h.mode,ty),_p.return=_h,_p;if(typeof _p=="object"&&_p!==null){switch(_p.$$typeof){case va:return ty=Rg(_p.type,_p.key,_p.props,null,_h.mode,ty),ty.ref=Lg(_h,null,_p),ty.return=_h,ty;case wa:return _p=Sg(_p,_h.mode,ty),_p.return=_h,_p;case Ha:var ry=_p._init;return _r(_h,ry(_p._payload),ty)}if(eb(_p)||Ka(_p))return _p=Tg(_p,_h.mode,ty,null),_p.return=_h,_p;Mg(_h,_p)}return null}function _i(_h,_p,ty,ry){var ly=_p!==null?_p.key:null;if(typeof ty=="string"&&ty!==""||typeof ty=="number")return ly!==null?null:j(_h,_p,""+ty,ry);if(typeof ty=="object"&&ty!==null){switch(ty.$$typeof){case va:return ty.key===ly?$(_h,_p,ty,ry):null;case wa:return ty.key===ly?_t(_h,_p,ty,ry):null;case Ha:return ly=ty._init,_i(_h,_p,ly(ty._payload),ry)}if(eb(ty)||Ka(ty))return ly!==null?null:_e(_h,_p,ty,ry,null);Mg(_h,ty)}return null}function _n(_h,_p,ty,ry,ly){if(typeof ry=="string"&&ry!==""||typeof ry=="number")return _h=_h.get(ty)||null,j(_p,_h,""+ry,ly);if(typeof ry=="object"&&ry!==null){switch(ry.$$typeof){case va:return _h=_h.get(ry.key===null?ty:ry.key)||null,$(_p,_h,ry,ly);case wa:return _h=_h.get(ry.key===null?ty:ry.key)||null,_t(_p,_h,ry,ly);case Ha:var uy=ry._init;return _n(_h,_p,ty,uy(ry._payload),ly)}if(eb(ry)||Ka(ry))return _h=_h.get(ty)||null,_e(_p,_h,ry,ly,null);Mg(_p,ry)}return null}function _s(_h,_p,ty,ry){for(var ly=null,uy=null,py=_p,fy=_p=0,my=null;py!==null&&fy<ty.length;fy++){py.index>fy?(my=py,py=null):my=py.sibling;var xy=_i(_h,py,ty[fy],ry);if(xy===null){py===null&&(py=my);break}e&&py&&xy.alternate===null&&o(_h,py),_p=g(xy,_p,fy),uy===null?ly=xy:uy.sibling=xy,uy=xy,py=my}if(fy===ty.length)return s(_h,py),I&&tg(_h,fy),ly;if(py===null){for(;fy<ty.length;fy++)py=_r(_h,ty[fy],ry),py!==null&&(_p=g(py,_p,fy),uy===null?ly=py:uy.sibling=py,uy=py);return I&&tg(_h,fy),ly}for(py=h(_h,py);fy<ty.length;fy++)my=_n(py,_h,fy,ty[fy],ry),my!==null&&(e&&my.alternate!==null&&py.delete(my.key===null?fy:my.key),_p=g(my,_p,fy),uy===null?ly=my:uy.sibling=my,uy=my);return e&&py.forEach(function(Ly){return o(_h,Ly)}),I&&tg(_h,fy),ly}function _l(_h,_p,ty,ry){var ly=Ka(ty);if(typeof ly!="function")throw Error(p(150));if(ty=ly.call(ty),ty==null)throw Error(p(151));for(var uy=ly=null,py=_p,fy=_p=0,my=null,xy=ty.next();py!==null&&!xy.done;fy++,xy=ty.next()){py.index>fy?(my=py,py=null):my=py.sibling;var Ly=_i(_h,py,xy.value,ry);if(Ly===null){py===null&&(py=my);break}e&&py&&Ly.alternate===null&&o(_h,py),_p=g(Ly,_p,fy),uy===null?ly=Ly:uy.sibling=Ly,uy=Ly,py=my}if(xy.done)return s(_h,py),I&&tg(_h,fy),ly;if(py===null){for(;!xy.done;fy++,xy=ty.next())xy=_r(_h,xy.value,ry),xy!==null&&(_p=g(xy,_p,fy),uy===null?ly=xy:uy.sibling=xy,uy=xy);return I&&tg(_h,fy),ly}for(py=h(_h,py);!xy.done;fy++,xy=ty.next())xy=_n(py,_h,fy,xy.value,ry),xy!==null&&(e&&xy.alternate!==null&&py.delete(xy.key===null?fy:xy.key),_p=g(xy,_p,fy),uy===null?ly=xy:uy.sibling=xy,uy=xy);return e&&py.forEach(function(My){return o(_h,My)}),I&&tg(_h,fy),ly}function Ap(_h,_p,ty,ry){if(typeof ty=="object"&&ty!==null&&ty.type===ya&&ty.key===null&&(ty=ty.props.children),typeof ty=="object"&&ty!==null){switch(ty.$$typeof){case va:t:{for(var ly=ty.key,uy=_p;uy!==null;){if(uy.key===ly){if(ly=ty.type,ly===ya){if(uy.tag===7){s(_h,uy.sibling),_p=d(uy,ty.props.children),_p.return=_h,_h=_p;break t}}else if(uy.elementType===ly||typeof ly=="object"&&ly!==null&&ly.$$typeof===Ha&&Ng(ly)===uy.type){s(_h,uy.sibling),_p=d(uy,ty.props),_p.ref=Lg(_h,uy,ty),_p.return=_h,_h=_p;break t}s(_h,uy);break}else o(_h,uy);uy=uy.sibling}ty.type===ya?(_p=Tg(ty.props.children,_h.mode,ry,ty.key),_p.return=_h,_h=_p):(ry=Rg(ty.type,ty.key,ty.props,null,_h.mode,ry),ry.ref=Lg(_h,_p,ty),ry.return=_h,_h=ry)}return _(_h);case wa:t:{for(uy=ty.key;_p!==null;){if(_p.key===uy)if(_p.tag===4&&_p.stateNode.containerInfo===ty.containerInfo&&_p.stateNode.implementation===ty.implementation){s(_h,_p.sibling),_p=d(_p,ty.children||[]),_p.return=_h,_h=_p;break t}else{s(_h,_p);break}else o(_h,_p);_p=_p.sibling}_p=Sg(ty,_h.mode,ry),_p.return=_h,_h=_p}return _(_h);case Ha:return uy=ty._init,Ap(_h,_p,uy(ty._payload),ry)}if(eb(ty))return _s(_h,_p,ty,ry);if(Ka(ty))return _l(_h,_p,ty,ry);Mg(_h,ty)}return typeof ty=="string"&&ty!==""||typeof ty=="number"?(ty=""+ty,_p!==null&&_p.tag===6?(s(_h,_p.sibling),_p=d(_p,ty),_p.return=_h,_h=_p):(s(_h,_p),_p=Qg(ty,_h.mode,ry),_p.return=_h,_h=_p),_(_h)):s(_h,_p)}return Ap}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(e){var o=Wg.current;E(Wg),e._currentValue=o}function bh(e,o,s){for(;e!==null;){var h=e.alternate;if((e.childLanes&o)!==o?(e.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),e===s)break;e=e.return}}function ch(e,o){Xg=e,Zg=Yg=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&o&&(dh=!0),e.firstContext=null)}function eh(e){var o=e._currentValue;if(Zg!==e)if(e={context:e,memoizedValue:o,next:null},Yg===null){if(Xg===null)throw Error(p(308));Yg=e,Xg.dependencies={lanes:0,firstContext:e}}else Yg=Yg.next=e;return o}var fh=null;function gh(e){fh===null?fh=[e]:fh.push(e)}function hh(e,o,s,h){var d=o.interleaved;return d===null?(s.next=s,gh(o)):(s.next=d.next,d.next=s),o.interleaved=s,ih(e,h)}function ih(e,o){e.lanes|=o;var s=e.alternate;for(s!==null&&(s.lanes|=o),s=e,e=e.return;e!==null;)e.childLanes|=o,s=e.alternate,s!==null&&(s.childLanes|=o),s=e,e=e.return;return s.tag===3?s.stateNode:null}var jh=!1;function kh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(e,o){e=e.updateQueue,o.updateQueue===e&&(o.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mh(e,o){return{eventTime:e,lane:o,tag:0,payload:null,callback:null,next:null}}function nh(e,o,s){var h=e.updateQueue;if(h===null)return null;if(h=h.shared,K&2){var d=h.pending;return d===null?o.next=o:(o.next=d.next,d.next=o),h.pending=o,ih(e,s)}return d=h.interleaved,d===null?(o.next=o,gh(h)):(o.next=d.next,d.next=o),h.interleaved=o,ih(e,s)}function oh(e,o,s){if(o=o.updateQueue,o!==null&&(o=o.shared,(s&4194240)!==0)){var h=o.lanes;h&=e.pendingLanes,s|=h,o.lanes=s,Cc(e,s)}}function ph(e,o){var s=e.updateQueue,h=e.alternate;if(h!==null&&(h=h.updateQueue,s===h)){var d=null,g=null;if(s=s.firstBaseUpdate,s!==null){do{var _={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};g===null?d=g=_:g=g.next=_,s=s.next}while(s!==null);g===null?d=g=o:g=g.next=o}else d=g=o;s={baseState:h.baseState,firstBaseUpdate:d,lastBaseUpdate:g,shared:h.shared,effects:h.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=o:e.next=o,s.lastBaseUpdate=o}function qh(e,o,s,h){var d=e.updateQueue;jh=!1;var g=d.firstBaseUpdate,_=d.lastBaseUpdate,j=d.shared.pending;if(j!==null){d.shared.pending=null;var $=j,_t=$.next;$.next=null,_===null?g=_t:_.next=_t,_=$;var _e=e.alternate;_e!==null&&(_e=_e.updateQueue,j=_e.lastBaseUpdate,j!==_&&(j===null?_e.firstBaseUpdate=_t:j.next=_t,_e.lastBaseUpdate=$))}if(g!==null){var _r=d.baseState;_=0,_e=_t=$=null,j=g;do{var _i=j.lane,_n=j.eventTime;if((h&_i)===_i){_e!==null&&(_e=_e.next={eventTime:_n,lane:0,tag:j.tag,payload:j.payload,callback:j.callback,next:null});t:{var _s=e,_l=j;switch(_i=o,_n=s,_l.tag){case 1:if(_s=_l.payload,typeof _s=="function"){_r=_s.call(_n,_r,_i);break t}_r=_s;break t;case 3:_s.flags=_s.flags&-65537|128;case 0:if(_s=_l.payload,_i=typeof _s=="function"?_s.call(_n,_r,_i):_s,_i==null)break t;_r=A({},_r,_i);break t;case 2:jh=!0}}j.callback!==null&&j.lane!==0&&(e.flags|=64,_i=d.effects,_i===null?d.effects=[j]:_i.push(j))}else _n={eventTime:_n,lane:_i,tag:j.tag,payload:j.payload,callback:j.callback,next:null},_e===null?(_t=_e=_n,$=_r):_e=_e.next=_n,_|=_i;if(j=j.next,j===null){if(j=d.shared.pending,j===null)break;_i=j,j=_i.next,_i.next=null,d.lastBaseUpdate=_i,d.shared.pending=null}}while(!0);if(_e===null&&($=_r),d.baseState=$,d.firstBaseUpdate=_t,d.lastBaseUpdate=_e,o=d.shared.interleaved,o!==null){d=o;do _|=d.lane,d=d.next;while(d!==o)}else g===null&&(d.shared.lanes=0);rh|=_,e.lanes=_,e.memoizedState=_r}}function sh(e,o,s){if(e=o.effects,o.effects=null,e!==null)for(o=0;o<e.length;o++){var h=e[o],d=h.callback;if(d!==null){if(h.callback=null,h=s,typeof d!="function")throw Error(p(191,d));d.call(h)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(e){if(e===th)throw Error(p(174));return e}function yh(e,o){switch(G(wh,o),G(vh,e),G(uh,th),e=o.nodeType,e){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:lb(null,"");break;default:e=e===8?o.parentNode:o,o=e.namespaceURI||null,e=e.tagName,o=lb(o,e)}E(uh),G(uh,o)}function zh(){E(uh),E(vh),E(wh)}function Ah(e){xh(wh.current);var o=xh(uh.current),s=lb(o,e.type);o!==s&&(G(vh,e),G(uh,s))}function Bh(e){vh.current===e&&(E(uh),E(vh))}var L=Uf(0);function Ch(e){for(var o=e;o!==null;){if(o.tag===13){var s=o.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Dh=[];function Eh(){for(var e=0;e<Dh.length;e++)Dh[e]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M=null,N=null,O=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P(){throw Error(p(321))}function Mh(e,o){if(o===null)return!1;for(var s=0;s<o.length&&s<e.length;s++)if(!He(e[s],o[s]))return!1;return!0}function Nh(e,o,s,h,d,g){if(Hh=g,M=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Fh.current=e===null||e.memoizedState===null?Oh:Ph,e=s(h,d),Jh){g=0;do{if(Jh=!1,Kh=0,25<=g)throw Error(p(301));g+=1,O=N=null,o.updateQueue=null,Fh.current=Qh,e=s(h,d)}while(Jh)}if(Fh.current=Rh,o=N!==null&&N.next!==null,Hh=0,O=N=M=null,Ih=!1,o)throw Error(p(300));return e}function Sh(){var e=Kh!==0;return Kh=0,e}function Th(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O===null?M.memoizedState=O=e:O=O.next=e,O}function Uh(){if(N===null){var e=M.alternate;e=e!==null?e.memoizedState:null}else e=N.next;var o=O===null?M.memoizedState:O.next;if(o!==null)O=o,N=e;else{if(e===null)throw Error(p(310));N=e,e={memoizedState:N.memoizedState,baseState:N.baseState,baseQueue:N.baseQueue,queue:N.queue,next:null},O===null?M.memoizedState=O=e:O=O.next=e}return O}function Vh(e,o){return typeof o=="function"?o(e):o}function Wh(e){var o=Uh(),s=o.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var h=N,d=h.baseQueue,g=s.pending;if(g!==null){if(d!==null){var _=d.next;d.next=g.next,g.next=_}h.baseQueue=d=g,s.pending=null}if(d!==null){g=d.next,h=h.baseState;var j=_=null,$=null,_t=g;do{var _e=_t.lane;if((Hh&_e)===_e)$!==null&&($=$.next={lane:0,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null}),h=_t.hasEagerState?_t.eagerState:e(h,_t.action);else{var _r={lane:_e,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null};$===null?(j=$=_r,_=h):$=$.next=_r,M.lanes|=_e,rh|=_e}_t=_t.next}while(_t!==null&&_t!==g);$===null?_=h:$.next=j,He(h,o.memoizedState)||(dh=!0),o.memoizedState=h,o.baseState=_,o.baseQueue=$,s.lastRenderedState=h}if(e=s.interleaved,e!==null){d=e;do g=d.lane,M.lanes|=g,rh|=g,d=d.next;while(d!==e)}else d===null&&(s.lanes=0);return[o.memoizedState,s.dispatch]}function Xh(e){var o=Uh(),s=o.queue;if(s===null)throw Error(p(311));s.lastRenderedReducer=e;var h=s.dispatch,d=s.pending,g=o.memoizedState;if(d!==null){s.pending=null;var _=d=d.next;do g=e(g,_.action),_=_.next;while(_!==d);He(g,o.memoizedState)||(dh=!0),o.memoizedState=g,o.baseQueue===null&&(o.baseState=g),s.lastRenderedState=g}return[g,h]}function Yh(){}function Zh(e,o){var s=M,h=Uh(),d=o(),g=!He(h.memoizedState,d);if(g&&(h.memoizedState=d,dh=!0),h=h.queue,$h(ai.bind(null,s,h,e),[e]),h.getSnapshot!==o||g||O!==null&&O.memoizedState.tag&1){if(s.flags|=2048,bi(9,ci.bind(null,s,h,d,o),void 0,null),Q===null)throw Error(p(349));Hh&30||di(s,o,d)}return d}function di(e,o,s){e.flags|=16384,e={getSnapshot:o,value:s},o=M.updateQueue,o===null?(o={lastEffect:null,stores:null},M.updateQueue=o,o.stores=[e]):(s=o.stores,s===null?o.stores=[e]:s.push(e))}function ci(e,o,s,h){o.value=s,o.getSnapshot=h,ei(o)&&fi(e)}function ai(e,o,s){return s(function(){ei(o)&&fi(e)})}function ei(e){var o=e.getSnapshot;e=e.value;try{var s=o();return!He(e,s)}catch{return!0}}function fi(e){var o=ih(e,1);o!==null&&gi(o,e,1,-1)}function hi(e){var o=Th();return typeof e=="function"&&(e=e()),o.memoizedState=o.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:e},o.queue=e,e=e.dispatch=ii.bind(null,M,e),[o.memoizedState,e]}function bi(e,o,s,h){return e={tag:e,create:o,destroy:s,deps:h,next:null},o=M.updateQueue,o===null?(o={lastEffect:null,stores:null},M.updateQueue=o,o.lastEffect=e.next=e):(s=o.lastEffect,s===null?o.lastEffect=e.next=e:(h=s.next,s.next=e,e.next=h,o.lastEffect=e)),e}function ji(){return Uh().memoizedState}function ki(e,o,s,h){var d=Th();M.flags|=e,d.memoizedState=bi(1|o,s,void 0,h===void 0?null:h)}function li(e,o,s,h){var d=Uh();h=h===void 0?null:h;var g=void 0;if(N!==null){var _=N.memoizedState;if(g=_.destroy,h!==null&&Mh(h,_.deps)){d.memoizedState=bi(o,s,g,h);return}}M.flags|=e,d.memoizedState=bi(1|o,s,g,h)}function mi(e,o){return ki(8390656,8,e,o)}function $h(e,o){return li(2048,8,e,o)}function ni(e,o){return li(4,2,e,o)}function oi(e,o){return li(4,4,e,o)}function pi(e,o){if(typeof o=="function")return e=e(),o(e),function(){o(null)};if(o!=null)return e=e(),o.current=e,function(){o.current=null}}function qi(e,o,s){return s=s!=null?s.concat([e]):null,li(4,4,pi.bind(null,o,e),s)}function ri(){}function si(e,o){var s=Uh();o=o===void 0?null:o;var h=s.memoizedState;return h!==null&&o!==null&&Mh(o,h[1])?h[0]:(s.memoizedState=[e,o],e)}function ti(e,o){var s=Uh();o=o===void 0?null:o;var h=s.memoizedState;return h!==null&&o!==null&&Mh(o,h[1])?h[0]:(e=e(),s.memoizedState=[e,o],e)}function ui(e,o,s){return Hh&21?(He(s,o)||(s=yc(),M.lanes|=s,rh|=s,e.baseState=!0),o):(e.baseState&&(e.baseState=!1,dh=!0),e.memoizedState=s)}function vi(e,o){var s=C;C=s!==0&&4>s?s:4,e(!0);var h=Gh.transition;Gh.transition={};try{e(!1),o()}finally{C=s,Gh.transition=h}}function wi(){return Uh().memoizedState}function xi(e,o,s){var h=yi(e);if(s={lane:h,action:s,hasEagerState:!1,eagerState:null,next:null},zi(e))Ai(o,s);else if(s=hh(e,o,s,h),s!==null){var d=R();gi(s,e,h,d),Bi(s,o,h)}}function ii(e,o,s){var h=yi(e),d={lane:h,action:s,hasEagerState:!1,eagerState:null,next:null};if(zi(e))Ai(o,d);else{var g=e.alternate;if(e.lanes===0&&(g===null||g.lanes===0)&&(g=o.lastRenderedReducer,g!==null))try{var _=o.lastRenderedState,j=g(_,s);if(d.hasEagerState=!0,d.eagerState=j,He(j,_)){var $=o.interleaved;$===null?(d.next=d,gh(o)):(d.next=$.next,$.next=d),o.interleaved=d;return}}catch{}finally{}s=hh(e,o,d,h),s!==null&&(d=R(),gi(s,e,h,d),Bi(s,o,h))}}function zi(e){var o=e.alternate;return e===M||o!==null&&o===M}function Ai(e,o){Jh=Ih=!0;var s=e.pending;s===null?o.next=o:(o.next=s.next,s.next=o),e.pending=o}function Bi(e,o,s){if(s&4194240){var h=o.lanes;h&=e.pendingLanes,s|=h,o.lanes=s,Cc(e,s)}}var Rh={readContext:eh,useCallback:P,useContext:P,useEffect:P,useImperativeHandle:P,useInsertionEffect:P,useLayoutEffect:P,useMemo:P,useReducer:P,useRef:P,useState:P,useDebugValue:P,useDeferredValue:P,useTransition:P,useMutableSource:P,useSyncExternalStore:P,useId:P,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(e,o){return Th().memoizedState=[e,o===void 0?null:o],e},useContext:eh,useEffect:mi,useImperativeHandle:function(e,o,s){return s=s!=null?s.concat([e]):null,ki(4194308,4,pi.bind(null,o,e),s)},useLayoutEffect:function(e,o){return ki(4194308,4,e,o)},useInsertionEffect:function(e,o){return ki(4,2,e,o)},useMemo:function(e,o){var s=Th();return o=o===void 0?null:o,e=e(),s.memoizedState=[e,o],e},useReducer:function(e,o,s){var h=Th();return o=s!==void 0?s(o):o,h.memoizedState=h.baseState=o,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:o},h.queue=e,e=e.dispatch=xi.bind(null,M,e),[h.memoizedState,e]},useRef:function(e){var o=Th();return e={current:e},o.memoizedState=e},useState:hi,useDebugValue:ri,useDeferredValue:function(e){return Th().memoizedState=e},useTransition:function(){var e=hi(!1),o=e[0];return e=vi.bind(null,e[1]),Th().memoizedState=e,[o,e]},useMutableSource:function(){},useSyncExternalStore:function(e,o,s){var h=M,d=Th();if(I){if(s===void 0)throw Error(p(407));s=s()}else{if(s=o(),Q===null)throw Error(p(349));Hh&30||di(h,o,s)}d.memoizedState=s;var g={value:s,getSnapshot:o};return d.queue=g,mi(ai.bind(null,h,g,e),[e]),h.flags|=2048,bi(9,ci.bind(null,h,g,s,o),void 0,null),s},useId:function(){var e=Th(),o=Q.identifierPrefix;if(I){var s=sg,h=rg;s=(h&~(1<<32-oc(h)-1)).toString(32)+s,o=":"+o+"R"+s,s=Kh++,0<s&&(o+="H"+s.toString(32)),o+=":"}else s=Lh++,o=":"+o+"r"+s.toString(32)+":";return e.memoizedState=o},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var o=Uh();return ui(o,N.memoizedState,e)},useTransition:function(){var e=Wh(Vh)[0],o=Uh().memoizedState;return[e,o]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(e){var o=Uh();return N===null?o.memoizedState=e:ui(o,N.memoizedState,e)},useTransition:function(){var e=Xh(Vh)[0],o=Uh().memoizedState;return[e,o]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(e,o){if(e&&e.defaultProps){o=A({},o),e=e.defaultProps;for(var s in e)o[s]===void 0&&(o[s]=e[s]);return o}return o}function Di(e,o,s,h){o=e.memoizedState,s=s(h,o),s=s==null?o:A({},o,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var Ei={isMounted:function(e){return(e=e._reactInternals)?Vb(e)===e:!1},enqueueSetState:function(e,o,s){e=e._reactInternals;var h=R(),d=yi(e),g=mh(h,d);g.payload=o,s!=null&&(g.callback=s),o=nh(e,g,d),o!==null&&(gi(o,e,d,h),oh(o,e,d))},enqueueReplaceState:function(e,o,s){e=e._reactInternals;var h=R(),d=yi(e),g=mh(h,d);g.tag=1,g.payload=o,s!=null&&(g.callback=s),o=nh(e,g,d),o!==null&&(gi(o,e,d,h),oh(o,e,d))},enqueueForceUpdate:function(e,o){e=e._reactInternals;var s=R(),h=yi(e),d=mh(s,h);d.tag=2,o!=null&&(d.callback=o),o=nh(e,d,h),o!==null&&(gi(o,e,h,s),oh(o,e,h))}};function Fi(e,o,s,h,d,g,_){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(h,g,_):o.prototype&&o.prototype.isPureReactComponent?!Ie(s,h)||!Ie(d,g):!0}function Gi(e,o,s){var h=!1,d=Vf,g=o.contextType;return typeof g=="object"&&g!==null?g=eh(g):(d=Zf(o)?Xf:H$2.current,h=o.contextTypes,g=(h=h!=null)?Yf(e,d):Vf),o=new o(s,g),e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Ei,e.stateNode=o,o._reactInternals=e,h&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=d,e.__reactInternalMemoizedMaskedChildContext=g),o}function Hi(e,o,s,h){e=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(s,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(s,h),o.state!==e&&Ei.enqueueReplaceState(o,o.state,null)}function Ii(e,o,s,h){var d=e.stateNode;d.props=s,d.state=e.memoizedState,d.refs={},kh(e);var g=o.contextType;typeof g=="object"&&g!==null?d.context=eh(g):(g=Zf(o)?Xf:H$2.current,d.context=Yf(e,g)),d.state=e.memoizedState,g=o.getDerivedStateFromProps,typeof g=="function"&&(Di(e,o,g,s),d.state=e.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(o=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),o!==d.state&&Ei.enqueueReplaceState(d,d.state,null),qh(e,s,d,h),d.state=e.memoizedState),typeof d.componentDidMount=="function"&&(e.flags|=4194308)}function Ji(e,o){try{var s="",h=o;do s+=Pa(h),h=h.return;while(h);var d=s}catch(g){d=`
Error generating stack: `+g.message+`
`+g.stack}return{value:e,source:o,stack:d,digest:null}}function Ki(e,o,s){return{value:e,source:null,stack:s??null,digest:o??null}}function Li(e,o){try{console.error(o.value)}catch(s){setTimeout(function(){throw s})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(e,o,s){s=mh(-1,s),s.tag=3,s.payload={element:null};var h=o.value;return s.callback=function(){Oi||(Oi=!0,Pi=h),Li(e,o)},s}function Qi(e,o,s){s=mh(-1,s),s.tag=3;var h=e.type.getDerivedStateFromError;if(typeof h=="function"){var d=o.value;s.payload=function(){return h(d)},s.callback=function(){Li(e,o)}}var g=e.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(s.callback=function(){Li(e,o),typeof h!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var _=o.stack;this.componentDidCatch(o.value,{componentStack:_!==null?_:""})}),s}function Si(e,o,s){var h=e.pingCache;if(h===null){h=e.pingCache=new Mi;var d=new Set;h.set(o,d)}else d=h.get(o),d===void 0&&(d=new Set,h.set(o,d));d.has(s)||(d.add(s),e=Ti.bind(null,e,o,s),o.then(e,e))}function Ui(e){do{var o;if((o=e.tag===13)&&(o=e.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return e;e=e.return}while(e!==null);return null}function Vi(e,o,s,h,d){return e.mode&1?(e.flags|=65536,e.lanes=d,e):(e===o?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(o=mh(-1,1),o.tag=2,nh(s,o,1))),s.lanes|=1),e)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(e,o,s,h){o.child=e===null?Vg(o,null,s,h):Ug(o,e.child,s,h)}function Yi(e,o,s,h,d){s=s.render;var g=o.ref;return ch(o,d),h=Nh(e,o,s,h,g,d),s=Sh(),e!==null&&!dh?(o.updateQueue=e.updateQueue,o.flags&=-2053,e.lanes&=~d,Zi(e,o,d)):(I&&s&&vg(o),o.flags|=1,Xi(e,o,h,d),o.child)}function $i(e,o,s,h,d){if(e===null){var g=s.type;return typeof g=="function"&&!aj(g)&&g.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(o.tag=15,o.type=g,bj(e,o,g,h,d)):(e=Rg(s.type,null,h,o,o.mode,d),e.ref=o.ref,e.return=o,o.child=e)}if(g=e.child,!(e.lanes&d)){var _=g.memoizedProps;if(s=s.compare,s=s!==null?s:Ie,s(_,h)&&e.ref===o.ref)return Zi(e,o,d)}return o.flags|=1,e=Pg(g,h),e.ref=o.ref,e.return=o,o.child=e}function bj(e,o,s,h,d){if(e!==null){var g=e.memoizedProps;if(Ie(g,h)&&e.ref===o.ref)if(dh=!1,o.pendingProps=h=g,(e.lanes&d)!==0)e.flags&131072&&(dh=!0);else return o.lanes=e.lanes,Zi(e,o,d)}return cj(e,o,s,h,d)}function dj(e,o,s){var h=o.pendingProps,d=h.children,g=e!==null?e.memoizedState:null;if(h.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},G(ej,fj),fj|=s;else{if(!(s&1073741824))return e=g!==null?g.baseLanes|s:s,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:e,cachePool:null,transitions:null},o.updateQueue=null,G(ej,fj),fj|=e,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=g!==null?g.baseLanes:s,G(ej,fj),fj|=h}else g!==null?(h=g.baseLanes|s,o.memoizedState=null):h=s,G(ej,fj),fj|=h;return Xi(e,o,d,s),o.child}function gj(e,o){var s=o.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(o.flags|=512,o.flags|=2097152)}function cj(e,o,s,h,d){var g=Zf(s)?Xf:H$2.current;return g=Yf(o,g),ch(o,d),s=Nh(e,o,s,h,g,d),h=Sh(),e!==null&&!dh?(o.updateQueue=e.updateQueue,o.flags&=-2053,e.lanes&=~d,Zi(e,o,d)):(I&&h&&vg(o),o.flags|=1,Xi(e,o,s,d),o.child)}function hj(e,o,s,h,d){if(Zf(s)){var g=!0;cg(o)}else g=!1;if(ch(o,d),o.stateNode===null)ij(e,o),Gi(o,s,h),Ii(o,s,h,d),h=!0;else if(e===null){var _=o.stateNode,j=o.memoizedProps;_.props=j;var $=_.context,_t=s.contextType;typeof _t=="object"&&_t!==null?_t=eh(_t):(_t=Zf(s)?Xf:H$2.current,_t=Yf(o,_t));var _e=s.getDerivedStateFromProps,_r=typeof _e=="function"||typeof _.getSnapshotBeforeUpdate=="function";_r||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(j!==h||$!==_t)&&Hi(o,_,h,_t),jh=!1;var _i=o.memoizedState;_.state=_i,qh(o,h,_,d),$=o.memoizedState,j!==h||_i!==$||Wf.current||jh?(typeof _e=="function"&&(Di(o,s,_e,h),$=o.memoizedState),(j=jh||Fi(o,s,j,h,_i,$,_t))?(_r||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(o.flags|=4194308)):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=$),_.props=h,_.state=$,_.context=_t,h=j):(typeof _.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{_=o.stateNode,lh(e,o),j=o.memoizedProps,_t=o.type===o.elementType?j:Ci(o.type,j),_.props=_t,_r=o.pendingProps,_i=_.context,$=s.contextType,typeof $=="object"&&$!==null?$=eh($):($=Zf(s)?Xf:H$2.current,$=Yf(o,$));var _n=s.getDerivedStateFromProps;(_e=typeof _n=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(j!==_r||_i!==$)&&Hi(o,_,h,$),jh=!1,_i=o.memoizedState,_.state=_i,qh(o,h,_,d);var _s=o.memoizedState;j!==_r||_i!==_s||Wf.current||jh?(typeof _n=="function"&&(Di(o,s,_n,h),_s=o.memoizedState),(_t=jh||Fi(o,s,_t,h,_i,_s,$)||!1)?(_e||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(h,_s,$),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(h,_s,$)),typeof _.componentDidUpdate=="function"&&(o.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof _.componentDidUpdate!="function"||j===e.memoizedProps&&_i===e.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||j===e.memoizedProps&&_i===e.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=_s),_.props=h,_.state=_s,_.context=$,h=_t):(typeof _.componentDidUpdate!="function"||j===e.memoizedProps&&_i===e.memoizedState||(o.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||j===e.memoizedProps&&_i===e.memoizedState||(o.flags|=1024),h=!1)}return jj(e,o,s,h,g,d)}function jj(e,o,s,h,d,g){gj(e,o);var _=(o.flags&128)!==0;if(!h&&!_)return d&&dg(o,s,!1),Zi(e,o,g);h=o.stateNode,Wi.current=o;var j=_&&typeof s.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,e!==null&&_?(o.child=Ug(o,e.child,null,g),o.child=Ug(o,null,j,g)):Xi(e,o,j,g),o.memoizedState=h.state,d&&dg(o,s,!0),o.child}function kj(e){var o=e.stateNode;o.pendingContext?ag(e,o.pendingContext,o.pendingContext!==o.context):o.context&&ag(e,o.context,!1),yh(e,o.containerInfo)}function lj(e,o,s,h,d){return Ig(),Jg(d),o.flags|=256,Xi(e,o,s,h),o.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(e){return{baseLanes:e,cachePool:null,transitions:null}}function oj(e,o,s){var h=o.pendingProps,d=L.current,g=!1,_=(o.flags&128)!==0,j;if((j=_)||(j=e!==null&&e.memoizedState===null?!1:(d&2)!==0),j?(g=!0,o.flags&=-129):(e===null||e.memoizedState!==null)&&(d|=1),G(L,d&1),e===null)return Eg(o),e=o.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(o.mode&1?e.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(_=h.children,e=h.fallback,g?(h=o.mode,g=o.child,_={mode:"hidden",children:_},!(h&1)&&g!==null?(g.childLanes=0,g.pendingProps=_):g=pj(_,h,0,null),e=Tg(e,h,s,null),g.return=o,e.return=o,g.sibling=e,o.child=g,o.child.memoizedState=nj(s),o.memoizedState=mj,e):qj(o,_));if(d=e.memoizedState,d!==null&&(j=d.dehydrated,j!==null))return rj(e,o,_,h,j,d,s);if(g){g=h.fallback,_=o.mode,d=e.child,j=d.sibling;var $={mode:"hidden",children:h.children};return!(_&1)&&o.child!==d?(h=o.child,h.childLanes=0,h.pendingProps=$,o.deletions=null):(h=Pg(d,$),h.subtreeFlags=d.subtreeFlags&14680064),j!==null?g=Pg(j,g):(g=Tg(g,_,s,null),g.flags|=2),g.return=o,h.return=o,h.sibling=g,o.child=h,h=g,g=o.child,_=e.child.memoizedState,_=_===null?nj(s):{baseLanes:_.baseLanes|s,cachePool:null,transitions:_.transitions},g.memoizedState=_,g.childLanes=e.childLanes&~s,o.memoizedState=mj,h}return g=e.child,e=g.sibling,h=Pg(g,{mode:"visible",children:h.children}),!(o.mode&1)&&(h.lanes=s),h.return=o,h.sibling=null,e!==null&&(s=o.deletions,s===null?(o.deletions=[e],o.flags|=16):s.push(e)),o.child=h,o.memoizedState=null,h}function qj(e,o){return o=pj({mode:"visible",children:o},e.mode,0,null),o.return=e,e.child=o}function sj(e,o,s,h){return h!==null&&Jg(h),Ug(o,e.child,null,s),e=qj(o,o.pendingProps.children),e.flags|=2,o.memoizedState=null,e}function rj(e,o,s,h,d,g,_){if(s)return o.flags&256?(o.flags&=-257,h=Ki(Error(p(422))),sj(e,o,_,h)):o.memoizedState!==null?(o.child=e.child,o.flags|=128,null):(g=h.fallback,d=o.mode,h=pj({mode:"visible",children:h.children},d,0,null),g=Tg(g,d,_,null),g.flags|=2,h.return=o,g.return=o,h.sibling=g,o.child=h,o.mode&1&&Ug(o,e.child,null,_),o.child.memoizedState=nj(_),o.memoizedState=mj,g);if(!(o.mode&1))return sj(e,o,_,null);if(d.data==="$!"){if(h=d.nextSibling&&d.nextSibling.dataset,h)var j=h.dgst;return h=j,g=Error(p(419)),h=Ki(g,h,void 0),sj(e,o,_,h)}if(j=(_&e.childLanes)!==0,dh||j){if(h=Q,h!==null){switch(_&-_){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(h.suspendedLanes|_)?0:d,d!==0&&d!==g.retryLane&&(g.retryLane=d,ih(e,d),gi(h,e,d,-1))}return tj(),h=Ki(Error(p(421))),sj(e,o,_,h)}return d.data==="$?"?(o.flags|=128,o.child=e.child,o=uj.bind(null,e),d._reactRetry=o,null):(e=g.treeContext,yg=Lf(d.nextSibling),xg=o,I=!0,zg=null,e!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=e.id,sg=e.overflow,qg=o),o=qj(o,h.children),o.flags|=4096,o)}function vj(e,o,s){e.lanes|=o;var h=e.alternate;h!==null&&(h.lanes|=o),bh(e.return,o,s)}function wj(e,o,s,h,d){var g=e.memoizedState;g===null?e.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:s,tailMode:d}:(g.isBackwards=o,g.rendering=null,g.renderingStartTime=0,g.last=h,g.tail=s,g.tailMode=d)}function xj(e,o,s){var h=o.pendingProps,d=h.revealOrder,g=h.tail;if(Xi(e,o,h.children,s),h=L.current,h&2)h=h&1|2,o.flags|=128;else{if(e!==null&&e.flags&128)t:for(e=o.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&vj(e,s,o);else if(e.tag===19)vj(e,s,o);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===o)break t;for(;e.sibling===null;){if(e.return===null||e.return===o)break t;e=e.return}e.sibling.return=e.return,e=e.sibling}h&=1}if(G(L,h),!(o.mode&1))o.memoizedState=null;else switch(d){case"forwards":for(s=o.child,d=null;s!==null;)e=s.alternate,e!==null&&Ch(e)===null&&(d=s),s=s.sibling;s=d,s===null?(d=o.child,o.child=null):(d=s.sibling,s.sibling=null),wj(o,!1,d,s,g);break;case"backwards":for(s=null,d=o.child,o.child=null;d!==null;){if(e=d.alternate,e!==null&&Ch(e)===null){o.child=d;break}e=d.sibling,d.sibling=s,s=d,d=e}wj(o,!0,s,null,g);break;case"together":wj(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ij(e,o){!(o.mode&1)&&e!==null&&(e.alternate=null,o.alternate=null,o.flags|=2)}function Zi(e,o,s){if(e!==null&&(o.dependencies=e.dependencies),rh|=o.lanes,!(s&o.childLanes))return null;if(e!==null&&o.child!==e.child)throw Error(p(153));if(o.child!==null){for(e=o.child,s=Pg(e,e.pendingProps),o.child=s,s.return=o;e.sibling!==null;)e=e.sibling,s=s.sibling=Pg(e,e.pendingProps),s.return=o;s.sibling=null}return o.child}function yj(e,o,s){switch(o.tag){case 3:kj(o),Ig();break;case 5:Ah(o);break;case 1:Zf(o.type)&&cg(o);break;case 4:yh(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,d=o.memoizedProps.value;G(Wg,h._currentValue),h._currentValue=d;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(G(L,L.current&1),o.flags|=128,null):s&o.child.childLanes?oj(e,o,s):(G(L,L.current&1),e=Zi(e,o,s),e!==null?e.sibling:null);G(L,L.current&1);break;case 19:if(h=(s&o.childLanes)!==0,e.flags&128){if(h)return xj(e,o,s);o.flags|=128}if(d=o.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),G(L,L.current),h)break;return null;case 22:case 23:return o.lanes=0,dj(e,o,s)}return Zi(e,o,s)}var zj,Aj,Bj,Cj;zj=function(e,o){for(var s=o.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break;for(;s.sibling===null;){if(s.return===null||s.return===o)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Aj=function(){};Bj=function(e,o,s,h){var d=e.memoizedProps;if(d!==h){e=o.stateNode,xh(uh.current);var g=null;switch(s){case"input":d=Ya(e,d),h=Ya(e,h),g=[];break;case"select":d=A({},d,{value:void 0}),h=A({},h,{value:void 0}),g=[];break;case"textarea":d=gb(e,d),h=gb(e,h),g=[];break;default:typeof d.onClick!="function"&&typeof h.onClick=="function"&&(e.onclick=Bf)}ub(s,h);var _;s=null;for(_t in d)if(!h.hasOwnProperty(_t)&&d.hasOwnProperty(_t)&&d[_t]!=null)if(_t==="style"){var j=d[_t];for(_ in j)j.hasOwnProperty(_)&&(s||(s={}),s[_]="")}else _t!=="dangerouslySetInnerHTML"&&_t!=="children"&&_t!=="suppressContentEditableWarning"&&_t!=="suppressHydrationWarning"&&_t!=="autoFocus"&&(ea.hasOwnProperty(_t)?g||(g=[]):(g=g||[]).push(_t,null));for(_t in h){var $=h[_t];if(j=d!=null?d[_t]:void 0,h.hasOwnProperty(_t)&&$!==j&&($!=null||j!=null))if(_t==="style")if(j){for(_ in j)!j.hasOwnProperty(_)||$&&$.hasOwnProperty(_)||(s||(s={}),s[_]="");for(_ in $)$.hasOwnProperty(_)&&j[_]!==$[_]&&(s||(s={}),s[_]=$[_])}else s||(g||(g=[]),g.push(_t,s)),s=$;else _t==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,j=j?j.__html:void 0,$!=null&&j!==$&&(g=g||[]).push(_t,$)):_t==="children"?typeof $!="string"&&typeof $!="number"||(g=g||[]).push(_t,""+$):_t!=="suppressContentEditableWarning"&&_t!=="suppressHydrationWarning"&&(ea.hasOwnProperty(_t)?($!=null&&_t==="onScroll"&&D("scroll",e),g||j===$||(g=[])):(g=g||[]).push(_t,$))}s&&(g=g||[]).push("style",s);var _t=g;(o.updateQueue=_t)&&(o.flags|=4)}};Cj=function(e,o,s,h){s!==h&&(o.flags|=4)};function Dj(e,o){if(!I)switch(e.tailMode){case"hidden":o=e.tail;for(var s=null;o!==null;)o.alternate!==null&&(s=o),o=o.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var h=null;s!==null;)s.alternate!==null&&(h=s),s=s.sibling;h===null?o||e.tail===null?e.tail=null:e.tail.sibling=null:h.sibling=null}}function S(e){var o=e.alternate!==null&&e.alternate.child===e.child,s=0,h=0;if(o)for(var d=e.child;d!==null;)s|=d.lanes|d.childLanes,h|=d.subtreeFlags&14680064,h|=d.flags&14680064,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)s|=d.lanes|d.childLanes,h|=d.subtreeFlags,h|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=h,e.childLanes=s,o}function Ej(e,o,s){var h=o.pendingProps;switch(wg(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(o),null;case 1:return Zf(o.type)&&$f(),S(o),null;case 3:return h=o.stateNode,zh(),E(Wf),E(H$2),Eh(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(e===null||e.child===null)&&(Gg(o)?o.flags|=4:e===null||e.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(e,o),S(o),null;case 5:Bh(o);var d=xh(wh.current);if(s=o.type,e!==null&&o.stateNode!=null)Bj(e,o,s,h,d),e.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(p(166));return S(o),null}if(e=xh(uh.current),Gg(o)){h=o.stateNode,s=o.type;var g=o.memoizedProps;switch(h[Of]=o,h[Pf]=g,e=(o.mode&1)!==0,s){case"dialog":D("cancel",h),D("close",h);break;case"iframe":case"object":case"embed":D("load",h);break;case"video":case"audio":for(d=0;d<lf.length;d++)D(lf[d],h);break;case"source":D("error",h);break;case"img":case"image":case"link":D("error",h),D("load",h);break;case"details":D("toggle",h);break;case"input":Za(h,g),D("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!g.multiple},D("invalid",h);break;case"textarea":hb(h,g),D("invalid",h)}ub(s,g),d=null;for(var _ in g)if(g.hasOwnProperty(_)){var j=g[_];_==="children"?typeof j=="string"?h.textContent!==j&&(g.suppressHydrationWarning!==!0&&Af(h.textContent,j,e),d=["children",j]):typeof j=="number"&&h.textContent!==""+j&&(g.suppressHydrationWarning!==!0&&Af(h.textContent,j,e),d=["children",""+j]):ea.hasOwnProperty(_)&&j!=null&&_==="onScroll"&&D("scroll",h)}switch(s){case"input":Va(h),db(h,g,!0);break;case"textarea":Va(h),jb(h);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(h.onclick=Bf)}h=d,o.updateQueue=h,h!==null&&(o.flags|=4)}else{_=d.nodeType===9?d:d.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kb(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=_.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof h.is=="string"?e=_.createElement(s,{is:h.is}):(e=_.createElement(s),s==="select"&&(_=e,h.multiple?_.multiple=!0:h.size&&(_.size=h.size))):e=_.createElementNS(e,s),e[Of]=o,e[Pf]=h,zj(e,o,!1,!1),o.stateNode=e;t:{switch(_=vb(s,h),s){case"dialog":D("cancel",e),D("close",e),d=h;break;case"iframe":case"object":case"embed":D("load",e),d=h;break;case"video":case"audio":for(d=0;d<lf.length;d++)D(lf[d],e);d=h;break;case"source":D("error",e),d=h;break;case"img":case"image":case"link":D("error",e),D("load",e),d=h;break;case"details":D("toggle",e),d=h;break;case"input":Za(e,h),d=Ya(e,h),D("invalid",e);break;case"option":d=h;break;case"select":e._wrapperState={wasMultiple:!!h.multiple},d=A({},h,{value:void 0}),D("invalid",e);break;case"textarea":hb(e,h),d=gb(e,h),D("invalid",e);break;default:d=h}ub(s,d),j=d;for(g in j)if(j.hasOwnProperty(g)){var $=j[g];g==="style"?sb(e,$):g==="dangerouslySetInnerHTML"?($=$?$.__html:void 0,$!=null&&nb(e,$)):g==="children"?typeof $=="string"?(s!=="textarea"||$!=="")&&ob(e,$):typeof $=="number"&&ob(e,""+$):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(ea.hasOwnProperty(g)?$!=null&&g==="onScroll"&&D("scroll",e):$!=null&&ta(e,g,$,_))}switch(s){case"input":Va(e),db(e,h,!1);break;case"textarea":Va(e),jb(e);break;case"option":h.value!=null&&e.setAttribute("value",""+Sa(h.value));break;case"select":e.multiple=!!h.multiple,g=h.value,g!=null?fb(e,!!h.multiple,g,!1):h.defaultValue!=null&&fb(e,!!h.multiple,h.defaultValue,!0);break;default:typeof d.onClick=="function"&&(e.onclick=Bf)}switch(s){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return S(o),null;case 6:if(e&&o.stateNode!=null)Cj(e,o,e.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(p(166));if(s=xh(wh.current),xh(uh.current),Gg(o)){if(h=o.stateNode,s=o.memoizedProps,h[Of]=o,(g=h.nodeValue!==s)&&(e=xg,e!==null))switch(e.tag){case 3:Af(h.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Af(h.nodeValue,s,(e.mode&1)!==0)}g&&(o.flags|=4)}else h=(s.nodeType===9?s:s.ownerDocument).createTextNode(h),h[Of]=o,o.stateNode=h}return S(o),null;case 13:if(E(L),h=o.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(I&&yg!==null&&o.mode&1&&!(o.flags&128))Hg(),Ig(),o.flags|=98560,g=!1;else if(g=Gg(o),h!==null&&h.dehydrated!==null){if(e===null){if(!g)throw Error(p(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(p(317));g[Of]=o}else Ig(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;S(o),g=!1}else zg!==null&&(Fj(zg),zg=null),g=!0;if(!g)return o.flags&65536?o:null}return o.flags&128?(o.lanes=s,o):(h=h!==null,h!==(e!==null&&e.memoizedState!==null)&&h&&(o.child.flags|=8192,o.mode&1&&(e===null||L.current&1?T===0&&(T=3):tj())),o.updateQueue!==null&&(o.flags|=4),S(o),null);case 4:return zh(),Aj(e,o),e===null&&sf(o.stateNode.containerInfo),S(o),null;case 10:return ah(o.type._context),S(o),null;case 17:return Zf(o.type)&&$f(),S(o),null;case 19:if(E(L),g=o.memoizedState,g===null)return S(o),null;if(h=(o.flags&128)!==0,_=g.rendering,_===null)if(h)Dj(g,!1);else{if(T!==0||e!==null&&e.flags&128)for(e=o.child;e!==null;){if(_=Ch(e),_!==null){for(o.flags|=128,Dj(g,!1),h=_.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=s,s=o.child;s!==null;)g=s,e=h,g.flags&=14680066,_=g.alternate,_===null?(g.childLanes=0,g.lanes=e,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=_.childLanes,g.lanes=_.lanes,g.child=_.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=_.memoizedProps,g.memoizedState=_.memoizedState,g.updateQueue=_.updateQueue,g.type=_.type,e=_.dependencies,g.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return G(L,L.current&1|2),o.child}e=e.sibling}g.tail!==null&&B()>Gj&&(o.flags|=128,h=!0,Dj(g,!1),o.lanes=4194304)}else{if(!h)if(e=Ch(_),e!==null){if(o.flags|=128,h=!0,s=e.updateQueue,s!==null&&(o.updateQueue=s,o.flags|=4),Dj(g,!0),g.tail===null&&g.tailMode==="hidden"&&!_.alternate&&!I)return S(o),null}else 2*B()-g.renderingStartTime>Gj&&s!==1073741824&&(o.flags|=128,h=!0,Dj(g,!1),o.lanes=4194304);g.isBackwards?(_.sibling=o.child,o.child=_):(s=g.last,s!==null?s.sibling=_:o.child=_,g.last=_)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=B(),o.sibling=null,s=L.current,G(L,h?s&1|2:s&1),o):(S(o),null);case 22:case 23:return Hj(),h=o.memoizedState!==null,e!==null&&e.memoizedState!==null!==h&&(o.flags|=8192),h&&o.mode&1?fj&1073741824&&(S(o),o.subtreeFlags&6&&(o.flags|=8192)):S(o),null;case 24:return null;case 25:return null}throw Error(p(156,o.tag))}function Ij(e,o){switch(wg(o),o.tag){case 1:return Zf(o.type)&&$f(),e=o.flags,e&65536?(o.flags=e&-65537|128,o):null;case 3:return zh(),E(Wf),E(H$2),Eh(),e=o.flags,e&65536&&!(e&128)?(o.flags=e&-65537|128,o):null;case 5:return Bh(o),null;case 13:if(E(L),e=o.memoizedState,e!==null&&e.dehydrated!==null){if(o.alternate===null)throw Error(p(340));Ig()}return e=o.flags,e&65536?(o.flags=e&-65537|128,o):null;case 19:return E(L),null;case 4:return zh(),null;case 10:return ah(o.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V=null;function Lj(e,o){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(h){W(e,o,h)}else s.current=null}function Mj(e,o,s){try{s()}catch(h){W(e,o,h)}}var Nj=!1;function Oj(e,o){if(Cf=dd,e=Me(),Ne(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else t:{s=(s=e.ownerDocument)&&s.defaultView||window;var h=s.getSelection&&s.getSelection();if(h&&h.rangeCount!==0){s=h.anchorNode;var d=h.anchorOffset,g=h.focusNode;h=h.focusOffset;try{s.nodeType,g.nodeType}catch{s=null;break t}var _=0,j=-1,$=-1,_t=0,_e=0,_r=e,_i=null;e:for(;;){for(var _n;_r!==s||d!==0&&_r.nodeType!==3||(j=_+d),_r!==g||h!==0&&_r.nodeType!==3||($=_+h),_r.nodeType===3&&(_+=_r.nodeValue.length),(_n=_r.firstChild)!==null;)_i=_r,_r=_n;for(;;){if(_r===e)break e;if(_i===s&&++_t===d&&(j=_),_i===g&&++_e===h&&($=_),(_n=_r.nextSibling)!==null)break;_r=_i,_i=_r.parentNode}_r=_n}s=j===-1||$===-1?null:{start:j,end:$}}else s=null}s=s||{start:0,end:0}}else s=null;for(Df={focusedElem:e,selectionRange:s},dd=!1,V=o;V!==null;)if(o=V,e=o.child,(o.subtreeFlags&1028)!==0&&e!==null)e.return=o,V=e;else for(;V!==null;){o=V;try{var _s=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(_s!==null){var _l=_s.memoizedProps,Ap=_s.memoizedState,_h=o.stateNode,_p=_h.getSnapshotBeforeUpdate(o.elementType===o.type?_l:Ci(o.type,_l),Ap);_h.__reactInternalSnapshotBeforeUpdate=_p}break;case 3:var ty=o.stateNode.containerInfo;ty.nodeType===1?ty.textContent="":ty.nodeType===9&&ty.documentElement&&ty.removeChild(ty.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p(163))}}catch(ry){W(o,o.return,ry)}if(e=o.sibling,e!==null){e.return=o.return,V=e;break}V=o.return}return _s=Nj,Nj=!1,_s}function Pj(e,o,s){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var d=h=h.next;do{if((d.tag&e)===e){var g=d.destroy;d.destroy=void 0,g!==void 0&&Mj(o,s,g)}d=d.next}while(d!==h)}}function Qj(e,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var s=o=o.next;do{if((s.tag&e)===e){var h=s.create;s.destroy=h()}s=s.next}while(s!==o)}}function Rj(e){var o=e.ref;if(o!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof o=="function"?o(e):o.current=e}}function Sj(e){var o=e.alternate;o!==null&&(e.alternate=null,Sj(o)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(o=e.stateNode,o!==null&&(delete o[Of],delete o[Pf],delete o[of],delete o[Qf],delete o[Rf])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tj(e){return e.tag===5||e.tag===3||e.tag===4}function Uj(e){t:for(;;){for(;e.sibling===null;){if(e.return===null||Tj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue t;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vj(e,o,s){var h=e.tag;if(h===5||h===6)e=e.stateNode,o?s.nodeType===8?s.parentNode.insertBefore(e,o):s.insertBefore(e,o):(s.nodeType===8?(o=s.parentNode,o.insertBefore(e,s)):(o=s,o.appendChild(e)),s=s._reactRootContainer,s!=null||o.onclick!==null||(o.onclick=Bf));else if(h!==4&&(e=e.child,e!==null))for(Vj(e,o,s),e=e.sibling;e!==null;)Vj(e,o,s),e=e.sibling}function Wj(e,o,s){var h=e.tag;if(h===5||h===6)e=e.stateNode,o?s.insertBefore(e,o):s.appendChild(e);else if(h!==4&&(e=e.child,e!==null))for(Wj(e,o,s),e=e.sibling;e!==null;)Wj(e,o,s),e=e.sibling}var X=null,Xj=!1;function Yj(e,o,s){for(s=s.child;s!==null;)Zj(e,o,s),s=s.sibling}function Zj(e,o,s){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,s)}catch{}switch(s.tag){case 5:U||Lj(s,o);case 6:var h=X,d=Xj;X=null,Yj(e,o,s),X=h,Xj=d,X!==null&&(Xj?(e=X,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):X.removeChild(s.stateNode));break;case 18:X!==null&&(Xj?(e=X,s=s.stateNode,e.nodeType===8?Kf(e.parentNode,s):e.nodeType===1&&Kf(e,s),bd(e)):Kf(X,s.stateNode));break;case 4:h=X,d=Xj,X=s.stateNode.containerInfo,Xj=!0,Yj(e,o,s),X=h,Xj=d;break;case 0:case 11:case 14:case 15:if(!U&&(h=s.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){d=h=h.next;do{var g=d,_=g.destroy;g=g.tag,_!==void 0&&(g&2||g&4)&&Mj(s,o,_),d=d.next}while(d!==h)}Yj(e,o,s);break;case 1:if(!U&&(Lj(s,o),h=s.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=s.memoizedProps,h.state=s.memoizedState,h.componentWillUnmount()}catch(j){W(s,o,j)}Yj(e,o,s);break;case 21:Yj(e,o,s);break;case 22:s.mode&1?(U=(h=U)||s.memoizedState!==null,Yj(e,o,s),U=h):Yj(e,o,s);break;default:Yj(e,o,s)}}function ak(e){var o=e.updateQueue;if(o!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new Kj),o.forEach(function(h){var d=bk.bind(null,e,h);s.has(h)||(s.add(h),h.then(d,d))})}}function ck(e,o){var s=o.deletions;if(s!==null)for(var h=0;h<s.length;h++){var d=s[h];try{var g=e,_=o,j=_;t:for(;j!==null;){switch(j.tag){case 5:X=j.stateNode,Xj=!1;break t;case 3:X=j.stateNode.containerInfo,Xj=!0;break t;case 4:X=j.stateNode.containerInfo,Xj=!0;break t}j=j.return}if(X===null)throw Error(p(160));Zj(g,_,d),X=null,Xj=!1;var $=d.alternate;$!==null&&($.return=null),d.return=null}catch(_t){W(d,o,_t)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)dk(o,e),o=o.sibling}function dk(e,o){var s=e.alternate,h=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ck(o,e),ek(e),h&4){try{Pj(3,e,e.return),Qj(3,e)}catch(_l){W(e,e.return,_l)}try{Pj(5,e,e.return)}catch(_l){W(e,e.return,_l)}}break;case 1:ck(o,e),ek(e),h&512&&s!==null&&Lj(s,s.return);break;case 5:if(ck(o,e),ek(e),h&512&&s!==null&&Lj(s,s.return),e.flags&32){var d=e.stateNode;try{ob(d,"")}catch(_l){W(e,e.return,_l)}}if(h&4&&(d=e.stateNode,d!=null)){var g=e.memoizedProps,_=s!==null?s.memoizedProps:g,j=e.type,$=e.updateQueue;if(e.updateQueue=null,$!==null)try{j==="input"&&g.type==="radio"&&g.name!=null&&ab(d,g),vb(j,_);var _t=vb(j,g);for(_=0;_<$.length;_+=2){var _e=$[_],_r=$[_+1];_e==="style"?sb(d,_r):_e==="dangerouslySetInnerHTML"?nb(d,_r):_e==="children"?ob(d,_r):ta(d,_e,_r,_t)}switch(j){case"input":bb(d,g);break;case"textarea":ib(d,g);break;case"select":var _i=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!g.multiple;var _n=g.value;_n!=null?fb(d,!!g.multiple,_n,!1):_i!==!!g.multiple&&(g.defaultValue!=null?fb(d,!!g.multiple,g.defaultValue,!0):fb(d,!!g.multiple,g.multiple?[]:"",!1))}d[Pf]=g}catch(_l){W(e,e.return,_l)}}break;case 6:if(ck(o,e),ek(e),h&4){if(e.stateNode===null)throw Error(p(162));d=e.stateNode,g=e.memoizedProps;try{d.nodeValue=g}catch(_l){W(e,e.return,_l)}}break;case 3:if(ck(o,e),ek(e),h&4&&s!==null&&s.memoizedState.isDehydrated)try{bd(o.containerInfo)}catch(_l){W(e,e.return,_l)}break;case 4:ck(o,e),ek(e);break;case 13:ck(o,e),ek(e),d=e.child,d.flags&8192&&(g=d.memoizedState!==null,d.stateNode.isHidden=g,!g||d.alternate!==null&&d.alternate.memoizedState!==null||(fk=B())),h&4&&ak(e);break;case 22:if(_e=s!==null&&s.memoizedState!==null,e.mode&1?(U=(_t=U)||_e,ck(o,e),U=_t):ck(o,e),ek(e),h&8192){if(_t=e.memoizedState!==null,(e.stateNode.isHidden=_t)&&!_e&&e.mode&1)for(V=e,_e=e.child;_e!==null;){for(_r=V=_e;V!==null;){switch(_i=V,_n=_i.child,_i.tag){case 0:case 11:case 14:case 15:Pj(4,_i,_i.return);break;case 1:Lj(_i,_i.return);var _s=_i.stateNode;if(typeof _s.componentWillUnmount=="function"){h=_i,s=_i.return;try{o=h,_s.props=o.memoizedProps,_s.state=o.memoizedState,_s.componentWillUnmount()}catch(_l){W(h,s,_l)}}break;case 5:Lj(_i,_i.return);break;case 22:if(_i.memoizedState!==null){gk(_r);continue}}_n!==null?(_n.return=_i,V=_n):gk(_r)}_e=_e.sibling}t:for(_e=null,_r=e;;){if(_r.tag===5){if(_e===null){_e=_r;try{d=_r.stateNode,_t?(g=d.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(j=_r.stateNode,$=_r.memoizedProps.style,_=$!=null&&$.hasOwnProperty("display")?$.display:null,j.style.display=rb("display",_))}catch(_l){W(e,e.return,_l)}}}else if(_r.tag===6){if(_e===null)try{_r.stateNode.nodeValue=_t?"":_r.memoizedProps}catch(_l){W(e,e.return,_l)}}else if((_r.tag!==22&&_r.tag!==23||_r.memoizedState===null||_r===e)&&_r.child!==null){_r.child.return=_r,_r=_r.child;continue}if(_r===e)break t;for(;_r.sibling===null;){if(_r.return===null||_r.return===e)break t;_e===_r&&(_e=null),_r=_r.return}_e===_r&&(_e=null),_r.sibling.return=_r.return,_r=_r.sibling}}break;case 19:ck(o,e),ek(e),h&4&&ak(e);break;case 21:break;default:ck(o,e),ek(e)}}function ek(e){var o=e.flags;if(o&2){try{t:{for(var s=e.return;s!==null;){if(Tj(s)){var h=s;break t}s=s.return}throw Error(p(160))}switch(h.tag){case 5:var d=h.stateNode;h.flags&32&&(ob(d,""),h.flags&=-33);var g=Uj(e);Wj(e,g,d);break;case 3:case 4:var _=h.stateNode.containerInfo,j=Uj(e);Vj(e,j,_);break;default:throw Error(p(161))}}catch($){W(e,e.return,$)}e.flags&=-3}o&4096&&(e.flags&=-4097)}function hk(e,o,s){V=e,ik(e)}function ik(e,o,s){for(var h=(e.mode&1)!==0;V!==null;){var d=V,g=d.child;if(d.tag===22&&h){var _=d.memoizedState!==null||Jj;if(!_){var j=d.alternate,$=j!==null&&j.memoizedState!==null||U;j=Jj;var _t=U;if(Jj=_,(U=$)&&!_t)for(V=d;V!==null;)_=V,$=_.child,_.tag===22&&_.memoizedState!==null?jk(d):$!==null?($.return=_,V=$):jk(d);for(;g!==null;)V=g,ik(g),g=g.sibling;V=d,Jj=j,U=_t}kk(e)}else d.subtreeFlags&8772&&g!==null?(g.return=d,V=g):kk(e)}}function kk(e){for(;V!==null;){var o=V;if(o.flags&8772){var s=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:U||Qj(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!U)if(s===null)h.componentDidMount();else{var d=o.elementType===o.type?s.memoizedProps:Ci(o.type,s.memoizedProps);h.componentDidUpdate(d,s.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var g=o.updateQueue;g!==null&&sh(o,g,h);break;case 3:var _=o.updateQueue;if(_!==null){if(s=null,o.child!==null)switch(o.child.tag){case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}sh(o,_,s)}break;case 5:var j=o.stateNode;if(s===null&&o.flags&4){s=j;var $=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":$.autoFocus&&s.focus();break;case"img":$.src&&(s.src=$.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var _t=o.alternate;if(_t!==null){var _e=_t.memoizedState;if(_e!==null){var _r=_e.dehydrated;_r!==null&&bd(_r)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p(163))}U||o.flags&512&&Rj(o)}catch(_i){W(o,o.return,_i)}}if(o===e){V=null;break}if(s=o.sibling,s!==null){s.return=o.return,V=s;break}V=o.return}}function gk(e){for(;V!==null;){var o=V;if(o===e){V=null;break}var s=o.sibling;if(s!==null){s.return=o.return,V=s;break}V=o.return}}function jk(e){for(;V!==null;){var o=V;try{switch(o.tag){case 0:case 11:case 15:var s=o.return;try{Qj(4,o)}catch($){W(o,s,$)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var d=o.return;try{h.componentDidMount()}catch($){W(o,d,$)}}var g=o.return;try{Rj(o)}catch($){W(o,g,$)}break;case 5:var _=o.return;try{Rj(o)}catch($){W(o,_,$)}}}catch($){W(o,o.return,$)}if(o===e){V=null;break}var j=o.sibling;if(j!==null){j.return=o.return,V=j;break}V=o.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K=0,Q=null,Y=null,Z=0,fj=0,ej=Uf(0),T=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R(){return K&6?B():Ak!==-1?Ak:Ak=B()}function yi(e){return e.mode&1?K&2&&Z!==0?Z&-Z:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(e=C,e!==0||(e=window.event,e=e===void 0?16:jd(e.type)),e):1}function gi(e,o,s,h){if(50<yk)throw yk=0,zk=null,Error(p(185));Ac(e,s,h),(!(K&2)||e!==Q)&&(e===Q&&(!(K&2)&&(qk|=s),T===4&&Ck(e,Z)),Dk(e,h),s===1&&K===0&&!(o.mode&1)&&(Gj=B()+500,fg&&jg()))}function Dk(e,o){var s=e.callbackNode;wc(e,o);var h=uc(e,e===Q?Z:0);if(h===0)s!==null&&bc(s),e.callbackNode=null,e.callbackPriority=0;else if(o=h&-h,e.callbackPriority!==o){if(s!=null&&bc(s),o===1)e.tag===0?ig(Ek.bind(null,e)):hg(Ek.bind(null,e)),Jf(function(){!(K&6)&&jg()}),s=null;else{switch(Dc(h)){case 1:s=fc;break;case 4:s=gc;break;case 16:s=hc;break;case 536870912:s=jc;break;default:s=hc}s=Fk(s,Gk.bind(null,e))}e.callbackPriority=o,e.callbackNode=s}}function Gk(e,o){if(Ak=-1,Bk=0,K&6)throw Error(p(327));var s=e.callbackNode;if(Hk()&&e.callbackNode!==s)return null;var h=uc(e,e===Q?Z:0);if(h===0)return null;if(h&30||h&e.expiredLanes||o)o=Ik(e,h);else{o=h;var d=K;K|=2;var g=Jk();(Q!==e||Z!==o)&&(uk=null,Gj=B()+500,Kk(e,o));do try{Lk();break}catch(j){Mk(e,j)}while(!0);$g(),mk.current=g,K=d,Y!==null?o=0:(Q=null,Z=0,o=T)}if(o!==0){if(o===2&&(d=xc(e),d!==0&&(h=d,o=Nk(e,d))),o===1)throw s=pk,Kk(e,0),Ck(e,h),Dk(e,B()),s;if(o===6)Ck(e,h);else{if(d=e.current.alternate,!(h&30)&&!Ok(d)&&(o=Ik(e,h),o===2&&(g=xc(e),g!==0&&(h=g,o=Nk(e,g))),o===1))throw s=pk,Kk(e,0),Ck(e,h),Dk(e,B()),s;switch(e.finishedWork=d,e.finishedLanes=h,o){case 0:case 1:throw Error(p(345));case 2:Pk(e,tk,uk);break;case 3:if(Ck(e,h),(h&130023424)===h&&(o=fk+500-B(),10<o)){if(uc(e,0)!==0)break;if(d=e.suspendedLanes,(d&h)!==h){R(),e.pingedLanes|=e.suspendedLanes&d;break}e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),o);break}Pk(e,tk,uk);break;case 4:if(Ck(e,h),(h&4194240)===h)break;for(o=e.eventTimes,d=-1;0<h;){var _=31-oc(h);g=1<<_,_=o[_],_>d&&(d=_),h&=~g}if(h=d,h=B()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*lk(h/1960))-h,10<h){e.timeoutHandle=Ff(Pk.bind(null,e,tk,uk),h);break}Pk(e,tk,uk);break;case 5:Pk(e,tk,uk);break;default:throw Error(p(329))}}}return Dk(e,B()),e.callbackNode===s?Gk.bind(null,e):null}function Nk(e,o){var s=sk;return e.current.memoizedState.isDehydrated&&(Kk(e,o).flags|=256),e=Ik(e,o),e!==2&&(o=tk,tk=s,o!==null&&Fj(o)),e}function Fj(e){tk===null?tk=e:tk.push.apply(tk,e)}function Ok(e){for(var o=e;;){if(o.flags&16384){var s=o.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var h=0;h<s.length;h++){var d=s[h],g=d.getSnapshot;d=d.value;try{if(!He(g(),d))return!1}catch{return!1}}}if(s=o.child,o.subtreeFlags&16384&&s!==null)s.return=o,o=s;else{if(o===e)break;for(;o.sibling===null;){if(o.return===null||o.return===e)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ck(e,o){for(o&=~rk,o&=~qk,e.suspendedLanes|=o,e.pingedLanes&=~o,e=e.expirationTimes;0<o;){var s=31-oc(o),h=1<<s;e[s]=-1,o&=~h}}function Ek(e){if(K&6)throw Error(p(327));Hk();var o=uc(e,0);if(!(o&1))return Dk(e,B()),null;var s=Ik(e,o);if(e.tag!==0&&s===2){var h=xc(e);h!==0&&(o=h,s=Nk(e,h))}if(s===1)throw s=pk,Kk(e,0),Ck(e,o),Dk(e,B()),s;if(s===6)throw Error(p(345));return e.finishedWork=e.current.alternate,e.finishedLanes=o,Pk(e,tk,uk),Dk(e,B()),null}function Qk(e,o){var s=K;K|=1;try{return e(o)}finally{K=s,K===0&&(Gj=B()+500,fg&&jg())}}function Rk(e){wk!==null&&wk.tag===0&&!(K&6)&&Hk();var o=K;K|=1;var s=ok.transition,h=C;try{if(ok.transition=null,C=1,e)return e()}finally{C=h,ok.transition=s,K=o,!(K&6)&&jg()}}function Hj(){fj=ej.current,E(ej)}function Kk(e,o){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,Gf(s)),Y!==null)for(s=Y.return;s!==null;){var h=s;switch(wg(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&$f();break;case 3:zh(),E(Wf),E(H$2),Eh();break;case 5:Bh(h);break;case 4:zh();break;case 13:E(L);break;case 19:E(L);break;case 10:ah(h.type._context);break;case 22:case 23:Hj()}s=s.return}if(Q=e,Y=e=Pg(e.current,null),Z=fj=o,T=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(o=0;o<fh.length;o++)if(s=fh[o],h=s.interleaved,h!==null){s.interleaved=null;var d=h.next,g=s.pending;if(g!==null){var _=g.next;g.next=d,h.next=_}s.pending=h}fh=null}return e}function Mk(e,o){do{var s=Y;try{if($g(),Fh.current=Rh,Ih){for(var h=M.memoizedState;h!==null;){var d=h.queue;d!==null&&(d.pending=null),h=h.next}Ih=!1}if(Hh=0,O=N=M=null,Jh=!1,Kh=0,nk.current=null,s===null||s.return===null){T=1,pk=o,Y=null;break}t:{var g=e,_=s.return,j=s,$=o;if(o=Z,j.flags|=32768,$!==null&&typeof $=="object"&&typeof $.then=="function"){var _t=$,_e=j,_r=_e.tag;if(!(_e.mode&1)&&(_r===0||_r===11||_r===15)){var _i=_e.alternate;_i?(_e.updateQueue=_i.updateQueue,_e.memoizedState=_i.memoizedState,_e.lanes=_i.lanes):(_e.updateQueue=null,_e.memoizedState=null)}var _n=Ui(_);if(_n!==null){_n.flags&=-257,Vi(_n,_,j,g,o),_n.mode&1&&Si(g,_t,o),o=_n,$=_t;var _s=o.updateQueue;if(_s===null){var _l=new Set;_l.add($),o.updateQueue=_l}else _s.add($);break t}else{if(!(o&1)){Si(g,_t,o),tj();break t}$=Error(p(426))}}else if(I&&j.mode&1){var Ap=Ui(_);if(Ap!==null){!(Ap.flags&65536)&&(Ap.flags|=256),Vi(Ap,_,j,g,o),Jg(Ji($,j));break t}}g=$=Ji($,j),T!==4&&(T=2),sk===null?sk=[g]:sk.push(g),g=_;do{switch(g.tag){case 3:g.flags|=65536,o&=-o,g.lanes|=o;var _h=Ni(g,$,o);ph(g,_h);break t;case 1:j=$;var _p=g.type,ty=g.stateNode;if(!(g.flags&128)&&(typeof _p.getDerivedStateFromError=="function"||ty!==null&&typeof ty.componentDidCatch=="function"&&(Ri===null||!Ri.has(ty)))){g.flags|=65536,o&=-o,g.lanes|=o;var ry=Qi(g,j,o);ph(g,ry);break t}}g=g.return}while(g!==null)}Sk(s)}catch(ly){o=ly,Y===s&&s!==null&&(Y=s=s.return);continue}break}while(!0)}function Jk(){var e=mk.current;return mk.current=Rh,e===null?Rh:e}function tj(){(T===0||T===3||T===2)&&(T=4),Q===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q,Z)}function Ik(e,o){var s=K;K|=2;var h=Jk();(Q!==e||Z!==o)&&(uk=null,Kk(e,o));do try{Tk();break}catch(d){Mk(e,d)}while(!0);if($g(),K=s,mk.current=h,Y!==null)throw Error(p(261));return Q=null,Z=0,T}function Tk(){for(;Y!==null;)Uk(Y)}function Lk(){for(;Y!==null&&!cc();)Uk(Y)}function Uk(e){var o=Vk(e.alternate,e,fj);e.memoizedProps=e.pendingProps,o===null?Sk(e):Y=o,nk.current=null}function Sk(e){var o=e;do{var s=o.alternate;if(e=o.return,o.flags&32768){if(s=Ij(s,o),s!==null){s.flags&=32767,Y=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{T=6,Y=null;return}}else if(s=Ej(s,o,fj),s!==null){Y=s;return}if(o=o.sibling,o!==null){Y=o;return}Y=o=e}while(o!==null);T===0&&(T=5)}function Pk(e,o,s){var h=C,d=ok.transition;try{ok.transition=null,C=1,Wk(e,o,s,h)}finally{ok.transition=d,C=h}return null}function Wk(e,o,s,h){do Hk();while(wk!==null);if(K&6)throw Error(p(327));s=e.finishedWork;var d=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(p(177));e.callbackNode=null,e.callbackPriority=0;var g=s.lanes|s.childLanes;if(Bc(e,g),e===Q&&(Y=Q=null,Z=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),g=(s.flags&15990)!==0,s.subtreeFlags&15990||g){g=ok.transition,ok.transition=null;var _=C;C=1;var j=K;K|=4,nk.current=null,Oj(e,s),dk(s,e),Oe(Df),dd=!!Cf,Df=Cf=null,e.current=s,hk(s),dc(),K=j,C=_,ok.transition=g}else e.current=s;if(vk&&(vk=!1,wk=e,xk=d),g=e.pendingLanes,g===0&&(Ri=null),mc(s.stateNode),Dk(e,B()),o!==null)for(h=e.onRecoverableError,s=0;s<o.length;s++)d=o[s],h(d.value,{componentStack:d.stack,digest:d.digest});if(Oi)throw Oi=!1,e=Pi,Pi=null,e;return xk&1&&e.tag!==0&&Hk(),g=e.pendingLanes,g&1?e===zk?yk++:(yk=0,zk=e):yk=0,jg(),null}function Hk(){if(wk!==null){var e=Dc(xk),o=ok.transition,s=C;try{if(ok.transition=null,C=16>e?16:e,wk===null)var h=!1;else{if(e=wk,wk=null,xk=0,K&6)throw Error(p(331));var d=K;for(K|=4,V=e.current;V!==null;){var g=V,_=g.child;if(V.flags&16){var j=g.deletions;if(j!==null){for(var $=0;$<j.length;$++){var _t=j[$];for(V=_t;V!==null;){var _e=V;switch(_e.tag){case 0:case 11:case 15:Pj(8,_e,g)}var _r=_e.child;if(_r!==null)_r.return=_e,V=_r;else for(;V!==null;){_e=V;var _i=_e.sibling,_n=_e.return;if(Sj(_e),_e===_t){V=null;break}if(_i!==null){_i.return=_n,V=_i;break}V=_n}}}var _s=g.alternate;if(_s!==null){var _l=_s.child;if(_l!==null){_s.child=null;do{var Ap=_l.sibling;_l.sibling=null,_l=Ap}while(_l!==null)}}V=g}}if(g.subtreeFlags&2064&&_!==null)_.return=g,V=_;else t:for(;V!==null;){if(g=V,g.flags&2048)switch(g.tag){case 0:case 11:case 15:Pj(9,g,g.return)}var _h=g.sibling;if(_h!==null){_h.return=g.return,V=_h;break t}V=g.return}}var _p=e.current;for(V=_p;V!==null;){_=V;var ty=_.child;if(_.subtreeFlags&2064&&ty!==null)ty.return=_,V=ty;else t:for(_=_p;V!==null;){if(j=V,j.flags&2048)try{switch(j.tag){case 0:case 11:case 15:Qj(9,j)}}catch(ly){W(j,j.return,ly)}if(j===_){V=null;break t}var ry=j.sibling;if(ry!==null){ry.return=j.return,V=ry;break t}V=j.return}}if(K=d,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,e)}catch{}h=!0}return h}finally{C=s,ok.transition=o}}return!1}function Xk(e,o,s){o=Ji(s,o),o=Ni(e,o,1),e=nh(e,o,1),o=R(),e!==null&&(Ac(e,1,o),Dk(e,o))}function W(e,o,s){if(e.tag===3)Xk(e,e,s);else for(;o!==null;){if(o.tag===3){Xk(o,e,s);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ri===null||!Ri.has(h))){e=Ji(s,e),e=Qi(o,e,1),o=nh(o,e,1),e=R(),o!==null&&(Ac(o,1,e),Dk(o,e));break}}o=o.return}}function Ti(e,o,s){var h=e.pingCache;h!==null&&h.delete(o),o=R(),e.pingedLanes|=e.suspendedLanes&s,Q===e&&(Z&s)===s&&(T===4||T===3&&(Z&130023424)===Z&&500>B()-fk?Kk(e,0):rk|=s),Dk(e,o)}function Yk(e,o){o===0&&(e.mode&1?(o=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):o=1);var s=R();e=ih(e,o),e!==null&&(Ac(e,o,s),Dk(e,s))}function uj(e){var o=e.memoizedState,s=0;o!==null&&(s=o.retryLane),Yk(e,s)}function bk(e,o){var s=0;switch(e.tag){case 13:var h=e.stateNode,d=e.memoizedState;d!==null&&(s=d.retryLane);break;case 19:h=e.stateNode;break;default:throw Error(p(314))}h!==null&&h.delete(o),Yk(e,s)}var Vk;Vk=function(e,o,s){if(e!==null)if(e.memoizedProps!==o.pendingProps||Wf.current)dh=!0;else{if(!(e.lanes&s)&&!(o.flags&128))return dh=!1,yj(e,o,s);dh=!!(e.flags&131072)}else dh=!1,I&&o.flags&1048576&&ug(o,ng,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;ij(e,o),e=o.pendingProps;var d=Yf(o,H$2.current);ch(o,s),d=Nh(null,o,h,e,d,s);var g=Sh();return o.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Zf(h)?(g=!0,cg(o)):g=!1,o.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,kh(o),d.updater=Ei,o.stateNode=d,d._reactInternals=o,Ii(o,h,e,s),o=jj(null,o,h,!0,g,s)):(o.tag=0,I&&g&&vg(o),Xi(null,o,d,s),o=o.child),o;case 16:h=o.elementType;t:{switch(ij(e,o),e=o.pendingProps,d=h._init,h=d(h._payload),o.type=h,d=o.tag=Zk(h),e=Ci(h,e),d){case 0:o=cj(null,o,h,e,s);break t;case 1:o=hj(null,o,h,e,s);break t;case 11:o=Yi(null,o,h,e,s);break t;case 14:o=$i(null,o,h,Ci(h.type,e),s);break t}throw Error(p(306,h,""))}return o;case 0:return h=o.type,d=o.pendingProps,d=o.elementType===h?d:Ci(h,d),cj(e,o,h,d,s);case 1:return h=o.type,d=o.pendingProps,d=o.elementType===h?d:Ci(h,d),hj(e,o,h,d,s);case 3:t:{if(kj(o),e===null)throw Error(p(387));h=o.pendingProps,g=o.memoizedState,d=g.element,lh(e,o),qh(o,h,null,s);var _=o.memoizedState;if(h=_.element,g.isDehydrated)if(g={element:h,isDehydrated:!1,cache:_.cache,pendingSuspenseBoundaries:_.pendingSuspenseBoundaries,transitions:_.transitions},o.updateQueue.baseState=g,o.memoizedState=g,o.flags&256){d=Ji(Error(p(423)),o),o=lj(e,o,h,s,d);break t}else if(h!==d){d=Ji(Error(p(424)),o),o=lj(e,o,h,s,d);break t}else for(yg=Lf(o.stateNode.containerInfo.firstChild),xg=o,I=!0,zg=null,s=Vg(o,null,h,s),o.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Ig(),h===d){o=Zi(e,o,s);break t}Xi(e,o,h,s)}o=o.child}return o;case 5:return Ah(o),e===null&&Eg(o),h=o.type,d=o.pendingProps,g=e!==null?e.memoizedProps:null,_=d.children,Ef(h,d)?_=null:g!==null&&Ef(h,g)&&(o.flags|=32),gj(e,o),Xi(e,o,_,s),o.child;case 6:return e===null&&Eg(o),null;case 13:return oj(e,o,s);case 4:return yh(o,o.stateNode.containerInfo),h=o.pendingProps,e===null?o.child=Ug(o,null,h,s):Xi(e,o,h,s),o.child;case 11:return h=o.type,d=o.pendingProps,d=o.elementType===h?d:Ci(h,d),Yi(e,o,h,d,s);case 7:return Xi(e,o,o.pendingProps,s),o.child;case 8:return Xi(e,o,o.pendingProps.children,s),o.child;case 12:return Xi(e,o,o.pendingProps.children,s),o.child;case 10:t:{if(h=o.type._context,d=o.pendingProps,g=o.memoizedProps,_=d.value,G(Wg,h._currentValue),h._currentValue=_,g!==null)if(He(g.value,_)){if(g.children===d.children&&!Wf.current){o=Zi(e,o,s);break t}}else for(g=o.child,g!==null&&(g.return=o);g!==null;){var j=g.dependencies;if(j!==null){_=g.child;for(var $=j.firstContext;$!==null;){if($.context===h){if(g.tag===1){$=mh(-1,s&-s),$.tag=2;var _t=g.updateQueue;if(_t!==null){_t=_t.shared;var _e=_t.pending;_e===null?$.next=$:($.next=_e.next,_e.next=$),_t.pending=$}}g.lanes|=s,$=g.alternate,$!==null&&($.lanes|=s),bh(g.return,s,o),j.lanes|=s;break}$=$.next}}else if(g.tag===10)_=g.type===o.type?null:g.child;else if(g.tag===18){if(_=g.return,_===null)throw Error(p(341));_.lanes|=s,j=_.alternate,j!==null&&(j.lanes|=s),bh(_,s,o),_=g.sibling}else _=g.child;if(_!==null)_.return=g;else for(_=g;_!==null;){if(_===o){_=null;break}if(g=_.sibling,g!==null){g.return=_.return,_=g;break}_=_.return}g=_}Xi(e,o,d.children,s),o=o.child}return o;case 9:return d=o.type,h=o.pendingProps.children,ch(o,s),d=eh(d),h=h(d),o.flags|=1,Xi(e,o,h,s),o.child;case 14:return h=o.type,d=Ci(h,o.pendingProps),d=Ci(h.type,d),$i(e,o,h,d,s);case 15:return bj(e,o,o.type,o.pendingProps,s);case 17:return h=o.type,d=o.pendingProps,d=o.elementType===h?d:Ci(h,d),ij(e,o),o.tag=1,Zf(h)?(e=!0,cg(o)):e=!1,ch(o,s),Gi(o,h,d),Ii(o,h,d,s),jj(null,o,h,!0,e,s);case 19:return xj(e,o,s);case 22:return dj(e,o,s)}throw Error(p(156,o.tag))};function Fk(e,o){return ac(e,o)}function $k(e,o,s,h){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(e,o,s,h){return new $k(e,o,s,h)}function aj(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Zk(e){if(typeof e=="function")return aj(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Da)return 11;if(e===Ga)return 14}return 2}function Pg(e,o){var s=e.alternate;return s===null?(s=Bg(e.tag,o,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=o,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,o=e.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Rg(e,o,s,h,d,g){var _=2;if(h=e,typeof e=="function")aj(e)&&(_=1);else if(typeof e=="string")_=5;else t:switch(e){case ya:return Tg(s.children,d,g,o);case za:_=8,d|=8;break;case Aa:return e=Bg(12,s,o,d|2),e.elementType=Aa,e.lanes=g,e;case Ea:return e=Bg(13,s,o,d),e.elementType=Ea,e.lanes=g,e;case Fa:return e=Bg(19,s,o,d),e.elementType=Fa,e.lanes=g,e;case Ia:return pj(s,d,g,o);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ba:_=10;break t;case Ca:_=9;break t;case Da:_=11;break t;case Ga:_=14;break t;case Ha:_=16,h=null;break t}throw Error(p(130,e==null?e:typeof e,""))}return o=Bg(_,s,o,d),o.elementType=e,o.type=h,o.lanes=g,o}function Tg(e,o,s,h){return e=Bg(7,e,h,o),e.lanes=s,e}function pj(e,o,s,h){return e=Bg(22,e,h,o),e.elementType=Ia,e.lanes=s,e.stateNode={isHidden:!1},e}function Qg(e,o,s){return e=Bg(6,e,null,o),e.lanes=s,e}function Sg(e,o,s){return o=Bg(4,e.children!==null?e.children:[],e.key,o),o.lanes=s,o.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},o}function al(e,o,s,h,d){this.tag=o,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=h,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function bl(e,o,s,h,d,g,_,j,$){return e=new al(e,o,s,j,$),o===1?(o=1,g===!0&&(o|=8)):o=0,g=Bg(3,null,null,o),e.current=g,g.stateNode=e,g.memoizedState={element:h,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(g),e}function cl(e,o,s){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:h==null?null:""+h,children:e,containerInfo:o,implementation:s}}function dl(e){if(!e)return Vf;e=e._reactInternals;t:{if(Vb(e)!==e||e.tag!==1)throw Error(p(170));var o=e;do{switch(o.tag){case 3:o=o.stateNode.context;break t;case 1:if(Zf(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break t}}o=o.return}while(o!==null);throw Error(p(171))}if(e.tag===1){var s=e.type;if(Zf(s))return bg(e,s,o)}return o}function el(e,o,s,h,d,g,_,j,$){return e=bl(s,h,!0,e,d,g,_,j,$),e.context=dl(null),s=e.current,h=R(),d=yi(s),g=mh(h,d),g.callback=o??null,nh(s,g,d),e.current.lanes=d,Ac(e,d,h),Dk(e,h),e}function fl(e,o,s,h){var d=o.current,g=R(),_=yi(d);return s=dl(s),o.context===null?o.context=s:o.pendingContext=s,o=mh(g,_),o.payload={element:e},h=h===void 0?null:h,h!==null&&(o.callback=h),e=nh(d,o,_),e!==null&&(gi(e,d,_,g),oh(e,d,_)),_}function gl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function hl(e,o){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<o?s:o}}function il(e,o){hl(e,o),(e=e.alternate)&&hl(e,o)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(e){console.error(e)};function ll(e){this._internalRoot=e}ml.prototype.render=ll.prototype.render=function(e){var o=this._internalRoot;if(o===null)throw Error(p(409));fl(e,o,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var o=e.containerInfo;Rk(function(){fl(null,e,null,null)}),o[uf]=null}};function ml(e){this._internalRoot=e}ml.prototype.unstable_scheduleHydration=function(e){if(e){var o=Hc();e={blockedOn:null,target:e,priority:o};for(var s=0;s<Qc.length&&o!==0&&o<Qc[s].priority;s++);Qc.splice(s,0,e),s===0&&Vc(e)}};function nl(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ol(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(e,o,s,h,d){if(d){if(typeof h=="function"){var g=h;h=function(){var _t=gl(_);g.call(_t)}}var _=el(o,h,e,0,null,!1,!1,"",pl);return e._reactRootContainer=_,e[uf]=_.current,sf(e.nodeType===8?e.parentNode:e),Rk(),_}for(;d=e.lastChild;)e.removeChild(d);if(typeof h=="function"){var j=h;h=function(){var _t=gl($);j.call(_t)}}var $=bl(e,0,!1,null,null,!1,!1,"",pl);return e._reactRootContainer=$,e[uf]=$.current,sf(e.nodeType===8?e.parentNode:e),Rk(function(){fl(o,$,s,h)}),$}function rl(e,o,s,h,d){var g=s._reactRootContainer;if(g){var _=g;if(typeof d=="function"){var j=d;d=function(){var $=gl(_);j.call($)}}fl(o,_,e,d)}else _=ql(s,o,e,d,h);return gl(_)}Ec=function(e){switch(e.tag){case 3:var o=e.stateNode;if(o.current.memoizedState.isDehydrated){var s=tc(o.pendingLanes);s!==0&&(Cc(o,s|1),Dk(o,B()),!(K&6)&&(Gj=B()+500,jg()))}break;case 13:Rk(function(){var h=ih(e,1);if(h!==null){var d=R();gi(h,e,1,d)}}),il(e,1)}};Fc=function(e){if(e.tag===13){var o=ih(e,134217728);if(o!==null){var s=R();gi(o,e,134217728,s)}il(e,134217728)}};Gc=function(e){if(e.tag===13){var o=yi(e),s=ih(e,o);if(s!==null){var h=R();gi(s,e,o,h)}il(e,o)}};Hc=function(){return C};Ic=function(e,o){var s=C;try{return C=e,o()}finally{C=s}};yb=function(e,o,s){switch(o){case"input":if(bb(e,s),o=s.name,s.type==="radio"&&o!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<s.length;o++){var h=s[o];if(h!==e&&h.form===e.form){var d=Db(h);if(!d)throw Error(p(90));Wa(h),bb(h,d)}}}break;case"textarea":ib(e,s);break;case"select":o=s.value,o!=null&&fb(e,!!s.multiple,o,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zb(e),e===null?null:e.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(e,o){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(o))throw Error(p(200));return cl(e,o,null,s)};reactDom_production_min.createRoot=function(e,o){if(!nl(e))throw Error(p(299));var s=!1,h="",d=kl;return o!=null&&(o.unstable_strictMode===!0&&(s=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(d=o.onRecoverableError)),o=bl(e,1,!1,null,null,s,!1,h,d),e[uf]=o.current,sf(e.nodeType===8?e.parentNode:e),new ll(o)};reactDom_production_min.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var o=e._reactInternals;if(o===void 0)throw typeof e.render=="function"?Error(p(188)):(e=Object.keys(e).join(","),Error(p(268,e)));return e=Zb(o),e=e===null?null:e.stateNode,e};reactDom_production_min.flushSync=function(e){return Rk(e)};reactDom_production_min.hydrate=function(e,o,s){if(!ol(o))throw Error(p(200));return rl(null,e,o,!0,s)};reactDom_production_min.hydrateRoot=function(e,o,s){if(!nl(e))throw Error(p(405));var h=s!=null&&s.hydratedSources||null,d=!1,g="",_=kl;if(s!=null&&(s.unstable_strictMode===!0&&(d=!0),s.identifierPrefix!==void 0&&(g=s.identifierPrefix),s.onRecoverableError!==void 0&&(_=s.onRecoverableError)),o=el(o,null,e,1,s??null,d,!1,g,_),e[uf]=o.current,sf(e),h)for(e=0;e<h.length;e++)s=h[e],d=s._getVersion,d=d(s._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[s,d]:o.mutableSourceEagerHydrationData.push(s,d);return new ml(o)};reactDom_production_min.render=function(e,o,s){if(!ol(o))throw Error(p(200));return rl(null,e,o,!1,s)};reactDom_production_min.unmountComponentAtNode=function(e){if(!ol(e))throw Error(p(40));return e._reactRootContainer?(Rk(function(){rl(null,null,e,!1,function(){e._reactRootContainer=null,e[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(e,o,s,h){if(!ol(s))throw Error(p(200));if(e==null||e._reactInternals===void 0)throw Error(p(38));return rl(e,o,s,!1,h)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(e){console.error(e)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;function bind(e,o){return function(){return e.apply(o,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(e=>o=>{const s=toString.call(o);return e[s]||(e[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=e=>(e=e.toLowerCase(),o=>kindOf(o)===e),typeOfTest=e=>o=>typeof o===e,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer(e){return e!==null&&!isUndefined(e)&&e.constructor!==null&&!isUndefined(e.constructor)&&isFunction(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(e){let o;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?o=ArrayBuffer.isView(e):o=e&&e.buffer&&isArrayBuffer(e.buffer),o}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=e=>e!==null&&typeof e=="object",isBoolean=e=>e===!0||e===!1,isPlainObject=e=>{if(kindOf(e)!=="object")return!1;const o=getPrototypeOf(e);return(o===null||o===Object.prototype||Object.getPrototypeOf(o)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=e=>isObject(e)&&isFunction(e.pipe),isFormData=e=>{let o;return e&&(typeof FormData=="function"&&e instanceof FormData||isFunction(e.append)&&((o=kindOf(e))==="formdata"||o==="object"&&isFunction(e.toString)&&e.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),[isReadableStream,isRequest,isResponse,isHeaders]=["ReadableStream","Request","Response","Headers"].map(kindOfTest),trim=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach(e,o,{allOwnKeys:s=!1}={}){if(e===null||typeof e>"u")return;let h,d;if(typeof e!="object"&&(e=[e]),isArray(e))for(h=0,d=e.length;h<d;h++)o.call(null,e[h],h,e);else{const g=s?Object.getOwnPropertyNames(e):Object.keys(e),_=g.length;let j;for(h=0;h<_;h++)j=g[h],o.call(null,e[j],j,e)}}function findKey(e,o){o=o.toLowerCase();const s=Object.keys(e);let h=s.length,d;for(;h-- >0;)if(d=s[h],o===d.toLowerCase())return d;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=e=>!isUndefined(e)&&e!==_global;function merge(){const{caseless:e}=isContextDefined(this)&&this||{},o={},s=(h,d)=>{const g=e&&findKey(o,d)||d;isPlainObject(o[g])&&isPlainObject(h)?o[g]=merge(o[g],h):isPlainObject(h)?o[g]=merge({},h):isArray(h)?o[g]=h.slice():o[g]=h};for(let h=0,d=arguments.length;h<d;h++)arguments[h]&&forEach(arguments[h],s);return o}const extend=(e,o,s,{allOwnKeys:h}={})=>(forEach(o,(d,g)=>{s&&isFunction(d)?e[g]=bind(d,s):e[g]=d},{allOwnKeys:h}),e),stripBOM=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),inherits=(e,o,s,h)=>{e.prototype=Object.create(o.prototype,h),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:o.prototype}),s&&Object.assign(e.prototype,s)},toFlatObject=(e,o,s,h)=>{let d,g,_;const j={};if(o=o||{},e==null)return o;do{for(d=Object.getOwnPropertyNames(e),g=d.length;g-- >0;)_=d[g],(!h||h(_,e,o))&&!j[_]&&(o[_]=e[_],j[_]=!0);e=s!==!1&&getPrototypeOf(e)}while(e&&(!s||s(e,o))&&e!==Object.prototype);return o},endsWith=(e,o,s)=>{e=String(e),(s===void 0||s>e.length)&&(s=e.length),s-=o.length;const h=e.indexOf(o,s);return h!==-1&&h===s},toArray=e=>{if(!e)return null;if(isArray(e))return e;let o=e.length;if(!isNumber(o))return null;const s=new Array(o);for(;o-- >0;)s[o]=e[o];return s},isTypedArray=(e=>o=>e&&o instanceof e)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(e,o)=>{const h=(e&&e[Symbol.iterator]).call(e);let d;for(;(d=h.next())&&!d.done;){const g=d.value;o.call(e,g[0],g[1])}},matchAll=(e,o)=>{let s;const h=[];for(;(s=e.exec(o))!==null;)h.push(s);return h},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,h,d){return h.toUpperCase()+d}),hasOwnProperty=(({hasOwnProperty:e})=>(o,s)=>e.call(o,s))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(e,o)=>{const s=Object.getOwnPropertyDescriptors(e),h={};forEach(s,(d,g)=>{let _;(_=o(d,g,e))!==!1&&(h[g]=_||d)}),Object.defineProperties(e,h)},freezeMethods=e=>{reduceDescriptors(e,(o,s)=>{if(isFunction(e)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const h=e[s];if(isFunction(h)){if(o.enumerable=!1,"writable"in o){o.writable=!1;return}o.set||(o.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},toObjectSet=(e,o)=>{const s={},h=d=>{d.forEach(g=>{s[g]=!0})};return isArray(e)?h(e):h(String(e).split(o)),s},noop=()=>{},toFiniteNumber=(e,o)=>e!=null&&Number.isFinite(e=+e)?e:o,ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(e=16,o=ALPHABET.ALPHA_DIGIT)=>{let s="";const{length:h}=o;for(;e--;)s+=o[Math.random()*h|0];return s};function isSpecCompliantForm(e){return!!(e&&isFunction(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const toJSONObject=e=>{const o=new Array(10),s=(h,d)=>{if(isObject(h)){if(o.indexOf(h)>=0)return;if(!("toJSON"in h)){o[d]=h;const g=isArray(h)?[]:{};return forEach(h,(_,j)=>{const $=s(_,d+1);!isUndefined($)&&(g[j]=$)}),o[d]=void 0,g}}return h};return s(e,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=e=>e&&(isObject(e)||isFunction(e))&&isFunction(e.then)&&isFunction(e.catch),_setImmediate=((e,o)=>e?setImmediate:o?((s,h)=>(_global.addEventListener("message",({source:d,data:g})=>{d===_global&&g===s&&h.length&&h.shift()()},!1),d=>{h.push(d),_global.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",isFunction(_global.postMessage)),asap=typeof queueMicrotask<"u"?queueMicrotask.bind(_global):typeof process<"u"&&process.nextTick||_setImmediate,utils$1={isArray,isArrayBuffer,isBuffer,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject,isReadableStream,isRequest,isResponse,isHeaders,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray,isFileList,forEach,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable,setImmediate:_setImmediate,asap};function AxiosError(e,o,s,h,d){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",o&&(this.code=o),s&&(this.config=s),h&&(this.request=h),d&&(this.response=d)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{descriptors[e]={value:e}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(e,o,s,h,d,g)=>{const _=Object.create(prototype$1);return utils$1.toFlatObject(e,_,function($){return $!==Error.prototype},j=>j!=="isAxiosError"),AxiosError.call(_,e.message,o,s,h,d),_.cause=e,_.name=e.name,g&&Object.assign(_,g),_};const httpAdapter=null;function isVisitable(e){return utils$1.isPlainObject(e)||utils$1.isArray(e)}function removeBrackets(e){return utils$1.endsWith(e,"[]")?e.slice(0,-2):e}function renderKey(e,o,s){return e?e.concat(o).map(function(d,g){return d=removeBrackets(d),!s&&g?"["+d+"]":d}).join(s?".":""):o}function isFlatArray(e){return utils$1.isArray(e)&&!e.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(o){return/^is[A-Z]/.test(o)});function toFormData(e,o,s){if(!utils$1.isObject(e))throw new TypeError("target must be an object");o=o||new FormData,s=utils$1.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_l,Ap){return!utils$1.isUndefined(Ap[_l])});const h=s.metaTokens,d=s.visitor||_e,g=s.dots,_=s.indexes,$=(s.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(o);if(!utils$1.isFunction(d))throw new TypeError("visitor must be a function");function _t(_s){if(_s===null)return"";if(utils$1.isDate(_s))return _s.toISOString();if(!$&&utils$1.isBlob(_s))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(_s)||utils$1.isTypedArray(_s)?$&&typeof Blob=="function"?new Blob([_s]):Buffer.from(_s):_s}function _e(_s,_l,Ap){let _h=_s;if(_s&&!Ap&&typeof _s=="object"){if(utils$1.endsWith(_l,"{}"))_l=h?_l:_l.slice(0,-2),_s=JSON.stringify(_s);else if(utils$1.isArray(_s)&&isFlatArray(_s)||(utils$1.isFileList(_s)||utils$1.endsWith(_l,"[]"))&&(_h=utils$1.toArray(_s)))return _l=removeBrackets(_l),_h.forEach(function(ty,ry){!(utils$1.isUndefined(ty)||ty===null)&&o.append(_===!0?renderKey([_l],ry,g):_===null?_l:_l+"[]",_t(ty))}),!1}return isVisitable(_s)?!0:(o.append(renderKey(Ap,_l,g),_t(_s)),!1)}const _r=[],_i=Object.assign(predicates,{defaultVisitor:_e,convertValue:_t,isVisitable});function _n(_s,_l){if(!utils$1.isUndefined(_s)){if(_r.indexOf(_s)!==-1)throw Error("Circular reference detected in "+_l.join("."));_r.push(_s),utils$1.forEach(_s,function(_h,_p){(!(utils$1.isUndefined(_h)||_h===null)&&d.call(o,_h,utils$1.isString(_p)?_p.trim():_p,_l,_i))===!0&&_n(_h,_l?_l.concat(_p):[_p])}),_r.pop()}}if(!utils$1.isObject(e))throw new TypeError("data must be an object");return _n(e),o}function encode$1(e){const o={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(h){return o[h]})}function AxiosURLSearchParams(e,o){this._pairs=[],e&&toFormData(e,this,o)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(o,s){this._pairs.push([o,s])};prototype.toString=function(o){const s=o?function(h){return o.call(this,h,encode$1)}:encode$1;return this._pairs.map(function(d){return s(d[0])+"="+s(d[1])},"").join("&")};function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(e,o,s){if(!o)return e;const h=s&&s.encode||encode,d=s&&s.serialize;let g;if(d?g=d(o,s):g=utils$1.isURLSearchParams(o)?o.toString():new AxiosURLSearchParams(o,s).toString(h),g){const _=e.indexOf("#");_!==-1&&(e=e.slice(0,_)),e+=(e.indexOf("?")===-1?"?":"&")+g}return e}class InterceptorManager{constructor(){this.handlers=[]}use(o,s,h){return this.handlers.push({fulfilled:o,rejected:s,synchronous:h?h.synchronous:!1,runWhen:h?h.runWhen:null}),this.handlers.length-1}eject(o){this.handlers[o]&&(this.handlers[o]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(o){utils$1.forEach(this.handlers,function(h){h!==null&&o(h)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$1={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(e=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",origin=hasBrowserEnv&&window.location.href||"http://localhost",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv,origin},Symbol.toStringTag,{value:"Module"})),platform={...utils,...platform$1};function toURLEncodedForm(e,o){return toFormData(e,new platform.classes.URLSearchParams,Object.assign({visitor:function(s,h,d,g){return platform.isNode&&utils$1.isBuffer(s)?(this.append(h,s.toString("base64")),!1):g.defaultVisitor.apply(this,arguments)}},o))}function parsePropPath(e){return utils$1.matchAll(/\w+|\[(\w*)]/g,e).map(o=>o[0]==="[]"?"":o[1]||o[0])}function arrayToObject(e){const o={},s=Object.keys(e);let h;const d=s.length;let g;for(h=0;h<d;h++)g=s[h],o[g]=e[g];return o}function formDataToJSON(e){function o(s,h,d,g){let _=s[g++];if(_==="__proto__")return!0;const j=Number.isFinite(+_),$=g>=s.length;return _=!_&&utils$1.isArray(d)?d.length:_,$?(utils$1.hasOwnProp(d,_)?d[_]=[d[_],h]:d[_]=h,!j):((!d[_]||!utils$1.isObject(d[_]))&&(d[_]=[]),o(s,h,d[_],g)&&utils$1.isArray(d[_])&&(d[_]=arrayToObject(d[_])),!j)}if(utils$1.isFormData(e)&&utils$1.isFunction(e.entries)){const s={};return utils$1.forEachEntry(e,(h,d)=>{o(parsePropPath(h),d,s,0)}),s}return null}function stringifySafely(e,o,s){if(utils$1.isString(e))try{return(o||JSON.parse)(e),utils$1.trim(e)}catch(h){if(h.name!=="SyntaxError")throw h}return(s||JSON.stringify)(e)}const defaults={transitional:transitionalDefaults,adapter:["xhr","http","fetch"],transformRequest:[function(o,s){const h=s.getContentType()||"",d=h.indexOf("application/json")>-1,g=utils$1.isObject(o);if(g&&utils$1.isHTMLForm(o)&&(o=new FormData(o)),utils$1.isFormData(o))return d?JSON.stringify(formDataToJSON(o)):o;if(utils$1.isArrayBuffer(o)||utils$1.isBuffer(o)||utils$1.isStream(o)||utils$1.isFile(o)||utils$1.isBlob(o)||utils$1.isReadableStream(o))return o;if(utils$1.isArrayBufferView(o))return o.buffer;if(utils$1.isURLSearchParams(o))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),o.toString();let j;if(g){if(h.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(o,this.formSerializer).toString();if((j=utils$1.isFileList(o))||h.indexOf("multipart/form-data")>-1){const $=this.env&&this.env.FormData;return toFormData(j?{"files[]":o}:o,$&&new $,this.formSerializer)}}return g||d?(s.setContentType("application/json",!1),stringifySafely(o)):o}],transformResponse:[function(o){const s=this.transitional||defaults.transitional,h=s&&s.forcedJSONParsing,d=this.responseType==="json";if(utils$1.isResponse(o)||utils$1.isReadableStream(o))return o;if(o&&utils$1.isString(o)&&(h&&!this.responseType||d)){const _=!(s&&s.silentJSONParsing)&&d;try{return JSON.parse(o)}catch(j){if(_)throw j.name==="SyntaxError"?AxiosError.from(j,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):j}}return o}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform.classes.FormData,Blob:platform.classes.Blob},validateStatus:function(o){return o>=200&&o<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],e=>{defaults.headers[e]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=e=>{const o={};let s,h,d;return e&&e.split(`
`).forEach(function(_){d=_.indexOf(":"),s=_.substring(0,d).trim().toLowerCase(),h=_.substring(d+1).trim(),!(!s||o[s]&&ignoreDuplicateOf[s])&&(s==="set-cookie"?o[s]?o[s].push(h):o[s]=[h]:o[s]=o[s]?o[s]+", "+h:h)}),o},$internals=Symbol("internals");function normalizeHeader(e){return e&&String(e).trim().toLowerCase()}function normalizeValue(e){return e===!1||e==null?e:utils$1.isArray(e)?e.map(normalizeValue):String(e)}function parseTokens(e){const o=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let h;for(;h=s.exec(e);)o[h[1]]=h[2];return o}const isValidHeaderName=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function matchHeaderValue(e,o,s,h,d){if(utils$1.isFunction(h))return h.call(this,o,s);if(d&&(o=s),!!utils$1.isString(o)){if(utils$1.isString(h))return o.indexOf(h)!==-1;if(utils$1.isRegExp(h))return h.test(o)}}function formatHeader(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(o,s,h)=>s.toUpperCase()+h)}function buildAccessors(e,o){const s=utils$1.toCamelCase(" "+o);["get","set","has"].forEach(h=>{Object.defineProperty(e,h+s,{value:function(d,g,_){return this[h].call(this,o,d,g,_)},configurable:!0})})}class AxiosHeaders{constructor(o){o&&this.set(o)}set(o,s,h){const d=this;function g(j,$,_t){const _e=normalizeHeader($);if(!_e)throw new Error("header name must be a non-empty string");const _r=utils$1.findKey(d,_e);(!_r||d[_r]===void 0||_t===!0||_t===void 0&&d[_r]!==!1)&&(d[_r||$]=normalizeValue(j))}const _=(j,$)=>utils$1.forEach(j,(_t,_e)=>g(_t,_e,$));if(utils$1.isPlainObject(o)||o instanceof this.constructor)_(o,s);else if(utils$1.isString(o)&&(o=o.trim())&&!isValidHeaderName(o))_(parseHeaders(o),s);else if(utils$1.isHeaders(o))for(const[j,$]of o.entries())g($,j,h);else o!=null&&g(s,o,h);return this}get(o,s){if(o=normalizeHeader(o),o){const h=utils$1.findKey(this,o);if(h){const d=this[h];if(!s)return d;if(s===!0)return parseTokens(d);if(utils$1.isFunction(s))return s.call(this,d,h);if(utils$1.isRegExp(s))return s.exec(d);throw new TypeError("parser must be boolean|regexp|function")}}}has(o,s){if(o=normalizeHeader(o),o){const h=utils$1.findKey(this,o);return!!(h&&this[h]!==void 0&&(!s||matchHeaderValue(this,this[h],h,s)))}return!1}delete(o,s){const h=this;let d=!1;function g(_){if(_=normalizeHeader(_),_){const j=utils$1.findKey(h,_);j&&(!s||matchHeaderValue(h,h[j],j,s))&&(delete h[j],d=!0)}}return utils$1.isArray(o)?o.forEach(g):g(o),d}clear(o){const s=Object.keys(this);let h=s.length,d=!1;for(;h--;){const g=s[h];(!o||matchHeaderValue(this,this[g],g,o,!0))&&(delete this[g],d=!0)}return d}normalize(o){const s=this,h={};return utils$1.forEach(this,(d,g)=>{const _=utils$1.findKey(h,g);if(_){s[_]=normalizeValue(d),delete s[g];return}const j=o?formatHeader(g):String(g).trim();j!==g&&delete s[g],s[j]=normalizeValue(d),h[j]=!0}),this}concat(...o){return this.constructor.concat(this,...o)}toJSON(o){const s=Object.create(null);return utils$1.forEach(this,(h,d)=>{h!=null&&h!==!1&&(s[d]=o&&utils$1.isArray(h)?h.join(", "):h)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([o,s])=>o+": "+s).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(o){return o instanceof this?o:new this(o)}static concat(o,...s){const h=new this(o);return s.forEach(d=>h.set(d)),h}static accessor(o){const h=(this[$internals]=this[$internals]={accessors:{}}).accessors,d=this.prototype;function g(_){const j=normalizeHeader(_);h[j]||(buildAccessors(d,_),h[j]=!0)}return utils$1.isArray(o)?o.forEach(g):g(o),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:e},o)=>{let s=o[0].toUpperCase()+o.slice(1);return{get:()=>e,set(h){this[s]=h}}});utils$1.freezeMethods(AxiosHeaders);function transformData(e,o){const s=this||defaults,h=o||s,d=AxiosHeaders.from(h.headers);let g=h.data;return utils$1.forEach(e,function(j){g=j.call(s,g,d.normalize(),o?o.status:void 0)}),d.normalize(),g}function isCancel(e){return!!(e&&e.__CANCEL__)}function CanceledError(e,o,s){AxiosError.call(this,e??"canceled",AxiosError.ERR_CANCELED,o,s),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(e,o,s){const h=s.config.validateStatus;!s.status||!h||h(s.status)?e(s):o(new AxiosError("Request failed with status code "+s.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function parseProtocol(e){const o=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return o&&o[1]||""}function speedometer(e,o){e=e||10;const s=new Array(e),h=new Array(e);let d=0,g=0,_;return o=o!==void 0?o:1e3,function($){const _t=Date.now(),_e=h[g];_||(_=_t),s[d]=$,h[d]=_t;let _r=g,_i=0;for(;_r!==d;)_i+=s[_r++],_r=_r%e;if(d=(d+1)%e,d===g&&(g=(g+1)%e),_t-_<o)return;const _n=_e&&_t-_e;return _n?Math.round(_i*1e3/_n):void 0}}function throttle(e,o){let s=0,h=1e3/o,d,g;const _=(_t,_e=Date.now())=>{s=_e,d=null,g&&(clearTimeout(g),g=null),e.apply(null,_t)};return[(..._t)=>{const _e=Date.now(),_r=_e-s;_r>=h?_(_t,_e):(d=_t,g||(g=setTimeout(()=>{g=null,_(d)},h-_r)))},()=>d&&_(d)]}const progressEventReducer=(e,o,s=3)=>{let h=0;const d=speedometer(50,250);return throttle(g=>{const _=g.loaded,j=g.lengthComputable?g.total:void 0,$=_-h,_t=d($),_e=_<=j;h=_;const _r={loaded:_,total:j,progress:j?_/j:void 0,bytes:$,rate:_t||void 0,estimated:_t&&j&&_e?(j-_)/_t:void 0,event:g,lengthComputable:j!=null,[o?"download":"upload"]:!0};e(_r)},s)},progressEventDecorator=(e,o)=>{const s=e!=null;return[h=>o[0]({lengthComputable:s,total:e,loaded:h}),o[1]]},asyncDecorator=e=>(...o)=>utils$1.asap(()=>e(...o)),isURLSameOrigin=platform.hasStandardBrowserEnv?function(){const o=/(msie|trident)/i.test(navigator.userAgent),s=document.createElement("a");let h;function d(g){let _=g;return o&&(s.setAttribute("href",_),_=s.href),s.setAttribute("href",_),{href:s.href,protocol:s.protocol?s.protocol.replace(/:$/,""):"",host:s.host,search:s.search?s.search.replace(/^\?/,""):"",hash:s.hash?s.hash.replace(/^#/,""):"",hostname:s.hostname,port:s.port,pathname:s.pathname.charAt(0)==="/"?s.pathname:"/"+s.pathname}}return h=d(window.location.href),function(_){const j=utils$1.isString(_)?d(_):_;return j.protocol===h.protocol&&j.host===h.host}}():function(){return function(){return!0}}(),cookies=platform.hasStandardBrowserEnv?{write(e,o,s,h,d,g){const _=[e+"="+encodeURIComponent(o)];utils$1.isNumber(s)&&_.push("expires="+new Date(s).toGMTString()),utils$1.isString(h)&&_.push("path="+h),utils$1.isString(d)&&_.push("domain="+d),g===!0&&_.push("secure"),document.cookie=_.join("; ")},read(e){const o=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return o?decodeURIComponent(o[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function combineURLs(e,o){return o?e.replace(/\/?\/$/,"")+"/"+o.replace(/^\/+/,""):e}function buildFullPath(e,o){return e&&!isAbsoluteURL(o)?combineURLs(e,o):o}const headersToObject=e=>e instanceof AxiosHeaders?{...e}:e;function mergeConfig(e,o){o=o||{};const s={};function h(_t,_e,_r){return utils$1.isPlainObject(_t)&&utils$1.isPlainObject(_e)?utils$1.merge.call({caseless:_r},_t,_e):utils$1.isPlainObject(_e)?utils$1.merge({},_e):utils$1.isArray(_e)?_e.slice():_e}function d(_t,_e,_r){if(utils$1.isUndefined(_e)){if(!utils$1.isUndefined(_t))return h(void 0,_t,_r)}else return h(_t,_e,_r)}function g(_t,_e){if(!utils$1.isUndefined(_e))return h(void 0,_e)}function _(_t,_e){if(utils$1.isUndefined(_e)){if(!utils$1.isUndefined(_t))return h(void 0,_t)}else return h(void 0,_e)}function j(_t,_e,_r){if(_r in o)return h(_t,_e);if(_r in e)return h(void 0,_t)}const $={url:g,method:g,data:g,baseURL:_,transformRequest:_,transformResponse:_,paramsSerializer:_,timeout:_,timeoutMessage:_,withCredentials:_,withXSRFToken:_,adapter:_,responseType:_,xsrfCookieName:_,xsrfHeaderName:_,onUploadProgress:_,onDownloadProgress:_,decompress:_,maxContentLength:_,maxBodyLength:_,beforeRedirect:_,transport:_,httpAgent:_,httpsAgent:_,cancelToken:_,socketPath:_,responseEncoding:_,validateStatus:j,headers:(_t,_e)=>d(headersToObject(_t),headersToObject(_e),!0)};return utils$1.forEach(Object.keys(Object.assign({},e,o)),function(_e){const _r=$[_e]||d,_i=_r(e[_e],o[_e],_e);utils$1.isUndefined(_i)&&_r!==j||(s[_e]=_i)}),s}const resolveConfig=e=>{const o=mergeConfig({},e);let{data:s,withXSRFToken:h,xsrfHeaderName:d,xsrfCookieName:g,headers:_,auth:j}=o;o.headers=_=AxiosHeaders.from(_),o.url=buildURL(buildFullPath(o.baseURL,o.url),e.params,e.paramsSerializer),j&&_.set("Authorization","Basic "+btoa((j.username||"")+":"+(j.password?unescape(encodeURIComponent(j.password)):"")));let $;if(utils$1.isFormData(s)){if(platform.hasStandardBrowserEnv||platform.hasStandardBrowserWebWorkerEnv)_.setContentType(void 0);else if(($=_.getContentType())!==!1){const[_t,..._e]=$?$.split(";").map(_r=>_r.trim()).filter(Boolean):[];_.setContentType([_t||"multipart/form-data",..._e].join("; "))}}if(platform.hasStandardBrowserEnv&&(h&&utils$1.isFunction(h)&&(h=h(o)),h||h!==!1&&isURLSameOrigin(o.url))){const _t=d&&g&&cookies.read(g);_t&&_.set(d,_t)}return o},isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(e){return new Promise(function(s,h){const d=resolveConfig(e);let g=d.data;const _=AxiosHeaders.from(d.headers).normalize();let{responseType:j,onUploadProgress:$,onDownloadProgress:_t}=d,_e,_r,_i,_n,_s;function _l(){_n&&_n(),_s&&_s(),d.cancelToken&&d.cancelToken.unsubscribe(_e),d.signal&&d.signal.removeEventListener("abort",_e)}let Ap=new XMLHttpRequest;Ap.open(d.method.toUpperCase(),d.url,!0),Ap.timeout=d.timeout;function _h(){if(!Ap)return;const ty=AxiosHeaders.from("getAllResponseHeaders"in Ap&&Ap.getAllResponseHeaders()),ly={data:!j||j==="text"||j==="json"?Ap.responseText:Ap.response,status:Ap.status,statusText:Ap.statusText,headers:ty,config:e,request:Ap};settle(function(py){s(py),_l()},function(py){h(py),_l()},ly),Ap=null}"onloadend"in Ap?Ap.onloadend=_h:Ap.onreadystatechange=function(){!Ap||Ap.readyState!==4||Ap.status===0&&!(Ap.responseURL&&Ap.responseURL.indexOf("file:")===0)||setTimeout(_h)},Ap.onabort=function(){Ap&&(h(new AxiosError("Request aborted",AxiosError.ECONNABORTED,e,Ap)),Ap=null)},Ap.onerror=function(){h(new AxiosError("Network Error",AxiosError.ERR_NETWORK,e,Ap)),Ap=null},Ap.ontimeout=function(){let ry=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded";const ly=d.transitional||transitionalDefaults;d.timeoutErrorMessage&&(ry=d.timeoutErrorMessage),h(new AxiosError(ry,ly.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,e,Ap)),Ap=null},g===void 0&&_.setContentType(null),"setRequestHeader"in Ap&&utils$1.forEach(_.toJSON(),function(ry,ly){Ap.setRequestHeader(ly,ry)}),utils$1.isUndefined(d.withCredentials)||(Ap.withCredentials=!!d.withCredentials),j&&j!=="json"&&(Ap.responseType=d.responseType),_t&&([_i,_s]=progressEventReducer(_t,!0),Ap.addEventListener("progress",_i)),$&&Ap.upload&&([_r,_n]=progressEventReducer($),Ap.upload.addEventListener("progress",_r),Ap.upload.addEventListener("loadend",_n)),(d.cancelToken||d.signal)&&(_e=ty=>{Ap&&(h(!ty||ty.type?new CanceledError(null,e,Ap):ty),Ap.abort(),Ap=null)},d.cancelToken&&d.cancelToken.subscribe(_e),d.signal&&(d.signal.aborted?_e():d.signal.addEventListener("abort",_e)));const _p=parseProtocol(d.url);if(_p&&platform.protocols.indexOf(_p)===-1){h(new AxiosError("Unsupported protocol "+_p+":",AxiosError.ERR_BAD_REQUEST,e));return}Ap.send(g||null)})},composeSignals=(e,o)=>{let s=new AbortController,h;const d=function($){if(!h){h=!0,_();const _t=$ instanceof Error?$:this.reason;s.abort(_t instanceof AxiosError?_t:new CanceledError(_t instanceof Error?_t.message:_t))}};let g=o&&setTimeout(()=>{d(new AxiosError(`timeout ${o} of ms exceeded`,AxiosError.ETIMEDOUT))},o);const _=()=>{e&&(g&&clearTimeout(g),g=null,e.forEach($=>{$&&($.removeEventListener?$.removeEventListener("abort",d):$.unsubscribe(d))}),e=null)};e.forEach($=>$&&$.addEventListener&&$.addEventListener("abort",d));const{signal:j}=s;return j.unsubscribe=_,[j,()=>{g&&clearTimeout(g),g=null}]},streamChunk=function*(e,o){let s=e.byteLength;if(!o||s<o){yield e;return}let h=0,d;for(;h<s;)d=h+o,yield e.slice(h,d),h=d},readBytes=async function*(e,o,s){for await(const h of e)yield*streamChunk(ArrayBuffer.isView(h)?h:await s(String(h)),o)},trackStream=(e,o,s,h,d)=>{const g=readBytes(e,o,d);let _=0,j,$=_t=>{j||(j=!0,h&&h(_t))};return new ReadableStream({async pull(_t){try{const{done:_e,value:_r}=await g.next();if(_e){$(),_t.close();return}let _i=_r.byteLength;if(s){let _n=_+=_i;s(_n)}_t.enqueue(new Uint8Array(_r))}catch(_e){throw $(_e),_e}},cancel(_t){return $(_t),g.return()}},{highWaterMark:2})},isFetchSupported=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",isReadableStreamSupported=isFetchSupported&&typeof ReadableStream=="function",encodeText=isFetchSupported&&(typeof TextEncoder=="function"?(e=>o=>e.encode(o))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),test=(e,...o)=>{try{return!!e(...o)}catch{return!1}},supportsRequestStream=isReadableStreamSupported&&test(()=>{let e=!1;const o=new Request(platform.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!o}),DEFAULT_CHUNK_SIZE=64*1024,supportsResponseStream=isReadableStreamSupported&&test(()=>utils$1.isReadableStream(new Response("").body)),resolvers={stream:supportsResponseStream&&(e=>e.body)};isFetchSupported&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(o=>{!resolvers[o]&&(resolvers[o]=utils$1.isFunction(e[o])?s=>s[o]():(s,h)=>{throw new AxiosError(`Response type '${o}' is not supported`,AxiosError.ERR_NOT_SUPPORT,h)})})})(new Response);const getBodyLength=async e=>{if(e==null)return 0;if(utils$1.isBlob(e))return e.size;if(utils$1.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(utils$1.isArrayBufferView(e)||utils$1.isArrayBuffer(e))return e.byteLength;if(utils$1.isURLSearchParams(e)&&(e=e+""),utils$1.isString(e))return(await encodeText(e)).byteLength},resolveBodyLength=async(e,o)=>{const s=utils$1.toFiniteNumber(e.getContentLength());return s??getBodyLength(o)},fetchAdapter=isFetchSupported&&(async e=>{let{url:o,method:s,data:h,signal:d,cancelToken:g,timeout:_,onDownloadProgress:j,onUploadProgress:$,responseType:_t,headers:_e,withCredentials:_r="same-origin",fetchOptions:_i}=resolveConfig(e);_t=_t?(_t+"").toLowerCase():"text";let[_n,_s]=d||g||_?composeSignals([d,g],_):[],_l,Ap;const _h=()=>{!_l&&setTimeout(()=>{_n&&_n.unsubscribe()}),_l=!0};let _p;try{if($&&supportsRequestStream&&s!=="get"&&s!=="head"&&(_p=await resolveBodyLength(_e,h))!==0){let uy=new Request(o,{method:"POST",body:h,duplex:"half"}),py;if(utils$1.isFormData(h)&&(py=uy.headers.get("content-type"))&&_e.setContentType(py),uy.body){const[fy,my]=progressEventDecorator(_p,progressEventReducer(asyncDecorator($)));h=trackStream(uy.body,DEFAULT_CHUNK_SIZE,fy,my,encodeText)}}utils$1.isString(_r)||(_r=_r?"include":"omit"),Ap=new Request(o,{..._i,signal:_n,method:s.toUpperCase(),headers:_e.normalize().toJSON(),body:h,duplex:"half",credentials:_r});let ty=await fetch(Ap);const ry=supportsResponseStream&&(_t==="stream"||_t==="response");if(supportsResponseStream&&(j||ry)){const uy={};["status","statusText","headers"].forEach(xy=>{uy[xy]=ty[xy]});const py=utils$1.toFiniteNumber(ty.headers.get("content-length")),[fy,my]=j&&progressEventDecorator(py,progressEventReducer(asyncDecorator(j),!0))||[];ty=new Response(trackStream(ty.body,DEFAULT_CHUNK_SIZE,fy,()=>{my&&my(),ry&&_h()},encodeText),uy)}_t=_t||"text";let ly=await resolvers[utils$1.findKey(resolvers,_t)||"text"](ty,e);return!ry&&_h(),_s&&_s(),await new Promise((uy,py)=>{settle(uy,py,{data:ly,headers:AxiosHeaders.from(ty.headers),status:ty.status,statusText:ty.statusText,config:e,request:Ap})})}catch(ty){throw _h(),ty&&ty.name==="TypeError"&&/fetch/i.test(ty.message)?Object.assign(new AxiosError("Network Error",AxiosError.ERR_NETWORK,e,Ap),{cause:ty.cause||ty}):AxiosError.from(ty,ty&&ty.code,e,Ap)}}),knownAdapters={http:httpAdapter,xhr:xhrAdapter,fetch:fetchAdapter};utils$1.forEach(knownAdapters,(e,o)=>{if(e){try{Object.defineProperty(e,"name",{value:o})}catch{}Object.defineProperty(e,"adapterName",{value:o})}});const renderReason=e=>`- ${e}`,isResolvedHandle=e=>utils$1.isFunction(e)||e===null||e===!1,adapters={getAdapter:e=>{e=utils$1.isArray(e)?e:[e];const{length:o}=e;let s,h;const d={};for(let g=0;g<o;g++){s=e[g];let _;if(h=s,!isResolvedHandle(s)&&(h=knownAdapters[(_=String(s)).toLowerCase()],h===void 0))throw new AxiosError(`Unknown adapter '${_}'`);if(h)break;d[_||"#"+g]=h}if(!h){const g=Object.entries(d).map(([j,$])=>`adapter ${j} `+($===!1?"is not supported by the environment":"is not available in the build"));let _=o?g.length>1?`since :
`+g.map(renderReason).join(`
`):" "+renderReason(g[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+_,"ERR_NOT_SUPPORT")}return h},adapters:knownAdapters};function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new CanceledError(null,e)}function dispatchRequest(e){return throwIfCancellationRequested(e),e.headers=AxiosHeaders.from(e.headers),e.data=transformData.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(e.adapter||defaults.adapter)(e).then(function(h){return throwIfCancellationRequested(e),h.data=transformData.call(e,e.transformResponse,h),h.headers=AxiosHeaders.from(h.headers),h},function(h){return isCancel(h)||(throwIfCancellationRequested(e),h&&h.response&&(h.response.data=transformData.call(e,e.transformResponse,h.response),h.response.headers=AxiosHeaders.from(h.response.headers))),Promise.reject(h)})}const VERSION="1.7.3",validators$1={};["object","boolean","number","function","string","symbol"].forEach((e,o)=>{validators$1[e]=function(h){return typeof h===e||"a"+(o<1?"n ":" ")+e}});const deprecatedWarnings={};validators$1.transitional=function(o,s,h){function d(g,_){return"[Axios v"+VERSION+"] Transitional option '"+g+"'"+_+(h?". "+h:"")}return(g,_,j)=>{if(o===!1)throw new AxiosError(d(_," has been removed"+(s?" in "+s:"")),AxiosError.ERR_DEPRECATED);return s&&!deprecatedWarnings[_]&&(deprecatedWarnings[_]=!0,console.warn(d(_," has been deprecated since v"+s+" and will be removed in the near future"))),o?o(g,_,j):!0}};function assertOptions(e,o,s){if(typeof e!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const h=Object.keys(e);let d=h.length;for(;d-- >0;){const g=h[d],_=o[g];if(_){const j=e[g],$=j===void 0||_(j,g,e);if($!==!0)throw new AxiosError("option "+g+" must be "+$,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new AxiosError("Unknown option "+g,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(o){this.defaults=o,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(o,s){try{return await this._request(o,s)}catch(h){if(h instanceof Error){let d;Error.captureStackTrace?Error.captureStackTrace(d={}):d=new Error;const g=d.stack?d.stack.replace(/^.+\n/,""):"";try{h.stack?g&&!String(h.stack).endsWith(g.replace(/^.+\n.+\n/,""))&&(h.stack+=`
`+g):h.stack=g}catch{}}throw h}}_request(o,s){typeof o=="string"?(s=s||{},s.url=o):s=o||{},s=mergeConfig(this.defaults,s);const{transitional:h,paramsSerializer:d,headers:g}=s;h!==void 0&&validator.assertOptions(h,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),d!=null&&(utils$1.isFunction(d)?s.paramsSerializer={serialize:d}:validator.assertOptions(d,{encode:validators.function,serialize:validators.function},!0)),s.method=(s.method||this.defaults.method||"get").toLowerCase();let _=g&&utils$1.merge(g.common,g[s.method]);g&&utils$1.forEach(["delete","get","head","post","put","patch","common"],_s=>{delete g[_s]}),s.headers=AxiosHeaders.concat(_,g);const j=[];let $=!0;this.interceptors.request.forEach(function(_l){typeof _l.runWhen=="function"&&_l.runWhen(s)===!1||($=$&&_l.synchronous,j.unshift(_l.fulfilled,_l.rejected))});const _t=[];this.interceptors.response.forEach(function(_l){_t.push(_l.fulfilled,_l.rejected)});let _e,_r=0,_i;if(!$){const _s=[dispatchRequest.bind(this),void 0];for(_s.unshift.apply(_s,j),_s.push.apply(_s,_t),_i=_s.length,_e=Promise.resolve(s);_r<_i;)_e=_e.then(_s[_r++],_s[_r++]);return _e}_i=j.length;let _n=s;for(_r=0;_r<_i;){const _s=j[_r++],_l=j[_r++];try{_n=_s(_n)}catch(Ap){_l.call(this,Ap);break}}try{_e=dispatchRequest.call(this,_n)}catch(_s){return Promise.reject(_s)}for(_r=0,_i=_t.length;_r<_i;)_e=_e.then(_t[_r++],_t[_r++]);return _e}getUri(o){o=mergeConfig(this.defaults,o);const s=buildFullPath(o.baseURL,o.url);return buildURL(s,o.params,o.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(o){Axios.prototype[o]=function(s,h){return this.request(mergeConfig(h||{},{method:o,url:s,data:(h||{}).data}))}});utils$1.forEach(["post","put","patch"],function(o){function s(h){return function(g,_,j){return this.request(mergeConfig(j||{},{method:o,headers:h?{"Content-Type":"multipart/form-data"}:{},url:g,data:_}))}}Axios.prototype[o]=s(),Axios.prototype[o+"Form"]=s(!0)});class CancelToken{constructor(o){if(typeof o!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(g){s=g});const h=this;this.promise.then(d=>{if(!h._listeners)return;let g=h._listeners.length;for(;g-- >0;)h._listeners[g](d);h._listeners=null}),this.promise.then=d=>{let g;const _=new Promise(j=>{h.subscribe(j),g=j}).then(d);return _.cancel=function(){h.unsubscribe(g)},_},o(function(g,_,j){h.reason||(h.reason=new CanceledError(g,_,j),s(h.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(o){if(this.reason){o(this.reason);return}this._listeners?this._listeners.push(o):this._listeners=[o]}unsubscribe(o){if(!this._listeners)return;const s=this._listeners.indexOf(o);s!==-1&&this._listeners.splice(s,1)}static source(){let o;return{token:new CancelToken(function(d){o=d}),cancel:o}}}function spread(e){return function(s){return e.apply(null,s)}}function isAxiosError(e){return utils$1.isObject(e)&&e.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([e,o])=>{HttpStatusCode[o]=e});function createInstance(e){const o=new Axios(e),s=bind(Axios.prototype.request,o);return utils$1.extend(s,Axios.prototype,o,{allOwnKeys:!0}),utils$1.extend(s,o,null,{allOwnKeys:!0}),s.create=function(d){return createInstance(mergeConfig(e,d))},s}const axios=createInstance(defaults);axios.Axios=Axios;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(o){return Promise.all(o)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders;axios.formToJSON=e=>formDataToJSON(utils$1.isHTMLForm(e)?new FormData(e):e);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode;axios.default=axios;(function(){var m,aa=[];function ca(e){return function(){return aa[e].apply(this,arguments)}}function da(e,o){return aa[e]=o}function ea(e){var o=0;return function(){return o<e.length?{done:!1,value:e[o++]}:{done:!0}}}function fa(e){var o=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];return o?o.call(e):{next:ea(e)}}function ha(e){for(var o,s=[];!(o=e.next()).done;)s.push(o.value);return s}function ia(e){e=[typeof globalThis=="object"&&globalThis,e,typeof window=="object"&&window,typeof self=="object"&&self,typeof global=="object"&&global];for(var o=0;o<e.length;++o){var s=e[o];if(s&&s.Math==Math)return s}throw Error("Cannot find global object")}var ja=ia(this),ka=typeof Object.defineProperties=="function"?Object.defineProperty:function(e,o,s){return e==Array.prototype||e==Object.prototype||(e[o]=s.value),e};function la(e,o){if(o)t:{var s=ja;e=e.split(".");for(var h=0;h<e.length-1;h++){var d=e[h];if(!(d in s))break t;s=s[d]}e=e[e.length-1],h=s[e],o=o(h),o!=h&&o!=null&&ka(s,e,{configurable:!0,writable:!0,value:o})}}la("Symbol",function(e){function o(g){if(this instanceof o)throw new TypeError("Symbol is not a constructor");return new s(h+(g||"")+"_"+d++,g)}function s(g,_){this.Qx=g,ka(this,"description",{configurable:!0,writable:!0,value:_})}if(e)return e;s.prototype.toString=function(){return this.Qx};var h="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",d=0;return o}),la("Symbol.iterator",function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var o="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),s=0;s<o.length;s++){var h=ja[o[s]];typeof h=="function"&&typeof h.prototype[e]!="function"&&ka(h.prototype,e,{configurable:!0,writable:!0,value:function(){return ma(ea(this))}})}return e});function ma(e){return e={next:e},e[Symbol.iterator]=function(){return this},e}function na(e,o){e instanceof String&&(e+="");var s=0,h=!1,d={next:function(){if(!h&&s<e.length){var g=s++;return{value:o(g,e[g]),done:!1}}return h=!0,{done:!0,value:void 0}}};return d[Symbol.iterator]=function(){return d},d}la("Array.prototype.keys",function(e){return e||function(){return na(this,function(o){return o})}});function oa(e,o,s){e instanceof String&&(e=String(e));for(var h=e.length,d=0;d<h;d++){var g=e[d];if(o.call(s,g,d,e))return{Gu:d,Gx:g}}return{Gu:-1,Gx:void 0}}la("Array.prototype.find",function(e){return e||function(o,s){return oa(this,o,s).Gx}});var pa;if(typeof Object.setPrototypeOf=="function")pa=Object.setPrototypeOf;else{var qa;t:{var ra={a:!0},sa={};try{sa.__proto__=ra,qa=sa.a;break t}catch{}qa=!1}pa=qa?function(e,o){if(e.__proto__=o,e.__proto__!==o)throw new TypeError(e+" is not extensible");return e}:null}var ta=pa;la("Object.setPrototypeOf",function(e){return e||ta}),la("Promise",function(e){function o(_){this.o=0,this.qf=void 0,this.Uh=[],this.Wu=!1;var j=this.ap();try{_(j.resolve,j.reject)}catch($){j.reject($)}}function s(){this.He=null}function h(_){return _ instanceof o?_:new o(function(j){j(_)})}if(e)return e;s.prototype.ft=function(_){if(this.He==null){this.He=[];var j=this;this.gt(function(){j.az()})}this.He.push(_)};var d=ja.setTimeout;s.prototype.gt=function(_){d(_,0)},s.prototype.az=function(){for(;this.He&&this.He.length;){var _=this.He;this.He=[];for(var j=0;j<_.length;++j){var $=_[j];_[j]=null;try{$()}catch(_t){this.ny(_t)}}}this.He=null},s.prototype.ny=function(_){this.gt(function(){throw _})},o.prototype.ap=function(){function _(_t){return function(_e){$||($=!0,_t.call(j,_e))}}var j=this,$=!1;return{resolve:_(this.OC),reject:_(this.zr)}},o.prototype.OC=function(_){if(_===this)this.zr(new TypeError("A Promise cannot resolve to itself"));else if(_ instanceof o)this.dD(_);else{t:switch(typeof _){case"object":var j=_!=null;break t;case"function":j=!0;break t;default:j=!1}j?this.NC(_):this.au(_)}},o.prototype.NC=function(_){var j=void 0;try{j=_.then}catch($){this.zr($);return}typeof j=="function"?this.eD(j,_):this.au(_)},o.prototype.zr=function(_){this.$w(2,_)},o.prototype.au=function(_){this.$w(1,_)},o.prototype.$w=function(_,j){if(this.o!=0)throw Error("Cannot settle("+_+", "+j+"): Promise already settled in state"+this.o);this.o=_,this.qf=j,this.o===2&&this.RC(),this.cz()},o.prototype.RC=function(){var _=this;d(function(){if(_.MB()){var j=ja.console;typeof j<"u"&&j.error(_.qf)}},1)},o.prototype.MB=function(){if(this.Wu)return!1;var _=ja.CustomEvent,j=ja.Event,$=ja.dispatchEvent;return typeof $>"u"?!0:(typeof _=="function"?_=new _("unhandledrejection",{cancelable:!0}):typeof j=="function"?_=new j("unhandledrejection",{cancelable:!0}):(_=ja.document.createEvent("CustomEvent"),_.initCustomEvent("unhandledrejection",!1,!0,_)),_.promise=this,_.reason=this.qf,$(_))},o.prototype.cz=function(){if(this.Uh!=null){for(var _=0;_<this.Uh.length;++_)g.ft(this.Uh[_]);this.Uh=null}};var g=new s;return o.prototype.dD=function(_){var j=this.ap();_.Jl(j.resolve,j.reject)},o.prototype.eD=function(_,j){var $=this.ap();try{_.call(j,$.resolve,$.reject)}catch(_t){$.reject(_t)}},o.prototype.then=function(_,j){function $(_i,_n){return typeof _i=="function"?function(_s){try{_t(_i(_s))}catch(_l){_e(_l)}}:_n}var _t,_e,_r=new o(function(_i,_n){_t=_i,_e=_n});return this.Jl($(_,_t),$(j,_e)),_r},o.prototype.catch=function(_){return this.then(void 0,_)},o.prototype.Jl=function(_,j){function $(){switch(_t.o){case 1:_(_t.qf);break;case 2:j(_t.qf);break;default:throw Error("Unexpected state: "+_t.o)}}var _t=this;this.Uh==null?g.ft($):this.Uh.push($),this.Wu=!0},o.resolve=h,o.reject=function(_){return new o(function(j,$){$(_)})},o.race=function(_){return new o(function(j,$){for(var _t=fa(_),_e=_t.next();!_e.done;_e=_t.next())h(_e.value).Jl(j,$)})},o.all=function(_){var j=fa(_),$=j.next();return $.done?h([]):new o(function(_t,_e){function _r(_s){return function(_l){_i[_s]=_l,_n--,_n==0&&_t(_i)}}var _i=[],_n=0;do _i.push(void 0),_n++,h($.value).Jl(_r(_i.length-1),_e),$=j.next();while(!$.done)})},o}),la("Object.entries",function(e){return e||function(o){var s=[],h;for(h in o)Object.prototype.hasOwnProperty.call(o,h)&&s.push([h,o[h]]);return s}}),la("Array.prototype.entries",function(e){return e||function(){return na(this,function(o,s){return[o,s]})}}),la("Object.values",function(e){return e||function(o){var s=[],h;for(h in o)Object.prototype.hasOwnProperty.call(o,h)&&s.push(o[h]);return s}}),la("Object.is",function(e){return e||function(o,s){return o===s?o!==0||1/o===1/s:o!==o&&s!==s}}),la("Array.prototype.includes",function(e){return e||function(o,s){var h=this;h instanceof String&&(h=String(h));var d=h.length;for(s=s||0,0>s&&(s=Math.max(s+d,0));s<d;s++){var g=h[s];if(g===o||Object.is(g,o))return!0}return!1}}),la("String.prototype.includes",function(e){return e||function(o,s){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(o instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return(this+"").indexOf(o,s||0)!==-1}}),la("Array.prototype.fill",function(e){return e||function(o,s,h){var d=this.length||0;for(0>s&&(s=Math.max(0,d+s)),(h==null||h>d)&&(h=d),h=Number(h),0>h&&(h=Math.max(0,d+h)),s=Number(s||0);s<h;s++)this[s]=o;return this}});function ua(e){return e||Array.prototype.fill}la("Int8Array.prototype.fill",ua),la("Uint8Array.prototype.fill",ua),la("Uint8ClampedArray.prototype.fill",ua),la("Int16Array.prototype.fill",ua),la("Uint16Array.prototype.fill",ua),la("Int32Array.prototype.fill",ua),la("Uint32Array.prototype.fill",ua),la("Float32Array.prototype.fill",ua),la("Float64Array.prototype.fill",ua);var va=typeof Object.assign=="function"?Object.assign:function(e,o){for(var s=1;s<arguments.length;s++){var h=arguments[s];if(h)for(var d in h)Object.prototype.hasOwnProperty.call(h,d)&&(e[d]=h[d])}return e};la("Object.assign",function(e){return e||va}),la("Math.log2",function(e){return e||function(o){return Math.log(o)/Math.LN2}}),la("globalThis",function(e){return e||ja}),la("Array.prototype.findIndex",function(e){return e||function(o,s){return oa(this,o,s).Gu}});var wa=this||self;function xa(e,o,s,h){e=e.split("."),h=h||wa,e[0]in h||typeof h.execScript>"u"||h.execScript("var "+e[0]);for(var d;e.length&&(d=e.shift());)if(e.length||o===void 0)h=h[d]&&h[d]!==Object.prototype[d]?h[d]:h[d]={};else if(!s&&ya(o)&&ya(h[d]))for(var g in o)o.hasOwnProperty(g)&&(h[d][g]=o[g]);else h[d]=o}function za(){}function Aa(e){var o=typeof e;return o!="object"?o:e?Array.isArray(e)?"array":o:"null"}function Ba(e){var o=Aa(e);return o=="array"||o=="object"&&typeof e.length=="number"}function ya(e){var o=typeof e;return o=="object"&&e!=null||o=="function"}function Da(e){return Object.prototype.hasOwnProperty.call(e,Ea)&&e[Ea]||(e[Ea]=++Fa)}var Ea="closure_uid_"+(1e9*Math.random()>>>0),Fa=0;function Ga(e,o,s){return e.call.apply(e.bind,arguments)}function Ha(e,o,s){if(!e)throw Error();if(2<arguments.length){var h=Array.prototype.slice.call(arguments,2);return function(){var d=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(d,h),e.apply(o,d)}}return function(){return e.apply(o,arguments)}}function Ia(e,o,s){return Ia=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ga:Ha,Ia.apply(null,arguments)}function Ja(e,o){var s=Array.prototype.slice.call(arguments,1);return function(){var h=s.slice();return h.push.apply(h,arguments),e.apply(this,h)}}function t(e,o){xa(e,o,!0,void 0)}function u(e,o){function s(){}s.prototype=o.prototype,e.g=o.prototype,e.prototype=new s,e.prototype.constructor=e,e.SD=function(h,d,g){for(var _=Array(arguments.length-2),j=2;j<arguments.length;j++)_[j-2]=arguments[j];return o.prototype[d].apply(h,_)}}function Ka(e,o){for(var s in e)if(o.call(void 0,e[s],s,e))return!0;return!1}function Ma(e){for(var o in e)return!1;return!0}function Na(e){var o={},s;for(s in e)o[s]=e[s];return o}var Oa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pa(e,o){for(var s,h,d=1;d<arguments.length;d++){h=arguments[d];for(s in h)e[s]=h[s];for(var g=0;g<Oa.length;g++)s=Oa[g],Object.prototype.hasOwnProperty.call(h,s)&&(e[s]=h[s])}}function Ra(e,o){if(Error.captureStackTrace)Error.captureStackTrace(this,Ra);else{var s=Error().stack;s&&(this.stack=s)}e&&(this.message=String(e)),o&&(this.UD=o)}u(Ra,Error),Ra.prototype.name="CustomError";var Sa=Array.prototype.indexOf?function(e,o){return Array.prototype.indexOf.call(e,o,void 0)}:function(e,o){if(typeof e=="string")return typeof o!="string"||o.length!=1?-1:e.indexOf(o,0);for(var s=0;s<e.length;s++)if(s in e&&e[s]===o)return s;return-1},x=this;function Ta(){return Object.create(z,void 0)}var A=Ia,Va=String,Wa=x.Object.freeze||function(e){return e};function Xa(e){for(var o=Object.keys(e),s=o.length,h;s--;)h=e[o[s]],ya(h)&&Xa(h);return Wa(e)}function Ya(e){var o=Aa(e);if(o=="object"||o=="array"){if(Za(e.clone))return e.clone();o=o=="array"?[]:{};for(var s in e)e.hasOwnProperty(s)&&(o[s]=Ya(e[s]));return o}return e}var B=[].pop(),z=/x/.exec(""),$a="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(e,o,s,h,d){if(!(o=e instanceof o)&&s)throw new D(s,h,ab(d)?d:e);return o}function bb(e,o){if((C(e,o)&&e.constructor===o)===!0)throw new TypeError("Illegal constructor "+cb(o))}function Za(e){return Aa(e)=="function"}function db(e,o,s,h,d){if(!(o=eb(e)===o)&&s)throw new D(s,h,ab(d)?d:e);return o}function fb(e,o,s,h){return db(e,"Array",o,s,h)}t("H.lang.isArray",fb);function ab(e){return e!==B}function gb(e){return typeof e=="string"}t("H.lang.isString",gb);var hb=parseInt,ib=parseFloat,E=isNaN;function jb(e){return e===+e}t("H.lang.isNumber",jb),t("H.lang.isInteger",Number.isInteger?Number.isInteger:function(e){return typeof e=="number"&&e%1===0});function kb(e){return!E(+e)}function eb(e){var o=Object[$a[0]][$a[6]].call(e).match(/^\[object (\w+)\]$/);return o?o[1]:typeof e}var lb=[];function mb(e){0>lb.indexOf(e)&&lb.push(e)}mb(lb);function cb(e,o,s,h){var d="",g=2>arguments.length,_;return g&&(o={H:x.H},s="",h=lb.slice()),nb(o,!0,function(j,$){try{if(_=j[$],$=ob(j,_),!(ya(_)&&_.window===_&&_.self===_||ya(_)&&0<_.nodeType&&Za(_.cloneNode))&&ya(_)){if(_===e)return d=s+"."+$,!0;if(0>h.indexOf(_)&&(h.push(_),d=cb(e,_,s+"."+$,h)))return!0}}catch{}}),g&&(d=d?d.substr(1).replace("."+$a[0]+".","#"):"~"+(Za(e)?pb(e)+"()":eb(e))),d}function ob(e,o){var s=[];return nb(e,!1,function(h,d){h[d]===o&&s.push(d)}),s.sort(qb)[0]}function qb(e,o){return o.length-e.length}var rb=Object[$a[0]][$a[2]];function nb(e,o,s){var h;if(e){for(d in e)if((!o||rb.call(e,d))&&s(e,d,!0))return;for(h=$a.length;h--;){var d=$a[h];if((!o||rb.call(e,d))&&s(e,d,!1))break}}}function pb(e){return(e=/^\s*function ([^\( ]+)/.exec(e))?e[1]:"anonymous"}function sb(e,o,s){s[o]="#"+o}var tb=!!x.__karma__;function vb(){throw Error("unimplemented method")}function D(e,o,s){var h=arguments.length,d;o=o!==B?+o:o,o!==B&&((d=/^.*?\(([^\)]+)/.exec((""+e).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")))?(d=d[1].replace(/\s+/g,""),d=Va(d).split(B!==","?",":" ")):d=[],d.forEach(sb),d=d[o]||"#"+o);var g=e?cb(e):"";return h=2<h?Va(s):"",(d||h)&&(g+=" (Argument "+(d||"")+(h?" "+h:"")+")"),h=Error(g),Object.setPrototypeOf(h,D.prototype),h}u(D,Error),t("H.lang.InvalidArgumentError",D),D.prototype.name="InvalidArgumentError";function wb(e,o){var s=[];return e&&s.push(cb(e)),1<arguments.length&&s.push(""+o),s=Error(s.join(" ")),Object.setPrototypeOf(s,wb.prototype),s}u(wb,Error),t("H.lang.IllegalOperationError",wb),wb.prototype.name="IllegalOperationError";var xb=Math,yb=xb.min,zb=xb.max,Ab=xb.round,Bb=xb.floor,Cb=xb.ceil,Db=xb.abs,Eb=xb.log,Fb=xb.sqrt,Gb=xb.pow,Hb=xb.exp,Ib=xb.sin,Jb=xb.asin,Kb=xb.cos,Lb=xb.tan,Mb=xb.atan,Nb=xb.atan2,Ob=xb.LN2,Pb=xb.PI,Qb=Pb/2,Rb=Pb/4,Sb=2*Pb,Tb=3*Pb,Ub=Pb/180,Vb=180/Pb,Wb=1/0,Xb=Gb(-2,53),Yb=Yb||function(e){return Eb(e)/Ob};function Zb(e,o){var s;return 0>(s=e%o)==0>o?s:s+o}function $b(e,o,s){return o-=s=s||0,e-=s,e-Bb(e/o)*o+s}t("H.math.normalize",$b);function ac(e,o,s){return(e-=0)>s?s:e<o?o:e}t("H.math.clamp",ac);function bc(e,o,s,h){return(h-=0)||(h=0),o<s?e>=o-h&&e<=s+h:e>=s-h&&e<=o+h}var cc={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};t("H.math.CoverType",cc);function dc(e,o,s,h,d,g){var _=s.length,j=_,$=s[0],_t=0,_e=0,_r=0;h=h/2||0;var _i=g||2;g=_i*(d?0:1)+1;for(var _n=_i-2;_t!=1&&j>g;){j-=_n;var _s=s[--j];_i=s[--j];var _l=s[j?j-_n-1:(_+(j-_n-1))%_],Ap=s[j?j-_n-2:(_+(j-_n-2))%_];_i>=e-h&&_i<=e+h&&_s>=o-h&&_s<=o+h||Ap>=e-h&&Ap<=e+h&&_l>=o-h&&_l<=o+h?_t=1:!_t&&_i===e?(Ap===e&&(_s<o&&_l>o||_s>o&&_l<o)||($<=e&&Ap>e||$>=e&&Ap<e)&&(_s>=o?++_e:++_r),_t=bc(o,_s,_l,h)&&Fb(Gb((e-Ap)*(_s-_l)-(o-_l)*(_i-Ap),2)/(Gb(_i-Ap,2)+Gb(_s-_l,2)))<=h?2:0):!_t&&bc(e,_i,Ap,h)&&((_i<e&&Ap>e||_i>e&&Ap<e)&&($=_s+(e-_i)/(Ap-_i)*(_l-_s),_e+=$>o,_r+=$<o),_t=bc(o,_s,_l,h)&&Fb(Gb((e-Ap)*(_s-_l)-(o-_l)*(_i-Ap),2)/(Gb(_i-Ap,2)+Gb(_s-_l,2)))<=h?2:0),$=_i}return!_t&&d&&_r!==0&&_e%2!==0&&(_t=3),_t}function ec(e,o){return dc(e.x,e.y,o,0,!0)!==cc.NONE}t("H.math.isPointInsidePolygon",ec);function fc(e){for(var o=e.length,s=new Float64Array(2*o),h=o&&ab(e[0].x);o--;){var d=e[o],g=o<<1;s[g]=h?d.x:d[0],s[g+1]=h?d.y:d[1]}return s}t("H.math.flatten",fc);function gc(e){e&&typeof e.l=="function"&&e.l()}function hc(){this.jh=this.jh,this.ee=this.ee}var kc=0;hc.prototype.jh=!1,hc.prototype.l=function(){!this.jh&&(this.jh=!0,this.disposeInternal(),kc!=0)&&Da(this)},hc.prototype.bc=function(e,o){this.jh?o!==void 0?e.call(o):e():(this.ee||(this.ee=[]),this.ee.push(o!==void 0?Ia(e,o):e))},hc.prototype.disposeInternal=function(){if(this.ee)for(;this.ee.length;)this.ee.shift()()};function mc(e,o){return e.indexOf(o)!=-1}var nc;t:{var oc=wa.navigator;if(oc){var pc=oc.userAgent;if(pc){nc=pc;break t}}nc=""}function qc(e){return qc[" "](e),e}qc[" "]=za;var rc=mc(nc,"Gecko")&&!(mc(nc.toLowerCase(),"webkit")&&!mc(nc,"Edge"))&&!(mc(nc,"Trident")||mc(nc,"MSIE"))&&!mc(nc,"Edge"),sc=mc(nc.toLowerCase(),"webkit")&&!mc(nc,"Edge"),tc=function(){if(!wa.addEventListener||!Object.defineProperty)return!1;var e=!1,o=Object.defineProperty({},"passive",{get:function(){e=!0}});try{wa.addEventListener("test",za,o),wa.removeEventListener("test",za,o)}catch{}return e}();function uc(e,o){this.type=e,this.currentTarget=this.target=o,this.defaultPrevented=this.yk=!1}uc.prototype.stopPropagation=function(){this.yk=!0},uc.prototype.preventDefault=function(){this.defaultPrevented=!0};function vc(e,o){uc.call(this,e?e.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key="",this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.uj=null,e&&this.Em(e,o)}u(vc,uc);var wc={2:"touch",3:"pen",4:"mouse"};vc.prototype.Em=function(e,o){var s=this.type=e.type,h=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.currentTarget=o,o=e.relatedTarget){if(rc){t:{try{qc(o.nodeName);var d=!0;break t}catch{}d=!1}d||(o=null)}}else s=="mouseover"?o=e.fromElement:s=="mouseout"&&(o=e.toElement);this.relatedTarget=o,h?(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0):(this.offsetX=sc||e.offsetX!==void 0?e.offsetX:e.layerX,this.offsetY=sc||e.offsetY!==void 0?e.offsetY:e.layerY,this.clientX=e.clientX!==void 0?e.clientX:e.pageX,this.clientY=e.clientY!==void 0?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.keyCode=e.keyCode||0,this.key=e.key||"",this.charCode=e.charCode||(s=="keypress"?e.keyCode:0),this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=typeof e.pointerType=="string"?e.pointerType:wc[e.pointerType]||"",this.state=e.state,this.uj=e,e.defaultPrevented&&vc.g.preventDefault.call(this)},vc.prototype.stopPropagation=function(){vc.g.stopPropagation.call(this),this.uj.stopPropagation?this.uj.stopPropagation():this.uj.cancelBubble=!0},vc.prototype.preventDefault=function(){vc.g.preventDefault.call(this);var e=this.uj;e.preventDefault?e.preventDefault():e.returnValue=!1};var xc="closure_listenable_"+(1e6*Math.random()|0);function yc(e){return!(!e||!e[xc])}var zc=0;function Ac(e,o,s,h,d){this.listener=e,this.proxy=null,this.src=o,this.type=s,this.capture=!!h,this.vm=d,this.key=++zc,this.ii=this.Il=!1}function Cc(e){e.ii=!0,e.listener=null,e.proxy=null,e.src=null,e.vm=null}function Dc(e){this.src=e,this.pb={},this.ol=0}m=Dc.prototype,m.add=function(e,o,s,h,d){var g=e.toString();e=this.pb[g],e||(e=this.pb[g]=[],this.ol++);var _=Ec(e,o,h,d);return-1<_?(o=e[_],s||(o.Il=!1)):(o=new Ac(o,this.src,g,!!h,d),o.Il=s,e.push(o)),o},m.remove=function(e,o,s,h){if(e=e.toString(),!(e in this.pb))return!1;var d=this.pb[e];return o=Ec(d,o,s,h),-1<o?(Cc(d[o]),Array.prototype.splice.call(d,o,1),d.length==0&&(delete this.pb[e],this.ol--),!0):!1};function Fc(e,o){var s=o.type;if(!(s in e.pb))return!1;var h=e.pb[s],d=Sa(h,o),g;return(g=0<=d)&&Array.prototype.splice.call(h,d,1),g&&(Cc(o),e.pb[s].length==0&&(delete e.pb[s],e.ol--)),g}m.ia=function(e){e=e&&e.toString();var o=0,s;for(s in this.pb)if(!e||s==e){for(var h=this.pb[s],d=0;d<h.length;d++)++o,Cc(h[d]);delete this.pb[s],this.ol--}return o},m.Jp=function(e,o,s,h){e=this.pb[e.toString()];var d=-1;return e&&(d=Ec(e,o,s,h)),-1<d?e[d]:null},m.bq=function(e,o){var s=e!==void 0,h=s?e.toString():"",d=o!==void 0;return Ka(this.pb,function(g){for(var _=0;_<g.length;++_)if(!(s&&g[_].type!=h||d&&g[_].capture!=o))return!0;return!1})};function Ec(e,o,s,h){for(var d=0;d<e.length;++d){var g=e[d];if(!g.ii&&g.listener==o&&g.capture==!!s&&g.vm==h)return d}return-1}var Gc="closure_lm_"+(1e6*Math.random()|0),Hc={};function Jc(e,o,s,h,d){if(h&&h.once)return Kc(e,o,s,h,d);if(Array.isArray(o)){for(var g=0;g<o.length;g++)Jc(e,o[g],s,h,d);return null}return s=Mc(s),yc(e)?e.pd.add(String(o),s,!1,ya(h)?!!h.capture:!!h,d):Nc(e,o,s,!1,h,d)}function Nc(e,o,s,h,d,g){if(!o)throw Error("Invalid event type");var _=ya(d)?!!d.capture:!!d,j=Oc(e);if(j||(e[Gc]=j=new Dc(e)),s=j.add(o,s,h,_,g),s.proxy)return s;if(h=Pc(),s.proxy=h,h.src=e,h.listener=s,e.addEventListener)tc||(d=_),d===void 0&&(d=!1),e.addEventListener(o.toString(),h,d);else if(e.attachEvent)e.attachEvent(Qc(o.toString()),h);else if(e.addListener&&e.removeListener)e.addListener(h);else throw Error("addEventListener and attachEvent are unavailable.");return s}function Pc(){function e(s){return o.call(e.src,e.listener,s)}var o=Rc;return e}function Kc(e,o,s,h,d){if(Array.isArray(o)){for(var g=0;g<o.length;g++)Kc(e,o[g],s,h,d);return null}return s=Mc(s),yc(e)?e.pd.add(String(o),s,!0,ya(h)?!!h.capture:!!h,d):Nc(e,o,s,!0,h,d)}function Sc(e,o,s,h,d){if(Array.isArray(o)){for(var g=0;g<o.length;g++)Sc(e,o[g],s,h,d);return null}return h=ya(h)?!!h.capture:!!h,s=Mc(s),yc(e)?e.pd.remove(String(o),s,h,d):e&&(e=Oc(e))&&(o=e.Jp(o,s,h,d))?Tc(o):!1}function Tc(e){if(typeof e=="number"||!e||e.ii)return!1;var o=e.src;if(yc(o))return Fc(o.pd,e);var s=e.type,h=e.proxy;return o.removeEventListener?o.removeEventListener(s,h,e.capture):o.detachEvent?o.detachEvent(Qc(s),h):o.addListener&&o.removeListener&&o.removeListener(h),(s=Oc(o))?(Fc(s,e),s.ol==0&&(s.src=null,o[Gc]=null)):Cc(e),!0}function Qc(e){return e in Hc?Hc[e]:Hc[e]="on"+e}function Uc(e,o){var s=e.listener,h=e.vm||e.src;return e.Il&&Tc(e),s.call(h,o)}function Rc(e,o){return e.ii?!0:Uc(e,new vc(o,this))}function Oc(e){return e=e[Gc],e instanceof Dc?e:null}var Vc="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mc(e){return typeof e=="function"?e:(e[Vc]||(e[Vc]=function(o){return e.handleEvent(o)}),e[Vc])}var Wc,Xc,Yc;t("H.util.Event",uc),uc.prototype.stopPropagation=uc.prototype.stopPropagation,uc.prototype.stopPropagation=uc.prototype.stopPropagation,uc.prototype.CAPTURING_PHASE=1,uc.prototype.CAPTURING_PHASE=uc.prototype.CAPTURING_PHASE,uc.prototype.AT_TARGET=2,uc.prototype.AT_TARGET=uc.prototype.AT_TARGET,uc.prototype.BUBBLING_PHASE=3,uc.prototype.BUBBLING_PHASE=uc.prototype.BUBBLING_PHASE,uc.prototype.eventPhase=0,uc.prototype.eventPhase=uc.prototype.eventPhase;function Zc(e,o,s){Zc.g.constructor.call(this,e),this.oldValue=s,this.newValue=o}u(Zc,uc),t("H.util.ChangeEvent",Zc);function F(e,o){this.x=+e,this.y=+o}t("H.math.Point",F),F.prototype.set=F,F.prototype.set=F.prototype.set,F.prototype.clone=function(e){return e?(e.x=this.x,e.y=this.y):e=new F(this.x,this.y),e},F.prototype.clone=F.prototype.clone,F.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},F.prototype.add=F.prototype.add,F.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},F.prototype.sub=F.prototype.sub,F.prototype.scale=function(e,o){return this.x*=e,this.y*=o===void 0?e:o,this},F.prototype.scale=F.prototype.scale,F.prototype.round=function(){return this.x=Ab(this.x),this.y=Ab(this.y),this},F.prototype.round=F.prototype.round,F.prototype.floor=function(){return this.x=Bb(this.x),this.y=Bb(this.y),this},F.prototype.floor=F.prototype.floor,F.prototype.ceil=function(){return this.x=Cb(this.x),this.y=Cb(this.y),this},F.prototype.ceil=F.prototype.ceil,F.prototype.da=function(e){return!(!e||this.x!==e.x||this.y!==e.y)},F.prototype.equals=F.prototype.da,F.prototype.nu=function(e,o){var s=o.x-e.x,h=o.y-e.y,d=e;return(s||h)&&(d=((this.x-e.x)*s+(this.y-e.y)*h)/(s*s+h*h),d=0>=d?e:1<=d?o:new F(e.x+d*s,e.y+d*h)),d},F.prototype.getNearest=F.prototype.nu,F.prototype.kb=function(e){return Fb(Gb(this.x-e.x,2)+Gb(this.y-e.y,2))},F.prototype.distance=F.prototype.kb;function $c(e){if(!e)throw Error("invalid argument");return e instanceof F?e:new F(e.x,e.y)}F.fromIPoint=$c;function ad(e,o,s){var h=ac(+e,-90,90);if(o&&E(h))throw new D(o,s,e);return h}function bd(e,o,s){var h=+e;if((-180>h||180<h)&&(h=Zb(h+180,360)-180),o&&E(h))throw new D(o,s,e);return h}function cd(e,o,s){var h;if(e!==B&&E(h=+e)&&o)throw new D(o,s,e);return h}function dd(e,o){return 0>e!=0>o&&180<Db(o-e)}t("H.geo.isDBC",dd);function ed(){bb(this,ed)}t("H.geo.AbstractGeometry",ed),ed.prototype.getBoundingBox=ed.prototype.C,ed.prototype.equals=ed.prototype.da,ed.prototype.ac="",ed.prototype.Hc="",ed.prototype.toString=function(){return this.xf([this.ac.toUpperCase()," "]).join("")},ed.prototype.toString=ed.prototype.toString,ed.prototype.ye=function(){return{type:this.Hc,coordinates:this.wf()}},ed.prototype.toGeoJSON=ed.prototype.ye,ed.prototype.P=function(){return{type:this.ac,coordinates:this.Qd(),boundingBox:this.C().P()}},ed.prototype.forWorkerMessage=ed.prototype.P;function fd(e,o,s){this.lat=ad(e,fd,0),this.lng=bd(o,fd,1),s!==B&&(this.alt=cd(s,fd,2))}u(fd,ed),t("H.geo.Point",fd),fd.prototype.da=function(e){return this===e||!!e&&this.lat===e.lat&&this.lng===e.lng&&(this.alt||0)===(e.alt||0)},fd.prototype.equals=fd.prototype.da,fd.prototype.kb=function(e){if(this===e||this.lat===e.lat&&this.lng===e.lng)e=0;else{var o=this.lat*Ub,s=e.lat*Ub;e=1274200158e-2*Jb(yb(1,Fb(Gb(Ib((o-s)/2),2)+Kb(o)*Kb(s)*Gb(Ib((this.lng*Ub-e.lng*Ub)/2),2))))}return e},fd.prototype.distance=fd.prototype.kb,fd.prototype.mo=function(e,o,s){var h;if(s){if(h=o/637100079e-2){o=e*Ub,e=Ub*this.lat;var d=Ib(e);s=Ib(h);var g=Kb(h);h=Ub*this.lng;var _=Kb(e);e=Jb(_*Kb(o)*s+d*g),o=Nb(Ib(o)*_*s,g-d*Ib(e)),o=(h+o+Pb)%(2*Pb)-Pb,o*=Vb,d=new fd(e*Vb,(o+540)%360-180)}return d||this}return e=(e%360+360)%360,(e+90)%180===0?(e=this.lng+o/(637100079e-2*Sb*Kb(this.lat*Ub))*(e===270?-360:360),new fd(this.lat,(e+540)%360-180)):((o/=637100079e-2)&&(e*=Ub,d=this.lat*Ub,s=this.lng*Ub,h=d+o*Kb(e),g=h-d,_=Eb(Lb(h/2+Rb)/Lb(d/2+Rb)),_=E(g/_)?Kb(d):g/_,e=o*Ib(e)/_,Db(h)>Qb&&(h=0<h?Pb-h:-(Pb+h)),h=new fd(h*Vb,((s+e+Tb+(Db(d+g)>Qb?Pb:0))%Sb-Pb)*Vb)),h||this)},fd.prototype.walk=fd.prototype.mo,fd.prototype.C=function(){return new J(this.lat,this.lng,this.lat,this.lng)},fd.prototype.getBoundingBox=fd.prototype.C;function gd(e,o,s){var h=ya(e)&&!(E(e.lat=ad(e.lat))||E(e.lng=bd(e.lng))||e.alt!==B&&E(e.alt=cd(e.alt)));if(!h&&o)throw new D(o,s,e);return h}fd.validate=gd;function hd(e){if(!e)throw new D(hd,0,e);return new fd(e.lat,e.lng,e.alt)}fd.fromIPoint=hd,m=fd.prototype,m.ac="Point",m.xf=function(e){return e.push("(",this.lng," ",this.lat,")"),e},m.Hc="Point",m.wf=function(){return[this.lng,this.lat,this.alt||0]},m.Qd=function(){return[this.lat,this.lng,this.alt||0]};function id(){}function jd(e){return yb(1,zb(0,.5-Eb(Lb(Rb+Qb*e/180))/Pb/2))}id.prototype.Sm=function(e,o,s){return s?(s.x=o/360+.5,s.y=jd(e)):s=new F(o/360+.5,jd(e)),s},id.prototype.latLngToPoint=id.prototype.Sm,id.prototype.Re=function(e,o){return this.Sm(e.lat,e.lng,o)},id.prototype.geoToPoint=id.prototype.Re;function kd(e){return 0>=e?90:1<=e?-90:Vb*(2*Mb(Hb(Pb*(1-2*e)))-Qb)}id.prototype.Za=function(e,o,s){return s?(s.lat=kd(o),s.lng=360*(e===1?1:Zb(e,1))-180):s=new fd(kd(o),360*(e===1?1:Zb(e,1))-180),s},id.prototype.xyToGeo=id.prototype.Za,id.prototype.wn=function(e,o){return this.Za(e.x,e.y,o)},id.prototype.pointToGeo=id.prototype.wn;var ld=new id;t("H.geo.mercator",ld),t("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0),t("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22);function md(e,o){this.projection=e||ld,this.Ii=0,this.jl=this.exp=Eb(o||256)/Ob,nd(this),this.y=this.x=0}t("H.geo.PixelProjection",md);var od=Db(24)+Db(-8);md.prototype.Dn=ld,md.prototype.projection=md.prototype.Dn,md.prototype.x=0,md.prototype.x=md.prototype.x,md.prototype.y=0,md.prototype.y=md.prototype.y,md.prototype.w=Gb(2,od),md.prototype.w=md.prototype.w,md.prototype.QA=Gb(2,od),md.prototype.h=md.prototype.QA,md.prototype.Va=function(e){if(E(e))throw new D(this.Va,0,e);var o=this.x/this.w,s=this.y/this.h;this.Ii=e,this.jl=this.exp+e,nd(this),this.x=o*this.w,this.y=s*this.h},md.prototype.rescale=md.prototype.Va;function nd(e){e.jl>od&&(e.jl=od),e.w=Gb(2,e.jl),e.h=Gb(2,e.jl)}md.prototype.wu=function(){return this.Ii||0},md.prototype.getZoomScale=md.prototype.wu,md.prototype.Gb=function(e,o){return e=this.projection.Sm(e.lat,e.lng,o),e.x=e.x*this.w-this.x,e.y=e.y*this.h-this.y,e},md.prototype.geoToPixel=md.prototype.Gb,md.prototype.sk=function(e,o){return this.projection.Za((e.x+this.x)/this.w,(e.y+this.y)/this.h,o)},md.prototype.pixelToGeo=md.prototype.sk,md.prototype.Za=function(e,o,s){return this.projection.Za((e+this.x)/this.w,(o+this.y)/this.h,s)},md.prototype.xyToGeo=md.prototype.Za,md.prototype.wq=function(e,o,s){return e=this.projection.Sm(e,o,s),e.x=e.x*this.w-this.x,e.y=e.y*this.h-this.y,e},md.prototype.latLngToPixel=md.prototype.wq,md.prototype.bi=function(e){return new F(e.x*this.w-this.x,e.y*this.h-this.y)},md.prototype.pointToPixel=md.prototype.bi;function pd(e,o,s){var h=[],d=arguments.length;return e&&h.push(cb(e)),1<d&&(d=2<d&&fb(s)?" out of ["+s[0]+"..."+s[1]+"]":"",h.push("("+o+d+")")),h=Error(h.join(" ")),Object.setPrototypeOf(h,pd.prototype),h}u(pd,Error),t("H.lang.OutOfRangeError",pd),pd.prototype.name="OutOfRangeError";function qd(e,o,s){qd.g.constructor.call(this,e,s),this.data=o}u(qd,uc),t("H.util.DataEvent",qd);function K(){hc.call(this),this.pd=new Dc(this),this.gy=this,this.er=null}u(K,hc),K.prototype[xc]=!0,m=K.prototype,m.Jb=function(){return this.er},m.ea=function(e){this.er=e},m.addEventListener=function(e,o,s,h){Jc(this,e,o,s,h)},m.removeEventListener=function(e,o,s,h){Sc(this,e,o,s,h)},m.dispatchEvent=function(e){var o,s=this.Jb();if(s)for(o=[];s;s=s.Jb())o.push(s);s=this.gy;var h=e.type||e;if(typeof e=="string")e=new uc(e,s);else if(e instanceof uc)e.target=e.target||s;else{var d=e;e=new uc(h,s),Pa(e,d)}if(d=!0,o)for(var g=o.length-1;!e.yk&&0<=g;g--){var _=e.currentTarget=o[g];d=_.Kf(h,!0,e)&&d}if(e.yk||(_=e.currentTarget=s,d=_.Kf(h,!0,e)&&d,e.yk||(d=_.Kf(h,!1,e)&&d)),o)for(g=0;!e.yk&&g<o.length;g++)_=e.currentTarget=o[g],d=_.Kf(h,!1,e)&&d;return d},m.disposeInternal=function(){K.g.disposeInternal.call(this),this.pd&&this.pd.ia(void 0),this.er=null},m.Kf=function(e,o,s){if(e=this.pd.pb[String(e)],!e)return!0;e=e.concat();for(var h=!0,d=0;d<e.length;++d){var g=e[d];if(g&&!g.ii&&g.capture==o){var _=g.listener,j=g.vm||g.src;g.Il&&Fc(this.pd,g),h=_.call(j,s)!==!1&&h}}return h&&!s.defaultPrevented},m.Jp=function(e,o,s,h){return this.pd.Jp(String(e),o,s,h)},m.bq=function(e,o){return this.pd.bq(e!==void 0?String(e):void 0,o)},t("H.util.EventTarget",K),K.prototype.ea=K.prototype.ea,K.prototype.setParentEventTarget=K.prototype.ea,K.prototype.Jb=K.prototype.Jb,K.prototype.getParentEventTarget=K.prototype.Jb,K.prototype.addEventListener=K.prototype.addEventListener,K.prototype.addEventListener=K.prototype.addEventListener,K.prototype.removeEventListener=K.prototype.removeEventListener,K.prototype.removeEventListener=K.prototype.removeEventListener,K.prototype.dispatchEvent=K.prototype.dispatchEvent,K.prototype.dispatchEvent=K.prototype.dispatchEvent,K.prototype.l=K.prototype.l,K.prototype.dispose=K.prototype.l,K.prototype.bc=K.prototype.bc,K.prototype.addOnDisposeCallback=K.prototype.bc,K.prototype.fz=K.prototype.Kf,K.prototype.Kf=function(e,o,s){var h,d,g=!0,_=s[s.currentTarget===s.target?"AT_TARGET":o?"CAPTURING_PHASE":(h=!0,"BUBBLING_PHASE")];return(!h||(d=s.type)!=="pointerenter"&&d!=="pointerleave")&&(s.eventPhase=_,g=K.prototype.fz.apply(this,arguments),h&&this.Jb&&this.Jb()===null&&delete s.eventPhase),g},K.prototype.Ww=function(e){for(var o,s=this;s&&(o=s.Jb())&&o!==e;)s=o;o||s.ea(e)},K.prototype.setRootParentEventTarget=K.prototype.Ww;function rd(e){e=e||{};var o=e.callback;this.Wb=e.label,Za(o)&&(this.callback=o),this.ub=!!e.disabled,rd.g.constructor.call(this)}u(rd,K),t("H.util.ContextItem",rd),rd.prototype.Gp=function(){return this.Wb},rd.prototype.getLabel=rd.prototype.Gp,rd.prototype.we=function(e){return this.Wb!==e&&(this.Wb=e,this.dispatchEvent("update")),this},rd.prototype.setLabel=rd.prototype.we,rd.prototype.mq=function(){return this.ub},rd.prototype.isDisabled=rd.prototype.mq,rd.prototype.va=function(e){return e!==this.ub&&(this.ub=e,this.dispatchEvent("update")),this},rd.prototype.setDisabled=rd.prototype.va;var sd=new rd;rd.SEPARATOR=sd;function td(e,o,s){td.g.constructor.call(this,e,s),this.message=o}u(td,uc),t("H.util.ErrorEvent",td);function ud(){}t("H.util.ICancelable",ud),ud.prototype.cancel=function(){},ud.prototype.cancel=ud.prototype.cancel;function vd(e){wa.setTimeout(function(){throw e},0)}function wd(){var e=document,o="IFRAME";return e.contentType==="application/xhtml+xml"&&(o=o.toLowerCase()),e.createElement(o)}var xd;function yd(){var e=wa.MessageChannel;if(typeof e>"u"&&typeof window<"u"&&window.postMessage&&window.addEventListener&&!mc(nc,"Presto")&&(e=function(){var d=wd();d.style.display="none",document.documentElement.appendChild(d);var g=d.contentWindow;d=g.document,d.open(),d.close();var _="callImmediate"+Math.random(),j=g.location.protocol=="file:"?"*":g.location.protocol+"//"+g.location.host;d=Ia(function($){(j=="*"||$.origin==j)&&$.data==_&&this.port1.onmessage()},this),g.addEventListener("message",d,!1),this.port1={},this.port2={postMessage:function(){g.postMessage(_,j)}}}),typeof e<"u"&&!mc(nc,"Trident")&&!mc(nc,"MSIE")){var o=new e,s={},h=s;return o.port1.onmessage=function(){if(s.next!==void 0){s=s.next;var d=s.lt;s.lt=null,d()}},function(d){h.next={lt:d},h=h.next,o.port2.postMessage(0)}}return function(d){wa.setTimeout(d,0)}}function zd(e,o){this.oB=100,this.Iy=e,this.zg=o,this.an=0,this.zm=null}zd.prototype.get=function(){if(0<this.an){this.an--;var e=this.zm;this.zm=e.next,e.next=null}else e=this.Iy();return e},zd.prototype.put=function(e){this.zg(e),this.an<this.oB&&(this.an++,e.next=this.zm,this.zm=e)};function Ad(){this.no=this.Gi=null}Ad.prototype.add=function(e,o){var s=Bd.get();s.set(e,o),this.no?this.no.next=s:this.Gi=s,this.no=s},Ad.prototype.remove=function(){var e=null;return this.Gi&&(e=this.Gi,this.Gi=this.Gi.next,this.Gi||(this.no=null),e.next=null),e};var Bd=new zd(function(){return new Cd},function(e){return e.reset()});function Cd(){this.next=this.scope=this.tp=null}Cd.prototype.set=function(e,o){this.tp=e,this.scope=o,this.next=null},Cd.prototype.reset=function(){this.next=this.scope=this.tp=null};function Dd(e,o){Ed||Fd(),Gd||(Ed(),Gd=!0),Hd.add(e,o)}var Ed;function Fd(){if(wa.Promise&&wa.Promise.resolve){var e=wa.Promise.resolve(void 0);Ed=function(){e.then(Id)}}else Ed=function(){var o=Id;typeof wa.setImmediate!="function"||wa.Window&&wa.Window.prototype&&!mc(nc,"Edge")&&wa.Window.prototype.setImmediate==wa.setImmediate?(xd||(xd=yd()),xd(o)):wa.setImmediate(o)}}var Gd=!1,Hd=new Ad;function Id(){for(var e;e=Hd.remove();){try{e.tp.call(e.scope)}catch(o){vd(o)}Bd.put(e)}Gd=!1}function Jd(e){if(this.o=Kd,this.qf=void 0,this.Yg=this.Ke=this.og=null,this.tm=this.op=!1,e!=za)try{var o=this;e.call(void 0,function(s){Ld(o,Md,s)},function(s){Ld(o,Nd,s)})}catch(s){Ld(this,Nd,s)}}var Kd=0,Md=2,Nd=3;function Od(){this.next=this.context=this.Th=this.nk=this.Ef=null,this.Cl=!1}Od.prototype.reset=function(){this.context=this.Th=this.nk=this.Ef=null,this.Cl=!1};var Pd=new zd(function(){return new Od},function(e){e.reset()});function Qd(e,o,s){var h=Pd.get();return h.nk=e,h.Th=o,h.context=s,h}function Rd(e){if(e instanceof Jd)return e;var o=new Jd(za);return Ld(o,Md,e),o}function Sd(e){return new Jd(function(o,s){s(e)})}function Td(){var e,o,s=new Jd(function(h,d){e=h,o=d});return new Ud(s,e,o)}Jd.prototype.then=function(e,o,s){return Vd(this,typeof e=="function"?e:null,typeof o=="function"?o:null,s)},Jd.prototype.$goog_Thenable=!0,Jd.prototype.cancel=function(e){if(this.o==Kd){var o=new Wd(e);Dd(function(){Xd(this,o)},this)}};function Xd(e,o){if(e.o==Kd)if(e.og){var s=e.og;if(s.Ke){for(var h=0,d=null,g=null,_=s.Ke;_&&(_.Cl||(h++,_.Ef==e&&(d=_),!(d&&1<h)));_=_.next)d||(g=_);d&&(s.o==Kd&&h==1?Xd(s,o):(g?(h=g,h.next==s.Yg&&(s.Yg=h),h.next=h.next.next):Yd(s),Zd(s,d,Nd,o)))}e.og=null}else Ld(e,Nd,o)}function $d(e,o){e.Ke||e.o!=Md&&e.o!=Nd||ae(e),e.Yg?e.Yg.next=o:e.Ke=o,e.Yg=o}function Vd(e,o,s,h){var d=Qd(null,null,null);return d.Ef=new Jd(function(g,_){d.nk=o?function(j){try{var $=o.call(h,j);g($)}catch(_t){_(_t)}}:g,d.Th=s?function(j){try{var $=s.call(h,j);$===void 0&&j instanceof Wd?_(j):g($)}catch(_t){_(_t)}}:_}),d.Ef.og=e,$d(e,d),d.Ef}Jd.prototype.CD=function(e){this.o=Kd,Ld(this,Md,e)},Jd.prototype.DD=function(e){this.o=Kd,Ld(this,Nd,e)};function Ld(e,o,s){if(e.o==Kd){e===s&&(o=Nd,s=new TypeError("Promise cannot resolve to itself")),e.o=1;t:{var h=s,d=e.CD,g=e.DD;if(h instanceof Jd){$d(h,Qd(d||za,g||null,e));var _=!0}else{if(h)try{var j=!!h.$goog_Thenable}catch{j=!1}else j=!1;if(j)h.then(d,g,e),_=!0;else{if(ya(h))try{var $=h.then;if(typeof $=="function"){be(h,$,d,g,e),_=!0;break t}}catch(_t){g.call(e,_t),_=!0;break t}_=!1}}}_||(e.qf=s,e.o=o,e.og=null,ae(e),o!=Nd||s instanceof Wd||ce(e,s))}}function be(e,o,s,h,d){function g($){j||(j=!0,h.call(d,$))}function _($){j||(j=!0,s.call(d,$))}var j=!1;try{o.call(e,_,g)}catch($){g($)}}function ae(e){e.op||(e.op=!0,Dd(e.bz,e))}function Yd(e){var o=null;return e.Ke&&(o=e.Ke,e.Ke=o.next,o.next=null),e.Ke||(e.Yg=null),o}Jd.prototype.bz=function(){for(var e;e=Yd(this);)Zd(this,e,this.o,this.qf);this.op=!1};function Zd(e,o,s,h){if(s==Nd&&o.Th&&!o.Cl)for(;e&&e.tm;e=e.og)e.tm=!1;if(o.Ef)o.Ef.og=null,de(o,s,h);else try{o.Cl?o.nk.call(o.context):de(o,s,h)}catch(d){ee.call(null,d)}Pd.put(o)}function de(e,o,s){o==Md?e.nk.call(e.context,s):e.Th&&e.Th.call(e.context,s)}function ce(e,o){e.tm=!0,Dd(function(){e.tm&&ee.call(null,o)})}var ee=vd;function Wd(e){Ra.call(this,e)}u(Wd,Ra),Wd.prototype.name="cancel";function Ud(e,o,s){this.promise=e,this.resolve=o,this.reject=s}function fe(e,o,s){this.type=e,this.data=o,this.Er=Td(),this.resolve=A(this.resolve,this),this.reject=A(this.reject,this),this.priority=ge,s!==B&&(this.priority=s),this.Fp().add(this)}var ge=1,he={MD:0,PD:ge,KD:2};m=fe.prototype,m.then=function(e,o,s){return this.Er.promise.then(e,o,s)},m.resolve=function(e){this.state=3,this.Er.resolve(e)},m.reject=function(e){this.state=5,this.Er.reject(e)},m.state=0,m.cancel=function(){3>this.state&&(this.Wi(),this.Fp().remove(this),this.state=4)},fe.prototype.cancel=fe.prototype.cancel;function ie(e){var o;this.tg={};for(o in he)this.tg[he[o]]=[];this.Ik=e,this.Ik.addEventListener("allocatable",A(this.St,this))}t("H.util.JobManager",ie);var je=Object.keys(he).map(function(e){return he[e]}).sort().reverse();ie.prototype.add=function(e){C(e,fe,this.add,0),this.tg[e.priority].push(e),this.St()},ie.prototype.contains=function(e){return-1<this.tg[e.priority].indexOf(e)},ie.prototype.remove=function(e){var o=e.priority,s=this.tg[o].indexOf(e);return-1<s?(this.tg[o].splice(s,1),!0):(e.Ds&&this.Ik.$l(e.Ds),!1)},ie.prototype.St=function(){je.forEach(function(e){this.tg[e]=this.tg[e].filter(function(o){var s;if((s=this.Ik.Eo(o))!==z){var h=A(this.Ik.$l,this.Ik,s,o);o.Ds=s,o.then(h,h),o.state=o.Rt(s)?1:5}else return!0},this)},this)};function ke(e){if(x.document){var o=document.createElement("canvas");return o.width=o.height=1,o.getContext("2d",{XD:e})}return null}function le(){return window.devicePixelRatio||1}t("H.util.getPixelRatio",le);var me=/^rgba\(([^,]+),([^,]+),([^,]+),([^)]+)\)$/;function ne(e){var o=oe[e],s=x.RegExp;return o||(x.Uint8ClampedArray||(x.Uint8ClampedArray=function(h){return h instanceof Number?Array(h):h.map(function(d){return ac(Ab(d),0,255)})}),e==="none"?o=new Uint8ClampedArray([0,0,0,0]):(pe.fillStyle="black",pe.fillStyle=e,me.test(pe.fillStyle)?o=new Uint8ClampedArray([s.$1,s.$2,s.$3,255*s.$4]):(pe.clearRect(0,0,1,1),pe.fillRect(0,0,1,1),o=pe.getImageData(0,0,1,1).data)),oe[e]=o),o}function qe(e){return e!=="none"&&0<ne(e)[3]}var oe=Ta(),re=!!x.VBArray;t("H.util.eval",function(a){return eval(a)});function se(e,o){return e!==B?e:o}function te(e){return/^<svg/.test(e)?"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(e):e}t("H.util.provide",function(e){var o=wa.$jscomp;if(o&&(typeof o.Az=="function"&&o.Az()))throw Error("goog.provide cannot be used within a module.");xa(e,void 0,void 0)});function ue(e){this.zd=0<+e?xb.round(e):0}ue.prototype.next=function(e){if(this.zd===9007199254740992)throw new pd(e,this.zd,[0,9007199254740991]);return this.zd++};var ve=new ue,we=A(ve.next,ve);function xe(){return!0}function ye(){return!1}function ze(){}var Ae=Wa([]),Be=Wa({});function Ce(e){return e.tagName==="CANVAS"?[e]:e.getElementsByTagName("CANVAS")}function De(e,o,s){var h;if(o=e.ownerDocument===o?e.cloneNode(!0):o.importNode(e,!0),s)for(e=Ce(e),s=Ce(o),h=s.length;h--;)s[h].getContext("2d").drawImage(e[h],0,0);return o}var pe=ke(!0),Ee=ke(!1);function Fe(e){var o=e.complete,s=0<e.naturalWidth;if(o&&!s&&re)try{Ee.drawImage(e,0,0),s=!0}catch{}return o&&s}var Ge=x.BlobBuilder||x.WebKitBlobBuilder||x.MozBlobBuilder;function He(e,o){if(o=o||"",Ge){var s=new Ge;s.append(e),e=s.getBlob(o)}else e=new Blob([e],{type:o});return e}var Ie=x.navigator;Xc=/Edge\/\d+/.test(Ie.appVersion),Yc=/(A|a)ndroid/.test(Ie.appVersion);var Je={FEATURE:1,SOURCE:2,PROVIDER:3};t("H.map.provider.PickingMode",Je);function Ke(e,o){o=o||{},"status"in o&&(this.status=+o.status),"statusText"in o&&(this.statusText=o.statusText),this.ok=200<=this.status&&300>this.status,this.Su=!1,e?typeof e=="string"?this.Ko=e:(o=x.ArrayBuffer)&&o.prototype.isPrototypeOf(e)?this.Bf=e:o&&e.buffer?this.Bf=e.buffer:x.Blob.prototype.isPrototypeOf(e)&&(this.Fl=e):this.Ko=""}t("H.net.Response",Ke),Ke.prototype.type="default",Ke.prototype.type=Ke.prototype.type,Ke.prototype.status=200,Ke.prototype.status=Ke.prototype.status,Ke.prototype.statusText="OK",Ke.prototype.statusText=Ke.prototype.statusText;function Le(e){if(e.Su)return Sd(new TypeError("Already read"));e.Su=!0}Ke.error=function(){return Ke.mp||(Ke.mp=new Ke(null,{status:0,statusText:""}),Ke.mp.type="error"),Ke.mp},Ke.error=Ke.error,Ke.prototype.text=function(){var e=Le(this);if(!e)if(this.Ko)e=Rd(this.Ko);else if(this.Bf){e=new Uint8Array(this.Bf);var o=e.length,s=Array(o),h;for(h=0;h<o;h++)s[h]=String.fromCharCode(e[h]);e=Rd(s.join(""))}else e=this.Fl?Me(this.Fl):Sd("Unsupported response body");return e},Ke.prototype.json=function(){return this.text().then(x.JSON.parse)},Ke.prototype.blob=function(){var e,o=Le(this);return o||(this.Fl?e=this.Fl:this.Bf&&(e=new Blob([this.Bf],{type:"application/octet-stream"}))),o||Rd(e)},Ke.prototype.arrayBuffer=function(){return this.Bf?Le(this)||Rd(this.Bf.slice(0)):this.blob().then(Ke.ry)},Ke.ry=function(e){var o=new FileReader;return o.readAsArrayBuffer(e),new Jd(function(s,h){o.onload=function(){s(o.result)},o.onerror=function(){h(o.error)}})};function Me(e){var o=new FileReader;return o.readAsText(e),new Jd(function(s,h){o.onload=function(){s(o.result)},o.onerror=function(){h(o.error)}})}!tb&&x.Response&&x.Response.error&&(Ke=x.Response,mb(Ke.prototype));function Ne(){var e=Ne.pv;return e||(e=this,Ne.pv=e,mb(Ne.pv),K.call(e),this.zg()),e}u(Ne,K),m=Ne.prototype,m.disposeInternal=function(){Ne.g.disposeInternal.call(this),this.zg()},m.zg=function(){this.wB=10,this.xB=6,this.ki=Ta(),this.Cr=Ta(),this.Hr=0},m.Eo=function(e){e=e.type;var o=this.ki[e]||0;if(this.Hr<this.wB&&o<this.xB){var s=++this.lB;return this.Hr++,this.ki[e]=o+1,this.Cr[s+""]=e,s}return z},m.$l=function(e){var o=this.Cr[e];if(!ab(o)||!this.ki[o])throw new wb(this.$l,"Unknown requestId");this.Hr--,this.ki[o]--,this.ki[o]||delete this.ki[o],delete this.Cr[e],this.dispatchEvent("allocatable")},m.lB=-1;function Oe(e,o,s){function h(){var _e=A(_t.Wh,_t),_r=+$.timeout||0;Pe?(Qe(_t,"timeout",_e),d.timeout=_r):_r&&(_t.Lx=setTimeout(function(){d.abort(),_t.Wh({type:"timeout"})},_r)),Qe(_t,"error",_e),Qe(_t,"load",_e),d.send($.data)}var d,g,_,j=s&&s.headers||{},$={},_t=this;if(!Za(o))throw new D(Oe,1,"function required");e+="",Pa(j,Re.headers,j),Pa($,Re,s||{}),$.headers=j,this.kt=o,this.K=d=new XMLHttpRequest,o=$.method;try{d.open(o,e,!0);for(g in j)j.hasOwnProperty(g)&&(_=j[g])&&d.setRequestHeader(g,_);d.withCredentials=!!$.withCredentials,h()}catch{this.Wh({type:"cors"})}}t("H.net.Xhr",Oe);var Re={method:"GET",headers:{},data:null},Se="withCredentials"in new XMLHttpRequest,Pe="timeout"in new XMLHttpRequest;function Qe(e,o,s){Se?e.K.addEventListener(o,s):e.K["on"+o]=s}function Te(e,o,s){Se?e.K.removeEventListener(o,s):e.K["on"+o]=null}Oe.prototype.abort=function(){this.K&&(this.K.abort(),this.K&&this.Wh({type:"abort"}))},Oe.prototype.abort=Oe.prototype.abort,Oe.prototype.Wh=function(e){var o=e.type;e=this.K;var s;this.Lx&&clearTimeout(this.Lx),o==="load"?e instanceof XMLHttpRequest&&e.status!==200&&(s="network"):s=e.readyState===4&&e.status===0&&o=="error"?"cors":o!="error"?o:"network",o=this.Wh,Te(this,"timeout",o),Te(this,"error",o),Te(this,"load",o),e=e.status===0||s&&s!=="network"?Ke.error():new Ke(e.responseText||null,e),s=this.kt,delete this.Wh,delete this.kt,delete this.K,s(e)};function Ue(e,o,s,h){if(!Ve[e])throw new D(Ue,0,"Mime type is not supported");this.DB=e,e=h?Na(h):{},"crossOrigin"in e||(e.crossOrigin="anonymous"),this.Ea=e,We.href=o.toString(),fe.call(this,We.protocol+"//"+We.hostname,o,s)}u(Ue,fe),Ue.prototype.Rt=function(){return this.br=Ve[this.DB].call(this),!0},Ue.prototype.Wi=function(){this.br&&(this.br.abort(),delete this.br)};var Ve={"application/json":function(){var e=this,o=Xe(this.Ea),s=o.headers;return o.headers=s=s?Na(s):{},s.Accept="application/json",new Oe(this.data,function(h){200<=h.status&&300>h.status?e.resolve(h.json()):e.reject(h)},o)},"text/plain":function(){var e=this;return new Oe(this.data,function(o){200<=o.status&&300>o.status?e.resolve(o.text()):e.reject(o)},Xe(this.Ea))},image:function(){var e=x.document.createElement("img"),o=this,s=this.data;return e.onload=A(this.resolve,this,e),e.onerror=function(){o.reject(Ke.error())},e.crossOrigin=this.Ea.crossOrigin,e.src=s,{abort:function(){e.onerror=e.onload=null,re&&Fe(e)||e.removeAttribute("src")}}}};(function(){try{var e=new XMLHttpRequest;e.open("get","/",!0)}catch{e={}}"response"in e&&(Ve.arraybuffer=function(){var o=new XMLHttpRequest,s=this,h=this.Ea,d=h.headers,g;if(o.open("GET",this.data),Ye(o,h),o.responseType="arraybuffer",d)for(g in d)o.setRequestHeader(g,d[g]);return o.onerror=o.ontimeout=function(){s.reject(Ke.error())},o.onload=function(){s.resolve(new Ke(o.response))},o.send(),o})})();var Ze=new ie(new Ne);Ue.prototype.Fp=function(){return Ze};var We=x.document.createElement("a");function Xe(e){var o=Na(e);return delete o.crossOrigin,Ye(o,e),o}function Ye(e,o){e.withCredentials=o.crossOrigin==="use-credentials"}var $e;function af(e,o){if(x.URL)return new x.URL(e,o).toString();if(!e||!bf(e))return e;if(!o||bf(o))throw new TypeError("Failed to construct 'URL': Invalid base URL");$e||($e=document.createElement("a"),mb($e));var s=$e;return s.href=o,e[0]!=="/"?e=s.href.replace(/\/[^\/]*$/,"/")+e:((o=s.origin)||(o=s.protocol+"//"+s.host),e=o+e),e}function bf(e){var o=!1;return typeof e=="string"&&(o=!(-1<e.search(/^(http|https|data|blob):/)||e.substr(0,2)==="//")),o}function cf(e,o){if(cf.g.constructor.call(this),o&&bf(o))throw new D(cf,1,"Base URL must be absolute");this.o=df.INIT,this.Ia=null,this.kd=o}u(cf,K),t("H.map.render.Style",cf),cf.prototype.load=cf.prototype.load,cf.prototype.getState=function(){return this.o},cf.prototype.getState=cf.prototype.getState,cf.prototype.F=function(e){this.o=e},cf.prototype.setState=cf.prototype.F,cf.prototype.Ic=function(){return this.kd},cf.prototype.getBaseUrl=cf.prototype.Ic,cf.prototype.Rd=function(){return Ya(this.Ia)},cf.prototype.getConfig=cf.prototype.Rd,cf.prototype.yz=function(){return this.Ia},cf.prototype.getConfigReference=cf.prototype.yz,cf.prototype.Dg=function(e){this.Ia=e},cf.prototype.setConfig=cf.prototype.Dg,cf.prototype.Gc=function(e){this.Ia=null,this.F(df.ERROR),this.bq(ef)?this.dispatchEvent(new td(ef,e,this)):console.error(e)},cf.prototype.dispatchError=cf.prototype.Gc,cf.prototype.disposeInternal=function(){cf.g.disposeInternal.call(this),this.Ia=null};var ef="error",ff={zf:"change",Js:ef},df={ERROR:-1,INIT:0,LOADING:1,READY:2};cf.State=df;function gf(e,o){var s,h=arguments.length,d,g;for(s=1;s<h;s++)if((d=arguments[s])&&d!==e&&d!==_){var _=d;for(g in d){var j=d[g];e[g]!==j&&(hf(j)?hf(e[g])?e[g]=gf(e[g],j):e[g]=Ya(j):j!==void 0&&(e[g]=Ya(j)))}}return e}t("H.util.webgl.mergeObjects",gf);var jf=Ta();function kf(e,o,s){var h=s[e];return o&&h in o&&0>$a.indexOf(h)?(o=o[h],++e<s.length?kf(e,o,s):o):jf}var lf=kf.bind(null,0),mf={polygons:1,lines:1,"pattern-lines":1,points:1,text:1,raster:1,custom_icons:1,overlays:1},nf={data:1,draw:1,enabled:1,filter:1,properties:1},of=Object.keys(nf);function pf(e,o,s,h,d,g){var _=h[e],j=s[_];if(++e<h.length){var $=o[_]||{};for(s=of.length;s--;){var _t=of[s];if(_t!=="draw"||!g){var _e=j[_t];_e!==B&&($[_t]=Ya(_e))}}pf(e,$,j,h,d,g)}else d?$=Ya(j):($=j,delete s[_]);o[_]=o[_]?gf(o[_],$):$}var qf=pf.bind(null,0);function rf(e,o){e in mf&&(o[e]=1)}function sf(e,o,s){var h,d,g;for(h in e)if(nf[h]){if(h==="draw"){var _=e[h];for(d in _){var j=_[d];(g=j.style)?(j.style=o+g,rf(g,s)):(delete _[d],_[o+d]=j,rf(d,s))}}}else sf(e[h],o,s)}function tf(e,o){var s={},h,d,g,_;if(o+="_",e=gf({},e),h=e.styles)for(d in h){var j=h[d];if(delete h[d],h[o+d]=j,g=j.mix)for(gb(g)&&(g=[g]),_=g.length;_--;)rf(g[_],s),g[_]=o+g[_];(_=j.base)&&(g||(g=j.mix=[]),g.unshift(o+_),delete j.base,rf(_,s)),rf(d,s)}else h=e.styles={};if(j=e.layers)for(d in j)g=j[d],delete j[d],(_=g.data)&&!_.layer&&(_.layer=d),j[o+d]=g,sf(g,o,s);for(d in s)h[o+d]={base:d};return e}function uf(e,o){var s=e.sources,h=Object.keys(s)[0],d=gf(s[h],{uid:o});s=e.layers;var g;e.sources={},e.sources[o]=d;for(g in s)e=s[g],e.data?e.data.source===h&&(e.data.source=o):e.data={source:o}}function vf(e,o){var s,h=e.textures;e=e.fonts;for(s in h){var d=h[s];d.url&&(d.url=af(d.url,o))}for(s in e)if(d=e[s],fb(d))for(h=0;h<d.length;h++){var g=d[h];g.url=g.url&&af(g.url,o)}else g=d,g.url=g.url&&af(g.url,o)}function wf(e,o){return"function(){return "+("feature."+e)+";}"}function xf(e){return wf("style."+e)}function yf(e,o,s,h){return e={base:e,blend:o,blend_order:s},h&&(e.clean_depth=!!h),e}function zf(e){var o={};return o["translucent-"+(e?"extruded-":"")+"polygons"]={color:xf("fillColor"),order:1,interactive:!0,extrude:e},o}function Af(e,o,s,h){return e={data:{source:e,layer:o}},s&&(e.draw=s),h&&(e.filter=h),e}function hf(e){return ya(e)&&!fb(e)}function Bf(e,o){if(Bf.g.constructor.call(this,e,o),gb(e))Cf.test(e)&&e.indexOf("import:")===-1?(this.wc=e,o||(this.YA=bf(this.wc)?B:this.wc)):this.po=e;else if(ya(e))this.Dg(Ya(e));else throw new D(Bf,0,"invalid style configuration")}u(Bf,cf),t("H.map.render.webgl.Style",Bf),Bf.prototype.load=function(){var e=this,o=this.Ic();this.wc?(this.F(df.LOADING),new Ue("text/plain",this.wc).then(function(s){var h={};return Df(s,o,!1,(h[o]=!0,h))}).then(function(s){return e.Dg(s)},function(s){return e.Gc(s.message)}),delete this.wc):this.po&&(this.F(df.LOADING),Df(this.po,o).then(function(s){return e.Dg(s)},function(s){return e.Gc(s.message)}),delete this.po)},Bf.prototype.load=Bf.prototype.load,Bf.prototype.Uw=function(e,o,s){var h;for(Ef(this),e=Ff(this,e,this.Uw,s),s=0;s<e.length;s++){var d=e[s].yb.draw;for(h in d){var g=d[h];hf(g)&&(g.interactive=!!o)}}Gf(this)},Bf.prototype.setInteractive=Bf.prototype.Uw,Bf.prototype.setProperty=function(e,o,s){var h,d=e.split("."),g=0,_=d.length;if(Ef(this),!ab(o))throw new D(this.setProperty,1,"value");if(h=Hf(this.Ia,d)){if(!(h.parent instanceof Object)||h.parent instanceof Array)if(s)d.pop(),d=Hf(this.Ia,d),h.parent=d.parent[d.En]={};else throw new D(this.setProperty,0,e+" property is not primitive type");h.parent[h.En]=o}else{for(h=this.Ia;g!==_-1;)h[d[g]]={},h=h[d[g++]];h[d[g]]=o}If(this)&&Gf(this)},Bf.prototype.setProperty=Bf.prototype.setProperty,Bf.prototype.Op=function(e){return Ef(this),(e=Hf(this.Ia,e.split(".")))?Ya(e.node):void 0},Bf.prototype.getProperty=Bf.prototype.Op,Bf.prototype.removeProperty=function(e){Ef(this),(e=Hf(this.Ia,e.split(".")))&&e.parent&&e.parent.hasOwnProperty(e.En)&&(delete e.parent[e.En],If(this)&&Gf(this))},Bf.prototype.removeProperty=Bf.prototype.removeProperty,Bf.prototype.vj=function(e,o,s){var h;Ef(this);var d=this.Ia,g=d.layers,_=Ff(this,e,this.vj,!1);for(e=_.length,h={};e--;)qf(h,g,_[e].id,!!o,!!s);for(s={},_=Object.keys(d),e=_.length;e--;){var j=_[e],$=d[j];s[j]=$===g?h:Ya($)}return o||Gf(this),s},Bf.prototype.extractConfig=Bf.prototype.vj,Bf.prototype.fk=function(e){if(Ef(this),!ya(e))throw new D(this.fk,0,"config");this.Dg(gf(this.Ia,e))},Bf.prototype.mergeConfig=Bf.prototype.fk,Bf.prototype.Yb=ca(0),Bf.prototype.toString=function(){return this.getState()===df.READY?x.H.gl.yaml.dump(this.Ia,{lineWidth:120}):""},Bf.prototype.disposeInternal=function(){Bf.g.disposeInternal.call(this),delete this.po,delete this.wc};function If(e){var o=e.Ia,s;if(ya(o)){var h;if(h=e.ts){o=o&&o.sources,h=!1;for(var d in o)if(o[d].type===e.ts){h=!0;break}h=!(!o||h)}h&&(s="invalid source, the only valid type is "+e.ts)}else s="invalid style configuration";return s&&e.Gc(s),!s}function Gf(e){e.dispatchEvent(new uc("change",e))}function Ef(e){if(e.getState()!==df.READY)throw new wb(e.fk,"style is not ready yet")}function Ff(e,o,s,h){var d=[],g=fb(o)?o:[o],_,j;for(h===void 0&&(h=!0),g=g.sort().reverse();_=g.pop();){o=String(_).split(".");t:{for(var $=e.Ia,_t=o.length;_t--&&!nf[o[_t]];);if($&&0>_t&&($=lf($.layers,o),hf($)))break t;$=jf}if($===jf)throw new D(s,0,'Unresolvable layer ID "'+_+'"');if(d.push({id:o,yb:$}),h)for(j in $)!nf[j]&&hf($[j])&&g.push(_+"."+j)}return d}function Hf(e,o){var s=0,h;for(h=o.length;s!==h;){var d=o[s++],g=e;if(e=g[d],!e)break}return s===h?{node:e,parent:g,En:d}:void 0}var Cf=/^(http[s]?)?.*\.ya?ml/i;function Df(e,o,s,h){s=s===void 0?!1:s,h=h===void 0?{}:h;try{var d=x.H.gl.yaml.load(e,{json:!0})}catch(g){return Promise.reject(g)}return d&&(e=d.import,gb(e)&&(e=[e]),s&&o&&Jf(d,o),delete d.import,fb(e)&&e.length)?(s=e.reduce(function(g,_){var j=o?af(_,o):_;return h[j]||(h[j]=!0,g.push(new Ue("text/plain",j).then(function($){return Df($,j,!0,h)}))),g},[]),Promise.all(s).then(function(g){var _={};return g.forEach(function(j){return j&&gf(_,j)}),gf(_,d),_})):Promise.resolve(d)}function Jf(e,o){function s(_){_.url&&(_.url=af(_.url,o))}var h=e&&e.fonts;if(h)for(var d in h)fb(h[d])?h[d].forEach(s):s(h[d]);if(e=e&&e.textures)for(var g in e)s(e[g])}Bf.normalize=Jf,Bf.prototype.Dg=function(e){Bf.g.Dg.call(this,e),If(this)&&(this.F(df.READY),Gf(this))},Bf.prototype.Rd=function(){return Bf.g.Rd.call(this)},Bf.prototype.getConfig=Bf.prototype.Rd,Bf.prototype.Ic=function(){return this.YA||Bf.g.Ic.call(this)},Bf.prototype.getBaseUrl=Bf.prototype.Ic;var Kf={PROVIDES_BY_VIEWPORT:1,PROVIDES_RASTERS:2,PROVIDES_SPATIALS:4,PROVIDES_OVERLAYS:8,PROVIDES_MARKERS:16,PROVIDES_DOM_MARKERS:32,PROVIDES_GEOJSON:64,PROVIDES_OMV:128,CROP_LINES_BY_TILE:256,CROP_POLYGONS_BY_TILE:512,HAS_VOLATILE_DATA:1024};t("H.map.provider.Capabilities",Kf),Kf.PROVIDES_WEBGL_RENDERABLE_OBJECTS=Kf.PROVIDES_SPATIALS|Kf.PROVIDES_OVERLAYS|Kf.PROVIDES_MARKERS;function Lf(e,o,s,h,d){this.Aa=e,this.uid=o,this.Bv=s,this.Kq=h,this.tileSize=d}Lf.prototype.Je=function(){var e={};return e[this.uid]=this.Aa&Kf.PROVIDES_BY_VIEWPORT?Mf(this,"ObjectSource",!1,{progressiveUpdate:!0,has_volatile_data:!!(this.Aa&Kf.HAS_VOLATILE_DATA)}):this.Aa&Kf.PROVIDES_RASTERS?Mf(this,"RemoteRasterTileSource",!0,{url:""}):Mf(this,"ObjectTileSource",!0,{tile_size:this.tileSize}),e};function Mf(e,o,s,h){return e={type:o,uid:e.uid,tiled:s,max_zoom:e.Kq},h&&Pa(e,h),e}function Nf(e){this.Aa=e}Nf.prototype.Je=function(){var e={};if(this.Aa&Kf.PROVIDES_RASTERS&&(e={"translucent-raster":yf("raster","inlay",1)}),this.Aa&Kf.PROVIDES_WEBGL_RENDERABLE_OBJECTS){var o=!!(this.Aa&Kf.CROP_LINES_BY_TILE),s={"translucent-polygons":yf("polygons","inlay",2),"translucent-extruded-polygons":yf("polygons","translucent",3),"translucent-pattern-lines":yf("pattern-lines","translucent",4),"translucent-overlays":yf("overlays","inlay",5),markers:yf("custom_icons","overlay",6,!1)};s["translucent-polygons"].crop_by_tile=!!(this.Aa&Kf.CROP_POLYGONS_BY_TILE),s["translucent-pattern-lines"].crop_by_tile=o,s.markers.suppress_fade=!0,s.markers.stick=!0,Pa(e,s)}return e};function Of(e,o,s){this.Aa=e,this.uid=o,this.opacity=s,this.$m=this.Aa&Kf.PROVIDES_BY_VIEWPORT?"function(){return sources[$source].isInMinMaxRange(feature, $zoom) && feature.ref.effectiveVisibility;}":B,this.ag={}}Of.prototype.Je=function(){if(this.Aa&Kf.PROVIDES_RASTERS&&(this.ag["tile_layer_"+this.uid]=Af(this.uid,"_default",{"translucent-raster":{color:[1,1,1,this.opacity],order:0}})),this.Aa&Kf.PROVIDES_SPATIALS){var e={"translucent-pattern-lines":{color:xf("strokeColor"),width:xf("lineWidth * $meters_per_pixel"),join:xf("lineJoin"),cap:xf("lineCap"),tail_cap:xf("lineTailCap"),head_cap:xf("lineHeadCap"),miter_limit:xf("miterLimit"),order:"function() { return 2 + feature.effectiveZIdx / 2; }",interactive:!0,dash:xf("lineDash"),extrude:!0,dash_phase:xf("lineDashOffset")}},o=this.ag,s="polygon_layer_"+this.uid,h=Af(this.uid,"polygons",void 0,this.$m);h.flat={filter:"function(){return !feature.height && !feature.min_height;}",draw:zf(!1)},h.extruded={filter:"function(){return feature.height || feature.min_height;}",draw:zf(!0)},o[s]=h,this.ag["outline_layer_"+this.uid]=Af(this.uid,"outlines",e,this.$m),this.ag["polyline_layer_"+this.uid]=Af(this.uid,"polylines",e,this.$m)}return this.Aa&Kf.PROVIDES_OVERLAYS&&(this.ag["overlay_layer_"+this.uid]=Af(this.uid,"overlays",{"translucent-overlays":{color:[1,1,1,this.opacity],order:8190,interactive:!0}})),this.Aa&Kf.PROVIDES_MARKERS&&(this.ag["marker_layer_"+this.uid]=Af(this.uid,"markers",{markers:{sprite:wf("icon.id"),offset:wf("icon.offset"),collide:!1,priority:8191,elevate_by_altitude:!0,interactive:!0,stick:{color:wf("icon.stick_color"),height:wf("icon.stick_height")}}},this.$m)),this.ag};function Pf(e,o,s,h,d,g){this.Aa=e,this.uid=o,this.Bv=s,this.Kq=h,this.opacity=d,this.tileSize=g}Pf.prototype.Je=function(){if(this.Aa&Kf.PROVIDES_DOM_MARKERS&&!(this.Aa&Kf.PROVIDES_MARKERS))return{};var e=new Lf(this.Aa,this.uid,this.Bv,this.Kq,this.tileSize),o=new Nf(this.Aa),s=new Of(this.Aa,this.uid,this.opacity);return e=e.Je(),o=o.Je(),s=s.Je(),{sources:e,styles:o,layers:s}};function L(e){var o=""+we(),s;if(L.g.constructor.call(this),e=e||{},this.min=e.min||0,this.max=e.max||22,s=e.uri){if(/_/.test(s))throw new D(L,0,"uri "+s)}else s=o;if(this.uri=s||o,this.uid=o,e.getCopyrights&&db(e.getCopyrights,"Function",L)&&(this.getCopyrights=e.getCopyrights),this.Eb=this.Eb.bind(this),this.lq=!0,this.vb=e.engineType||Qf,this.vb===Rf.HARP&&!H.map.render.harp)throw new D(L,0,"HARP engine is not supported, module not found")}u(L,K),t("H.map.provider.Provider",L),m=L.prototype,m.j={Li:"configchange",za:"update"},m.jb=function(e,o){this.dispatchEvent(new qd(this.j.za,o,e))},m.Eb=function(e){e=new Zc(this.j.Li,e&&e.newValue,e&&e.oldValue),this.dispatchEvent(e)},m.disposeInternal=function(){K.prototype.disposeInternal.call(this),this.Ya&&(this.Ya.removeEventListener("change",this.Eb),this.Ya.l(),delete this.Ya)},m.U=function(){return null},L.prototype.getCopyrights=L.prototype.U,L.prototype.getCapabilities=function(){var e=0;return this.qr()&&(e|=Kf.PROVIDES_BY_VIEWPORT),this.providesRasters()&&(e|=Kf.PROVIDES_RASTERS),this.providesSpatials()&&(e|=Kf.PROVIDES_SPATIALS),this.providesOverlays()&&(e|=Kf.PROVIDES_OVERLAYS),this.providesMarkers()&&(e|=Kf.PROVIDES_MARKERS),this.providesDomMarkers()&&(e|=Kf.PROVIDES_DOM_MARKERS),this.providesGeoJSON()&&(e|=Kf.PROVIDES_GEOJSON),this.providesOMV()&&(e|=Kf.PROVIDES_OMV),e},L.prototype.getCapabilities=L.prototype.getCapabilities,L.prototype.qr=ye,L.prototype.zk=ye,L.prototype.providesRasters=L.prototype.zk,L.prototype.me=ye,L.prototype.providesSpatials=L.prototype.me,L.prototype.sr=ye,L.prototype.providesOverlays=L.prototype.sr,L.prototype.Uc=ye,L.prototype.providesMarkers=L.prototype.Uc,L.prototype.Tc=ye,L.prototype.providesDomMarkers=L.prototype.Tc,L.prototype.rr=ye,L.prototype.providesGeoJSON=L.prototype.rr,L.prototype.Vc=ye,L.prototype.providesOMV=L.prototype.Vc,L.prototype.Iz=function(){return this.vb},L.prototype.getEngineType=L.prototype.Iz,L.prototype.WC=function(e){this.vb=e},L.prototype.setEngineType=L.prototype.WC,L.prototype.xk=ze,L.prototype.preprocessData=L.prototype.xk,L.prototype.Qc=1,L.prototype.Eg=function(e){e=ac(e,0,1),E(e)&&(e=1),this.Qc!==e&&(this.Qc=e,this.lq&&Sf(this),this.Eb(),this.jb())},L.prototype.jA=function(){return this.Qc},L.prototype.getOpacityInternal=L.prototype.jA,L.prototype.Xa=function(e,o){var s=this;if(this.vb===Rf.WEBGL&&!C(e,Bf)||this.vb===Rf.HARP&&!C(e,H.map.render.harp.Style))throw e=Object.entries(Rf).find(function(h){return h[1]===s.vb}),new D(this.Xa,0,"Invalid style for engineType "+e);this.Ya&&(this.Ya.removeEventListener("change",this.Eb),this.Ya.removeEventListener(ef,this.Eb),this.Ya.l()),this.Ya=e,this.Ya.addEventListener("change",this.Eb),this.Ya.addEventListener(ef,this.Eb),o||this.Eb(),this.lq=!1},L.prototype.setStyleInternal=L.prototype.Xa,L.prototype.mb=function(){return this.Ya||Sf(this),this.Ya},L.prototype.getStyleInternal=L.prototype.mb;function Sf(e){if(e.vb===Rf.WEBGL){var o=new Pf(e.getCapabilities(),e.uid,e.min,e.max,e.Qc,e.tileSize);e.Ya=new Bf(o.Je())}else e.vb===Rf.HARP&&H.map.render.harp&&(e.Ya=new H.map.render.harp.Style({}));e.lq=!0}L.prototype.qu=function(){var e=this.getCapabilities(),o=Je.FEATURE;return e&Kf.PROVIDES_BY_VIEWPORT?o=Je.SOURCE:e&Kf.PROVIDES_RASTERS?o=null:e&Kf.PROVIDES_WEBGL_RENDERABLE_OBJECTS&&(o=Je.PROVIDER),o},L.prototype.getPickingMode=L.prototype.qu,L.prototype.Nz=function(){return!1},L.prototype.getFeatureProxy=L.prototype.Nz;function Tf(e){e=e||{},Tf.g.constructor.call(this),this.min=0,this.max=22,this.Ly=this.dark=!!e.dark,e.min&&this.Tr(e.min),e.max&&this.Rr(e.max),this.pixelProjection=new md(e.projection,e.minWorldSize),e.provider&&(this.D=e.provider,this.jb=A(this.jb,this),this.D.addEventListener(L.prototype.j.za,this.jb,!1,this),this.Eb=A(this.Eb,this),this.D.addEventListener(L.prototype.j.Li,this.Eb,!1,this))}u(Tf,K),t("H.map.layer.Layer",Tf),Tf.prototype.min=0,Tf.prototype.min=Tf.prototype.min,Tf.prototype.max=22,Tf.prototype.max=Tf.prototype.max,Tf.prototype.j={za:"update",Li:"configchange",Qs:"minchange",Ps:"maxchange"},Tf.prototype.Pp=function(){return this.D},Tf.prototype.getProvider=Tf.prototype.Pp,Tf.prototype.eB=function(e){return this.min<=e&&e<=this.max},Tf.prototype.isValid=Tf.prototype.eB;function Uf(e,o,s){var h=e[o],d=o==="min",g=d?e.Tr:e.Rr;if(s!==h)if(d?s<=e.max:s>=e.min)e[o]=s,e.jb(),e.Eb(),e.dispatchEvent(new Zc(d?e.j.Qs:e.j.Ps,s,h));else throw new D(g,0,"Invalid condition min <= max");return e}Tf.prototype.Tr=function(e){return Uf(this,"min",+e)},Tf.prototype.setMin=Tf.prototype.Tr,Tf.prototype.Rr=function(e){return Uf(this,"max",+e)},Tf.prototype.setMax=Tf.prototype.Rr,Tf.prototype.jb=function(){this.dispatchEvent(this.j.za)},Tf.prototype.Eb=function(e){e=new Zc(this.j.Li,e&&e.newValue,e&&e.oldValue),this.dispatchEvent(e)},Tf.prototype.disposeInternal=function(){Tf.g.disposeInternal.call(this)},Tf.prototype.U=function(){return null},Tf.prototype.getCopyrights=Tf.prototype.U;function J(e,o,s,h){Vf(this,ad(e,J,0),bd(o,J,1),ad(s,J,2),bd(h,J,3))}u(J,ed),t("H.geo.Rect",J),J.prototype.ac="Polygon",J.prototype.xf=function(e){var o=this.fa,s=this.W,h=this.ga,d=this.ca;return e.push("(","(",s," ",o,",",d," ",o,",",d," ",h,",",s," ",h,",",s," ",o,")",")"),e},J.prototype.da=function(e){var o=this===e;return!o&&C(e,J)&&(o=this.fa===e.fa&&this.W===e.W&&this.ga===e.ga&&this.ca===e.ca),o},J.prototype.equals=J.prototype.da,J.prototype.clone=function(){return new J(this.fa,this.W,this.ga,this.ca)},J.prototype.clone=J.prototype.clone;function Vf(e,o,s,h,d){return e.W=s,e.ca=d,o<h&&(s=o,o=h,h=s),e.fa=o,e.ga=h,e.ll=e.Ri=e.Df=null,e}J.prototype.Lc=function(){return this.ll||(this.ll=new fd(this.fa,this.W)),this.ll},J.prototype.getTopLeft=J.prototype.Lc,J.prototype.Jc=function(){return this.Ri||(this.Ri=new fd(this.ga,this.ca)),this.Ri},J.prototype.getBottomRight=J.prototype.Jc,J.prototype.HA=function(){return this.fa},J.prototype.getTop=J.prototype.HA,J.prototype.uz=function(){return this.ga},J.prototype.getBottom=J.prototype.uz,J.prototype.bA=function(){return this.W},J.prototype.getLeft=J.prototype.bA,J.prototype.xA=function(){return this.ca},J.prototype.getRight=J.prototype.xA,J.prototype.wb=function(){return this.Df||(this.Df=new fd(this.ga+(this.fa-this.ga)/2,Wf(this.W,this.oc()))),this.Df},J.prototype.getCenter=J.prototype.wb,J.prototype.oc=function(){return Xf(this.W,this.ca)},J.prototype.getWidth=J.prototype.oc,J.prototype.yh=function(){return this.fa-this.ga},J.prototype.getHeight=J.prototype.yh,J.prototype.pc=function(){return this.W>this.ca},J.prototype.isCDB=J.prototype.pc,J.prototype.Im=function(){return!this.oc()&&!this.yh()},J.prototype.isEmpty=J.prototype.Im,J.prototype.C=function(){return new J(this.fa,this.W,this.ga,this.ca)},J.prototype.getBoundingBox=J.prototype.C,J.prototype.Pl=function(e,o,s){var h=this.wb();return s||(e=ad(e,this.Pl,0),o=bd(o,this.Pl,1)),o=this.cf(e,o,s),e=o.wb(),e.lat===h.lat&&e.lng===h.lng&&this.yh()===o.yh()&&this.oc()===o.oc()},J.prototype.containsLatLng=J.prototype.Pl,J.prototype.Ff=function(e,o){return o||gd(e,this.Ff,0),this.Pl(e.lat,e.lng,o)},J.prototype.containsPoint=J.prototype.Ff,J.prototype.Vo=function(e,o){var s=this.wb();if(!o&&!C(e,J))throw new D(this.Vo,0,e);return o=this.yd(e,o),e=o.wb(),e.lat===s.lat&&e.lng===s.lng&&this.yh()===o.yh()&&this.oc()===o.oc()},J.prototype.containsRect=J.prototype.Vo,J.prototype.cf=function(e,o,s,h){if(!s){if(E(e=ad(e)))throw new D(this.cf,0,e);if(E(o=bd(o)))throw new D(this.cf,1,o)}return Yf(this.fa,this.W,this.ga,this.ca,e,o,e,o,h)},J.prototype.mergeLatLng=J.prototype.cf,J.prototype.xv=function(e,o,s){return o||gd(e,this.xv,0),this.cf(e.lat,e.lng,o,s)},J.prototype.mergePoint=J.prototype.xv,J.prototype.yd=function(e,o,s){if(!o&&!C(e,J))throw new D(this.yd,0,e);return Yf(this.fa,this.W,this.ga,this.ca,e.fa,e.W,e.ga,e.ca,s)},J.prototype.mergeRect=J.prototype.yd,J.prototype.ce=function(e,o,s,h,d,g){return d||(e=ad(e,this.ce,0),o=bd(o,this.ce,1),s=ad(s,this.ce,2),h=bd(h,this.ce,3)),Yf(this.fa,this.W,this.ga,this.ca,e,o,s,h,g)},J.prototype.mergeTopLeftBottomRight=J.prototype.ce,J.prototype.Vf=function(e,o){var s=this.W<=this.ca,h=e.W<=e.ca,d=this.W<e.ca,g=e.W<this.ca;if(!o&&!C(e,J))throw new D(this.Vf,0,e);return this.ga<=e.fa&&e.ga<=this.fa&&(!s&&(!h||d||g)||!h&&(d||g)||d&&g)},J.prototype.intersects=J.prototype.Vf;function Xf(e,o){return e=o-e,e+(0>e?360:0)}function Wf(e,o){return e+=o/2,e-(180<e?360:0)}function Yf(e,o,s,h,d,g,_,j,$){s=yb(s,_),e=zb(e,d),d=Xf(o,h);var _t=Wf(o,d);_=Xf(g,j);var _e=Wf(g,_)-_t;if(_e+=0>_e-1e-6?360:0,180>_e-1e-6){_t=o;var _r=j}else _e=360-_e,_t=g,_r=h;return _e=_e+d/2+_/2,360<=_e+5e-7?(_t=-180,_r=180):_e-5e-7<d?(_t=o,_r=h):_e-5e-7<_&&(_t=g,_r=j),$?Vf($,e,_t,s,_r):new J(e,_t,s,_r)}J.merge=Yf;function Zf(e,o,s){return s||(gd(e,Zf,0),gd(o,Zf,1)),new J(e.lat,e.lng,o.lat,o.lng)}J.fromPoints=Zf;function $f(e,o){var s=1,h=e.length,d=null;if(!Ba(e))throw new D($f,0,e);if(0<h){var g=e[0];for(d=Zf(g,g,o);s<h;s++)g=e[s],d.cf(g.lat,g.lng,o,d)}return d}J.coverPoints=$f;function ag(e,o){var s=3,h=e.length,d;if(!(o||e&&e.length!=null))throw new D(ag,0,e);if(0<h)for(d=new J(e[0],e[1],e[0],e[1]);s<h;s+=3)d.cf(e[s],e[s+1],o,d);return d}J.coverLatLngAlts=ag;function bg(e,o){var s=1,h=e.length,d;if(o&&(!e||e.length==null))throw new D(bg,0,e);if(0<h)for(d=new J(e[0].fa,e[0].W,e[0].ga,e[0].ca);s<h;s++)d.yd(e[s],o,d);return d}J.coverRects=bg,J.prototype.Hw=function(e,o){var s=this.W,h=this.fa,d=this.ca,g=this.ga,_=this.wb().lng;gd(e,this.Hw,0);var j=e.lat-g-(h-g)/2,$=e.lng-_;return $=180<$||-180>$?-(_+e.lng):$,e=s+(0>$?2*$:0),e=-180>e?360+e:e,d+=0<$?2*$:0,d=180<d?d-360:d,h=0<j?h+2*j:h,90<=h&&(h=90),g=0>j?g+2*j:g,-90>=g&&(g=-90),o?Vf(o,h,e,g,d):new J(h,e,g,d)},J.prototype.resizeToCenter=J.prototype.Hw,J.prototype.Hc="Polygon",J.prototype.wf=function(){return[[this.W,this.fa,0],[this.ca,this.fa,0],[this.ca,this.ga,0],[this.W,this.ga,0],[this.W,this.fa,0]]},J.prototype.P=function(){return this.Qd()},J.prototype.Qd=function(){return[this.fa,this.W,this.ga,this.ca]};function cg(e,o,s,h){this.left=+e,this.top=+o,this.right=+s,this.bottom=+h}t("H.math.Rect",cg),cg.prototype.set=cg,cg.prototype.set=cg.prototype.set,cg.prototype.Lc=function(){return this.ll||(this.ll=new F(this.left,this.top))},cg.prototype.getTopLeft=cg.prototype.Lc,cg.prototype.Jc=function(){return this.Ri||(this.Ri=new F(this.right,this.bottom))},cg.prototype.getBottomRight=cg.prototype.Jc,cg.prototype.Ql=function(e,o){return this.left<=e&&this.right>=e&&this.top<=o&&this.bottom>=o},cg.prototype.containsXY=cg.prototype.Ql;function dg(e,o){return new cg(e.x,e.y,o.x,o.y)}cg.fromPoints=dg,cg.prototype.clone=function(){return new cg(this.left,this.top,this.right,this.bottom)},cg.prototype.clone=cg.prototype.clone;function eg(e,o){if(o=o||{},!e)throw new D(eg,0,e);this.tileSize=e.tileSize,this.sx={},Tf.call(this,{min:o.min!==void 0?o.min:e.min,max:o.max!==void 0?o.max:e.max,minWorldSize:this.tileSize,projection:o.Dn,dark:o.dark,provider:e})}u(eg,Tf),t("H.map.layer.BaseTileLayer",eg),eg.prototype.Bj=function(e,o){var s=this.pixelProjection;if(!C(e,J))throw new D(this.Bj,0,e);if(!E(o)){var h=s.wu();s.Va(o)}return e=dg(s.Gb(e.Lc()),s.Gb(e.Jc())),!E(h)&&s.Va(h),e},eg.prototype.geoRectToRect=eg.prototype.Bj,eg.prototype.Fh=function(e,o){var s=Gb(2,Bb(o)),h=this.tileSize;if(!C(e,cg))throw new D(this.Fh,0,e);if(E(o=+o))throw new D(this.Fh,1,o);o=Bb(e.left/h),o===s&&--o;var d=Bb(e.right/h);return d===s&&--d,new cg(o,ac(Bb(e.top/h),0,s-1),d,ac(Bb(e.bottom/h),0,s-1))},eg.prototype.getTileBounds=eg.prototype.Fh,eg.prototype.Oa=function(e,o,s,h){return this.D.requestTile(e,o,s,h)},eg.prototype.requestTile=eg.prototype.Oa,eg.prototype.Md=function(e,o,s){this.D.cancelTile(e,o,s)},eg.prototype.cancelTile=eg.prototype.Md,eg.prototype.U=function(e,o){return this.D.getCopyrights?this.D.getCopyrights(e,o):null},eg.prototype.getCopyrights=eg.prototype.U;function fg(e,o,s,h,d){h=Bb(h);var g=Gb(2,h),_=o.left,j=o.top,$=o.right;s=$+(s?g+($===o.left?0:1):1);var _t=o.bottom,_e=[];if(d)var _r=_+(1+$-_)/2+d.x/e.tileSize-.5,_i=j+(1+_t-j)/2+d.y/e.tileSize-.5;for(;_<s;){for(j=o.top;j<=_t;)e=_%g,_e.push([e,j,h,d?Db(_r-_)+Db(_i-j):0]),j++;_++}return _e}eg.prototype.Oj=function(e,o,s,h,d,g){var _,j=[],$,_t=this.D;g=g??"__default__";var _e=_t.requestTile;if(!C(e,cg))throw new D(this.Oj,0,e);if(E(s=+s))throw new D(this.Oj,1,s);if(h||(_={}),o=fg(this,e,o,s,d),e=o.length)for(h||o.sort(gg),s=e;s--;)d=o[s],h||(_[_t.Ud.apply(_t,d)]=!0),d[3]=+h,($=_e.apply(_t,d))&&j.push($);if(!h){h=_;var _r;_=this.sx[g]||{};for(_r in _)_.hasOwnProperty(_r)&&_[_r]&&!h[_r]&&this.D.cancelTileByKey(_r);this.sx[g]=h}return{total:e,tiles:j}},eg.prototype.getProviderTiles=eg.prototype.Oj;function gg(e,o){return o[3]-e[3]}function hg(e,o){hg.g.constructor.call(this,e,o)}u(hg,eg),t("H.map.layer.MarkerTileLayer",hg);var ig={markers:[],total:0,requested:0};function jg(e,o,s,h,d){var g=Bb(s);e.pixelProjection.Va(g),o=e.Fh(e.Bj(o),g),s=e.Oj(o,o.left>o.right,~~s,h,d),e=s.tiles,s=s.total,h=e.length,d=[];var _;for(_=0;_<h;_++)for(o=e[_],g=o.data.length;g--;)d.push(o.data[g]);return{markers:d,total:e.length,requested:s}}hg.prototype.pe=function(e,o,s,h){return this.D.providesDomMarkers()?ig:jg(this,e,o,s,h)},hg.prototype.requestMarkers=hg.prototype.pe,hg.prototype.oe=function(e,o,s,h){return this.D.providesDomMarkers()?jg(this,e,o,s,h):ig},hg.prototype.requestDomMarkers=hg.prototype.oe;function kg(e){bb(this,kg),kg.g.constructor.call(this),this.ha=lg(this,e,this.constructor,0)}u(kg,ed),t("H.geo.MultiGeometry",kg),kg.prototype.splice=function(e,o,s){return e=[e],o!==B&&e.push(o),s&&(o=lg(this,s,this.splice,2),e=e.concat(o)),this.I=z,this.ha.splice.apply(this.ha,e)},kg.prototype.splice=kg.prototype.splice,kg.prototype.Dd=function(e){var o=this.ha.length;if(!(0<=e&&e<o))throw new pd(this.Dd,e,[0,o-1]);return this.I=z,this.ha.splice(e,1)[0]},kg.prototype.removeAt=kg.prototype.Dd,kg.prototype.remove=function(e){if(e=this.ha.indexOf(e),0<=e){var o=this.ha.splice(e,1)[0];this.I=z}return o||z},kg.prototype.remove=kg.prototype.remove,kg.prototype.Rz=function(){return this.ha},kg.prototype.getGeometries=kg.prototype.Rz,kg.prototype.push=function(e){var o=lg(this,[e],this.push,0)[0];this.I&&(this.I=this.I.yd(e.C())),this.ha.push(o)},kg.prototype.push=kg.prototype.push,kg.prototype.C=function(){var e;if(!(e=this.I)){e=z;var o,s;if(this.ha.length)for(e=this.ha[0].C(),s=1;s<this.ha.length;s++)(o=this.ha[s].C())&&(e=e?e.yd(o):o)}return this.I=e},kg.prototype.getBoundingBox=kg.prototype.C,kg.prototype.I=z;function lg(e,o,s,h){var d,g=[];if(!fb(o))throw new D(s,h);for(d=0;d<o.length;d++)if(e.tq(o[d]))g.push(e.nw(o[d]));else throw new D(s,h);return g}kg.prototype.nw=function(e){return e},kg.prototype.da=function(e){var o=this===e,s;if(!o&&(o=C(e,this.constructor))){var h=this.ha;for(e=e.ha,o=(s=h.length)===e.length;o&&s--;)o=h[s].da(e[s])}return o},kg.prototype.equals=kg.prototype.da,kg.prototype.xf=function(e){var o=this.ha,s=o.length,h,d,g=!1;if(s){for(e.push("("),h=0;h<s;h++)(d=0<h&&g)&&e.push(","),o[h].xf(e),e[e.length-1]==="EMPTY"?e.splice(-1-+d,1+ +d):g=!0;g?e.push(")"):e.splice(-1,1,"EMPTY")}else e.push("EMPTY");return e},kg.prototype.Qd=function(){for(var e=[],o=this.ha,s=o.length;s--;)e[s]=o[s].Qd();return e},kg.prototype.P=function(){var e=kg.g.P.call(this);return e.type=this.ac,e},kg.prototype.wf=function(){for(var e=[],o=this.ha,s=o.length;s--;)e[s]=o[s].wf();return e};function mg(e){mg.g.constructor.call(this,e)}u(mg,kg),t("H.geo.MultiPoint",mg),mg.prototype.tq=function(e){return gd(e)},mg.prototype.nw=function(e){return C(e,fd)?e:hd(e)},mg.prototype.ac="Multi"+fd.prototype.ac,mg.prototype.Hc="Multi"+fd.prototype.Hc;function ng(e,o,s,h,d,g){var _,j,$=e.length,_t,_e;if($)for(_=[];$--;){var _r=e[$],_i=_r.length,_n=0;for(_t=1;_t<_i;_t++)if(_e=og(_r[_t-1],_r[_t],s,o,h,d)){var _s=_e[0],_l=_e[1];_n&&_n.da(_s)?j.push(_l):_.push(j=_e),_n=_l,g&&(_t=_i,$=0)}}else _=e;return _}t("H.math.clipping.clipStrips",ng);function og(e,o,s,h,d,g){var _=e.x;e=-e.y;var j=o.x;if(o=-o.y,s=-s,g=-g,_>j){if(j>d||_<h)return;var $=_,_t=e;_=j,e=o,j=$,o=_t,$=1}else if(_>d||j<h)return;if(e>o){if(o>s||e<g)return;var _e=1;e=-e,o=-o,_t=g,g=-s,s=-_t}else if(e>s||o<g)return;if(_<h){if((e+=(h-_)*(o-e)/(j-_))>s)return;_=h}if(e<g){if((_+=(g-e)*(j-_)/(o-e))>d)return;e=g}return j>d&&(o=e+(d-_)*(o-e)/(j-_),j=d),o>s&&(j=_+(s-e)*(j-_)/(o-e),o=s),_e&&(e=-e,o=-o),$?[new F(j,-o),new F(_,-e)]:[new F(_,-e),new F(j,-o)]}function pg(e,o,s){e=qg(e,!0),o=qg(o,!1);var h,d,g={},_=h=1;switch(~~(1*(s||0))){case 1:_=h=0;break;case 2:h=0,_=1;break;case 3:h=1,_=0}s=h;var j=_;if(o&&e){for(o.kj=new rg(o.x,o.y,null,sg(o)),e.kj=new rg(e.x,e.y,null,sg(e)),_=o;_.next;_=_.next)if(!_.ob){for(h=e;h.next;h=h.next)if(!h.ob){var $=tg(_.next),_t=tg(h.next);if(d=ug(_,$,h,_t,g)){d=g.ky;var _e=g.ly,_r=g.GD,_i=g.HD;d=new rg(_r,_i,null,null,null,null,!0,0,0,d),vg(d,_,$),$=new rg(_r,_i,null,null,null,null,!0,0,0,_e),vg($,h,_t),d.Mq=$,$.Mq=d}}}for(g=ec(o,wg(e)),s&&(g=!g),_=o;_;_=_.next)_.ob&&(_.nq=g,g=!g);for(g=ec(e,wg(o)),j&&(g=!g),h=e;h.next;h=h.next)h.ob&&(h.nq=g,g=!g);for(xg(o),xg(e);(e=yg(o))!=o;){for(s=null;!e.ko;e=e.Mq){for(g=e.nq;s=new rg(e.x,e.y,s),s.artificial=e.ob||e.Tu,e.ko=1,e=g?e.next:e.Cd,!!e;)if(e.ob){e.ko=1;break}if(!e)break}s.Nq=_n||null;var _n=s}return _n}}t("H.math.clipping.clipPolygon",pg);function rg(e,o,s,h,d,g,_,j,$,_t){this.x=e,this.y=o,this.next=s||null,this.Cd=h||null,this.Nq=d||null,this.Mq=g||null,this.ob=!!_,this.nq=!!j,this.ko=$||0,this.alpha=_t||0,h&&(h.next=this),s&&(s.Cd=this),this.Tu=!1,this.kj=null}function tg(e){for(;e&&e.ob;)e=e.next;return e}function sg(e){if(e)for(;e.next;)e=e.next;return e}function yg(e){var o=e;if(o)do o=o.next;while(o!=e&&(!o.ob||o.ob&&o.ko));return o}function xg(e){var o=sg(e);o.Cd.next=e,e.Cd=o.Cd}function ug(e,o,s,h,d,g){var _,j=o.x-e.x,$=o.y-e.y,_t=h.x-s.x,_e=h.y-s.y,_r=j*_e-$*_t;return!_r||(_t=((s.x-e.x)*_e-(s.y-e.y)*_t)/_r,_r=($*(s.x-e.x)-j*(s.y-e.y))/_r,0>_t||1<_t||0>_r||1<_r)?0:(_t===0?_=e:_t===1?_=o:_r===0?_=s:_r===1&&(_=h),_&&!g?(_.x+=2480549651603763e-20,_.y+=7321997314118067e-20,_.kj&&(_.kj.x=_.x,_.kj.y=_.y),ug(e,o,s,h,d)):(d.GD=e.x+_t*j,d.HD=e.y+_t*$,d.ky=_t,d.ly=_r,1))}function wg(e){for(var o=[];e;)o.push(e.x,e.y),e=e.next;return o}function vg(e,o,s){for(o=o.next;o!==s&&o.alpha<=e.alpha;)o=o.next;e.next=o,e.Cd=o.Cd,e.next.Cd=e,e.Cd.next=e}function qg(e,o){for(var s,h=null,d=0,g=e.length;d<g;d++)s=new rg(e[d].x,e[d].y,h),s.Tu=o,(s.next=h)&&(h.Cd=s),h=s;return h}function zg(e,o,s,h,d,g){bb(this,zg),this.Ph=e||10,this.xj=null,this.Yi=h||0,this.Zi=d||0,this.Bk=o||1,this.Ck=s||1,this.Kx=!!g,this.flush()}function Ag(e){var o=e.xj;if(e.Kx&&!o){var s=e.head;(s.entries||s[0]||s[1]||s[2]||s[3])&&(o=[s],o=Bg([o,o,o,o],[s[6],s[7],s[4],s[5]]),e.xj=o)}return o}function Bg(e,o){var s,h,d,g,_=0;for(s=3;0<=s;s--){var j=s+4,$=0<s%3,_t=[],_e=o[s],_r=e[s];for(h=_r.length;h--;){var _i=_r[h];if(d=_i.entries)for(g=d.length;g--;){var _n=d[g].Nf(s);($?_n>_e:_n<_e)&&(_e=_n)}for(g=4;g--;)(d=_i[g])&&($?d[j]>_e:d[j]<_e)&&_t.push(d)}_+=_t.length,o[s]=_e,e[s]=_t}return _&&(o=Bg(e,o)),o}function Cg(e,o,s){var h,d;if(e.Kx&&(h=e.xj))for(d=3;0<=d;d--){var g=o.Nf(d);if(d%3?g>=h[d]:g<=h[d])if(s)h[d]=g;else{e.xj=null;break}}}m=zg.prototype,m.remove=function(e){var o,s,h,d=!1;return e&&(o=e.node)&&o.nl===this&&(s=o.entries)&&0<=(h=s.indexOf(e))&&(s.splice(h,1),this.Ll(o),Cg(this,e,!1),d=!0),d},m.flush=function(){var e=new Dg(B,NaN,this.Yi-this.Bk,this.Zi-this.Ck,this.Yi+this.Bk,this.Zi+this.Ck);e.nl=this,this.head=this.root=e,this.xj=null},m.jd=function(e){var o=this.head,s;if(e){var h=e;if(h!==o)for(o=h;h=h.parent;)(h.entries||1<h.hb)&&(o=h)}else for(;!o.entries&&2>(s=o.hb)&&s;)o=h;this.head=o},m.ob=function(e,o,s,h,d,g){var _=[],j=this.head,$=this.root;return e<=j[5]&&o<=j[6]&&(d?s>=j[7]:s>j[7])&&(g?h>=j[4]:h>j[4])&&Eg(this,j,_,e,o,s,h,g||h>=$[6],d||s>=$[5]),_};function Eg(e,o,s,h,d,g,_,j,$){var _t=o.entries,_e=o[7],_r=o[4],_i=o[5],_n=o[6],_s=o[8],_l=o[9],Ap;if(_t){var _h=_t.length;if(d>_r||h>_e||_<_n||g<_i)for(;_h--;){_e=_t[_h],_r=_e.Nf(3),_i=_e.Nf(0),_n=_e.Nf(1);var _p=_e.Nf(2);_p>=d&&_n>=h&&(_i<_||j&&_i==_)&&(_r<g||$&&_r==g)&&s.push(_e)}else for(;_h--;)s.push(_t[_h])}(g>_s||$&&g==_s)&&(d<_l&&(Ap=o[1])&&Eg(e,Ap,s,h,d,g,_,j,$),(_>_l||j&&_==_l)&&(Ap=o[3])&&Eg(e,Ap,s,h,d,g,_,j,$)),h<_s&&(d<_l&&(Ap=o[0])&&Eg(e,Ap,s,h,d,g,_,j,$),(_>_l||j&&_==_l)&&(Ap=o[2])&&Eg(e,Ap,s,h,d,g,_,j,$))}m.ze=ca(2);var Fg=0;function Dg(e,o,s,h,d,g){this.Co=o,e&&(this.parent=e,this.nl=e.nl,o&1?(s=e[8],d=e[5]):(s=e[7],d=e[8]),o&2?(h=e[9],g=e[6]):(h=e[4],g=e[9])),this[7]=s,this[5]=d,this[8]=(s+d)/2,this[4]=h,this[6]=g,this[9]=(h+g)/2}m=Dg.prototype,m.hb=0,m.th=function(e){return this[e]||(++this.hb,this[e]=new Dg(this,e))},m.removeChild=function(e){var o=e.Co;this[o]===e&&(delete this[o],delete e.parent,--this.hb)},m.ze=ca(1),m.Qg=function(e){(this.entries||(this.entries=[])).push(e),e.node=this};function Gg(e,o,s,h,d){var g=e[5],_=e[6];return e[7]<=o&&e[4]<=s&&(g>h||g===h&&g===e.nl.root[5])&&(_>d||_===d&&_===e.nl.root[6])}function Hg(e,o,s,h,d,g){Hg.g.constructor.apply(this,arguments)}u(Hg,zg),Hg.prototype.Ll=function(e){for(var o,s,h=this.head;e;){if((!(o=e.entries)||!o.length)&&(o&&delete e.entries,!e.hb&&(s=e.parent))){s.removeChild(e),h===e&&(h=s),e=s;continue}break}this.head!==h&&(this.head=h,this.jd())};function Ig(e,o,s,h,d){if(Gg(e.root,o,s,h,d))return e.Vb(e.root,o,s,h,d,e.Ph);throw Error("Coordinates out of bounds")}Hg.prototype.Nu=function(e,o,s,h){if(e>s){var d=e;e=s,s=d}return o>h&&(d=o,o=h,h=d),Ig(this,e,o,s,h)},Hg.prototype.Yd=function(e,o){return Ig(this,e,o,e,o)},Hg.prototype.Vb=function(e,o,s,h,d,g){var _=e[8],j=e[9],$=0,_t=0;return g&&(h<_||($=+(o>=_)))&&(d<j||(_t=+(s>=j)))?o=this.Vb(e.th($|_t<<1),o,s,h,d,g-1):(e.Qg(o=new Jg(o,s,h,d)),Cg(this,o,!0),this.jd(e)),o};function Jg(e,o,s,h){this.id=Fg++,this[0]=o,this[1]=s,this[2]=h,this[3]=e}Jg.prototype.Nf=function(e){return this[e]};function Kg(e){this.Ae=new Hg(+e||10,180,90,0,0,!0),this.Kl=[],this.kq=!1,this.Cf=this.Mg=this.I=null}t("H.geo.QuadTree",Kg),m=Kg.prototype,m.jc=0,m.pc=function(){return this.kq},m.C=function(){var e,o;if(!this.I){var s=[];!this.Mg&&(e=Ag(this.Ae))&&(this.Mg=new J(-e[0],e[3],-e[2],e[1])),(o=this.Mg)&&s.push(o);var h,d,g;if(!this.Cf&&(g=(d=this.Kl).length)){e=90;var _=360,j=-90;for(h=0;g--;){var $=d[g];e=yb(e,$[0]),_=yb(_,$[3]),j=zb(j,$[2]),h=zb(h,$[1])}this.Cf=new J(-e,_,-j,h-360)}(o=this.Cf)&&s.push(o),(o=s[0])&&(s[1]&&(o=o.yd(s[1],!0)),this.I=o)}return this.I},m.Vb=function(e,o,s,h,d){return d?(d=new Jg(h,-e,o+360,-s),this.Kl.push(d),this.kq=!0,this.Cf&&this.Cf.ce(e,o,s,h,!0,this.Cf)):(d=Ig(this.Ae,o,-e,h,-s),this.Mg&&this.Mg.ce(e,o,s,h,!0,this.Mg)),++this.jc,this.I=null,d},m.Yd=function(e){var o=e.lng;return e=e.lat,this.Vb(e,o,e,o,!1)},m.Lu=function(e){var o=e.Lc(),s=e.Jc();return(e=e.pc())?this.Vb(o.lat,s.lng,s.lat,o.lng,e):this.Vb(o.lat,o.lng,s.lat,s.lng,e)},Kg.prototype.insertBoundingBox=Kg.prototype.Lu,Kg.prototype.Nu=function(e,o,s,h){if(o<h)var d=o;else d=h,h=o;return e<s?o=s:(o=e,e=s),this.Vb(o,d,e,h,180<h-d)},Kg.prototype.remove=function(e){var o;if(e.node){var s=this.Ae.remove(e);this.Mg=null}else e=(o=this.Kl).indexOf(e),(s=0<=e)&&(o.splice(e,1),this.kq=0<o.length,this.Cf=null);return s&&(--this.jc,this.I=null),s},Kg.prototype.remove=Kg.prototype.remove;function Lg(e,o,s,h,d,g,_){e=e.Kl;var j=e.length,$=[],_t;if(j){var _e=s+360;for(_t=d+360;j--;){var _r=e[j];(Mg(_r,o,s,h,d,g,_)||Mg(_r,o,_e,h,_t,g,_))&&$.push(_r)}}return $}function Mg(e,o,s,h,d,g,_){var j=e[3],$=e[0],_t=e[1];return e=e[2],(g?$<=h:$<h)&&(_?j<=d:j<d)&&e>=o&&_t>=s}function Ng(e,o){var s,h,d;if(s=o.length){var g=e.length;for(h={};g--;)h[e[g].id]=1;for(;s--;)(d=o[s]).id in h||e.push(d)}}Kg.prototype.Fm=function(e,o,s){var h=this.Ae,d=e.Lc(),g=e.Jc(),_=-d.lat;d=d.lng;var j=-g.lat;return g=g.lng,!o&&_===j||!s&&d===g?e=[]:e.pc()?(e=h.ob(-180,_,g,j,s,o),Ng(e,h.ob(d,_,180,j,!1,o)),Ng(e,Lg(this,_,g,j,d+360,o,s))):(e=h.ob(d,_,g,j,s,o),Ng(e,Lg(this,_,d,j,g,o,s))),e},Kg.prototype.intersectBoundingBox=Kg.prototype.Fm;var Og=[62,-1,-1,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,63,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Pg=typeof BigInt<"u"?BigInt:Number;function Qg(e){var o=Pg(0),s=Pg(0),h=[];if(e.split("").forEach(function(d){d=Pg(Og[d.charCodeAt(0)-45]),o|=(d&Pg(31))<<s,(d&Pg(32))===Pg(0)?(h.push(o),o=Pg(0),s=Pg(0)):s+=Pg(5)}),0<s)throw Error("Invalid encoding");return h}function Rg(e){return e&Pg(1)&&(e=~e),e>>=Pg(1),+e.toString()}function Sg(e){var o=e.precision===void 0?5:e.precision,s=e.hl===void 0?0:e.hl,h=e.il===void 0?0:e.il;e=e.kr;var d=Math.pow(10,o),g=Math.pow(10,h);if(0>o||15<o)throw Error("precision out of range. Should be between 0 and 15");if(0>h||15<h)throw Error("thirdDimPrecision out of range. Should be between 0 and 15");if(0>s||7<s||s===4||s===5)throw Error("thirdDim should be between 0, 1, 2, 3, 6 or 7");o=Tg(1)+Tg(h<<7|s<<4|o);var _=[],j=Pg(0),$=Pg(0),_t=Pg(0);return e.forEach(function(_e){var _r=Pg(Math.round(_e[0]*d));_.push(Ug(_r-j)),j=_r,_r=Pg(Math.round(_e[1]*d)),_.push(Ug(_r-$)),$=_r,s&&(_e=Pg(Math.round(_e[2]*g)),_.push(Ug(_e-_t)),_t=_e)}),[].concat(o instanceof Array?o:ha(fa(o)),_ instanceof Array?_:ha(fa(_))).join("")}function Tg(e){var o="";for(e=Pg(e);31<e;)o+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[e&Pg(31)|Pg(32)],e>>=Pg(5);return o+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"[e]}function Ug(e){e=Pg(e);var o=0>e;return e<<=Pg(1),o&&(e=~e),Tg(e)}function Vg(e){return Sg({kr:e.polyline,precision:e.precision,hl:e.thirdDim,il:e.thirdDimPrecision})}t("H.util.flexiblePolyline.encode",Vg);function Wg(e){if(e=Qg(e),+e[0].toString()!=1)throw Error("Invalid format version");var o=+e[1].toString();o={precision:o&15,hl:o>>4&7,il:o>>7&15};for(var s=Math.pow(10,o.precision),h=Math.pow(10,o.il),d=o.hl,g=0,_=0,j=0,$=[],_t=2;_t<e.length;){var _e=Rg(e[_t+1])/s;g+=Rg(e[_t])/s,_+=_e,d?(j+=Rg(e[_t+2])/h,$.push([g,_,j]),_t+=3):($.push([g,_]),_t+=2)}if(_t!==e.length)throw Error("Invalid encoding. Premature ending reached");return e=Object.assign({},o,{kr:$}),{polyline:e.kr,precision:e.precision,thirdDim:e.hl,thirdDimPrecision:e.il}}t("H.util.flexiblePolyline.decode",Wg);function M(e){M.g.constructor.call(this),e&&Xg(e,M,0),this.S=e||[],this.gd=Yg(this,0,this.S.length)}u(M,ed),t("H.geo.LineString",M);function Yg(e,o,s){e=e.S;var h=0;for(o=zb(o,0),s=yb(s,e.length),s-=2,o+=1;o<s;)h+=dd(e[o],e[o+=3]);return h}M.prototype.tr=function(e,o,s){Zg(this,e,o,s,this.tr)},M.prototype.pushLatLngAlt=M.prototype.tr;function Zg(e,o,s,h,d){var g=e.S.length;o=ad(o,d),s=bd(s,d),e.S.push(ad(o,d),bd(s,d),h===B?0:cd(h,d)),g&&(e.gd+=dd(e.S[g-2],s)),delete e.I,delete e.ur}M.prototype.Yk=function(e,o,s){s&&Xg(s,this.Yk,2),o===void 0&&(o=this.S.length),o&&(this.gd-=Yg(this,e-3,e+o+3));var h=s?this.S.splice.apply(this.S,[e,o].concat(s)):this.S.splice(e,o);return s&&(this.gd+=Yg(this,e-3,e+s.length+3)),o&&!s&&(this.gd+=Yg(this,e-3,e-3)),delete this.I,delete this.ur,h},M.prototype.spliceLatLngAlts=M.prototype.Yk,M.prototype.Mu=function(e,o,s,h){this.Yk(e,0,[o,s,h])},M.prototype.insertLatLngAlt=M.prototype.Mu,M.prototype.yw=function(e){this.Yk(e,3)},M.prototype.removeLatLngAlt=M.prototype.yw,M.prototype.sg=function(e){Zg(this,e.lat,e.lng,e.alt,this.sg)},M.prototype.pushPoint=M.prototype.sg,M.prototype.Yd=function(e,o){this.Mu(3*e,o.lat,o.lng,o.alt)},M.prototype.insertPoint=M.prototype.Yd,M.prototype.Ek=function(e){this.yw(3*e)},M.prototype.removePoint=M.prototype.Ek,M.prototype.wj=function(e,o){var s=this.S,h=3*e;e=s[h];var d=s[h+1];return s=s[h+2],o&&(o.lat=e,o.lng=d,o.alt=s),o||new fd(e,d,s)},M.prototype.extractPoint=M.prototype.wj,M.prototype.Yy=function(e,o,s){var h=this.S;o=o||0,s=se(s,h.length/3);for(var d=3*o;o<s;)e(h[d++],h[d++],h[d++],o++)},M.prototype.eachLatLngAlt=M.prototype.Yy,M.isDBC=dd,M.prototype.Cp=function(e){var o=this.gd;return e&&(e=this.S,o+=dd(e[e.length-2],e[1])),o},M.prototype.getDBCs=M.prototype.Cp,M.prototype.Mj=function(){return this.S.length/3},M.prototype.getPointCount=M.prototype.Mj,M.prototype.Zz=function(){return this.S},M.prototype.getLatLngAltArray=M.prototype.Zz,M.prototype.I=z,M.prototype.C=function(){var e;if(!(e=this.I)){e=this.S;var o=e.length,s=3,h,d,g=z;if(3<=o){var _=h=e[0],j=d=e[1];for(g=new J(_,j,h,d);s<o;s+=3){if(_=e[s-3],j=e[s-2],h=e[s],d=e[s+1],j>d&&180<d-j||j<d&&-180>j-d||d<j&&180>Db(d-j)){var $=j;j=d,d=$}_<h&&($=_,_=h,h=$),Yf(g.fa,g.W,g.ga,g.ca,_,j,h,d,g)}}e=this.I=g}return e},M.prototype.getBoundingBox=M.prototype.C,M.prototype.SA=function(){return this.I!==z},M.prototype.hasBoundingBox=M.prototype.SA;function Xg(e,o,s){for(var h=e.length,d=!(h%3),g;d&&h;)d=!(E(e[--h]=cd((g=e[h])===B?0:g))||E(e[--h]=bd(e[h]))||E(e[--h]=ad(e[h])));if(!d&&o)throw new D(o,s,e)}function $g(e){var o=new M,s=0,h=e.length;if(h%2)throw new D($g,0,e);for(;s<h;)Zg(o,e[s++],e[s++],0,$g);return o}M.fromLatLngArray=$g,M.prototype.da=function(e){var o=this===e,s;if(!o&&(o=C(e,M))){var h=this.S;for(e=e.S,o=(s=h.length)===e.length;o&&s--;)o=h[s]==e[s]}return o},M.prototype.equals=M.prototype.da;function ah(e,o){return e.to-o.to}function bh(e,o){var s=e.S,h=-2,d=[],g,_=e.ur;if(!_){_=e.ur=new Kg;var j=0,$=e.S,_t=$.length;for(g=0;g<_t;g+=3){var _e=$[g],_r=$[g+1];if(g){var _i=_.Nu(_i,_n,_e,_r);_i.to=j++}_i=_e;var _n=_r}}for(_=_.Fm(o).sort(ah),$=_.length,o=0;o<$;o++){if(j=_[o],j=j.to,_t=3*j,j>h+1){var _s=[s[_t],s[_t+1]];d.push(_s)}h=j,_s.push(s[_t+3],s[_t+4])}if(e.gd){for(s=[],h=d.length,o=0;o<h;o++)if(_s=d[o],_=_s.length){for($=[],e=0;e<_;e+=2)j=_s[e],_t=_s[e+1],$.push(j,_t),g=_s[e-1],e&&dd(_t,g)&&(s.push($),$=[],g+=0>g?360:-360,$.push(_s[e-2],g,j,_t));s.push($)}d=s}return d}m=M.prototype,m.ac="LineString",m.xf=function(e,o){var s=this.S,h=s.length,d;if(h){for(e.push("("),d=0;d<h;d+=3)d&&e.push(","),e.push(s[d+1]," ",s[d]);o&&(s[0]!==s[h-3]||s[1]!==s[h-2])&&e.push(",",s[1]," ",s[0]),e.push(")")}else e.push("EMPTY");return e},m.Hc="LineString",m.wf=function(){var e=[],o=this.S,s=o.length,h;for(h=0;h<s;h+=3)e.push([o[h+1],o[h],o[h+2]]);return e},m.Qd=function(){var e=this.S,o;if(this.C().pc()){e=e.slice();var s=1;for(o=e.length;s<o;s+=3)0>e[s]&&(e[s]+=360)}return e},m.wD=function(e){e=e===void 0?5:e;for(var o=this.S,s=o.length,h=[],d=0;d<s;d+=3)h.push([o[d],o[d+1],o[d+2]]);return Vg({polyline:h,precision:e,thirdDim:2,thirdDimPrecision:e})},M.prototype.toFlexiblePolyline=M.prototype.wD;function ch(e){var o=Wg(e);e=o.polyline;var s=o.thirdDim;if(o=s===2||s===3,s=s===0,!e)throw new D(ch,0,"data");if(o||s){s=e.length;for(var h=Array(3*s),d=0,g=0;d<s;d++){var _=e[d];h[g++]=_[0],h[g++]=_[1],h[g++]=o?_[2]:0}}if(!h)throw new D(ch,0,"only ABSENT, ALTITUDE or ELEVATION are supported as type of the 3rd dimension");return new M(h)}M.fromFlexiblePolyline=ch;function N(e,o){var s;if(N.g.constructor.call(this),C(e,M,N,0),o!==B&&fb(o,N,1)){for(s=0;s<o.length;s++)C(o[s],M,N,1,"index "+s);this.cb=o}else this.cb=[];this.Fb=e,this.Tj=[]}u(N,ed),t("H.geo.Polygon",N);function dh(e){var o=N,s=M,h=e.fa,d=e.W,g=e.ga,_=e.ca;return d=[h,d,B,h,_,B,g,_,B,g,d,B],180<=e.oc()&&(d.splice(9,0,g,e=e.wb().lng,B),d.splice(3,0,h,e,B)),new o(new s(d))}N.fromRect=dh;var eh={NORTH:90,SOUTH:-90};N.Direction=eh,N.prototype.jf=eh.NORTH,N.prototype.Vw=function(e){return this.jf!==e&&(this.I=z,this.Tj.length=0,this.jf=e),this},N.prototype.setPoleCovering=N.prototype.Vw,N.prototype.pA=function(){return this.jf},N.prototype.getPoleCovering=N.prototype.pA,N.prototype.Kz=function(){return this.Fb},N.prototype.getExterior=N.prototype.Kz,N.prototype.Sw=function(e){if(!C(e,M))throw new D(this.Sw,0,e);this.Fb=e,this.I=z},N.prototype.setExterior=N.prototype.Sw,N.prototype.Wz=function(){return this.cb},N.prototype.getInteriors=N.prototype.Wz,N.prototype.fo=function(e,o,s){var h=arguments.length,d;for(d=2;d<h;d++)C(arguments[d],M,this.fo,d);var g=this.cb.splice.apply(this.cb,arguments);for(d=2;d<h;d++)arguments[d]=B;return this.Tj.splice.apply(this.Tj,arguments),g},N.prototype.spliceInteriors=N.prototype.fo,N.prototype.AC=function(e){return this.fo(e,1)[0]},N.prototype.removeInteriorAt=N.prototype.AC,N.prototype.zC=function(e){return e=this.cb.indexOf(e),0>e?B:this.fo(e,1)[0]},N.prototype.removeInterior=N.prototype.zC,N.prototype.uw=function(e){if(!C(e,M))throw new D(this.uw,0,e);this.cb.push(e)},N.prototype.pushInterior=N.prototype.uw,N.prototype.C=function(){var e=this.I;return e||(this.I=e=fh(this.Fb,this.jf)),e},N.prototype.getBoundingBox=N.prototype.C,m=N.prototype,m.du=function(e){var o=this.cb.length;if(0>e||e>=o)throw new pd(this.du,e,[0,o-1]);return(o=this.Tj[e])||(this.Tj[e]=o=fh(this.cb[e],this.jf)),o};function fh(e,o){var s,h,d;return(d=e.C())&&((s=e.Cp(!0))&&(h=e.Mj())&&(d=d.yd($f([e.wj(0),e.wj(h-1)],!0),!0)),d.oc()===360&&s%2===1&&(d=d.cf(o,0))),d}m.ac="Polygon",m.xf=function(e){var o=this.cb,s=o.length,h;if(this.Fb.Mj()){for(e.push("("),this.Fb.xf(e,!0),h=0;h<s;h++)o[h].Mj()&&(e.push(","),o[h].xf(e,!0));e.push(")")}else e.push("EMPTY");return e},m.Hc="Polygon",m.wf=function(){var e,o=[],s=this.cb,h=this.Fb.wf();for(h[0].toString()!==h[h.length-1].toString()&&h.push(h[0]),o.push(h),e=0;e<s.length;e++)h=s[e].wf(),h[0].toString()!==h[h.length-1].toString()&&h.push(h[0]),o.push(h);return o},m.P=function(){var e=N.g.P.call(this);return this.C().pc()&&(e.type="Multi"+e.type),e},m.Qd=function(){var e=[],o=this.cb,s=o.length;for(e.push(this.Fb.Qd());s--;)e[s+1]=o[s].Qd();return this.C().pc()?[e]:e},m.da=function(e){var o=!1;if(C(e,N)){var s=e.cb,h=this.cb.length;o=s.length;var d=0;for(o=this.Fb.da(e.Fb)&&h===o;o&&d<h;)o=o&&this.cb[d].da(s[d]),d++}return o},N.prototype.equals=N.prototype.da;function gh(e,o,s,h){var d=e.cb,g=hh.bind(null,o,s);return dc(o,s,e.Fb.S,0,!0,3)!==cc.NONE?h===void 0||h?!d.some(g):!0:!1}function hh(e,o,s){return dc(e,o,s.S,0,!0,3)===cc.SURFACE}function ih(e,o){o=o.S,e=e.Fb.S;var s,h,d=o.length-3,g=e.length-3,_={};for(s=0;s<d;s+=3){var j=o[s],$=o[s+1],_t=o[s+3],_e=o[s+4];for(h=0;h<g;h+=3){var _r=e[h],_i=e[h+1],_n=e[h+3],_s=e[h+4];if(ug(new rg($,j),new rg(_e,_t),new rg(_i,_r),new rg(_s,_n),_,!0))return!0}}return!1}function jh(e,o){var s=o.Fb,h=o.cb,d=h.length,g=s.S,_=g.length,j=e.Fb.S,$=j.length;if(ih(e,s))return!0;for(s=0;s<_;s+=3)if(gh(e,g[s],g[s+1]))return!0;for(s=0;s<$;s+=3)if(gh(o,j[s],j[s+1]))return!0;for(s=0;s<d;s++)if(ih(e,h[s]))return!0;return!1}function kh(e){kh.g.constructor.call(this,e)}u(kh,kg),t("H.geo.MultiPolygon",kh),kh.prototype.tq=function(e){return C(e,N)},kh.prototype.ac="Multi"+N.prototype.ac,kh.prototype.Hc="Multi"+N.prototype.Hc;function lh(e){lh.g.constructor.call(this,e)}u(lh,kg),t("H.geo.MultiLineString",lh),lh.prototype.tq=function(e){return C(e,M)},lh.prototype.ac="Multi"+M.prototype.ac,lh.prototype.Hc="Multi"+M.prototype.Hc;function mh(e,o,s){var h,d=6;if(o){for(h=' expected close to: "'+o;d--;)o=e.nt.next(),o!==-1&&(h+=String.fromCharCode(o));h+='"'}throw new D(nh,0,"- Malformed WKT: "+(h?s+h:"unexpected end of stream"))}function oh(e,o){var s=e.next();o=o?")":"(",s!==o&&mh(e,s,'"'+o+'"')}function ph(e){return e.eb()===","?(e.next(),!0):!1}function qh(e,o,s,h,d){var g,_,j=2+o+s;for(_=1;_<=j;_++)(s=e.next())?(g=+s)!==g?mh(e,s,"number"):_===1?h[d+1]=g:_===2?h[d+0]=g:_===3&&(h[d+2]=g):mh(e,s);o||(h[d+2]=0)}var rh=[];function sh(e,o,s,h){return h||oh(e,0),qh(e,o,s,rh,0),h||oh(e,1),new fd(rh[0],rh[1],o?rh[2]:B)}function th(e,o,s){var h=[];oh(e,0);do qh(e,o,s,h,h.length);while(ph(e));return oh(e,1),new M(h)}function uh(e,o,s){oh(e,0);var h=th(e,o,s);if(ph(e)){var d=[];do d.push(th(e,o,s));while(ph(e))}return oh(e,1),new N(h,d)}var vh=[],wh=[uh],xh=[sh],yh={POINT:xh,LINESTRING:[th],POLYGON:wh,MULTIPOINT:[sh,mg],MULTILINESTRING:[th,lh],MULTIPOLYGON:[uh,kh],GEOMETRY:vh,GEOMETRYCOLLECTION:vh,CIRCULARSTRING:vh,COMPOUNDCURVE:vh,CURVEPOLYGON:vh,MULTICURVE:vh,MULTISURFACE:vh,CURVE:vh,SURFACE:vh,POLYHEDRALSURFACE:vh,TIN:vh,TRIANGLE:vh},zh={Z:1,M:2,ZM:3};function nh(e){e=new Ah(e);var o,s=e.next();if((o=yh[s.toUpperCase()])||mh(e,s,"type name"),o!==vh){s=e.eb(),s=zh[s.toUpperCase()];var h=s&1,d=s>>1;if(h|d&&e.next(),s=e.eb(),s==="EMPTY")if(e.next(),h=o[1])var g=new h([]);else o!==xh&&(g=new M([]),o===wh&&(g=new N(g)));else if(s==="("){if(g=o[0],o=o[1],o){var _=[];if(oh(e,0),g===sh){var j=e.eb()!=="(";do _.push(g(e,h,d,j));while(ph(e))}else do _.push(g(e,h,d));while(ph(e));oh(e,1),h=new o(_)}else h=g(e,h,d);g=h}else mh(e,s,'"Z", "M", "ZM", "(" or "EMPTY"');e.next()&&mh(e,s,"end of stream")}return g||z}function Ah(e){this.nt=e}Ah.prototype.eb=function(){var e=this.cw;if(e===B){for(e=this.nt;e.eb()===Bh;)e.next();if(Ch[e.eb()])e=e.next(),e=e===Dh?"":String.fromCharCode(e);else{e.yi();do e.next();while(!Ch[e.eb()]);e=String.fromCharCode.apply(null,e.mh())}this.cw=e}return e},Ah.prototype.next=function(){var e=this.eb();return e!==""&&delete this.cw,e};var Bh=32,Dh=-1,Eh={RD:Bh,LD:40,QD:41,ID:44,JD:Dh},Ch=Object.keys(Eh).reduce(function(e,o){return e[Eh[o]]=!0,e},Ta());function Fh(){}t("H.util.ICharStream",Fh),Fh.prototype.next=function(){},Fh.prototype.yi=function(){},Fh.prototype.mh=function(){},Fh.prototype.eb=function(){};function Gh(e){this.Ku=String(e),this.iw=0,this.Cc=[],this.Xf=!1}t("H.util.CharStream",Gh),Gh.prototype.next=function(){var e=this.Ku.charCodeAt(this.iw++);return e=isNaN(e)?-1:e,this.Xf&&this.Cc.push(e),e},Gh.prototype.yi=function(){this.Xf=!0,this.Cc=[]},Gh.prototype.mh=function(){var e=this.Cc.slice();return this.Xf=!1,this.Cc=[],e},Gh.prototype.eb=function(){var e=this.Ku.charCodeAt(this.iw+0);return isNaN(e)?-1:e},t("H.util.wkt.toGeometry",function(e){return nh(new Gh(e))});function Hh(e){var o=Ih[e];if(!o)if(e in Jh)o=Ih[e]=e;else{o=Kh.length;var s="",h=e.substr(0,1).toUpperCase()+e.substr(1),d="",g=!1;for(Lh&&(d=Lh+h,g=d in Jh);o--&&!g;)s=Kh[o],d=s+h,g=d in Jh;if(g&&(Lh=s),o=g?d:null)Ih[e]=o;else throw Error("Could not find any variant of CSS property ["+e+"]")}return o}t("H.dom.cssPrefixer.prefix",Hh);var Kh=["O","Ms","ms","Moz","Webkit"],Ih={},Lh="",Jh=document.createElement("span").style;function Mh(){Mh.g.constructor.call(this),this.fd=Nh(this),this.Cn=Ta(),this.nn=A(this.nn,this),this.fd.addEventListener("message",this.nn),this.el={}}u(Mh,K),Mh.prototype.disposeInternal=function(){this.fd.terminate()},Mh.prototype.pw=function(e){var o=e.type,s=!!this.Cn[o],h=e.data,d=Oh++,g=h&&h.zD?h.zD:B,_=!0;return s?(this.el[d]=e,Ph(this,o,d,h&&h.message,g)):(e.reject(new D(this.pw,0,"processor_not_found")),_=!1),_},Mh.prototype.nn=function(e){e=e.data;var o=this.el[e.taskId],s=e.taskId,h=e.data,d=this;if(e.type===2)new Ue("arraybuffer",h).then(function(g){return g.arrayBuffer()}).then(function(g){d.fd.postMessage(["3",s,[g]],[g])},function(){d.fd.postMessage(["3",s,[null,"ERROR"]])});else{if(o){switch(e.type){case 1:o.resolve(h);break;case 0:o.reject(h)}delete this.el[s]}this.dispatchEvent(new uc(this.j.IDLE))}};var Oh=0;function Qh(e,o,s){var h=Oh++,d;return e.el[h]=d=Td(),Ph(e,o,h,s),d.promise}function Ph(e,o,s,h,d){h===B||Ba(h)||(h=[h]);try{e.fd.postMessage([o,s,h],d)}catch(g){e=e.el[s],e.reject(g.message)}}Mh.prototype.j={IDLE:"idle",Js:"error"},Mh.prototype.iy=function(e,o){var s=this.$y||(this.$y=new uc(this.j.Js));s.data=o,delete this.Cn[e],this.dispatchEvent(s)},Mh.prototype.importScripts=function(e){Qh(this,"0",e)};function Nh(a){var b=x.H.__bootstrap__;if(b=Za(b)?(""+b).replace(/^[^{]+{((.|[\r\n])+?)}\s*$/,"$1"):""+b,x.Worker&&x.URL)try{var c=new x.Worker(x.URL.createObjectURL(He(b,"application/javascript")))}catch{}return c||(a=new Rh(a),function(){eval("var self = arguments[0];"+b)}(),c=new Sh(a)),c}function Sh(e){K.call(this),this.fd=e}u(Sh,K),Sh.prototype.postMessage=function(e){x.setTimeout(A(this.rC,this,e),0)},Sh.prototype.rC=function(e){var o=new uc("message");o.data=e,this.fd.dispatchEvent(o)},Sh.prototype.terminate=function(){this.fd.l(),this.l()};function Rh(e){K.call(this),this.fd=e,this.addEventListener=A(this.addEventListener,this),this.removeEventListener=A(this.removeEventListener,this),this.postMessage=A(this.postMessage,this),this.eval=A(eval,this)}u(Rh,K),Rh.prototype.postMessage=function(e){var o=new uc("message");o.data=e,x.setTimeout(A(this.fd.nn,this.fd,o),0)};function Th(){var e=Uh;return e||(e=Uh=this,K.call(e),this.zg()),e}var Uh;u(Th,K),m=Th.prototype,m.disposeInternal=function(){Th.g.disposeInternal.call(this),this.zg()},m.zg=function(){var e=this.oo,o;if(e)for(o=e.length;o--;)e[o].l();this.oo=[],mb(this.oo),this.Dm={},this.rw=Ta()},m.Eo=function(e){var o;if(e=e.type,o=this.rw[e]){var s=this.oo,h=s[0];h||(h=s[0]=new Mh,this.bc(Ja(gc,h)),Ma(this.Dm)||h.importScripts(x.Object.keys(this.Dm))),s=h,s.Cn[e]||(s.Cn[e]=o,Qh(s,"1",[e,Za(o)?o+"":o]).then(ze,A(s.iy,s,e)))}else throw new wb(this.Eo,'Unknown type "'+e+'"');return h},m.$l=function(){},m.registerProcessor=function(e,o){var s=this.rw,h=s[e];if(h){if(o!==h)throw new wb(this.registerProcessor,'Type "'+e+'" is already registered')}else s[e]=o},m.importScripts=function(e){[].concat(e).forEach(function(o){this.Dm[o]||(this.Dm[o]=!0,this.oo.forEach(function(s){s.importScripts(o)}))},this)};function Vh(e,o,s){fe.call(this,e,o,s)}var Wh;u(Vh,fe),Vh.prototype.Fp=function(){return Wh||(Wh=new ie(new Th)),Wh},Vh.prototype.Wi=function(){},Vh.prototype.Rt=function(e){return e.pw(this)};function Xh(e,o,s){this.paths=this.Rc=e,o!==B&&(this.interiorsIndex=this.Uj=o),s!==B&&(this.outlinesIndex=this.sn=s)}Xh.prototype.Uj=Wb,Xh.prototype.interiorsIndex=Xh.prototype.Uj,Xh.prototype.sn=Wb,Xh.prototype.outlinesIndex=Xh.prototype.sn;var Yh=Xa(new Xh([])),Zh=Wa([]);function $h(e){var o;if(e){var s=ai;for(o=C(e,$h);s--;){var h=bi[s];if(e.hasOwnProperty(h)){var d=e[h];if(o)this[h]=d;else{if((d=ci[s](d))===di)throw new D($h,0,h+": "+e[h]);d!==this[h]&&d!==B&&(this[h]=d)}}}s=o?e.Xj:this.lineWidth&&qe(this.strokeColor),s||(this.Xj=s),s=o?e.Nc:qe(this.fillColor),s||(this.Nc=s),s=o?e.Vj:this.strokeColor!=="none"&&this.lineWidth,s||(this.Vj=s)}Wa(this)}t("H.map.SpatialStyle",$h),$h.prototype.Nc=!0,$h.prototype.Xj=!0,$h.prototype.Vj=!0;var bi="strokeColor fillColor lineWidth lineCap lineJoin miterLimit lineDash lineDashOffset lineDashImage lineHeadCap lineTailCap".split(" ");$h.prototype.strokeColor="rgba(0,85,170,.6)",$h.prototype.strokeColor=$h.prototype.strokeColor,$h.prototype.fillColor="rgba(0,85,170,.4)",$h.prototype.fillColor=$h.prototype.fillColor,$h.prototype.lineWidth=2,$h.prototype.lineWidth=$h.prototype.lineWidth,$h.prototype.lineCap="round",$h.prototype.lineCap=$h.prototype.lineCap,$h.prototype.lineJoin="miter",$h.prototype.lineJoin=$h.prototype.lineJoin,$h.prototype.miterLimit=1,$h.prototype.miterLimit=$h.prototype.miterLimit,$h.prototype.pB=Ae,$h.prototype.lineDash=$h.prototype.pB,$h.prototype.lineDashOffset=0,$h.prototype.lineDashOffset=$h.prototype.lineDashOffset,$h.prototype.qB=B,$h.prototype.lineDashImage=$h.prototype.qB,$h.prototype.rB=B,$h.prototype.lineHeadCap=$h.prototype.rB,$h.prototype.sB=B,$h.prototype.lineTailCap=$h.prototype.sB;var ai=bi.length;$h.prototype.da=function(e){var o=this===e;if(!o&&e){for(o=0;o<ai;o++){var s=bi[o];if(this[s]!==e[s])break}o=o===ai}return o},$h.prototype.equals=$h.prototype.da,$h.prototype.fu=function(e){if(e){var o={};Pa(o,this,e)}else o=this;return new $h(o)},$h.prototype.getCopy=$h.prototype.fu;var di=Wa({}),ci=[function(e){return e?Va(e):di},function(e){return e?Va(e):di},function(e){return 0<=e&&100>=e?+e:di},function(e){return e=Va(e),e==="butt"||e==="square"||e==="round"||e==="arrow-head"||e==="arrow-tail"?e:di},function(e){return e==="round"||e==="bevel"||e==="miter"?e:di},function(e){return 0<e&&100>=e?+e:di},function(e){return e&&e.every&&e.every(kb)?e:di},function(e){return E(+e)?di:+e},function(e){return e===B||e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||Object.values(ei).includes(e)?e:di},function(e){return ab(e)?ci[3](e):B},function(e){return ab(e)?ci[3](e):B}],fi=new Image;fi.src="data:image/svg+xml;base64,"+btoa('<svg width="128" height="128" viewBox="0 0 128 128" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><g id="arrow"><path style="fill:#ff0000" d="M 0,0 32,64 2,128 128,64 Z"/></g></svg> ');var gi=new Image;gi.src="data:image/svg+xml;base64,"+btoa('<svg width="128" height="128" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg"><circle style="fill:#ffffff" cx="64" cy="64" r="64" /></svg>');var ei={ARROW:fi,CIRCLE:gi};$h.DashImage=ei,$h.MAX_LINE_WIDTH=100;var hi=new $h;$h.DEFAULT_STYLE=hi;var ii="fillColor strokeColor lineWidth lineCap lineJoin miterLimit lineDashOffset lineDash lineTailCap lineHeadCap".split(" ");$h.prototype.P=function(){for(var e={},o=ii.length,s;o--;)s=ii[o],e[s]=this[s];return e},$h.prototype.forWorkerMessage=$h.prototype.P;function ji(e){ji.g.constructor.call(this),e!==void 0&&(this.data=e)}u(ji,K),t("H.map.Feature",ji),ji.prototype.getData=function(){return this.data},ji.prototype.getData=ji.prototype.getData,ji.prototype.disposeInternal=function(){ji.g.disposeInternal.call(this),delete this.data};function ki(){}t("H.map.provider.Invalidations",ki),ki.MARK_INITIAL=Xb,ki.prototype.update=function(e,o){o!==li.NONE&&(this.Ld=e,o&li.SPATIAL&&(this.dx=e),o&li.VISUAL&&(this.Ix=e),o&li.ADD&&(this.$s=e),o&li.REMOVE&&(this.zw=e),o&li.Z_ORDER&&(this.Mx=e),o&li.VOLATILITY&&(this.Jx=e))},ki.prototype.update=ki.prototype.update,ki.prototype.fA=function(){return this.Ld},ki.prototype.getMark=ki.prototype.fA,ki.prototype.Ld=Xb,ki.prototype.aB=function(e){return this.Ld>e},ki.prototype.isAny=ki.prototype.aB,ki.prototype.Ix=Xb,ki.prototype.Kh=function(e){return this.Ix>e},ki.prototype.isVisual=ki.prototype.Kh,ki.prototype.dx=Xb,ki.prototype.sq=function(e){return this.dx>e},ki.prototype.isSpatial=ki.prototype.sq,ki.prototype.$s=Xb,ki.prototype.Qu=function(e){return this.$s>e},ki.prototype.isAdd=ki.prototype.Qu,ki.prototype.zw=Xb,ki.prototype.Km=function(e){return this.zw>e},ki.prototype.isRemove=ki.prototype.Km,ki.prototype.Mx=Xb,ki.prototype.uq=function(e){return this.Mx>e},ki.prototype.isZOrder=ki.prototype.uq,ki.prototype.Jx=Xb,ki.prototype.fB=function(e){return this.Jx>e},ki.prototype.isVolatility=ki.prototype.fB;var li={NONE:0,VISUAL:1,SPATIAL:2,ADD:4,REMOVE:8,Z_ORDER:16,VOLATILITY:32};ki.Flag=li;function O(e){if(bb(this,O),O.g.constructor.call(this,e?e.data:B),this.Rj=mi.next(),e){var o="min";jb(e[o])&&(this.zb=e[o]),o="max",jb(e[o])&&(this.Oc=e[o]),o="visibility",o in e&&(this.Kd=!!e[o]),o="volatility",o in e&&(this.lo=!!e[o]),o="zIndex",o in e&&(this.Hi=+e[o]||0),o="provider",o in e&&!C(e[o],Q)&&(this.D=e[o],this.qa(li.ADD))}}u(O,ji),t("H.map.Object",O);var mi=new ue(1),ni={ANY:31,OVERLAY:1,SPATIAL:2,MARKER:4,DOM_MARKER:8,GROUP:16};O.Type=ni,O.prototype.xb=function(){return this.Rj},O.prototype.getId=O.prototype.xb,O.prototype.Zr=function(e){if(!jb(e)&&!gb(e))throw new D(this.Zr,0,"id must be a number or a string");return this.gi=e,this},O.prototype.setRemoteId=O.prototype.Zr,O.prototype.wA=function(){return this.gi},O.prototype.getRemoteId=O.prototype.wA,O.prototype.zb=-1/0,O.prototype.Oc=1/0,O.prototype.ku=function(e){var o=this.Oc;if(e)for(e=this;e=e.Ma;)o=yb(o,e.Oc);return o},O.prototype.getMax=O.prototype.ku,O.prototype.mu=function(e){var o=this.zb;if(e)for(e=this;e=e.Ma;)o=zb(o,e.zb);return o},O.prototype.getMin=O.prototype.mu,O.prototype.Kd=!0,O.prototype.Zb=function(e){var o=this.Kd;return(e=!!e)!==o&&(this.Kd=e,this.invalidate(li.VISUAL)),this},O.prototype.setVisibility=O.prototype.Zb,O.prototype.Vd=function(e){for(var o=this,s;(s=o.Kd)&&e&&(o=o.Ma););return s},O.prototype.getVisibility=O.prototype.Vd,O.prototype.lo=!1,O.prototype.sm=function(e){for(var o=this,s;!(s=o.lo)&&e&&(o=o.Ma););return s},O.prototype.getVolatility=O.prototype.sm,O.prototype.Yw=function(e){var o=this.lo;return o!==!!e&&(this.lo=!o,this.invalidate(li.VOLATILITY)),this},O.prototype.setVolatility=O.prototype.Yw,O.prototype.Hi=B,O.prototype.vu=function(){return this.Hi},O.prototype.getZIndex=O.prototype.vu,O.prototype.ui=function(e){return e!==this.Hi&&(this.Hk(),this.Hi=e,this.invalidate(li.Z_ORDER)),this},O.prototype.setZIndex=O.prototype.ui,O.prototype.qo=B,O.prototype.Ve=function(){var e=this.qo,o,s;if(!e){var h=+((o=this.Hi)!==B);(e=this.Ma)?(e=e.Ve().slice(),e[0]|=h):e=[h],e.push(o||0,0>(s=this.ds)?this.Rj:s),this.qo=e}return e},O.prototype.getZInfo=O.prototype.Ve,O.prototype.Hk=function(){this.qo=B};function oi(e,o,s){var h,d;if(!s||e[0]|o[0]){var g=e.length,_=o.length,j=yb(g,_),$=1;for(d=1+ +s;$<j;$+=d)if(h=e[$]-o[$])return h}return s?0:g-_}O.compareZInfo=oi;function pi(e,o){return e.qt(o)}O.compareZOrder=pi,O.prototype.qt=function(e){return this.ro-e.ro||oi(this.Ve(),e.Ve(),!1)},O.prototype.compareZOrder=O.prototype.qt,m=O.prototype,m.previousSibling=z,m.nextSibling=z,m.ds=-1,m.Ma=z,m.kA=function(){return this.Ma},O.prototype.getParentGroup=O.prototype.kA,O.prototype.rd=function(){for(var e=this,o;o=e.Ma;)e=o;return e},O.prototype.getRootGroup=O.prototype.rd,O.prototype.contains=function(e){return this===e},O.prototype.contains=O.prototype.contains,O.prototype.ea=function(e){if(this.Ma)throw new wb(this.ea,"Not allowed for a child of a group");O.g.ea.call(this,e)},O.prototype.setParentEventTarget=O.prototype.ea,O.prototype.draggable=O.prototype.draggable=!1,O.prototype.D=z,O.prototype.Pp=function(){return this.D},O.prototype.getProvider=O.prototype.Pp,O.prototype.ti=function(e,o){var s=this.D,h;if(h=s!==e){if(o&&(s&&!C(s,Q)||e&&!C(e,Q)))throw new wb(o,"Only LocalObjectProvider allows an object transfers");o=this.type!==ni.GROUP,s&&(this.invalidate(li.REMOVE),o&&s.Na(this)),(this.D=e)&&(o&&e.Y(this),this.Wf=z,this.invalidate(li.ADD))}return h},O.prototype.Wf=z,O.prototype.Kc=function(){return this.Wf||(this.Wf=new ki)},O.prototype.getInvalidations=O.prototype.Kc,O.prototype.qa=function(e){var o=this.D,s;return(s=!!o)&&o.invalidateObject(this,e),s},O.prototype.invalidate=O.prototype.qa,O.prototype.disposeInternal=function(){this.Ma&&this.Ma.Na(this),O.g.disposeInternal.call(this)},O.prototype.setData=function(e){return this.data=e,this},O.prototype.setData=O.prototype.setData,O.prototype.ye=function(e){if(e&&!Za(e))throw new D(O.prototype.ye,0,"opt_callback must be a function");return e=qi(this,e?e(this.data):this.data,!!e),e=Za(this.V)?{type:"Feature",properties:e,geometry:this.V().ye()}:{type:"FeatureCollection",features:Ae},this.gi&&(e.id=this.gi),e},O.prototype.toGeoJSON=O.prototype.ye;function qi(e,o,s){if(o===null||o===B)return null;if(0<=Object.keys(o).length&&Object.prototype.toString.call(o)!=="[object Object]")throw Error(ri(e,s));try{return JSON.stringify(o),o}catch{throw Error(ri(e,s))}}function ri(e,o){return"Object Remote-Id: "+e.gi+" - "+(o?"The value returned by the callback is not a valid JSON object and cannot be set as Feature properties.":"The given object data is not a valid JSON object and cannot be set as Feature properties.")}O.prototype.P=function(){return{id:this.Rj,properties:{min:this.mu(),max:this.ku(),zIdx:this.Hi,sIdx:this.ds,parent:this.Ma?this.Ma.xb():0,visible:this.Vd(),volatile:this.sm()},type:"Feature"}},O.prototype.forWorkerMessage=O.prototype.P;function si(e){var o;if(e){var s=C(e,si);for(o in e)if(o in this){var h=e[o];h!==this[o]&&(o==="fillColor"||0<(h=+h))&&(this[o]=h)}e=s?e.Nc:!!(qe(this.fillColor)&&this.width&&this.width),e||(this.Nc=e)}Wa(this)}t("H.map.ArrowStyle",si),si.prototype.Nc=!0,si.prototype.fillColor="rgba(255,255,255,.75)",si.prototype.width=1.2,si.prototype.length=1.6,si.prototype.frequency=5,si.prototype.eu=function(){return new si(this)},si.prototype.da=function(e){var o=this===e;return!o&&e&&(o=e.width===this.width&&e.fillColor===this.fillColor&&e.length===this.length&&e.frequency===this.frequency),o},si.prototype.equals=si.prototype.da;function ti(e,o){var s;ti.g.constructor.call(this,o),o&&this.Cb(o.style),e&&(this.We=!0),o&&(s=o.arrows)&&this.Pw(s)}u(ti,O),t("H.map.Spatial",ti),ti.prototype.type=ni.SPATIAL,ti.prototype.ro=0,ti.prototype.style=hi,ti.prototype.J=function(){return this.style},ti.prototype.getStyle=ti.prototype.J,ti.prototype.Cb=function(e){var o=!0;return e?this.style=C(e,$h)?e:new $h(e):this.style?delete this.style:o=!1,o&&this.invalidate(li.VISUAL),this},ti.prototype.setStyle=ti.prototype.Cb,ti.prototype.qz=function(){return this.Tg},ti.prototype.getArrows=ti.prototype.qz,ti.prototype.Pw=function(e){var o=this.Tg,s=!1;return!e&&o?(delete this.Tg,s=!0):!e||o&&o.da(e)||(this.Tg=new si(e),s=!0),s&&this.style.strokeColor!=="none"&&this.qa(1),this},ti.prototype.setArrows=ti.prototype.Pw;function ui(e,o){var s=!1,h=!1,d;if(o.length){for(s=0;s<o.length;s++)if(o[s]!==Yh){h=!0;break}o=e.style,s=h?o.Xj||o.Nc&&e.We||(d=e.Tg||!1)&&o.Vj&&d.Nc:o.Nc}return s&&e.Vd(!0)}ti.prototype.We=!1,ti.prototype.bB=function(){return this.We},ti.prototype.isClosed=ti.prototype.bB,ti.prototype.getGeometriesForTile=ti.prototype.xh,ti.prototype.Hp=function(){return B},ti.prototype.getLabels=ti.prototype.Hp;function vi(e,o){vi.g.constructor.call(this,e,o)}u(vi,ti),t("H.map.GeoShape",vi),vi.prototype.getBoundingBox=vi.prototype.C;function wi(e,o,s,h){var d=[],g=o.length,_;for(_=0;_<g;_++){var j=o[_];if(j.length){var $=d,_t=$.push,_e=void 0,_r=e,_i=s,_n=h,_s=[],_l=j.length,Ap=0;for(_r.Ft=0,_e=_e||0;Ap<_l;)_s.push(xi(_r,j[Ap++],j[Ap++],_e,_n));_i&&_s.push(xi(_r,j[0],j[1],_e,_n)),_t.call($,_s)}}return d}function xi(e,o,s,h,d){var g=e.Ft;return g&&180<Db(g-s)&&(s+=0>g?-360:360),e.Ft=s,d.wq(o,s+h)}function yi(e,o,s){for(var h=o,d,g=e.length+o,_,j;h--;){for(o=e[h],_=o.length,d=Array(_);_--;)j=o[_],d[_]=new F(j.x+s,j.y);e[--g]=d}}function zi(e,o){var s=o&&(+o.extrusion||+o.extrude)||0,h=o&&+o.elevation||0,d=0;if(zi.g.constructor.call(this,!0,o),0<h&&(d+=h,this.If=h),0<s&&(d+=s,this.nh=s),2047<d)throw new pd(zi,d,[0,2047]);C(e,M)?this.X(new N(e)):this.X(e)}u(zi,vi),t("H.map.Polygon",zi);var Ai=new N(new M([0,0,0,0,0,0,0,0,0]));zi.prototype.nh=0,zi.prototype.If=0,zi.prototype.Hb=Ai,zi.MAX_EXTRUDE_HEIGHT=2047,zi.prototype.Pr=function(e){var o=+e;if(o!==e)throw new D(this.Pr,0,e);if(0>o||2047<this.If+o)throw new pd(this.Pr,this.If+o,[0,2047]);this.nh=o,this.qa(li.SPATIAL)},zi.prototype.setExtrusion=zi.prototype.Pr,zi.prototype.Lz=function(){return this.nh},zi.prototype.getExtrusion=zi.prototype.Lz,zi.prototype.Or=function(e){var o=+e;if(o!==e)throw new D(this.Or,0,e);if(0>o||2047<this.nh+o)throw new pd(this.Or,this.nh+o,[0,2047]);this.If=o,this.qa(li.SPATIAL)},zi.prototype.setElevation=zi.prototype.Or,zi.prototype.Gz=function(){return this.If},zi.prototype.getElevation=zi.prototype.Gz,zi.prototype.V=function(){return this.Hb},zi.prototype.getGeometry=zi.prototype.V,zi.prototype.X=function(e){if(C(e,N))var o=!1;else C(e,kh,this.X,0),o=!0;return this.Uf=o,o=this.Hb,this.Hb=e,o!==Ai&&this.qa(li.SPATIAL),this},zi.prototype.setGeometry=zi.prototype.X,zi.prototype.C=function(){return this.V().C()},zi.prototype.getBoundingBox=zi.prototype.C,zi.prototype.xh=function(e){var o,s=this.V(),h,d;if(this.Uf){s=s.ha;var g=0;for(d=s.length;g<d;g++)(h=Bi(this,s[g],e,s[g].jf))&&(o||(o=[]),o.push(h))}else h=this.jf,h===B&&(h=this.Uf?eh.NORTH:this.V().jf),(h=Bi(this,s,e,h))&&(o=[h]);return o},zi.prototype.getGeometriesForTile=zi.prototype.xh;function Bi(e,o,s,h){var d,g,_=0,j=!0;if(d=Ci(e,o.Fb,s,h,o.C())){var $=new Xh(d),_t=o.cb;if(g=_t.length)for($.Uj=$.Rc.length;_<g;_++)(d=Ci(e,_t[_],s,h,o.du(_)))&&($.Rc=$.Rc.concat(d));for(g=$.Rc.length,_=0;_<g;_++)if($.Rc[_]!==Zh){j=!1;break}j&&($=_%2?Yh:B)}return $}function Ci(e,o,s,h,d){var g=s.Pj(),_=d,j=_.oc(),$=[[]],_t=o.S,_e=[],_r=_t.length,_i,_n=!1;for(_i=0;_i<_r;_i+=3){var _s=_t[_i],_l=_t[_i+1];_n||Db(_l)!=180||(_e.push(_s),_e.push(_l),_e.push(_s),_e.push(-_l),_n=!0),_e.push(_s),_e.push(_l)}if(_t=_e,360>j&&_.W==-180&&(_=new J(_.fa,180,_.ga,_.ca)),360>j&&_.ca==180&&(_=new J(_.fa,_.W,_.ga,-180)),_.pc()){for(j=_t,_s=j.length,_t=-1,_e=0;_e<_s-2;_e+=2)if(dd(j[_e+1],j[_e+3])){_t=_e+2;break}_t===-1&&dd(j[_s-1],j[1])&&(_t=_s),_t!==-1&&(_r=j[_t-2],_e=j[_t-1],_i=j[_t%_s],_n=j[(_t+1)%_s],Db(_r)!==180&&Db(_i)!==180&&(_l=Db(_i-_r),_s=Db(_n-_e),_s+=180<_s?-360:0,_n=Db(180-_n),_n+=180<_n?-360:0,_s&&_n&&(_l/=Db(_s)/Db(_n),_r=_i+(_i>_r?-_l:_l),_e=0<_e?180:-180,j.splice(_t,0,_r,_e,_r,-_e)))),_t=j}if($[0]=Di([].concat(_t),_.W),360>_.oc()&&_.Ff(new fd(_.fa,180))&&(_t=Di([].concat(_t),_.ca),$.push(_t)),_=s.pm(),e=wi(e,$,!0,_),d.oc()===360&&o.Cp(!0)%2===1){for(o=e,e=s.Pj(),o[0][1].x>o[0][o[0].length-1].x&&(o[0]=o[0].reverse()),_t=[],j=o[0].length-1,$=0;$<j;$++)_e=o[0][$],_t[$]=new F(_e.x-2*_.w,_e.y),_t[$+j]=new F(_e.x-_.w,_e.y),_t[$+2*j]=new F(_e.x,_e.y),_t[$+3*j]=new F(_e.x+_.w,_e.y),_t[$+4*j]=new F(_e.x+2*_.w,_e.y);o[0]=_t,$=_.wq(h,0),$.y=2*e[h===eh.NORTH?"top":"bottom"],h=$.clone(),$.x=o[0][o[0].length-1].x+1,h.x=o[0][0].x-1,o[0].push($,h),e=o}if(h=g.left,o=g.top,$=g.right,g=g.bottom,ng(e,h,o,$,g,!0).length){if(!s.nm().Vo(d)){for(s=e,d=[new F(h,o),new F($,o),new F($,g),new F(h,g)],g=[],e=s.length;e--;)if(h=pg(d,s[e]))for(o=Ei(h),g.push(o);h.Nq;)h=h.Nq,o=Ei(h),g.push(o);e=g}}else s=Fi(h,o,e[0]),e[1]&&(s=s!==Fi(h,o,e[1])),e=s?[Zh]:B;return e}function Fi(e,o,s){var h,d,g,_=h=s[0].x,j=d=s[0].y,$=1;for(g=s.length;$<g;$++){var _t=s[$].x,_e=s[$].y;_t>h?h=_t:_t<_&&(_=_t),_e>d?d=_e:_e<j&&(j=_e)}return _<=e&&e<=h&&j<=o&&o<=d&&ec({x:e,y:o},fc(s.concat(s[0])))}function Ei(e){var o=[],s=e;do{var h=Ab(100*(s.jC?s.jC:s.x))/100,d=Ab(100*(s.kC?s.kC:s.y))/100;if(!g||.01<Fb(Gb(g.x-h,2)+Gb(g.y-d,2))){var g=new F(h,d);o.push(g)}s=s.next}while(s&&s!==e);return o}zi.prototype.Si=z;function Di(e,o){var s,h=Number.POSITIVE_INFINITY,d=-1,g=e.length;for(s=0;s<g;s+=2){var _=Db(e[s+1]-o);_+=180<_?360-_:_,_<h&&(h=_,d=s)}return 0<s?(o=e.splice(d,e.length-d),o.concat(e)):e}zi.prototype.P=function(){var e=zi.g.P.call(this),o=this.V(),s=this.Uf?o.ha:[o],h,d=e.properties,g=e.geometry=o.P();if(d.style=this.J().P(),d.height=this.nh+this.If,d.min_height=this.If,this.C().pc()&&(g.type="MultiPolygon",this.Uf)){var _=[];s.forEach(function(j,$){h=g.coordinates[$],j.C().pc()?_=_.concat(h):_.push(h)}),g.coordinates=_}return e},zi.prototype.forWorkerMessage=zi.prototype.P;function Gi(e,o){Gi.g.constructor.call(this,Ai,o),this.si(e)}u(Gi,zi),t("H.map.Rect",Gi),Gi.prototype.si=function(e){if(!C(e,J))throw new D(this.si,0,e);e.da(this.Si)||(this.Si=this.I=e,this.Hb!==z&&Gi.g.X.call(this,dh(e)))},Gi.prototype.setBoundingBox=Gi.prototype.si,Gi.prototype.C=function(){return this.I},Gi.prototype.getBoundingBox=Gi.prototype.C,Gi.prototype.X=function(){return this},Gi.prototype.setGeometry=Gi.prototype.X,Gi.prototype.V=function(){return this.Hb===Ai&&Gi.g.X.call(this,dh(this.Si)),this.Hb},Gi.prototype.getGeometry=Gi.prototype.V,t("H.map.Style",Bf),Bf.State=df;function Hi(e,o){this.w=+e,this.h=+o}t("H.math.Size",Hi);function Ii(e,o){var s,h=e,d=o||[];if(e!==Ji.NONE){if(o=s=d.length,Ki.indexOf(h)===-1)throw new D(Ii,0,e);if(!d)throw new D(Ii,1,d);for(;s--;)if(E(d[s]))throw new D(Ii,1,d);if(h===Ji.RECT&&3<o&&(d=[d[0],d[1],d[2],d[1],d[2],d[3],d[0],d[3]],h=Ji.POLYGON),h===Ji.CIRCLE&&2<o&&(e=d[2],0<e)){h=d[0];var g=d[1];s=yb(2*Cb(e),40);var _=360/s;for(d=[];s--;){var j=_*s*Ub;d.push(h+Ib(j)*e,g+Kb(j)*e)}h=Ji.POLYGON}if(h!==Ji.POLYGON||!o||d.length%2)throw new D(Ii,1,d);this.hw=d}}t("H.map.HitArea",Ii);var Ji={NONE:0,RECT:1,CIRCLE:2,POLYGON:3};Ii.ShapeType=Ji;var Ki=[Ji.RECT,Ji.CIRCLE,Ji.POLYGON];Ii.prototype.Bm=function(e,o,s){return this.hw?dc(e,o,this.hw,s,!0):cc.NONE},Ii.prototype.hitTest=Ii.prototype.Bm;function Li(e,o){var s;bb(this,Li),Li.g.constructor.call(this,o),this.X(e),o&&"icon"in o&&(s=o.icon),this.ve(s||this.Dp())}u(Li,O),t("H.map.AbstractMarker",Li),Li.prototype.V=function(){return this.hm},Li.prototype.getGeometry=Li.prototype.V,Li.prototype.X=function(e){var o=this.hm;return C(e,fd)||C(e,mg)?this.hm=e:(gd(e,this.X,0),this.hm=hd(e)),o&&this.qa(li.SPATIAL),this},Li.prototype.setGeometry=Li.prototype.X,Li.prototype.C=function(){return this.hm.C()},Li.prototype.kc=function(){return this.icon},Li.prototype.getIcon=Li.prototype.kc,Li.prototype.ve=function(e){var o=this.icon,s=!o;if(o!==e){if(!this.Xu(e))throw s?new D(this.constructor,1,e):new D(this.ve,0,e);this.icon=e,s||this.qa(li.VISUAL)}return this},Li.prototype.setIcon=Li.prototype.ve,Li.prototype.Dp=function(){var e=this.Ny;return e||(e=this.constructor.prototype.Ny=this.tt(Mi)),e};var Mi={svg:'<svg xmlns="http://www.w3.org/2000/svg" width="38" height="47" viewBox="0 0 38 47"><g fill="none"><path fill="#0F1621" fill-opacity=".4" d="M15 46c0 .317 1.79.574 4 .574s4-.257 4-.574c0-.317-1.79-.574-4-.574s-4 .257-4 .574z"></path><path fill="#01b6b2" d="M33.25 31.652A19.015 19.015 0 0 0 38 19.06C38 8.549 29.478 0 19 0S0 8.55 0 19.059c0 4.823 1.795 9.233 4.75 12.593L18.975 46 33.25 31.652z"></path><path fill="#6A6D74" fill-opacity=".5" d="M26.862 37.5l4.714-4.77c3.822-3.576 5.924-8.411 5.924-13.62C37.5 8.847 29.2.5 19 .5S.5 8.848.5 19.11c0 5.209 2.102 10.044 5.919 13.614l4.719 4.776h15.724zM19 0c10.493 0 19 8.525 19 19.041 0 5.507-2.348 10.454-6.079 13.932L19 46 6.079 32.973C2.348 29.495 0 24.548 0 19.04 0 8.525 8.507 0 19 0z"></path></g></svg>',size:new Hi(38,47),anchor:new F(19,45),hitArea:new Ii(Ji.POLYGON,[19,46,2,27,0,18,5,6,19,0,32,5,38,15,36,27,19,47])};Li.prototype.P=function(){var e=Li.g.P.call(this),o=this.kc(),s=o.mc(),h=o.Db;return e.geometry=this.V().P(),s&&(o=e.properties.icon={id:o.uid},o.size={w:s.w,h:s.h},o.offset=[s.w/2-(h?h.x:0),s.h/2-(h?h.y:0)]),e},Li.prototype.forWorkerMessage=Li.prototype.P;function Ni(e,o){if(!C(e,Element)){if(Oi.innerHTML=e,e=Oi.firstElementChild,!e)throw new D(Ni,0,"No element data");Oi.removeChild(e);var s=!0;Oi.innerHTML=""}this.Uo=Ce(e).length!==0,this.Nt=s?e:De(e,x.document,this.Uo),o&&(s="onAttach",s in o&&db(e=o[s],"Function",Ni,1,s)&&(this.Oq=e),s="onDetach",s in o&&db(e=o[s],"Function",Ni,1,s)&&(this.Sq=e))}t("H.map.DomIcon",Ni);var Oi=document.createElement("DIV");Ni.prototype.Oq=null,Ni.prototype.Sq=null,Ni.prototype.eu=function(e){return De(this.Nt,e,this.Uo)},Ni.prototype.Uo=!1;function Pi(e,o){Pi.g.constructor.call(this,e,o)}u(Pi,Li),t("H.map.DomMarker",Pi),Pi.prototype.type=ni.DOM_MARKER,Pi.prototype.ro=2,Pi.prototype.tt=function(e){var o=new Ni(e.svg,e);return e=e.anchor,o.Nt.style.margin=-e.y+"px 0 0 -"+e.x+"px",o},Pi.prototype.Xu=function(e){return C(e,Ni)};function Qi(){}t("H.util.ICache",Qi),Qi.prototype.add=function(){},Qi.prototype.add=Qi.prototype.add,Qi.prototype.get=function(){},Qi.prototype.get=Qi.prototype.get,Qi.prototype.cm=function(){},Qi.prototype.drop=Qi.prototype.cm,Qi.prototype.forEach=function(){},Qi.prototype.forEach=Qi.prototype.forEach,Qi.prototype.ia=function(){},Qi.prototype.removeAll=Qi.prototype.ia,Qi.prototype.fi=function(){},Qi.prototype.registerOnDrop=Qi.prototype.fi,Qi.prototype.gp=function(){},Qi.prototype.deRegisterOnDrop=Qi.prototype.gp;function Ri(e,o,s){if(this.mk=[],o&&this.fi(o),s&&!Za(s))throw new D(Ri,2,s);this.Ne=0,this.filter=s,this.aa={},this.ak=this.ph=null,this.Sr(e)}t("H.util.Cache",Ri),Ri.prototype.add=function(e,o,s){var h,d;if(s=+s,!jb(s)||0>s)throw new D(this.add,2,s);return e=String(e),(d=this.filter?this.filter(e,o,s):!0)&&((h=this.aa[e])?(h.data!==o&&Si(this,h),this.Ne+=s-h.size,h.size=s,h.data=o,Ti(this,h)):this.aa[e]=Ui(this,{id:e,data:o,size:s,zd:null,lf:null},this.ph),Vi(this)),d},Ri.prototype.add=Ri.prototype.add,Ri.prototype.fi=function(e){if(!Za(e))throw new D(this.fi,0,e);this.mk.push(e)},Ri.prototype.registerOnDrop=Ri.prototype.fi,Ri.prototype.gp=function(e){this.mk=this.mk.filter(function(o){return o!==e})},Ri.prototype.deRegisterOnDrop=Ri.prototype.gp,Ri.prototype.get=function(e,o){return(e=o?this.aa[e]:Ti(this,this.aa[e]))&&e.data},Ri.prototype.get=Ri.prototype.get,Ri.prototype.cm=function(e){var o;(o=this.aa[e])&&this.nf(o,!0)},Ri.prototype.drop=Ri.prototype.cm,Ri.prototype.forEach=function(e,o,s){var h;for(h in this.aa){var d=this.aa[h];(!s||s(h,d.data,d.size))&&e.call(o,h,d.data,d.size)}},Ri.prototype.forEach=Ri.prototype.forEach,Ri.prototype.ia=function(e){var o;for(o in this.aa){var s=this.aa[o];(!e||e(o,s.data,s.size))&&this.nf(this.aa[o],!0)}},Ri.prototype.removeAll=Ri.prototype.ia,Ri.prototype.Sr=function(e){if(!(0<+e))throw new D(Ri.prototype.Sr,0,e);return this.vv=+e,Vi(this),this},Ri.prototype.setMaxSize=Ri.prototype.Sr,Ri.prototype.gA=function(){return this.vv},Ri.prototype.getMaxSize=Ri.prototype.gA,Ri.prototype.Cz=function(){return this.Ne},Ri.prototype.getCurrentSize=Ri.prototype.Cz;function Ti(e,o){return o&&(e.ph=Ui(e,o,e.ph)),o}function Vi(e){for(;e.Ne>e.vv&&e.ak;)e.nf(e.ak,!0)}function Ui(e,o,s){return s!==o&&((o.zd||o.lf)&&e.nf(o,!1),(o.zd=s)&&(o.lf=s.lf,s.lf=o),o.lf||(e.ph=o),o.zd||(e.ak=o),e.Ne+=o.size),o}Ri.prototype.nf=function(e,o){var s=e.lf,h=e.zd;return(s||h||e==this.ph&&e==this.ak)&&(s?s.zd=h:this.ph=h,h?h.lf=s:this.ak=s,this.Ne-=e.size,o&&(delete this.aa[e.id],Si(this,e))),e.zd=e.lf=null,e};function Si(e,o){for(var s=e.mk.length;s--;)e.mk[s].call(e,o.id,o.data,o.size)}function Wi(e,o,s,h){this.key="",this.x=e,this.y=o,this.z=s,this.data=h,this.valid=!0}t("H.map.provider.Tile",Wi);function Xi(e){if(bb(this,Xi),Xi.g.constructor.call(this,e),e&&"tileSize"in e){var o=Eb(+e.tileSize)/Ob;if(isNaN(o)||o%1||0>o||30<o)throw new D(Xi,0,"tileSize: "+e.tileSize);this.tileSize=+e.tileSize}}u(Xi,L),t("H.map.provider.TileProvider",Xi);function Yi(e,o){return Yb(e)-8-Ab(Yb(o))}Xi.getZoomLevelOffset=Yi,Xi.prototype.requestTile=Xi.prototype.Oa,Xi.prototype.cancelTile=Xi.prototype.Md,Xi.prototype.cancelTileByKey=Xi.prototype.Xi,Xi.prototype.createTileInternal=Xi.prototype.nd,Xi.prototype.Ud=function(e,o,s){return this.uri.concat("_",e,"_",o,"_",s)},Xi.prototype.getTileKey=Xi.prototype.Ud,Xi.prototype.tileSize=256,Xi.prototype.tileSize=Xi.prototype.tileSize;function R(e){bb(this,R),R.g.constructor.call(this,e),this.mD=new Zi,this.cc=A(this.cc,this),this.jt=$i,this.createTileInternal=this.nd.bind(this)}u(R,Xi),t("H.map.provider.RemoteTileProvider",R),R.prototype.Jz=function(){return 1},R.prototype.getEntryWeight=R.prototype.Jz;var $i,aj=screen.width,bj=screen.height,cj=le();cj=zb(cj,1);var dj=Cb(aj*cj*bj*cj/1e6);$i=new Ri(Gb(2,zb(8,yb(12,7+dj))));var ej={},fj={};R.prototype.Sb=function(){return this.jt},R.prototype.getCache=R.prototype.Sb,R.prototype.Yn=ca(3),R.prototype.cc=function(e){var o=this.uri;return!e.indexOf(o)&&e.charAt(o.length)==="_"},R.prototype.cacheFilter=R.prototype.cc,R.prototype.$A=function(e,o){o.valid=!1},R.prototype.reload=function(e){var o=this.getCache();e?o.ia(this.cc):o.forEach(this.$A,this,this.cc),gj(this),this.jb(this,{isReload:!0})},R.prototype.reload=R.prototype.reload,R.prototype.Vi=function(){return!1},R.prototype.MAX_STORE_TIME=1/0,R.prototype.sd=function(){return this.mD},R.prototype.ow=function(e,o){o(e)};function hj(e,o,s,h,d,g){return h=~~h,e.requestInternal(o,s,h,function(_,j){e.sd().put(e.Ud(o,s,h),{raw:j&&j.raw||_,timestamp:x.Date.now()},d,g)},g,0)}R.prototype.requestInternal=R.prototype.s,R.prototype.Oa=function(e,o,s,h){var d=this,g=this.getCache();if(E(e=+e))throw new D(this.Oa,0,e);if(E(o=+o))throw new D(this.Oa,0,o);if(E(s=+s))throw new D(this.Oa,0,s);s=~~s;var _=this.getTileKey(e,o,s);return g=g.get(_),g&&g.valid||h||ej[_]||(g=B,this.requestTileAsPromise(e,o,s,h).then(function(j){d.jb(j)},ze)),g},R.prototype.requestTile=R.prototype.Oa,R.prototype.Gw=function(e,o,s,h){var d=this,g=this.getCache(),_=this.getTileKey(e,o,s),j,$,_t=this.sd();return fj[_]?fj[_]:(fj[_]=j=new Jd(function(_e,_r){function _i(_n){var _s=0,_l,Ap=function(_h,_p){_l=d.createTileInternal(e,o,s,_h,_p),_l.key=_,g.add(_,_l,1),_e(_l),ij(_)};_n&&(_s=x.Date.now()-_n.timestamp),_n&&_s<d.MAX_STORE_TIME?d.ow(_n.raw,Ap):(0<_s&&_t.remove(_),(_l=g.get(_))&&_l.valid||h?_e(_l||null):ej[_]=d.requestInternal(e,o,s,Ap,_r))}$=_t.get(_,_i,_i)}),ej[_]||(ej[_]=$),j.then(function(){ij(_)},function(){ij(_)}),j)},R.prototype.requestTileAsPromise=R.prototype.Gw,R.prototype.Fw=function(e,o){var s=this,h=e.id,d=e.tile.coords;return new Jd(function(g,_){s.Gw(d.x,d.y,d.z,o).then(function(j){var $=z;j=j.bb?j.bb():j.data;for(var _t=j.length,_e;_t--;)if(_e=j[_t],_e.xb()===h){$=_e;break}g($)},_)})},R.prototype.requestObjectAsPromise=R.prototype.Fw;function ij(e){delete ej[e],delete fj[e]}function gj(e){for(var o in ej)e.cc(o)&&e.cancelTileByKey(o)}var jj={cancel:ze};R.prototype.nd=function(e,o,s,h){return new Wi(e,o,s,h)},R.prototype.createTileInternal=R.prototype.nd,R.prototype.Xi=function(e){var o=ej[e];o&&(o.cancel(),ij(e))},R.prototype.cancelTileByKey=R.prototype.Xi,R.prototype.Md=function(e,o,s){this.cancelTileByKey(this.getTileKey(e,o,s))},R.prototype.cancelTile=R.prototype.Md,R.prototype.disposeInternal=function(){R.g.disposeInternal.call(this),this.getCache().ia(this.cc),gj(this)};function Zi(){}R.NullStorage=Zi,Zi.prototype.get=function(e,o){return o(),jj},Zi.prototype.get=Zi.prototype.get,Zi.prototype.put=function(e,o,s){s&&s()},Zi.prototype.put=Zi.prototype.put,Zi.prototype.clear=function(e){e&&e()},Zi.prototype.clear=Zi.prototype.clear,Zi.prototype.remove=function(e,o){o&&o()},Zi.prototype.remove=Zi.prototype.remove;function kj(e){if(kj.g.constructor.call(this,e),e&&(this.Gk={crossOrigin:e.crossOrigin||"anonymous",headers:e.headers||{}},this.Vp=e.getURL),lj(this)){var o=e&&e.style&&e.style instanceof H.map.render.harp.Style?e.style:new H.map.render.harp.Style({styles:[{technique:"raster",attr:{gamma:1,brightness:1}}]});this.Xa(o)}if(!Za(this.Vp))throw new D(kj,0,"getURL");if(this.Eg(e.opacity),this.zl=x.URL||x.webkitURL,e=this.Gk.crossOrigin,!(e=e==="anonymous"||e==="use-credentials")){e=this.Vp(0,0,0),o=window.location;var s=document.createElement("a");s.href=e,e=s.hostname===o.hostname&&s.port===o.port&&s.protocol===o.protocol}(this.cx=e&&!!Ve.arraybuffer&&!!this.zl)&&this.Sb().fi(A(this.je,this))}u(kj,R),t("H.map.provider.ImageTileProvider",kj);function lj(e){return!!H.map.render.harp&&e.vb===Rf.HARP}kj.prototype.Ed=function(e){this.Eg(e)},kj.prototype.setOpacity=kj.prototype.Ed,kj.prototype.Ue=function(){return this.Qc},kj.prototype.getOpacity=kj.prototype.Ue,kj.prototype.zk=xe,kj.prototype.providesRasters=kj.prototype.zk,kj.prototype.s=function(e,o,s,h,d,g){var _=this,j=this.Vp(e,o,s),$;if(e=jj,j){var _t=x.setTimeout(function(){_.cx?($=new Ue("arraybuffer",j,g,_.Gk),$.then(function(_e){return _e.blob()}).then(function(_e){var _r=new Image;_r.onload=A(h,null,_r,{raw:_e}),_r.onerror=A(d,null,"bad url");try{_r.src=_.zl.createObjectURL(_e)}catch{}},d)):($=new Ue("image",j,g,_.Gk),$.then(h,d))},150);e={cancel:function(){$?$.cancel():x.clearTimeout(_t)}}}else h(null);return e},kj.prototype.requestInternal=kj.prototype.s,kj.prototype.ow=function(e,o){var s=new Image;s.onload=function(){o(this)},s.src=this.zl.createObjectURL(e)},kj.prototype.je=function(e,o){(e=o.data)&&e instanceof HTMLImageElement&&this.zl.revokeObjectURL(e.src)},kj.prototype.J=function(){return this.mb()},kj.prototype.getStyle=kj.prototype.J,kj.prototype.Cb=function(e){lj(this)&&e instanceof H.map.render.harp.Style&&this.Xa(e)},kj.prototype.setStyle=kj.prototype.Cb;function mj(e,o,s,h){mj.g.constructor.call(this,e,o,s),this.modifiers=h}u(mj,Zc),t("H.map.ChangeEvent",mj);var nj={SIZE:1,POSITION:2,HEADING:4,TILT:8,INCLINE:16,ZOOM:32,BOUNDS:64};mj.Type=nj,mj.prototype.cy=nj.SIZE,mj.prototype.SIZE=mj.prototype.cy,mj.prototype.Ss=nj.POSITION,mj.prototype.POSITION=mj.prototype.Ss,mj.prototype.Ks=nj.HEADING,mj.prototype.HEADING=mj.prototype.Ks,mj.prototype.Vs=nj.TILT,mj.prototype.TILT=mj.prototype.Vs,mj.prototype.Ls=nj.INCLINE,mj.prototype.INCLINE=mj.prototype.Ls,mj.prototype.Ws=nj.ZOOM,mj.prototype.ZOOM=mj.prototype.Ws,mj.prototype.Es=nj.BOUNDS,mj.prototype.BOUNDS=mj.prototype.Es;var oj={PENDING:0,ACTIVE:1,DONE:2};t("H.map.render.RenderState",oj),t("H.util.Disposable",hc),hc.prototype.bc=hc.prototype.bc,hc.prototype.addOnDisposeCallback=hc.prototype.bc,t("H.util.dispose",gc),hc.prototype.l=hc.prototype.l,hc.prototype.dispose=hc.prototype.l,hc.prototype.disposeInternal=hc.prototype.disposeInternal,hc.prototype.disposeInternal=hc.prototype.disposeInternal;function pj(e,o,s,h){pj.g.constructor.call(this),this.ld=e,this.ja=h,this.element=e.appendChild(this.createElement(e.ownerDocument)),this.Uk(o,s)}u(pj,hc),pj.prototype.A=function(){return this.element},pj.prototype.Uk=function(e,o){this.size?(this.size.w=e,this.size.h=o):this.size=new Hi(e,o),this.Xw(this.element,this.element.style,e,o,this.ja)},pj.prototype.setSize=pj.prototype.Uk,m=pj.prototype,m.mc=function(){return this.size},m.lb=function(){return this.ja},m.Yu=!0,m.Zb=function(e){e!==this.Yu&&(this.element.style.display=e?"block":"none",this.Yu=e)},m.opacity=1,m.Ed=function(e){this.opacity!==e&&(this.Eg(e),this.opacity=e)},m.Ue=function(){return this.opacity},m.ui=function(e){this.element.style.zIndex=e},pj.prototype.setZIndex=pj.prototype.ui,pj.prototype.vu=function(){return+this.element.style.zIndex},pj.prototype.Qe=function(){},pj.prototype.clear=function(){},pj.prototype.disposeInternal=function(){this.clear(),this.ld.removeChild(this.element),this.Uk(0,0),delete this.element,delete this.ld,pj.g.disposeInternal.call(this)},pj.prototype.disposeInternal=pj.prototype.disposeInternal,pj.prototype.ww=0,pj.prototype.Sn=function(){++this.ww},pj.prototype.release=function(){--this.ww||this.l()};function qj(e){this.yb=e}u(qj,hc),qj.prototype.Tb=function(){return this.yb},qj.prototype.getLayer=qj.prototype.Tb,qj.prototype.DA=function(){return this.Pb},qj.prototype.getSurface=qj.prototype.DA,qj.prototype.sf=function(e){var o=this.Pb;e!==o&&(this.Pb=e,e.Sn(),o&&o.release())},qj.prototype.setSurface=qj.prototype.sf,qj.prototype.disposeInternal=function(){this.Pb.release()},qj.prototype.disposeInternal=qj.prototype.disposeInternal,qj.prototype.Eh=function(){},qj.prototype.render=qj.prototype.L;function rj(e,o){rj.g.constructor.call(this,e),this.Pd=!(!o||!o.Pd),this.Hq={}}u(rj,qj),rj.prototype.sf=function(e){rj.g.sf.call(this,e),this.mC=e.ld.ownerDocument},rj.prototype.setSurface=rj.prototype.sf;var sj=(function(e,o){return o=o.V(),C(o,kg)?o.ha:(e[0]=o,e)}).bind(null,[]);rj.prototype.L=function(e,o,s,h,d,g,_){var j=this.yb,$,_t,_e,_r;if(this.sC=o=this.Hq,this.Hq=s={},h>=j.min&&h<=j.max){var _i=this.Xt(e,h,d,g),_n=_i.markers;if(e=_n.length){for(h=[],d=this.Pb,g=0;g<e;g++){j=_n[g];var _s=sj(j);for($=_s.length;$--;)(_t=_(_s[$]))&&((_r=o[_e=j.xb()+"_"+$])?delete o[_e]:_r={tv:j},s[_e]=_r,h.push([_r,j,j.kc(),d,_t.x,_t.y]))}for(h.sort(tj),e=h.length,g=0;g<e;g++)this.Dw.apply(this,h[g])}}return!_i||_i.requested&&_i.requested===_i.total||!_i.requested&&_n.length===_i.total?oj.DONE:oj.PENDING},rj.prototype.render=rj.prototype.L;function tj(e,o){var s=e[1].Ve(),h=o[1].Ve();return oi(s,h,!0)||e[5]-o[5]||oi(s,h,!1)}rj.prototype.La=function(){},rj.prototype.getObjectsAt=rj.prototype.La;function uj(e,o){uj.g.constructor.apply(this,arguments),this.Gq=0,this.Sh=[],this.sp=A(this.sp,this)}u(uj,rj),t("H.map.render.dom.MarkerRenderer",uj),uj.prototype.Xt=function(){return this.yb.oe.apply(this.yb,arguments)},uj.prototype.L=function(e,o,s,h,d,g,_){this.sp(),this.KB=0;var j=uj.g.L.apply(this,arguments),$=this.Pb,_t=this.sC,_e;for(_e in _t)vj(this,$,_t[_e]);return this.Sh.length===0&&j?oj.DONE:oj.PENDING},uj.prototype.render=uj.prototype.L,uj.prototype.sf=function(e){uj.g.sf.call(this,e),this.na=e.lb()},uj.prototype.setSurface=uj.prototype.sf,uj.prototype.sp=function(){for(var e=this.Sh.length,o,s,h;e--;)h=this.Sh[e],o=h.uo,s=o.kc(),s.Oq(h,s,o);this.Sh.length=0},uj.prototype.Dw=function(e,o,s,h,d,g){var _,j=h.lb(),$=o.Kc();d*=j,g*=j,this.Pd||(d=Ab(d),g=Ab(g)),e.detail&&($.Kh(e.ZA)?vj(this,h,e):_=e.detail),_||(e.detail=_=s.eu(this.mC),this.Gq++,Za(s.Oq)&&this.Sh.push(_)),e.ZA=$.Ld,_.style.zIndex=this.KB++,_.uo=o,h.Qe(_,d,g,0,0)};var wj,xj="pointer-events",yj;if(re){var zj;re&&Wc!==z&&(Wc=(zj=/(MSIE\s+|rv:)([^\);]+)(\)|;)/.exec(navigator.userAgent))?+zj[2]:z),yj=Wc,yj===9?xj="display":yj===10&&(xj="visibility")}wj=xj,uj.prototype.La=function(e,o,s){var h=this.na,d=Ae,g,_,j,$,_t;if(this.Gq){e/=h,o/=h,h=this.Pb.ld.getRootNode();var _e=h.documentElement,_r=this.Pb.A(),_i=_r.getBoundingClientRect();for(e+=_i.left,o+=_i.top;(_=j=h.elementFromPoint(e,o))&&_!==_r&&_!==_e&&_!==h.host&&j!==_n;){for(;($=_.parentNode)&&(!Za($.contains)||!$.contains(_r));)_=$;if($===_r&&(_!==j||_.nodeName!=="svg")&&0>d.indexOf(_t=_.uo)&&(d===Ae&&(d=[]),d.push(_t),s))break;g||(g=[]);var _n=_.style;g.push({xt:_n.getPropertyValue(wj),UA:_n.getPropertyPriority(wj),style:_n}),_n.setProperty(wj,wj==="visibility"?"hidden":"none","important"),_n=j}if(g)for(o=g.length;o--;)e=g[o],e.style.removeProperty(wj),gb(e.xt)&&e.style.setProperty(wj,e.xt,e.UA)}return d},uj.prototype.getObjectsAt=uj.prototype.La,uj.prototype.Eh=function(){return"dom"};function vj(e,o,s){o.clear(o=s.detail),delete o.uo,e.Gq--,s=(e=s.tv).kc(),s.Sq&&s.Sq(o,s,e)}uj.prototype.disposeInternal=function(){this.Sh.length=0;var e=this.Pb,o=this.Hq,s;for(s in o)vj(this,e,o[s]);this.Pb.l(),uj.g.disposeInternal.call(this)},uj.prototype.disposeInternal=uj.prototype.disposeInternal;function Aj(e,o,s,h,d,g){var _=d||"2d";Aj.g.constructor.apply(this,arguments),this.Zl=this.element.getContext(_,g),this.Bu=_==="2d",this.ij=_,this.hj=g}u(Aj,pj),m=Aj.prototype,m.createElement=function(e){e=e.createElement("canvas");var o=e.style;return o.position="absolute",o.top=o.left="0",e},m.Xw=function(e,o,s,h,d){e.width=zb(s,1),e.height=zb(h,1),o.width=Ab(s/d)+"px",o.height=Ab(h/d)+"px"},m.Eg=function(e){this.Zl.globalAlpha=e},m.Qe=function(e,o,s,h,d){this.Bu&&this.Zl.drawImage(e,o,s,h,d)},m.getContextAttributes=function(){return this.hj},m.uh=function(){return this.ij},m.clear=function(e){var o,s;this.Bu&&(e?this.Zl.clearRect(o=e.left,s=e.top,e.right-o,e.bottom-s):this.element.width=this.size.w)},m.disposeInternal=function(){var e=this.element;e.width=e.height=0,delete this.Zl,Aj.g.disposeInternal.call(this)},Aj.prototype.disposeInternal=Aj.prototype.disposeInternal;function Bj(e,o){var s=o||{},h=s.contextType;if(s=s.contextAttributes,Bj.g.constructor.call(this,o),db(e,"Function",Bj,0,"invalid render callback"),h){if(Cj.indexOf(h)===-1)throw new D(Bj,1,"invalid context type");this.ij=h}s&&(this.hj=s),this.Ar=e}u(Bj,Tf),t("H.map.layer.CanvasLayer",Bj);var Cj=["2d","webgl","webgl2","experimental-webgl"];m=Bj.prototype,m.ij="2d",m.uh=function(){return this.ij},m.getContextAttributes=function(){return this.hj},m.L=function(e,o){return this.Sl&&this.Sl.canvas===e||(this.Sl=e.getContext(this.ij,this.hj)),this.Ar(this.Sl,o)},m.disposeInternal=function(){Bj.g.disposeInternal.call(this),delete this.Sl};function Dj(e){var o="dom";Dj.g.constructor.call(this,e),C(this.yb,Bj)&&(o=e.uh()==="2d"?"2d":"webgl"),this.pD=o}u(Dj,qj),Dj.prototype.L=function(e,o,s,h,d,g,_,j){_=this.yb;var $=this.Pb,_t=!(C($,Aj)&&$.uh()==="2d");return h>=_.min&&h<=_.max?(_t&&$.Zb(!0),_.L($.A(),{boundingBox:e,zoom:h,screenCenter:o,priorityCenter:g,projection:s,cacheOnly:d,size:$.mc(),pixelRatio:$.lb(),cameraMatrix:j})):(_t&&$.Zb(!1),oj.DONE)},Dj.prototype.Eh=function(){return this.pD};var Ej,Fj=function(){function e(){}for(var o,s,h,d=Va("o ms moz webkit ").split(B!==void 0?void 0:" "),g=5;g--&&!o;)o=d[g],o=(s=x[o+(o?"R":"r")+"equestAnimationFrame"])&&!E(s.call(window,e))&&(h=x[o+(o?"C":"c")+"ancelAnimationFrame"]);return Ej=o?function(_){return s.call(x,_)}:function(_){return x.setTimeout(_,25)},o?function(_){return h.call(x,_)}:function(_){return x.clearTimeout(_)}}(),Gj=x.performance&&x.performance.now?function(){return x.performance.now()}:function(){return x.Date.now()};function Hj(e,o){if(E(this.x=+e))throw new D(Hj,0,e);if(E(this.y=+o))throw new D(Hj,1,o)}m=Hj.prototype,m.add=function(e){return new Hj(this.x+e.x,this.y+e.y)},m.Lt=function(e){if(!C(e,Hj))throw new D(this.Lt,0,e);return e=this.multiply(e),e.x+e.y},m.multiply=function(e){if(!C(e,Hj))throw new D(this.multiply,0,e);return new Hj(this.x*e.x,this.y*e.y)},m.Va=function(e){return new Hj(this.x*e,this.y*e)};function Ij(e){return Fb(e.Lt(e))}m.normalize=function(){var e=Ij(this);return e!==0?new Hj(this.x/e,this.y/e):this};function Jj(e){e=e||Be,this.FB=ab(e.EB)?e.EB:3,this.wv=ab(e.zB)?e.zB:300,this.Hx=ab(e.ED)?e.ED:3,this.uD=ab(e.tD)?e.tD:50,this.ei=[],this.clear()}t("H.map.render.InteractionUtils",Jj),Jj.prototype.cB=function(){return this.Jh},Jj.prototype.isGestureDetected=Jj.prototype.cB,Jj.prototype.start=function(e,o){var s=Kj.HEADING,h=Kj.TILT;this.R&&this.clear(),this.ik=e,this.Jm=!!o,this.R=!0,this.Jh=!(e&(s|h))||e===s||e===h},Jj.prototype.start=Jj.prototype.start,Jj.prototype.store=function(e,o,s,h,d){var g=!1;if(this.R){if(e=new Lj(e,o,s,h,d),g=e.Ru,this.Vn=this.$e,this.$e=e,this.yj){if(this.ym=!0,g){o=this.ik;var _=this.Jh;if(!_&&this.ym){d=Kj.HEADING;var j=Kj.TILT;s=Kj.COORD,h=Kj.ZOOM;var $=o&(s|j)?this.Ah(!0):Mj,_t=o&h?this.jm(!0):1,_e=o&d?Db(this.Bp(!0)):0,_r=Db($.x),_i=Db($.y);$=10<_r||10<_i,_r=10<_i&&_i>3*_r,_t=.8>_t||1.2<_t,_e=7<_e,o&j&&(_e||_t||$&&!_r?Nj(this,j):_r&&(Nj(this,~j>>>0),_=!0)),!_&&o&d&&o&(s|h)&&(_t||$?(Nj(this,d),_=!0):_e&&(Nj(this,j),_=!0)),this.Jh=_}}}else this.yj=e,g||(this.Jh=!0);this.Jm&&this.ei.push(e)}return g},Jj.prototype.store=Jj.prototype.store,Jj.prototype.clear=function(){this.ei.length=0,this.R=this.Jm=this.ym=this.Jh=!1,this.yj=this.Vn=this.$e=void 0},Jj.prototype.clear=Jj.prototype.clear,Jj.prototype.$d=function(e){return 0<(this.ik&e)},Jj.prototype.isModifierEnabled=Jj.prototype.$d;function Nj(e,o){e.ik^=e.ik&o}Jj.prototype.Lm=function(){return this.R},Jj.prototype.isRunning=Jj.prototype.Lm;var Mj=Wa(new Hj(0,0));Jj.prototype.Mf=function(){var e;if(this.Jm){var o=this.ei,s=o.length,h=0;for(e=new Hj(0,0);--s&&h<this.Hx;)e=e.add(Oj(o[s-1],o[s])),h++}else e=this.Ah();return e.normalize()},Jj.prototype.getDirection=Jj.prototype.Mf,Jj.prototype.nc=function(e){e=e||Gj();var o,s;if(this.Jm){var h=this.ei,d=this.ei.length,g=this.ei[d-1];for(s=o=0;--d&&o<this.Hx;)s+=Ij(Oj(h[d],h[d-1])),o++;h=s/o}else g=this.$e,h=Ij(this.Ah());return h=h>=this.FB&&e-g.timestamp<=this.uD?h>this.wv?this.wv:h:0},Jj.prototype.getSpeed=Jj.prototype.nc,Jj.prototype.im=function(){return this.$e?Pj(this.$e):B},Jj.prototype.getBifocalCenter=Jj.prototype.im,Jj.prototype.Ah=function(e){return(e=e?this.yj:this.Vn)?Oj(e,this.$e):new Hj(0,0)},Jj.prototype.getMoveVector=Jj.prototype.Ah,Jj.prototype.jm=function(e){var o=1;if(this.ym){var s=this.$e;e=e?this.yj:this.Vn,(e=Qj(e))&&(s=Qj(s))&&(o=s/e)}return o},Jj.prototype.getBifocalScaling=Jj.prototype.jm,Jj.prototype.Bp=function(e){if(this.ym){var o=e?this.yj:this.Vn,s=this.$e;e=o.qg;var h=s.qg,d=0;e&&h&&(o=o.ke,s=s.ke,d-=Nb(h.y-s.y,h.x-s.x)*Vb-Nb(e.y-o.y,e.x-o.x)*Vb),e=d}else e=0;return e},Jj.prototype.getBifocalRotation=Jj.prototype.Bp;function Lj(e,o,s,h,d){this.ke=new F(e,o),s!==B&&(this.qg=new F(s,h),this.Ru=!0),this.timestamp=d!==B?d:Gj()}Lj.prototype.Ru=!1;function Pj(e){var o=e.ke;return(e=e.qg)?new F(o.x-(o.x-e.x)/2,o.y-(o.y-e.y)/2):B}function Rj(e,o){var s=e.ke;return(e=e.qg)&&e.kb(o)<s.kb(o)?e:s}function Oj(e,o){var s=e.qg,h=o.qg;return h&&s?(o=Pj(o),e=Pj(e)):s?(o=o.ke,e=Rj(e,o)):h?(e=e.ke,o=Rj(o,e)):(o=o.ke,e=e.ke),new Hj(o.x-e.x,o.y-e.y)}function Qj(e){var o=e.qg;return o?e.ke.kb(o):0}function Sj(){this.aa=[],Sj.g.constructor.call(this)}u(Sj,K),t("H.util.OList",Sj);function Tj(e,o,s){if(e=e.aa.length,s)var h=e;else if(E(h=0>(h=+o)?zb(0,e+h):yb(e,h)))throw new pd(Sj,o,[0,e-1]);return h}Sj.prototype.Bo=function(e,o){this.aa.splice(o,0,e),this.dispatchEvent(new Uj(this,this.j.Ki,o,e,null,null))},Sj.prototype.add=function(e,o){this.Bo(e,Tj(this,o,E(o)))},Sj.prototype.add=Sj.prototype.add,Sj.prototype.nf=function(e){var o=this.aa.splice(e,1)[0];return this.dispatchEvent(new Uj(this,this.j.Mi,e,null,o,null)),o},Sj.prototype.Dd=function(e){return this.get(e),this.nf(e)},Sj.prototype.removeAt=Sj.prototype.Dd,Sj.prototype.remove=function(e){return e=this.indexOf(e),0<=e?(this.nf(e),!0):!1},Sj.prototype.remove=Sj.prototype.remove,Sj.prototype.set=function(e,o){if(this.aa.length!==0||e!==0){this.get(e),e=Tj(this,e,!1);var s=this.aa[e]}return this.aa[e]=o,this.dispatchEvent(new Uj(this,this.j.Ni,e,o,s,null)),s},Sj.prototype.set=Sj.prototype.set,Sj.prototype.indexOf=function(e){return this.aa.indexOf(e)},Sj.prototype.indexOf=Sj.prototype.indexOf,Sj.prototype.get=function(e){var o=Tj(this,e,!1),s=this.aa;if(o>=s.length)throw new pd(this.get,e,[0,s.length-1]);return s[o]},Sj.prototype.get=Sj.prototype.get,Sj.prototype.cA=function(){return this.aa.length},Sj.prototype.getLength=Sj.prototype.cA,Sj.prototype.Sa=function(){return[].concat(this.aa)},Sj.prototype.asArray=Sj.prototype.Sa,Sj.prototype.flush=function(){for(var e=this.aa.length;e--;)this.nf(e)},Sj.prototype.flush=Sj.prototype.flush,Sj.prototype.disposeInternal=function(){this.flush(),Sj.g.disposeInternal.call(this)},Sj.prototype.j={Ki:"add",Mi:"remove",Ni:"set",OD:"move"};function Uj(e,o,s,h,d,g){Uj.g.constructor.call(this,o,e),this.idx=s,this.added=h,this.removed=d,this.moved=g}u(Uj,uc),Sj.Event=Uj;function Vj(e){var o;if(Vj.g.constructor.call(this),this.dispatchEvent=A(this.dispatchEvent,this),e){var s=e.length;for(o=0;o<s;o++)this.add(e[o])}}u(Vj,Sj),t("H.map.DataModel",Vj);function Wj(e,o){var s=o.getProvider&&o.getProvider();s&&(Xj[s.uid]=s),o.ea(e)}function Yj(e){var o=e.getProvider&&e.getProvider();o&&delete Xj[o.uid],e.ea(null)}Vj.prototype.add=function(e,o){C(e,Tf,this.add,0),Wj(this,e),Vj.g.add.call(this,e,o)},Vj.prototype.add=Vj.prototype.add,Vj.prototype.set=function(e,o){return C(o,Tf,this.set,0),Wj(this,o),(e=Vj.g.set.call(this,e,o))&&Yj(e),e},Vj.prototype.set=Vj.prototype.set,Vj.prototype.Dd=function(e){var o;return(o=Vj.g.Dd.call(this,e))&&Yj(o),o},Vj.prototype.removeAt=Vj.prototype.Dd,Vj.prototype.remove=function(e){var o;return(o=Vj.g.remove.call(this,e))&&Yj(e),o},Vj.prototype.remove=Vj.prototype.remove,Vj.prototype.flush=function(){for(var e=this.aa.length;e--;)this.Dd(e);Vj.g.flush.call(this)},Vj.prototype.flush=Vj.prototype.flush;var Xj={};mb(Xj);function Zj(e,o,s){if(e=Xj[e])return C(e[o],Function,Zj,1,"invalid method"),e[o].apply(e,s)}Vj.invoke=Zj;function ak(){ak.g.constructor.call(this),this.Pn={},this.ji={position:new fd(0,0),zoom:0,heading:180,incline:0,tilt:0,bounds:new N($g([90,-180,90,0,90,180,-90,180,-90,-180]))},this.yu=!1}u(ak,K),t("H.map.ViewModel",ak),ak.prototype.j={za:"update",Oi:"sync"},ak.prototype.Zc=function(e,o){if(!e)throw new D(this.Zc,0,e);var s=e[bk];if(ab(s)&&!gd(s))throw new D(this.Zc,0,bk);if(s=e[ck],ab(s)&&E(+s))throw new D(this.Zc,0,ck);if(s=e[dk],ab(s)&&!C(s,ed))throw new D(this.Zc,0,dk);return e=x.Object.assign({},e),s=ek(e,this.Pn,this.ji),fk(this,this.Pn,e),this.yu||fk(this,this.ji,e),this.dispatchEvent(new gk(this.Pn,s,o)),this},ak.prototype.setLookAtData=ak.prototype.Zc,ak.prototype.Ib=function(){var e={};return e[bk]=hd(this.ji[bk]),fk(this,e,this.ji,!0),e},ak.prototype.getLookAtData=ak.prototype.Ib;var bk="position",ck="zoom",dk="bounds",hk={Ss:bk,Ws:ck,Ks:"heading",Vs:"tilt",Ls:"incline",Es:dk},ik=Object.keys(hk).map(function(e){return hk[e]});function fk(e,o,s,h){e.Fv={},e.Ev={},e.ov=[];for(var d=e.aC,g=e.$B,_=ik.length,j,$,_t;_--;)if(j=ik[_],_t=s[j],$=o[j],$==null||!h)if(_t!=null){if(ab(d)&&d.call(e,j,$,_t),o[j]=j!=="position"||_t&&!E(_t.lat)&&!E(_t.lng)?_t:hd(_t),ab(g)){switch(j){case"position":$=_t&&$&&(_t.lat!==$.lat||_t.lng!==$.lng);break;case"bounds":$=_t&&$&&!_t.da($);break;default:$=_t!==$}$&&g.call(e,j)}}else delete o[j]}ak.prototype.aC=function(e,o,s){this.Fv[e]=o,this.Ev[e]=s},ak.prototype.$B=function(e){this.ov.push(jk[e])};var jk=ik.reduce(function(e,o){return e[o]=nj[o.toUpperCase()],e},{});function ek(e,o,s){var h=0;return["tilt","incline","heading",ck].forEach(function(d){E(e[d])?e[d]=E(o[d])?s[d]:o[d]:h|=jk[d]}),[bk,dk].forEach(function(d){e[d]?h|=jk[d]:e[d]=o[d]||s[d]}),h}ak.prototype.rb=function(e){var o={},s={};this.yu=!0,fk(this,this.ji,e),this.Pn={},o.lookAt=this.Ev,s.lookAt=this.Fv,e=this.ov,e=e.length?e.reduce(kk):0,this.dispatchEvent(new mj(this.j.Oi,o,s,e))},ak.prototype.synchronize=ak.prototype.rb;function kk(e,o){return e|o}ak.prototype.Vk=function(e,o){if(E(e=+e))throw new D(this.Vk,0,ck);this.Zc({zoom:e},o)},ak.prototype.Ub=function(){return this.ji.zoom},ak.prototype.Hd=vb,ak.prototype.startControl=ak.prototype.Hd,ak.prototype.control=vb,ak.prototype.control=ak.prototype.control,ak.prototype.hc=vb,ak.prototype.endControl=ak.prototype.hc;function gk(e,o,s){gk.g.constructor.call(this,ak.prototype.j.za,e,null,o),this.animate=this.animate=jb(s)&&0<s&&1/0>s?s:!!s}u(gk,mj);function lk(e,o){o=o||{};var s;if(!C(e,Element))throw new D(lk,0,e);var h=e.ownerDocument.createElement("div");this.G=e,lk.g.constructor.call(this),this.padding=new cg(0,0,0,0),this.center=new F(0,0),this.margin=0,this.element=h,h.style.zIndex=0,h.style.height=h.style.width="100%",h.style.direction="ltr",h.style.position=e.style.position==="relative"?"absolute":"relative",this.resize(),e.appendChild(h),(s=o.padding)!==B&&this.Vr(s.top,s.right,s.bottom,s.left),this.Qr((s=o.margin)!==B?s:0)}u(lk,K),t("H.map.ViewPort",lk),lk.prototype.j={za:"update",Oi:"sync"},lk.prototype.Qr=function(e){if(this.margin!==+e){if(E(this.margin=+e))throw new D(this.Qr,0,e);this.Ce(),this.dispatchEvent(this.j.za)}},lk.prototype.setMargin=lk.prototype.Qr,lk.prototype.Vr=function(e,o,s,h){var d=this.padding;if(d.top!==e||d.right!==o||d.bottom!==s||d.left!==h){if(E(e+o+s+h))throw new D(this.Vr);d.top=e,d.right=o,d.bottom=s,d.left=h,this.Ce(),this.dispatchEvent(this.j.za)}},lk.prototype.setPadding=lk.prototype.Vr,lk.prototype.Ce=function(){var e=this.padding;this.center.set((this.width+e.left-e.right)/2<<0,(this.height+e.top-e.bottom)/2<<0)},lk.prototype.resize=function(){var e=this.G.offsetWidth,o=this.G.offsetHeight;(this.width!==e||this.height!==o)&&(this.OB=new Hi(this.width,this.height),this.width=e,this.height=o,this.Ce(),this.dispatchEvent(this.j.za))},lk.prototype.resize=lk.prototype.resize,lk.prototype.rb=function(e){this.dispatchEvent(new mj(this.j.Oi,this.OB,e,nj.SIZE))},lk.prototype.synchronize=lk.prototype.rb,lk.prototype.disposeInternal=function(){this.G.removeChild(this.element),delete this.G,delete this.element,lk.g.disposeInternal.call(this)},lk.prototype.Id=vb,lk.prototype.startInteraction=lk.prototype.Id,lk.prototype.vd=vb,lk.prototype.interaction=lk.prototype.vd,lk.prototype.ic=vb,lk.prototype.endInteraction=lk.prototype.ic,t("H.util.events.listenOnce",Kc),t("H.util.events.dispatchEvent",function(e,o){return e.dispatchEvent(o)}),t("H.util.events.fireListeners",function(e,o,s,h){if(yc(e))s=e.Kf(o,s,h);else{var d=!0;if((e=Oc(e))&&(o=e.pb[o.toString()]))for(o=o.concat(),e=0;e<o.length;e++){var g=o[e];g&&g.capture==s&&!g.ii&&(g=Uc(g,h),d=d&&g!==!1)}s=d}return s}),t("H.util.events.listen",Jc),t("H.util.events.unlisten",Sc);var mk=Uc;Uc=function(e,o){var s,h,d=!0,g=o[o.currentTarget===o.target?"AT_TARGET":e.capture?"CAPTURING_PHASE":(s=!0,"BUBBLING_PHASE")];return(!s||(h=o.type)!=="pointerenter"&&h!=="pointerleave")&&(o.eventPhase=g,d=mk(e,o),s&&e.src&&e.src.Jb&&e.src.Jb()===null&&delete o.eventPhase),d};function nk(e,o,s,h){var d=new cg(0,0,0,0);if(nk.g.constructor.call(this),!e)throw new D(nk,0,e);if(!o)throw new D(nk,1,o);if(!s)throw new D(nk,2,s);if(typeof h!="object")throw new D(nk,3,h+" is not an object");if(typeof h.pixelRatio!="number")throw new D(nk,3,h.pixelRatio+" is not a number");this.ja=h.pixelRatio,this.zoom=0,this.Ab=Eb(this.ja)/Ob,this.pixelProjection=new md,this.rl={1:d.clone(),2:d.clone(),4:d.clone()},this.xd=new F(.5,.5),this.ya=e,ok(this,this.ja),this.Id=A(this.Id,this),this.vd=A(this.vd,this),this.ic=A(this.ic,this),e.startInteraction=this.Id,e.interaction=this.vd,e.endInteraction=this.ic,e.addEventListener(e.j.za,this.mg,!1,this),this.getCapabilities=this.getCapabilities,this.capture=this.capture,this.zoomAt=this.Ng,this.relaunch=this.ba,this.dispose=this.l,this.screenToGeo=this.Wa,this.geoToScreen=this.Ka,this.screenToLookAtData=this.Un,this.De=o,this.Hd=A(this.Hd,this),this.control=A(this.control,this),this.hc=A(this.hc,this),o.startControl=this.Hd,o.control=this.control,o.endControl=this.hc,o.addEventListener(o.j.za,this.ar,!1,this),this.ib=s,this.gn=A(this.gn,this),this.ig=A(this.ig,this),this.jg=A(this.jg,this),this.fn=A(this.fn,this),s.addEventListener(Tf.prototype.j.za,this.gn,!1,this),s.addEventListener(s.j.Ki,this.ig,!1,this),s.addEventListener(s.j.Mi,this.jg,!1,this),s.addEventListener(s.j.Ni,this.fn,!1,this)}u(nk,K),t("H.map.render.RenderEngine",nk),nk.prototype.Ng=function(){};function ok(e,o){var s=e.ya,h=s.width,d=s.height,g=s.padding,_=g.top,j=g.left,$=g.bottom;g=g.right,s=s.margin;var _t=-(h+j-g)/2<<0,_e=-(d+_-$)/2<<0;h+=_t,d+=_e,e=e.rl,e[1].set((_t-s)*o,(_e-s)*o,(h+s)*o,(d+s)*o),e[2].set(_t*o,_e*o,h*o,d*o),e[4].set((_t+j)*o,(_e+_)*o,(h-g)*o,(d-$)*o)}nk.prototype.mg=function(){ok(this,this.ja)},nk.prototype.disposeInternal=function(){var e=this.ya,o=this.De,s=this.ib;e.removeEventListener(e.j.za,this.mg,!1,this),e.startInteraction===this.Id&&(e.startInteraction=lk.prototype.Id),e.interaction===this.vd&&(e.interaction=lk.prototype.vd),e.endInteraction===this.ic&&(e.endInteraction=lk.prototype.ic),o.removeEventListener(o.j.za,this.ar,!1,this),o.startControl===this.Hd&&(o.startControl=ak.prototype.Hd),o.control===this.control&&(o.control=ak.prototype.control),o.endControl===this.hc&&(o.endControl=ak.prototype.hc),s.removeEventListener(Tf.prototype.j.za,this.gn,!1,this),s.removeEventListener(s.j.Ki,this.ig,!1,this),s.removeEventListener(s.j.Mi,this.jg,!1,this),s.removeEventListener(s.j.Ni,this.fn,!1,this)},nk.prototype.Mr=function(e){this.Fo=e},nk.prototype.setAnimationCallback=nk.prototype.Mr,nk.prototype.Dr=function(){this.Fo=void 0},nk.prototype.resetAnimationCallback=nk.prototype.Dr,nk.prototype.control=function(){},nk.prototype.capture=function(){return Sd(Error("not implemented"))};function pk(e,o){e.style.transition="opacity 1.5s",Kc(e,"transitionend",o,!1),e.style.opacity=0}var Kj={ZOOM:1,HEADING:2,TILT:4,INCLINE:8,COORD:16};nk.InteractionModifiers=Kj,m=nk.prototype,m.j={Us:"render"},m.gn=function(e){this.Nv(e),this.ba()},m.ig=function(e){this.pk(e.idx,e.added)},m.jg=function(e){this.Uq(e.idx,e.removed,e.type===this.ib.j.Ni)},m.fn=function(e){e.removed&&this.jg(e),this.ig(e)},m.Nv=ze,m.pk=function(e,o){this.hq(e,o),e===0&&this.yc(),C(o,Tf)&&qk(this,o,!0),this.li(),this.ba()},m.yc=function(){var e=this.ib.Sa();if(0<e.length){var o=e[0].max;this.zq=e[0].min,this.yq=o}else e=this.getCapabilities().lookAt.zoom,o=e.max,this.zq=e.min,this.yq=o;e=rk(this,this.zoom),e!==this.zoom&&(this.zoom=e,this.pixelProjection.Va(e),this.rb())},m.rb=function(e){this.uf=this.Ib(),e&&(this.uf.position=e),this.uf.zoom=this.zoom-this.Ab,this.uf.position.alt=0},m.tx=0,m.heading=180,m.Ib=function(){return sk(this,{position:this.pixelProjection.projection.wn(this.xd),zoom:this.zoom,tilt:this.tx,heading:this.heading})};function sk(e,o){return o.tilt=tk(e,o.tilt),o.heading=uk(e,o.heading),o.incline=e.getCapabilities().lookAt.incline.min,o}function rk(e,o){var s=e.getCapabilities().lookAt.zoom;return ac(o,zb(s.min,e.zq),yb(s.max,e.yq))}function tk(e,o){return e=e.getCapabilities().lookAt.tilt,ac(o,e.min,e.max)}function uk(e,o){return e=e.getCapabilities().lookAt.heading,ac((o%360+360)%360,e.min,e.max)}function qk(e,o,s){s=s?o.addEventListener:o.removeEventListener,s.call(o,o.j.Qs,e.Vq,!1,e),s.call(o,o.j.Ps,e.Vq,!1,e)}m.hq=ze,m.Uq=ze,m.XC=function(e,o){this.ef={before:e,after:o}},nk.prototype.setOnRenderCallbacks=nk.prototype.XC;var vk={P2D:0,WEBGL:1,HARP:2};nk.EngineType=vk;var wk={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:85},incline:{min:0,max:0},heading:{min:0,max:360}},interaction:{ZOOM:Kj.ZOOM,COORD:Kj.COORD},capture:!0};t("H.map.render.webgl.capabilities",wk);function xk(e,o){xk.g.constructor.call(this,o),db(e,"Function",xk,0,"invalid render callback"),this.Ar=e}u(xk,Tf),t("H.map.layer.DomLayer",xk),xk.prototype.L=function(e,o){return this.Ar(e,o)};function yk(e,o,s,h,d){switch(o&&(this.ff=o),ab(s)&&(this.Ho=!!s),this.Ho&&h&&(this.Io=new Hi(h.w,h.h)),ab(d)&&(this.Gk={crossOrigin:d}),zk[eb(e)]){case 2:this.gb=e,Ak(this,1);break;case 1:if(Fe(e)){this.gb=e,Bk(this),Ak(this,1);break}e=e.src;case 0:if(e){e=te(e),this.Cm=new Ue("image",e,B,this.Gk),this.Cm.then(A(this.XB,this),A(this.WB,this));break}default:throw Ak(this,-1),new D(yk,0,"No image data")}}yk.prototype.o=0,yk.prototype.getState=function(){return this.o};function Ak(e,o){e.o=o,delete e.Cm,e.ff&&e.ff(o,e)}yk.prototype.Ho=!0;function Bk(e){if(e.Ho){var o=e.gb,s=Ck(e),h=s&&s.w||+o.width,d=s&&s.h||+o.height,g=le();if(C(o,x.HTMLCanvasElement))s=o;else{s=o.ownerDocument.createElement("canvas"),s.width=Cb(h*g),s.height=Cb(d*g);var _=s.getContext("2d");_.scale(g,g),_.drawImage(o,0,0,h,d),Xc&&(_.clearRect(0,0,h,d),_.drawImage(o,0,0,h,d))}e.gb=s}}yk.prototype.getData=function(){return this.gb||z};var zk={String:0,HTMLImageElement:1,HTMLCanvasElement:2};m=yk.prototype,m.Io=z,m.mc=function(){return this.o===1?Ck(this):z};function Ck(e){var o=e.Io,s;if(!o){var h=e.gb;if(o=h.naturalWidth||h.width,o===0&&re&&zk[eb(h)]===1){var d=!0;if(s=h.parentNode)var g=h.nextSibling;document.body.appendChild(h)}e.Io=o=new Hi(h.naturalWidth||h.width,h.naturalHeight||h.height),d&&(s?s.insertBefore(h,g):document.body.removeChild(h))}return o}m.XB=function(e){this.gb=e,Bk(this),Ak(this,1)},m.WB=function(){Ak(this,-1)},m.cancel=function(){this.Cm&&this.Cm.cancel()};function Dk(e,o){eg.call(this,e,o)}u(Dk,eg),t("H.map.layer.TileLayer",Dk),Dk.prototype.xg=function(e,o,s,h,d){if(!C(e,J))throw new D(this.xg,0,e);if(E(o=+o))throw new D(this.xg,1,o);o=Bb(o),this.pixelProjection.Va(o),e=this.Bj(e);var g=this.Fh(e,o);return this.Oj(g,e.left>e.right,o,s,h,d)},Dk.prototype.requestTiles=Dk.prototype.xg;function Ek(e,o){var s=this;if(!Za(o))throw new D(Ek,1,o);if(!Za(e.next||Za(e.cycle)))throw new D(Ek,2,'Argument "mode" must implement H.util.AsyncQueue.Mode');this.Ak=[],this.qw=[],this.HB=e,this.process=o,this.tC=function(){Fk(s)},this.nr=null,this.Kw=function(){s.nr||(s.nr=x.setTimeout(s.tC,1))}}t("H.util.AsyncQueue",Ek),Ek.prototype.push=function(e,o){if(!Za(o))throw new D(this.push,1,o);return e=Gk(new Hk,e,this.Kw,o),this.Ak.push(e),this.Kw(),e},Ek.prototype.push=Ek.prototype.push,Ek.prototype.An=function(){Fk(this)};function Fk(e){var o=e.qw,s=0,h=e.HB;for(h.yt(),e.nr=null;s<o.length;){var d=o[s];d.Uu?o.splice(s,1):s++}for(;d=h.next(e.Ak,e.qw);)d.cancelled?d.done(null,"cancelled"):(o.push(d),e.process(d,d.data))}function Hk(){Gk(this,null,null,null)}Ek.Task=Hk;function Gk(e,o,s,h){return e.data=o,e.cancelled=!1,e.Uu=!1,e.RB=s,e.SB=h,e.Qo=null,e}Hk.prototype.done=function(e,o){this.Uu=!0,this.RB(),this.SB(this,e,o)},Hk.prototype.done=Hk.prototype.done,Hk.prototype.cancel=function(){this.Qo&&this.Qo(),this.cancelled=!0},Hk.prototype.cancel=Hk.prototype.cancel,Hk.prototype.VC=function(e){return this.Qo=e,this},Hk.prototype.setCancelFn=Hk.prototype.VC;function Ik(){}Ek.Mode=Ik,Ik.prototype.next=function(){},Ik.prototype.yt=function(){};function Jk(e,o){Jk.g.constructor.call(this,new Kk(e),o)}u(Jk,Ek),t("H.util.SequentialQueue",Jk);function Kk(e){if(isNaN(e)||0>e)throw new D(Jk,1,'Argument "maxTime" must be a positive number');this.AB=e,this.$k=Gj()}Kk.prototype.next=function(e){return e.length&&Gj()-this.$k<this.AB?e=e.shift():null},Kk.prototype.yt=function(){this.$k=Gj()};function Lk(e,o,s,h){return e-=s,o-=h,e*e+o*o}function Mk(e,o,s){return Nk(e,o*o,s||0,0,e.length-1)}t("H.math.simplifyDP",Mk);function Nk(e,o,s,h,d){var g=0,_=h,j=e[h].x,$=e[h].y,_t=e[d].x,_e=e[d].y,_r=h+1,_i=Lk(j,$,_t,_e);if(_i)for(;_r<d;){var _n=e[_r++],_s=_n.x;_n=_n.y;var _l=((_s-j)*(_t-j)+(_n-$)*(_e-$))/_i;_s=0>_l?Lk(_s,_n,j,$):1<_l?Lk(_s,_n,_t,_e):Lk(_s,_n,j+_l*(_t-j),$+_l*(_e-$)),_s>g&&(g=_s,_=_r-1)}else for(;_r<d;)_n=e[_r++],_s=_n.x,_n=_n.y,_s=Lk(_s,_n,j,$),_s>g&&(g=_s,_=_r-1);return g>=o||0<s&&_-h?(--s,1<_-h?(h=Nk(e,o,s,h,_),h.splice(h.length-1,1)):h=[e[h]],h=1<d-_?h.concat(Nk(e,o,s,_,d)):h.concat(e.slice(_,d+1))):h=[e[h],e[d]],h}function Ok(e,o,s,h,d,g,_,j){Ok.g.constructor.call(this,o,s,h,null),this.key=e,this.Ad=j,this.ed=d,this.na=g,this.di={},this.zL=_,this.Vm=Cb($h.MAX_LINE_WIDTH/2*this.na+1)}u(Ok,Wi),t("H.map.provider.SpatialTile",Ok),Ok.prototype.yg=Xb,Ok.prototype.xr=Xb,Ok.prototype.pf=Xb;function Pk(e){return e.Ad.getInvalidations(ni.SPATIAL)}function Qk(e){var o=Pk(e),s=o.Ld,h=e.yg,d=h===s,g;if(!(d||o.Qu(h)||o.sq(h))){d=e.Ig;var _=e.di;if(o.Km(h))for(g=d.length;g--;){var j=d[g];if(j.Kc().Km(h)){d.splice(g,1);var $=$||Rk(e,j.xb())}}if(o.uq(h)){for(g=d.length;g--;)if(j=d[g],j.Kc().uq(h)){var _t=1;if((j=_[j.xb()])&&j.wm){$=1;break}}_t&&d.sort(Sk)}if(!$&&o.Kh(h)){for(g=d.length;g--;)if(d[g].Kc().Kh(h)){var _e=1;break}}e.xr!==h||_e||(e.xr=s,e.pf!==h||$||(e.pf=s)),e.yg=s,d=!0}return d}Ok.prototype.Ih=function(){var e=Pk(this),o=e.Ld,s=this.pf,h=s===o;return h||(this.Ad.tw&&!e.Kh(s)?h=!0:Qk(this)&&(h=this.pf===o)),h},Ok.prototype.isCanvasValid=Ok.prototype.Ih,Object.defineProperty(Ok.prototype,"valid",{get:function(){return this.Ih()},set:ze,configurable:!0});function Tk(e,o){this.gm=e,this.wm=o}function Rk(e,o){e=e.di;var s=e[o];if(s)return delete e[o],s.wm}Ok.prototype.Ig=Ae;function Uk(e){var o=Pk(e),s=e.yg,h=e.Ig,d;if(!Qk(e)){for(d=h.length;d--;){var g=h[d],_=g.Kc();(_.Km(s)||_.sq(s))&&Rk(e,g.xb())}e.Ig=e.Ad.requestSpatialsByTile(e,!1,!1).sort(Sk),e.yg=o.Ld}}function Sk(e,o){return oi(e.Ve(),o.Ve(),!1)}Ok.prototype.bb=function(){return this.Ig},Ok.prototype.getObjects=Ok.prototype.bb,Ok.prototype.FA=function(){return this.ed},Ok.prototype.getTileSize=Ok.prototype.FA;var Vk={};Ok.prototype.Pj=function(){var e=this.ed+"_"+this.na,o=Vk[e];if(!o){o=-this.Vm;var s=this.ed-o;o=Vk[e]=new cg(o,o,s,s)}return o},Ok.prototype.getPxClipRect=Ok.prototype.Pj,Ok.prototype.nm=function(){var e=this.lz;if(!e){var o=this.pm();e=0;var s=this.ed;this.z&&(s-=e+=this.Pj().top),e=this.lz=Zf(o.sk(new F(e,e)),o.sk(new F(s,s)))}return e},Ok.prototype.getGeoClipRect=Ok.prototype.nm,Ok.prototype.pm=function(){var e=this.vC;if(!e){var o=this.ed;e=this.vC=new md(B,o),e.Va(this.z),e.x=this.x*o,e.y=this.y*o}return e},Ok.prototype.getPxProj=Ok.prototype.pm,Ok.prototype.lb=function(){return this.na},Ok.prototype.getPixelRatio=Ok.prototype.lb,Ok.prototype.Hn=function(){var e=this.data;return e&&(this.data=null,this.pf=Xb),e},Ok.prototype.releaseCanvas=Ok.prototype.Hn,Ok.prototype.In=function(){this.di={},delete this.Ig,this.yg=Xb},Ok.prototype.releaseData=Ok.prototype.In,Ok.prototype.L=function(e){var o=e.getContext("2d"),s,h,d,g,_=0;if(Uk(this),this.pf<this.yg){var j=this.Ig;if(s=j.length){e.width=e.height=this.ed,o.clearRect(0,0,this.ed,this.ed);var $=this.di;for(h=0;h<s;h++){var _t=j[h],_e=_t.xb();if(g=(d=$[_e])?d.gm:_t.getGeometriesForTile(this)){if(d)_t.Kc().Kh(this.pf)&&(d.wm=ui(_t,g)),d=d.wm;else{d=ui(_t,g);for(var _r,_i=g,_n=_t.We?2:0,_s=_i.length;_s--;){var _l=_i[_s];if(_l!==Yh){var Ap=_l.Rc;for(_r=Ap.length;_r--;)_l=Ap[_r],4<_l.length&&(Ap[_r]=Mk(_l,.6,_n))}}this.di[_e]=new Tk(g,d)}if(d){for(o.save(),_i=_t.We?this.BC:this.CC,_e=0;_e<g.length;_e++)_i.call(this,_t,g[_e],_t.J(),o);if(g=_t.getLabels(this))for(_t=o,_e=g.length;_e--;)for(_n=g[_e],_i=_n.size,_t.font=_i+"px "+_n.font,_t.fillStyle=_n.color,_t.textAlign="center",_t.translate(_n.x,_n.y),_t.rotate(_n.angle),_i=_n.lineHeight||1.375*_i,_s=_n.lines,_n=_s.length;_n--;)_t.fillText(_s[_n],0,_n*_i);o.restore()}_|=+d}}}this.data=_?e:null,this.xr=this.pf=this.yg}else this.data&&(_=1);return 0<_},Ok.prototype.render=Ok.prototype.L,Ok.prototype.data=null,Ok.prototype.CC=function(e,o,s,h){var d;s.Xj&&(Wk(h,s,this.na),Xk(o,h,!1,!0,!1,this.ed,this.Vm)),s.Vj&&(d=e.Tg)&&d.Nc&&(Yk(h,d),Zk(this,h,o,d,s.lineWidth))},Ok.prototype.BC=function(e,o,s,h){var d=s.Nc,g=s.Xj,_,j=this.ed,$=this.Vm;if(o===Yh)d&&(Yk(h,s),h.fillRect(0,0,j,j));else{if(g&&Wk(h,s,this.na),s.Vj&&(_=e.Tg)){var _t=s.lineWidth;_.Nc||(_=null)}e=o.sn,e===Wb?((g||d)&&(Yk(h,s),Xk(o,h,!0,g,d,j,this.Vm)),_&&(Yk(h,_),Zk(this,h,o,_,_t,0))):(d&&(Yk(h,s),Xk(o,h,!0,!1,d,j,$,0,e)),g&&Xk(o,h,!1,g,!1,j,$,e),_&&(Yk(h,_),Zk(this,h,o,_,_t,e)))}};function Xk(e,o,s,h,d,g,_,j,$){var _t=e.Rc,_e=-_;if(_=g+_,j=j||0,$===B&&($=_t.length),d&&e===Yh)o.fillRect(0,0,g,g);else if($>j){for(o.beginPath(),g=j;g<$;g++){var _r=_t[g],_i=_r.length;if(_r===Zh)o.moveTo(_e,_e),o.lineTo(_e,_),o.lineTo(_,_),o.lineTo(_,_e);else{var _n=_r[0];for(o.moveTo(_n.x,_n.y),j=1;j<_i;j++)_n=_r[j],o.lineTo(_n.x,_n.y)}s&&o.closePath()}s&&d&&o.fill(e.Uj!==Wb?"evenodd":"nonzero"),h&&o.stroke()}}function Wk(e,o,s){var h;e.strokeStyle=o.strokeColor,e.lineWidth=o.lineWidth*s,e.lineCap=o.lineCap,e.lineJoin=o.lineJoin,e.miterLimit=o.miterLimit,e.setLineDash&&(h=o.lineDash)!==Ae&&(e.setLineDash(h),e.lineDashOffset=o.lineDashOffset)}function Yk(e,o){e.fillStyle=o.fillColor}function Zk(e,o,s,h,d,g){var _=d*h.width/2;d=d*h.length/2;var j=d/2;h=2*d*h.frequency;var $=Fb(Gb(d,2)+Gb(_,2));e=e.ed-$,e=new cg($,$,e,e),s=s.Rc;var _t,_e,_r,_i,_n,_s,_l,Ap=Pb/2;for(g=g||0,$=s.length;$-- >g;){var _h=0,_p=s[$];if(_e=_t=_p.length){var ty=_p;for(_e=ty.length,_r=0;--_e;)_r+=ty[_e].kb(ty[_e-1]);_e=(ty=_r)>=h}if(_e)for(_e=yb(Bb(ty/h),1e3),_e=ty/(_e+1),_r=_e/2;--_t;){for(_i=(_n=_p[_t]).kb(_s=_p[_t-1]);_r<=_h+_i;){var ry=_n.x+(_s.x-_n.x)*(_l=(_r-_h)/_i);_l=_n.y+(_s.y-_n.y)*_l,e.Ql(ry,_l)&&(o.save(),o.translate(ry,_l),o.rotate(-Mb((_s.y-_n.y)/(_n.x-_s.x))+(_n.x<_s.x?Ap:-Ap)),o.beginPath(),o.moveTo(-_,-d),o.lineTo(0,d),o.lineTo(_,-d),o.lineTo(0,-j),o.closePath(),o.fill(),o.restore()),_r+=_e}_h+=_i}}}var $k=[];Ok.prototype.La=function(e,o,s){for(var h=this.Ig,d=h.length,g,_,j,$,_t,_e,_r=Ae,_i,_n=this.na;d--;)if(_=h[d],_.Vd(!0)&&(j=this.di[_.xb()])&&($=j.gm)){for(g=_.J(),_e=g.fillColor!=="none"&&_.We,_i=g.strokeColor==="none"?0:g.lineWidth*_n,g=$.length;g--;){_t=$[g];var _s;if(!(_s=_e&&_t===Yh)&&(_s=_e||_i)){var _l;_s=e;var Ap=o,_h=_e,_p=_i,ty=_t.Uj,ry=_t.sn,ly=ry!==Wb,uy=_t.Rc,py=uy.length,fy=0,my=0,xy=!1;for(_t=0;_t<py;_t++){var Ly=uy[_t],My=_t>=ry,Ry=!My&&_t>=ty;if(Ly===Zh&&_h)Ry?fy++:my++;else{var Sy=Ly.length;for($k.length=2*Sy,_l=0;_l<Sy;_l++){var Zy=Ly[_l];$k[2*_l]=Zy.x,$k[2*_l+1]=Zy.y}if(_l=_h&&!My,My=ly&&!My?0:_p,_l||My){if(My=dc(_s,Ap,$k,My,_l),My===cc.EDGE||My===cc.VERTEX){xy=!0;break}else if(My===cc.SURFACE){if(Ry)fy++;else if(my++,ty===Wb)break}}}}_s=xy||0<my&&!(fy%2)}if(_s){_r===Ae&&(_r=[]),_r.push(_);break}}if(s&&_r.length)break}return _r};function al(e,o){var s;al.g.constructor.call(this,o),this.sw=e,this.na=e=o.pixelRatio,this.tileSize=s=1<<Ab(Yb((o.tileSize||256)*e)),this.vs=Yi(s,e),this.je=A(this.je,this),this.Qq=A(this.Qq,this),this.rg=A(this.rg,this),this.kg=A(this.kg,this),this.ge=A(this.ge,this),this.sw.addEventListener(L.prototype.j.za,this.ge,!1,this),this.Zg=[],this.vf=new Ri(o.tileCacheSize||256,this.je),this.cp=new Ri(o.dataCacheSize||512,this.Qq),this.Mn=new Jk(20,this.rg),this.pg={},this.ev=Gj()}u(al,Xi),al.prototype.ge=function(e){e=e.target,e.type===ni.SPATIAL&&this.jb(e)},al.prototype.Oa=function(e,o,s,h){var d=this.getTileKey(e,o,s),g;if(g=this.vf.get(d,h)){if(h||g.Ih())return g;h||this.vf.cm(d)}if((g=this.cp.get(d,h))&&(h||Qk(g)))return e=this.Zg.pop()||document.createElement("canvas"),g.L(e)||this.Zg.push(e),this.vf.add(d,g,1),g;h||((g=this.pg[d])?g.count++:(g=this.Mn.push([d,e,o,s],this.kg),g.count=1,this.pg[d]=g))},al.prototype.requestTile=al.prototype.Oa,al.prototype.nd=function(){},al.prototype.createTileInternal=al.prototype.nd,al.prototype.An=function(){var e=Gj();33<e-this.ev&&(this.Mn.An(),this.ev=e)},al.prototype.Md=function(e,o,s){this.Xi(this.getTileKey(e,o,s))},al.prototype.cancelTile=al.prototype.Md,al.prototype.Xi=function(e){var o;(o=this.pg[e])&&(o.count--,o.count||(o.cancel(),delete this.pg[e]))},al.prototype.cancelTileByKey=al.prototype.Xi,m=al.prototype,m.rg=function(e,o){var s=o[0],h=o[1],d=o[2],g=o[3];s=this.vf.get(s)||new Ok(s,h,d,g,this.tileSize,this.na,g+this.vs,this.sw),h=s.data||this.Zg.pop()||document.createElement("canvas"),s.L(h)||this.Zg.push(h),o.push(s),e.done(s)},m.kg=function(e,o){e=e.data[0],o&&this.vf.add(e,o,1),delete this.pg[e],this.jb()},m.je=function(e,o){o.data&&this.Zg.push(o.Hn()),this.cp.add(e,o,1)},m.Qq=function(e,o){o.In()},m.disposeInternal=function(){for(var e in this.pg)this.pg[e].cancel();this.vf.ia(),this.cp.ia(),this.Zg.length=0,al.g.disposeInternal.call(this)};function bl(e,o){o=o?Na(o):{},o.tileSize=o.tileSize||256,o.pixelRatio=o.pixelRatio||le(),o.max=24,this.Hg=new al(e,o),this.wi=new Dk(this.Hg),o.minWorldSize=this.Hg.tileSize,o.provider=e,bl.g.constructor.call(this,o),this.tileSize=this.wi.tileSize,this.ln=A(this.ln,this),this.Hg.addEventListener(this.Hg.j.za,this.ln),e.addEventListener(e.j.za,this.ln)}u(bl,Tf),t("H.map.layer.ObjectLayer",bl),bl.prototype.ln=function(e){e.currentTarget!==this.Hg&&e.target.type===ni.SPATIAL||this.jb()};var cl={markers:Ae,total:0};bl.prototype.pe=function(e,o,s){var h=this.D,d;return h.providesMarkers()&&(d=h.requestMarkers(e,o,!0,s)).length?{markers:d,total:d.length}:cl},bl.prototype.requestMarkers=bl.prototype.pe,bl.prototype.oe=function(e,o,s){var h=this.D,d;return h.providesDomMarkers()&&(d=h.requestDomMarkers(e,o,!0,s)).length?{markers:d,total:d.length}:cl},bl.prototype.requestDomMarkers=bl.prototype.oe;var dl={tiles:Ae,total:0};bl.prototype.xg=function(e,o,s,h){if(this.D.providesSpatials()){var d=this.wi.xg(e,o,s,h);s||(this.Hg.An(),d=this.wi.xg(e,o,!0,h))}else d=dl;return d},bl.prototype.requestTiles=bl.prototype.xg,bl.prototype.Oa=function(e,o,s,h){return this.wi.Oa(e,o,s,h)},bl.prototype.requestTile=bl.prototype.Oa,bl.prototype.Md=function(e,o,s){this.wi.Md(e,o,s)},bl.prototype.cancelTile=bl.prototype.Md;var el={overlays:Ae,total:0};bl.prototype.wg=function(e,o,s){var h=this.D,d=el;return h.providesOverlays&&h.providesOverlays()&&(e=h.requestOverlays(e,o,!0,s),o=e.length)&&(d={overlays:e,total:o}),d},bl.prototype.requestOverlays=bl.prototype.wg,bl.prototype.disposeInternal=function(){this.Hg.l(),this.wi.l(),this.D.dispose(),bl.g.disposeInternal.call(this)};function fl(e){var o,s=this,h=x.H.gl;fl.g.constructor.call(this),this.m=o=h.Scene.create(x.URL.createObjectURL(He(JSON.stringify(gl))),{viewport:e.viewport,container:e.ld,disableRenderLoop:!0,devicePixelRatio:e.devicePixelRatio,logLevel:"error"}),e.ZB&&o.subscribe({load:e.ZB}),o.subscribe({view_complete:function(){s.Jr=!0,e.Pv()}});var d=o.requestRedraw;o.requestRedraw=function(){d.apply(o),e.Pv()},this.Kr=A(this.Kr,this),this.Kn=A(this.Kn,this),this.rs=0,this.Rh={},this.Gd={}}u(fl,hc),m=fl.prototype,m.Jr=!1;function hl(e){e=e.m.sources;var o;for(o in e){var s=e[o];if(s.hasPendingCommands&&s.hasPendingCommands())return!0}return x.H.gl.Task.hasPendingTasks()}m.L=function(){var e=x.H.gl.Task;return this.m.immediateRedraw(),e.setState({user_moving_view:this.m.view.user_input_active}),e.processAll(),this.Jr&&!this.m.dirty&&!this.m.building&&!hl(this)&&!Object.keys(this.Gd).length};function il(e){e.Jr=!1,e.m.resetViewComplete()}function jl(e){return e.m.view}function kl(e,o){function s(){var d=o.Sa(),g={},_={},j,$,_t,_e=++e.rs,_r,_i;for(gf(_,gl),$=0;$<d.length;$++){var _n=d[$];if(j=_n.D){var _s=j.mb();if(_s.getState()===df.READY){var _l=_s.Rd();if(!Ma(_l)){delete _l.cameras,delete _l.camera,g[$]=_l=tf(_l,$),!C(_n,bl)&&_l.sources&&uf(_l,j.uid);for(_t in _l.sources){var Ap=_l.sources[_t];Ap.max_zoom=yb(j.max,wk.lookAt.zoom.max),Ap.max_display_zoom=_n.max,Ap.min_display_zoom=_n.min,(_i=j.tileSize)&&(2<=h&&256<_i&&j instanceof kj&&(_i/=2),Ap.tile_size=_i)}(_r=_s.Ic())&&vf(_l,_r),gf(_,_l)}}}}return gf(_.layers.skybox.draw.skybox.color,_.scene.sky),e.m.config=_,e.m.updateConfig().then(function(){var _h={},_p,ty;if(_e!==e.rs)return!1;e.rs=0;for(ty in g){_n=d[+ty];var ry=g[ty].sources;for(_p in ry)(ry=e.m.sources[_p])&&(_h[_p]=ry,ry.initialize&&_n.getProvider()&&ry.initialize(_n.getProvider(),e.Kr,e.m.getWorkers().length,ry.tiled?B:e.m.tile_manager.getWorkerForTile(z,ry)))}for(_p in e.Rh)!_h[_p]&&e.Rh[_p].dispose&&e.Rh[_p].dispose();return e.Rh=_h,!0})}var h=e.m.pixelRatio();e.m.initialized?s():e.m.load(z,{blocking:!1}).then(s)}m.Kr=function(e,o,s){var h=this,d=this.m.sources[e],g=s&&s.isReload;o?this.Gd[e]!==!0&&(this.Gd[e]||(this.Gd[e]={rx:{},it:[]}),C(o,Wi)?this.Gd[e].rx[o.x+"/"+o.y+"/"+o.z]=!0:(o=o.boundingBox,this.Gd[e].it.push(new J(o[0],o[1],o[2],o[3])))):this.Gd[e]=!0,d&&d.has_volatile_data?ll(this,g):(x.clearTimeout(this.Aw),this.Aw=x.setTimeout(function(){return ll(h,g)},100))},m.Kn=function(e){var o=!1,s=this.Gd[e.source.name],h=x.H.gl;if(s)if(s===!0)o=!0;else{var d=h.Tile.coord(h.Geo.wrapTile(e.coords));if(o=!!s.rx[d.key],!o){var g=h.Geo.getTileBoundingBox(d,e.source.tile_size,$h.MAX_LINE_WIDTH/2);g=Zf(g.getTopLeft(),g.getBottomRight()),o=s.it.some(function(_){return _.Vf(g,!0)||g.Ff(_.wb(),!0)})}}return o};function ll(e,o){var s=e.m.tile_manager;s.removeTiles(e.Kn),s.updateTilesForView(),o&&s.removeCachedTiles(e.Kn),il(e),e.Gd={}}m.Rd=function(){return this.m.config};function ml(e,o,s,h){e.m.getFeatureAt(o,s,h),e.m.update()}function nl(e){return e.m.screenshot(void 0).then(function(o){return new Jd(function(s,h){new yk(URL.createObjectURL(o.blob),function(d,g){d===1?s(g.getData()):h()},!1)})})}m.lb=function(){return this.m.pixelRatio()},m.disposeInternal=function(){var e=this.Rh;fl.g.disposeInternal.call(this),this.m.destroy(),this.Gd={},e&&Object.keys(e).forEach(function(o){e[o].dispose()}),x.clearTimeout(this.Aw),delete this.Rh,delete this.m},fl.prototype.disposeInternal=fl.prototype.disposeInternal;var gl={scene:{background:{color:"#FFFFFF"},sky:{zenith:"#347BC0",horizon:"#EDF2F9",fog:"#FFFFFF"}},lights:{default_light:{type:"directional",name:"default_light",visible:!0}},camera:{type:"perspective"},styles:{},fonts:{},sources:{skybox:{type:"SkyBox"}},layers:{skybox:{data:{source:"skybox"},draw:{skybox:{color:{}}}}},global:{}};function ol(){K.call(this),this.reset()}u(ol,K),ol.prototype.start=function(e,o){this.R&&this.reset(),E(e-o)||(this.Ug=+e,this.Vg=+o),this.R=!0},ol.prototype.reset=function(){this.R=!1,this.Ug=this.Vg=B,this.Ro=new pl(0,0,0,0,0,0)},ol.prototype.Lm=function(){return this.R},ol.prototype.j={wo:"animationupdate"};function ql(e){ql.g.constructor.call(this,ol.prototype.j.wo),this.mt=e}u(ql,uc),ol.prototype.set=function(e,o,s,h,d,g){var _=this.Ro;this.R&&(e=new pl(e/1e3,o/1e3,s/1e3,h/1e3,d/1e3,g/1e3),_.da(e)||(this.Ro=e,this.dispatchEvent(new ql(rl(this)))))};function rl(e){return x.Object.create(e.Ro)}ol.prototype.nc=function(){return rl(this).nc()},ol.prototype.Mf=function(){var e=rl(this),o=this.nc()||1;return new pl(e.Lb/o,e.Mb/o,e.Nb/o,e.mi,e.ni,e.Jk)},ol.prototype.disposeInternal=function(){this.reset(),ol.g.disposeInternal.call(this)};function pl(e,o,s,h,d,g){this.Lb=e,this.Mb=o,this.Nb=s,this.mi=h,this.ni=d,this.Jk=g}pl.prototype.nc=function(){return Fb(this.Lb*this.Lb+this.Mb*this.Mb+this.Nb*this.Nb)},pl.prototype.Mf=function(){var e=this.nc()||1;return new pl(this.Lb/e,this.Mb/e,this.Nb/e,this.mi,this.ni,this.Jk)},pl.prototype.da=function(e){var o=e===this;return!o&&(o=C(e,pl))&&(o=this.Lb===e.Lb&&this.Mb===e.Mb&&this.Nb===e.Nb&&this.mi===e.mi&&this.ni===e.ni&&this.Jk===e.Jk),o};function sl(e,o,s,h){sl.g.constructor.apply(this,arguments)}u(sl,pj),t("H.map.render.dom.Surface",sl),m=sl.prototype,m.uh=function(){return"dom"},m.createElement=function(e){return e=e.createElement("DIV"),e.style.position="absolute",e.style.pointerEvents="none",e},m.Xw=function(e,o,s,h){o.width=s+"px",o.height=h+"px"},m.Eg=function(e){this.element.style.opacity=e},m.Qe=function(e,o,s){var h=this.ja,d=e.style;d[Hh("transform")]="matrix(1,0,0,1,"+o/h+","+s/h+")",e.parentNode!==this.element&&(d.position="absolute",this.element.appendChild(e),this.element.style.pointerEvents="auto",getComputedStyle(e).pointerEvents==="auto"&&(e.style.pointerEvents="all"),this.element.style.pointerEvents="none")},m.clear=function(e){e?this.element.removeChild(e):this.element.innerHTML=""};function tl(e,o){this.Cy=e,this.na=o}function ul(e,o,s){var h=[],d={ld:e.Cy,width:o.w,height:o.h,ja:e.na};for(e=0;e<s.length;e++){o=s[e];var g=o.Eh(),_={};Pa(_,d);var j=o.Pb;switch(g){case"2d":if(C(o.Tb(),Bj)&&(_.Wo=o.Tb().getContextAttributes()),g=_e&&_e.uh()==="2d"){g=_.Wo;var $=_e.hj;g=$===g?!0:$&&!g?!$.alpha&&!$.willReadFrequently:g&&!$?!g.alpha&&!g.willReadFrequently:!g.alpha==!g.alpha&&!$.willReadFrequently==!g.willReadFrequently}if(g)var _t=!1;else if(j&&!_t){var _e=j;_t=!1}else _e=new Aj(_.ld,_.width,_.height,_.ja,"2d",_.Wo),_t=!0;break;case"dom":_e=j||new sl(_.ld,_.width,_.height,_.ja),_t=!j;break;default:_e=j||new Aj(_.ld,_.width,_.height,_.ja,o.Tb().uh(),_.Wo),_t=!j}h[h.length-1]!==_e&&(_e.ui(h.length),h.push(_e)),o.sf(_e)}return h}function vl(e){return e}t("H.util.animation.ease.LINEAR",vl),t("H.util.animation.ease.EASE_IN_QUAD",function(e){return e*e});function wl(e){return-e*(e-2)}t("H.util.animation.ease.EASE_OUT_QUAD",wl),t("H.util.animation.ease.EASE_IN_OUT_QUINT",function(e){return e*=2,1>e?Gb(e,5)/2:(e-=2,Gb(e,5)/2+1)});function xl(e){return 1-Math.sqrt(1-e*e)}function yl(e){return Fb(2*e-e*e)}t("H.util.animation.ease.EASE_OUT_CIRC",yl);function zl(e){return 1-Math.cos(e*Math.PI/2)}function Al(e){return Math.sin(e*Math.PI/2)}function Bl(e,o){this.bg={tilt:Cl(e.tilt,o.tilt),heading:Cl(e.heading,o.heading),zoom:o.zoom-e.zoom};var s=this.bp=hd(e.position),h=o.position;e=h.lat*Ub;var d=s.lat*Ub;s=h.lng*Ub-s.lng*Ub,e=Math.atan2(Ib(s)*Kb(e),Kb(d)*Ib(e)-Ib(d)*Kb(e)*Kb(s)),this.qy=(0<=e?e:Sb+e)*Vb,this.kh=this.bp.kb(o.position),o=this.bg.zoom,this.Dv=o===0?Dl:Object.assign({},Dl,{zoom:0>o?yl:xl,position:0>o?zl:Al}),this.fv=Object.assign({},{tilt:0,heading:0,zoom:0})}function Cl(e,o){return e=o-e,-180<e&&180>=e?e:180<e?e-360:e+360}var Dl={tilt:vl,heading:vl,zoom:vl,position:vl};function El(e,o,s,h,d){if(!Za(e.Mr)||!Za(e.Dr))throw new D(El,0,e);if(this.bt=e,!Za(this.AD=o))throw new D(El,1,o);if(E(this.rj=+s))throw new D(El,2,s);if(!Za(this.Gv=h)&&h!=null)throw new D(El,3,h);if(!Za(this.Mt=d)&&d!=null)throw new D(El,4,d);this.id=new ue().next(),this.R=!1}t("H.util.animation.Animation",El),El.prototype.start=function(){var e=this;this.$k=Gj(),this.R=!0;var o=this.$k;this.bt.Mr(function(){if(e.R){var s=Gj(),h=s-e.$k,d=h/e.rj,g=!1;1<=d&&(d=1,g=!0),e.AD(e.Mt?e.Mt(d):d,h,s-o,s),o=s,g&&e.stop()}else e.stop()})},El.prototype.start=El.prototype.start,El.prototype.stop=function(e){this.R=!1,this.bt.Dr(),e||this.Gv&&this.Gv(this)},El.prototype.stop=El.prototype.stop,El.prototype.Lm=function(){return this.R},El.prototype.isRunning=El.prototype.Lm;function Fl(e,o){if(E(this.xo=+e))throw new D(Fl,0,e);this.eo=this.rj=0,o&&this.Tw(o)}t("H.util.kinetics.KineticMove",Fl),Fl.prototype.Tw=function(e){return this.eo=e,this.rj=this.gu(),this},Fl.prototype.setInitialSpeed=Fl.prototype.Tw,Fl.prototype.gu=function(){return Math.abs(this.eo/this.xo)},Fl.prototype.getDuration=Fl.prototype.gu,Fl.prototype.Hj=function(e){return this.eo+this.xo*e},Fl.prototype.getCurrentSpeed=Fl.prototype.Hj,Fl.prototype.Bz=function(e){return this.eo*e+this.xo*e*e/2},Fl.prototype.getCurrentPath=Fl.prototype.Bz;function S(e,o,s,h){var d;if(S.g.constructor.call(this,e,o,s,h),this.qp=new Ri(this.$x),this.Xb=new F(0,0),(d=h.renderBaseBackground)&&(this.Cw=d.lower,this.Bw=d.higher),this.tj=!!h.enableSubpixelRendering,this.Kg=Gl,this.ma=new Jj,this.T=h=new ol,this.fg=A(this.fg,this),h.addEventListener(h.j.wo,this.fg),h=e.element,this.qc=e=h.ownerDocument.createElement("div"),e.style.position="absolute",e.style.width=e.style.height="100%",e.style.zIndex=0,h.insertBefore(e,h.firstChild),this.cl=new tl(this.qc,this.ja),this.Um=o.Ib().position,o=x.H.gl,!o)throw new wb(S,'"H-webgl" module is missing');this.m=new fl({viewport:this.ya,ld:this.qc,devicePixelRatio:this.ja,Pv:A(this.ba,this)}),o.WorkerBroker.addTarget("model",Vj),this.gq(),this.Tq=A(this.Tq,this),this.vg=A(this.vg,this),this.Ka=A(this.Ka,this),s.addEventListener(Tf.prototype.j.Li,this.Tq),this.o=Hl,this.zoom=rk(this,this.De.Ub()),this.yc(),this.mg()}u(S,nk),t("H.map.render.webgl.RenderEngine",S),S.prototype.$x=100,S.prototype.Ib=function(){var e=this.Um;return sk(this,{position:{mB:e.mB,tB:e.tB},zoom:this.zoom,tilt:this.tx,heading:this.heading})},S.prototype.Tq=function(e){e=(e=e.target.D)&&e.mb(),(e&&e.getState())===df.INIT?e.load():(il(this.m),kl(this.m,this.ib),this.ba())},S.prototype.type=vk.WEBGL;var Hl=2;S.prototype.getState=function(){return this.o},S.prototype.getState=S.prototype.getState,S.prototype.Ej=function(e,o){e=o-e;var s=Gb(2,8+this.zoom);return e<s/2?e:e-s*o/Db(o)};function Il(e,o,s){function h(j){return d[j]+Cl(d[j],o[j])/2}if(!(s&nj.POSITION||s&nj.BOUNDS))return null;var d=jl(e.m).getLookAtData();s=d.position;var g=o.position,_=o.bounds;return gh(d.bounds,g.lat,g.lng,!1)||_&&gh(_,s.lat,s.lng,!1)?null:(s=Jl(e,{tilt:h("tilt"),heading:h("heading"),incline:0,bounds:$f([s,g])}),s.zoom=rk(e,s.zoom-.5),delete s.bounds,s)}S.prototype.mr=!1;function Kl(e,o,s,h){return e=e.getCapabilities().lookAt[h],Db(h==="zoom"?s[h]-o[h]:Cl(o[h],s[h]))/(e.max-e.min)||0}function Ll(e,o,s){return e=zb(8*Kl(e,o,s,"zoom"),Kl(e,o,s,"heading"),Kl(e,o,s,"tilt")/2),ac(3e3*e,300,4e3)}S.prototype.ar=function(e){var o=this,s=e.newValue,h=e.modifiers,d=jl(this.m);this.Jg(),this.Xb.set(0,0);var g=this.Do(s);if(ik.forEach(function(_e){h&e[_e.toUpperCase()]||delete g[_e]}),e.animate){d=jl(this.m).getLookAtData();var _=Jl(this,g);s=Il(this,_,h);var j=1;jb(e.animate)&&(j=1/e.animate);var $=function(){return o.mr=!1};if(delete _.bounds,this.mr=!0,s){d=Ll(this,d,s);var _t=Ll(this,s,_);Ml(this,s,d*j,function(){return Ml(o,_,_t*j,$)})}else s=Ll(this,d,_),Ml(this,_,s*j,$)}else Nl(g),d.setLookAtData(g);Ol(this),il(this.m),this.ba()};function Jl(e,o){return Nl(o),jl(e.m).getBestLookAtData(o)}function Nl(e){var o=e.bounds;!o||o instanceof N||(e.bounds=dh(o.C()))}function Pl(e,o,s){jl(e.m).setLookAtData(o),il(e.m),Ol(e),e.ba(),s&&setTimeout(s,0)}function Ml(e,o,s,h){var d=jl(e.m).getLookAtData(),g=new Bl(d,o);g.bg.tilt+g.bg.heading+g.bg.zoom+g.kh!==0?e.ad(function(_){for(var j in g.bg)if(g.bg[j]!==0){var $=g.Dv[j](_);d[j]+=g.bg[j]*($-g.fv[j]),g.fv[j]=$}return g.kh!==0&&(d.position=g.bp.mo(g.qy,g.kh*g.Dv.position(_),!0)),Pl(e,d)},s,function(){return Pl(e,o,h)}):Pl(e,o,h)}S.prototype.Wn=function(){},S.prototype.setAnimationDuration=S.prototype.Wn,S.prototype.zp=function(){},S.prototype.getAnimationDuration=S.prototype.zp,S.prototype.Xn=function(){},S.prototype.setAnimationEase=S.prototype.Xn,S.prototype.Ap=function(){},S.prototype.getAnimationEase=S.prototype.Ap,S.prototype.Qn=function(){},S.prototype.resetAnimationDefaults=S.prototype.Qn;function Ql(e,o){e.qp.ia(function(s,h){return h.Jb()===o})}m=S.prototype,m.Nv=function(e){Ql(this,e.target.D),il(this.m),this.ba()},m.pk=function(e,o){S.g.pk.call(this,e,o),Rl(o)&&(il(this.m),(e=(e=o.D)&&e.mb())&&e.getState()===df.INIT&&e.load())},m.Uq=function(e,o,s){var h;if(this.$j=Gj(),Ql(this,o.D),o.requestDomMarkers||C(o,Bj)||C(o,xk)){var d=this.qe.ka;for(h=d.length;h--;){var g=d[h];if(g.Tb()===o){d.splice(h,1),g.l();break}}}Rl(o)&&kl(this.m,this.ib),this.af=this.ib.Sa(),e===0&&(qk(this,o,!1),this.yc()),ul(this.cl,this.Sf(),this.Pf()),this.li(),s||this.ba()};function Rl(e){return!(C(e,xk)||C(e,Bj))}m.gq=function(){var e=this.ib.Sa(),o=0,s=e.length;for(this.qe={Pe:[],ka:[]},this.af=e;o<s;o++){var h=e[o];this.pk(o,h),qk(this,h,!0)}this.yc()},m.Vq=function(){this.yc()},m.yc=function(){S.g.yc.call(this);var e=this.getCapabilities().lookAt.zoom;jl(this.m).setZoomConstraints(zb(e.min,this.zq),yb(e.max,this.yq))},m.hq=function(e,o){var s;if(o){if(e={Pd:this.tj,Ab:this.Ab},o.L?C(o,Bj)?s=new Dj(o):C(o,xk)&&(s=new Dj(o)):o.requestDomMarkers&&(s=new uj(o,e)),s){this.qe.ka.push(s);var h=this.ib.Sa();this.qe.ka.sort(function(d,g){return h.indexOf(d.yb)-h.indexOf(g.yb)}),ul(this.cl,this.Sf(),this.Pf())}Rl(o)&&kl(this.m,this.ib)}this.af=this.ib.Sa()},m.Pf=function(){return this.qe.ka.filter(ab)},m.Po=function(){return this.o===Hl},m.Do=function(e){var o=e.position;return sk(this,{zoom:rk(this,e.zoom),position:new fd(o.lat,o.lng),tilt:e.tilt,heading:e.heading,bounds:e.bounds})};function Ol(e){var o=jl(e.m).getLookAtData();e.zoom=o.zoom,e.Um=o.position}m.Fs=4007501668557849e-8;function Sl(e,o){return o=jl(e.m).geoToMeters(o),new F(o.x/e.Fs+.5,1-(o.y/e.Fs+.5))}function Tl(e,o){return o.sub(Sl(e,e.Um)).scale(Gb(2,8+e.zoom))}m.Ka=function(e){return jl(this.m).geoToPixel(e)},S.prototype.geoToScreen=S.prototype.Ka,S.prototype.Wa=function(e,o){return jl(this.m).xyToGeo(e,o)},S.prototype.screenToGeo=S.prototype.Wa,S.prototype.Un=function(e,o){return e=this.Wa(e,o),o=this.De.Ib(),o.position=e,o};function Ul(e,o,s,h,d,g,_,j){var $,_t,_e=0,_r,_i=function(){--_e===0&&g(d)};if(j&&j.features)for(_e=_t=j.features.length,_r=0;_r<_t;_r++){var _n=j.features[_r],_s=_n.id;if($=e.m.m.sources[_n.source_name]){var _l=$.provider,Ap=_l.qu();if(Ap===Je.SOURCE){var _h=_n.source_layer;if(_h==="overlays")Vl(e,o,s,h,d,$,_n.properties.overlays_config);else if($=$.getMapObjectById(_s)){if(_h!=="markers")d.push($);else if(Wl(e,o,s,$))d.push($);else if(h&&!_){var _p=!0;ml(e.m,{x:o,y:s},{radius:3.5,top_most_only:!1},function(ty){Ul(e,o,s,h,d,g,!0,ty)})}}_e--}else Ap===Je.FEATURE?(_h=_n.tile.coords,_p=_l.getFeatureProxy(_n.properties,_h,function(ty){ty&&(ty.Ww(_l),d.push(ty)),_i()}),_p||($=e.qp.get(_s),$||($=new ji(_n),$.ea(_l),e.qp.add(_s,$,1)),d.push($),_e--)):Ap===Je.PROVIDER&&(_p=!0,_l.Fw(_n,!1).then(function(ty){ty&&(!(ty instanceof Li)||Wl(this,o,s,ty))&&d.push(ty),_i()},function(){_i()},e))}}Ap&&(_p||_e!==0)||g(d)}function Vl(e,o,s,h,d,g,_){var j;for(e=e.Wa(o,s),o=_.length;o--&&(!(j=g.getMapObjectById(_[o].id))||0<=d.indexOf(j)||!j.V().Ff(e)||(d.push(j),!h)););}function Wl(e,o,s,h){var d=h.kc(),g=d.Am,_,j=!g;if(g)if(d=d.Db,o+=d.x,s+=d.y,d=h.V(),C(d,mg))for(h=d.ha,_=h.length;_--&&!j;)d=e.Ka(h[_]),j=g.Bm(o-d.x,s-d.y,0)!==cc.NONE;else d=e.Ka(d),j=g.Bm(o-d.x,s-d.y,0)!==cc.NONE;return j}S.prototype.La=function(e,o,s,h){var d=this,g=[];g=this.Mp(g,this.qe.ka,e*this.ja,o*this.ja,s),s&&g.length?h(g):this.m.m.initialized?ml(this.m,{x:e,y:o},{radius:3.5,top_most_only:s},function(_){Ul(d,e,o,s,g,h,!1,_)}):h(g)},S.prototype.getObjectsAt=S.prototype.La,m=S.prototype,m.Mp=function(e,o,s,h,d){for(var g=o.length,_;g--&&!((_=o[g])&&_.La&&(e=e.concat(_.La(s,h,d)),e.length&&d)););return e},m.xe=z,m.Sf=function(){var e=this.rl[2];return{w:e.right-e.left,h:e.bottom-e.top}},m.mg=function(){var e=this.qe.ka.length;ok(this,this.ja),this.Xb.set(0,0);var o=this.Sf(),s=o.w,h=o.h;for(this.m.m.handleViewportUpdate();e--;){o=this.qe.ka[e].Pb;var d=o.mc();d.w===s&&d.h===h||o.Uk(s,h)}this.xe=new Hi(s,h),il(this.m),this.ba()},m.getCapabilities=function(){return wk},S.prototype.getCapabilities=S.prototype.getCapabilities,m=S.prototype,m.Lk=function(){this.sa&&this.sa.R||(hl(this.m)||Gj()-this.$j<this.Kg)&&!this.ne?this.rh||(this.rh=Ej(this.vg)):(this.ne&&(this.li(),this.pj()),this.o=Hl)},m.rh=0,m.li=function(){this.qe.Pe.length=0},m.vg=function(){this.rh=0,this.ef&&this.ef.before();var e=jl(this.m),o=e.getLookAtData(!1),s=e.getLookAtData(!0);e=this.ya.center.clone(),s=s.bounds.C();var h=this.zoom,d=this.Xb,g=this.af,_=g.length;for(this.Kg=Gl;_--;){var j=g[_];C(j,Tf)&&j.D&&j.D.xk(s,h)}this.ne=this.m.L(),this.De.rb(o),this.ne=this.Ln(s,e,h,!1,d,this.qe)&&this.ne,this.xe&&(this.ya.rb(this.xe),this.xe=z),this.sa&&this.sa.R&&this.Fo(),this.ef&&this.ef.after(),this.Lk()},m.Ln=function(e,o,s,h,d,g){var _=g.ka.length,j=!0,$;for($=0;$<_;$++){var _t=g.ka[$],_e=g.Pe;if(_t){var _r=_t.L(e,o,void 0,s,h,d,this.Ka,this.m.m.getCameraMatrix());_r===oj.ACTIVE&&(this.Kg=1/0),_r!==oj.DONE||_e[$]||(this.pj(_t.Tb()),_e[$]=!0),_e[$]||(j=!1)}}return j},m.pj=function(e){this.mr||setTimeout(A(this.dispatchEvent,this,{type:this.j.Us,target:e||this}),1)},m.disposeInternal=function(){var e=this.ib.Sa()[0],o=this.ya;Fj(this.rh),this.bd(!0),e&&qk(this,e,!1),this.Pf().forEach(function(s){s.l()}),o.element&&o.element.removeChild(this.qc),delete this.qc,this.o=3,this.m.l(),S.g.disposeInternal.call(this)},m.ba=function(){this.$j=Gj(),this.Po()&&(this.ne=!1,this.o=1,this.Lk())},m.zc=function(e,o){this.Sg(e,o),this.Xb.set(0,0),il(this.m),this.ba()},m.Sg=function(e,o){jl(this.m).applyPxOffset([e,o]),Ol(this)},m.Ng=function(e,o,s){e=rk(this,rk(this,e)),this.sb(e,o,s)},S.prototype.zoomAt=S.prototype.Ng,S.prototype.sb=function(e,o,s){jl(this.m).setLookAtData({zoom:e},jb(o)&&jb(o)?[o,s]:B),Ol(this),il(this.m),this.ba()},S.prototype.Jg=function(){this.bd(!0),this.T.R&&this.hc(!0),this.ma.R&&this.ic(!0)},S.prototype.Rk=function(e){if(e){var o={};o.wk=e.power,o.sj=e.ease,o.duration=e.duration,this.ta=o}},S.prototype.Id=function(e,o){var s=!!(o||e&(Kj.HEADING|Kj.TILT));this.Jg(),this.Rk(o),this.ma.start(e,s),jl(this.m).setPanning(!0)},S.prototype.startInteraction=S.prototype.Id,S.prototype.vd=function(e,o,s,h,d){var g=this.ma,_=!1;if(g.R){var j=jl(this.m),$=j.getLookAtData(),_t=this.ya.center;_t=[_t.x,_t.y],o=g.store(e,o,s,h,d),s=g.im(),e=g.Ah(),h=this.ma.jm(),d=this.ma.Bp(),g.Jh&&(g.$d(Kj.TILT)&&(j.setLookAtData({tilt:tk(this,$.tilt+e.y/this.ya.height*-180)},_t),_=!0),o&&h!==1&&g.$d(Kj.ZOOM)&&(_=g.im(),this.sb(rk(this,Eb(Gb(2,this.zoom)*h)/Ob),_.x,_.y),_=!0),g.$d(Kj.COORD)&&0<Ij(e)&&(this.zc(-e.x,-e.y),_=!0),g.$d(Kj.HEADING)&&(o?j.setLookAtData({heading:$.heading+uk(this,d)},[s.x,s.y]):e.x&&j.setLookAtData({heading:uk(this,$.heading+e.x/this.ya.width*360)},_t),_=!0),_&&(il(this.m),this.ba()))}},S.prototype.interaction=S.prototype.vd,S.prototype.ic=function(e){var o=this;if(this.ma.R&&!e){if(this.ta){e=this.ma.nc();var s=this.ma.Mf(),h=this.ta.duration,d=(this.ta.wk||1)*e,g=new Fl(-d/(0<h?h:1),d);!E(s.x)&&!E(s.y)&&0<d&&o.ma.$d(Kj.COORD)&&this.ad(function(_){d=g.Hj(_*h),E(d)||o.zc(Ab(-s.x*d),Ab(-s.y*d))},h,void 0,this.ta.sj)}delete this.ta,this.ma.clear()}jl(this.m).setPanning(!1),this.ba()},S.prototype.endInteraction=S.prototype.ic,S.prototype.Hd=function(e,o,s){this.Jg(),this.T.start(o,s),this.Rk(e),jl(this.m).setPanning(!0)},S.prototype.startControl=S.prototype.Hd,S.prototype.control=function(e,o,s,h,d,g){for(var _=0,j;_<arguments.length;_++)if(j=+arguments[_],j!==j)throw new D(this.control,_,j);this.T.R&&this.T.set(e,o,s,h,d,g)},S.prototype.control=S.prototype.control,S.prototype.hc=function(e,o){var s=this,h;if(this.T.R){this.bd(!0);var d=Gj(),g=d-this.jj;if(1<=g){var _=rl(this.T);this.Qi(_,g)}if(!this.ta||e||o)typeof o=="function"&&(e=jl(this.m),e=e.getLookAtData(),o(e),this.Go(e));else{o=this.T.nc();var j=this.T.Mf(),$=this.ta.duration,_t=(this.ta.wk||1)*o,_e=new Fl(-_t/(0<$?$:1),_t);!E(j.Lb)&&!E(j.Mb)&&0<_t&&this.ad(function(_r,_i,_n,_s){d&&(_n=_s-d,d=0),_t=_e.Hj(_r*$)*_n,E(_t)||((h=j.Nb*_t)&&s.sb(rk(s,s.zoom+h),s.T.Ug,s.T.Vg),s.zc(Ab(j.Lb*_t),Ab(j.Mb*_t)))},$,void 0,this.ta.sj)}this.T.reset(),jl(this.m).setPanning(!1),this.ba()}},S.prototype.endControl=S.prototype.hc,m=S.prototype,m.Go=function(e){var o=this,s=Tl(this,Sl(this,e.position)),h=s.y;s=s.x;var d=e.zoom,g=Tl(this,Sl(this,this.Um));e=g.y;var _=g.x;g=this.zoom;var j=this.T.nc(),$=this.T.Ug,_t=this.T.Vg,_e=0;if(s=this.Ej(_,s),s-=_,h-=e,g=d-g,e=Fb(s*s+h*h+g*g),j!==0&&e!==0){var _r=s/e,_i=h/e,_n=g/e,_s=j*j/(2*e);this.ad(function(_l,Ap){var _h;_l!==1?(_l=j*Ap-_s*Ap*Ap/2,Ap=_l-_e,(_h=_n*Ap)&&(_h=rk(o,o.zoom+_h),o.sb(_h,$,_t)),o.zc(Ab(_r*Ap),Ab(_i*Ap)),_e=_l):(o.sb(rk(o,d),$,_t),o.ba())},2*e/j)}},m.fg=function(e){var o=this,s=e.mt;this.Xb.set(0,0),s.Lb||s.Mb||s.Nb||s.mi||s.ni||s.Jk?(this.jj=Gj(),this.ad(function(h,d,g,_){o.jj=_,o.Qi(s,g)},Wb),this.ba()):this.bd(!0)},m.Qi=function(e,o){o=o||0;var s=this.T,h=jl(this.m),d=h.getLookAtData();e.Nb&&this.sb(rk(this,d.zoom+e.Nb*o),s.Ug,s.Vg),h.setLookAtData({heading:uk(this,d.heading+e.ni*o),tilt:tk(this,d.tilt+e.mi*o)}),Ol(this),this.zc(e.Lb*o,e.Mb*o)},m.ad=function(e,o,s,h){this.sa&&this.sa.R&&this.sa.stop(!0),this.sa=new El(this,e,o,s,h),this.sa.start()},m.bd=function(e){this.sa&&this.sa.R&&this.sa.stop(e)},m.kp=function(){},S.prototype.enter=S.prototype.kp,S.prototype.pp=function(e){pk(this.qc,e)},S.prototype.exit=S.prototype.pp,S.prototype.capture=function(e,o,s,h){var d=this;return nl(d.m).then(function(g){var _=d.qc.ownerDocument.createElement("canvas"),j=d.ja,$=_.getContext("2d"),_t=d.m.lb()/j,_e=(s-e)*j;return j*=h-o,_.width=_e,_.height=j,$.drawImage(g,e*_t,o*_t,_e*_t,j*_t,0,0,_e,j),_})},S.prototype.mz=function(e){return jl(this.m).geoToMeters(e)},S.prototype.geoToMeters=S.prototype.mz,S.prototype.CB=function(e){return jl(this.m).metersToGeo(e)},S.prototype.metersToGeo=S.prototype.CB;var Gl=5e3;function Xl(){}t("H.util.ICapturable",Xl),Xl.prototype.capture=function(){},Xl.prototype.capture=Xl.prototype.capture;function Yl(e,o){var s=e.A(),h=s.ownerDocument;Yl.g.constructor.call(this),this.u=e,this.G=s=s.appendChild(Zl(h,"DIV","position:absolute;bottom:0;right:0;left:0px;z-index:1;direction:ltr;pointer-events:none;height:40px-webkit-touch-callout: none;-webkit-user-select:none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select:none;",null,"H_imprint")),this.Gl=Zl(h,"DIV","margin: 0 0 16px 16px;display:inline-block;",'<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>',"H_logo"),s.appendChild(this.Gl),s=s.appendChild(Zl(h,"DIV","right:0;bottom:0;position:absolute;background-color:rgba(255,255,255,.8);color:#0F1621;padding:2px 16px",null,"H_copyright")),this.ho=s.appendChild(Zl(h,"A","color:inherit; margin:0px 8px; text-decoration:none; pointer-events:all;","Terms of use")),this.ho.target="_blank",this.ho.tabIndex=1,this.Ul=s.appendChild(Zl(h,"SPAN","margin:0px 8px")),this.cg=s.appendChild(Zl(h,"SPAN")),this.bv=Na($l),this.Ur(o),this.Di=A(this.Di,this),this.fe=A(this.fe,this),this.u.addEventListener(this.u.j.Os,this.Di),this.u.O.addEventListener("add",this.fe),this.u.O.addEventListener("remove",this.fe),this.u.O.addEventListener("set",this.fe),this.fe()}var am;u(Yl,hc),t("H.map.Imprint",Yl);var $l={font:'11px "Lucida Grande", Arial, Helvetica, sans-serif',href:"https://legal.here.com/{LN}/terms/serviceterms/{CN}",invert:!1,reportHref:"https://wego.here.com/",locale:"en-US",mark:""};Yl.prototype.Ur=function(e){var o,s=this.Gl.firstElementChild.firstElementChild.children;e||(this.bv=Na($l));var h=this.bv;for(o in h)e&&o in e&&(h[o]=e[o]);e=(this.oq=e=h.invert)?bm:cm,s[0].style.fill=e.ax,s[0].style.fillOpacity=""+e.bx,s[1].style.fill=e.ox,s[1].style.fillOpacity=""+e.px,e=h.locale,dm[e]||(e="en-US",h.locale=e),this.ho.innerHTML=dm[e],e=e.split("-"),this.ho.href=h.href.replace("{LN}",e[0]).replace("{CN}",e[1].toLowerCase()),h.mark?(this.cg.innerHTML=h.mark,this.cg.style.margin="0px 8px"):(this.cg.innerHTML="",this.cg.style.margin="0px"),this.G.style.font=h.font},Yl.prototype.setOptions=Yl.prototype.Ur;function Zl(e,o,s,h,d){return e=e.createElement(o),s&&(e.style.cssText=s),h&&(e.innerHTML=h),d&&(e.className=d),e}Yl.prototype.A=function(){return this.G},Yl.prototype.Di=function(){this.Ul.innerHTML=this.Gs+" "+this.U()},Yl.prototype.fe=function(){this.Di(),setTimeout(this.Di,5e3)};var cm={ox:"#0F1621",px:.3,ax:"#fff",bx:.6},bm={ox:"#fff",px:1,ax:"#0F1621",bx:.7},em="1987&ndash;"+zb(2015,new Date().getFullYear())+" HERE";Yl.prototype.U=function(){var e=this.u,o=e.Ub(),s=e.wa.Ib().bounds;e=e.O;var h=e.aa.length,d={},g=0,_,j,$,_t=[em];if(s){for(;g<h;g++)if(j=e.get(g).getCopyrights(s.C(),o))for(_=0;_<j.length;_++)d[$=j[_].label]||(_t.push($),d[$]=1)}return _t.join(", ")},Yl.prototype.getCopyrights=Yl.prototype.U,Yl.prototype.J=function(){return this.G.style},Yl.prototype.Gs="",Yl.prototype.disposeInternal=function(){if(this.u.removeEventListener(this.u.j.Os,this.Di),this.u.O.removeEventListener("add",this.fe),this.u.O.removeEventListener("remove",this.fe),this.u.O.removeEventListener("set",this.fe),this.G.parentNode){var e=this.G;e.parentNode.removeChild(e)}},Yl.prototype.disposeInternal=Yl.prototype.disposeInternal,Yl.prototype.capture=function(e,o,s,h){var d=e.getContext("2d"),g=window.getComputedStyle(this.Ul.parentElement),_=2*hb(g.paddingLeft,10),j=(this.Ul.offsetWidth+2*_)*o,$=this.Ul.offsetHeight*o,_t=this.cg.innerHTML.length!==0?this.cg.offsetWidth*o:0,_e=ib(g.getPropertyValue("font-size")),_r=this.G.ownerDocument,_i=+e.width,_n=+e.height,_s=16*o,_l=this.Gl.childNodes[0].getBoundingClientRect(),Ap=_l.width*o,_h=_l.height*o,_p=ze;Za(h)&&(_p=function(){h("capture_error")}),d.fillStyle=g.backgroundColor,d.fillRect(_i-j-_t,_n-$,j+_t,$),j=this.cg.innerHTML,j=this.Gs+" "+function(ty){return ty=Zl(_r,"div",null,ty),ty.textContent||ty.innerText||""}(this.U())+(j?" "+j:""),d.font=_e*o+"px "+g.getPropertyValue("font-family"),d.fillStyle=g.getPropertyValue("color"),d.textBaseline="bottom",d.textAlign="right",d.fillText(j,_i-_*o,_n),fm(this,d.font,function(ty){new Ue("image",ty).then(function(ry){d.drawImage(ry,_s,_n-(_h+_s),Ap,_h),s(e)},_p)},_p)},Yl.prototype.capture=Yl.prototype.capture;function fm(e,o,s,h){gm(A(function(d){d?this.oq?s("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAADNklEQVRYR82XW6hVVRSGv7+rmJfSMKSnSkMEfY7EogcJC7tilGRopBAiSaI+SBARQSCIIqgFISih2YW0oAgLCsKXojA0RB+81VugZEFZv/yHuWTt7d7Hfc4+6+h4OWefNfcc3xlj/v+YS1zjoab5bE8DZgGngB8keSg5GwO0PQ54F3i2BnQIWCLpx14hGwG0fT3wOfBwB5DzwOOSDvQC2RTgM8Ae4D/gaeA3YDdwN5AWvyxp+6gD2r4OmAq8AbwInAMmA/OAT4CbgBWStvYClzUjWkHbrwHLgF8LVHJ8DDxah7P9JHCil7M40oA/A7OBC8ANtSqlrQOVs30/8CWQat8r6cxg1RwRQNvPA88Bk4D7gJzBV4A5teSp5MlS4VuA/ZIeu1Kr+wa0/QTwIRDlRhT5eTswBvi2CKOd42AULilndNAYCcA7gK+BmbVMiyXtsh3Qt4FFBTgW8w6wXtLfV4LrSyS2FwAvAWOBX+JtwF0laUDmS/oun23fDNwJnJb0Ty9g1ZphVdB2qrK2LdFfBbb685/AIxXkUKDqa4cMaDs2kjalRe8Fola57J3qRQSJviGHA3gMuAdYI2lDUfDOArQLWAd8VTuTOW9vjUoFy6TIGYpS9wKfAjuK5wVuSfn91iKcvZJeHy5ci0hsZwzNk5Qh3xIFbLyks7aPAtPLgv+L4VZwDwLvA6uKz6XdfcVAi22PBz4q4+lVSRurXW2vKYKIZfwEHCmmXC35HngAyITYD0ys2t8XWflyBfhmvKm24QCk7aVFCPVc7WMszzKucknI+NoHPCUppt13VICZm2nNwjoksByY0SXL72Vi3FieZ97mgrpyqF432H9xScW2O0H+W6oSE/4D2FYuA9kzlUzVTwO3Ad9IOtx3ydo2aLGZLpABm5KW2Z4AfAbMLfsEcpGkKLqRuMwHu0CukrSpCCrvGlF6hBEVL5MUw24kOhp1B8gc+FTqgxpkFLuzSbjk6jpJOkC2tDPeKCkVbDRkO67fDTTC2VK7vgfyBUlfNEpV2zyAK4HNXRLmZfshScdHC6g9T+WDGU2XpkdZdNXhWs6g7dXAhmsJ7jKR2M77bG4kV7Wt9TZfBLgYEC7PSpcIAAAAAElFTkSuQmCC"):s("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAeCAYAAABe3VzdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAIMSURBVFiFzdZPiE1RGADwXzPTTPIMQoodVpbKgpoUG5qExUi8DSVJQv4slJJsbNjYWFhNETWLUUosRDRLUVLCYhIiojFojHkW997uvefNGIuZc99Xp/fOO6/Or++c75xDi0d7hDlWYQNqeB9hvv+OGq6jUWjPsKZKVBbtuKOMy9p3bKqOlsROCWYc27AWr9PfJnCgKlgbluNqivmGDmzBrxR3sCocnMEw7sqXdEAzboeK9uLTFPVbed8VcesxglFJtqNEHbcxlIL68ChADuCSpEgauBULt11SDI3C5yJJdrLCCNsQumMBl+J5AKinY4slBfNTfsRcxJwYsK0YxD3J0r1RPut6Cv/twgp0xoDBBc3LNhr0RwJktNifAn7gsnLmsuxVinyVTn4i7dcLoH4sU96Tp2Pi2uSVehN75Gdev+QO7pIXztmZnLwTvf+AzU+/v5Rn50+A24gP2IW5M4mbJ7+ejgVjJ/EpHXuCa8p77nGK68FX5eWfsTgfTJoh92qu1vAaa+CtPJuDZuEh3CHZUyHyxSSYrL3DWKE/gStm8aybDDkmKYperJM/BrJMnsJuHMLq2YJNh/wsX7JuPAyQfTFg0yGPFMZreCCv4n2xgTQjxyXP+CxquK8iXBYhMlzOtliQBVg4RVuCG/iSto/YHAuWxWFTHyXDWBkbNFkc1cK4LI5rYVwW57QY7i/pZeJv8QQJRQAAAABJRU5ErkJggg=="):(d=this.Gl.cloneNode(!0),d.firstChild.setAttribute("style","font:"+o),s(te(d.innerHTML)))},e),h)}Yl.prototype.oq=!1;function gm(e,o){var s="data:image/svg+xml;charset=utf-8,"+encodeURIComponent('<svg height="40" viewBox="0 0 47 40" width="47" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m45.2054149 8.82876345.6003191.40637037-.2240425.6914074-.4490426 1.38570368c-.1024468.3148889-.6998936 1.9596297-2.43 3.5918519l-.017234.0163704c-.188617.1887407-.3801064.3659259-.5467021.5084444l-.4605319.4285185-.486383.4516296-.1407447-.0702963c-.7257447.4583704-1.4926596.7886667-2.2796809.9831852l.5840426.5864445-.6769149.6817778-2.052766 2.0636296-.169468.1704444-.019149.0192593-2.3821276 2.3958518c-.4902128.8493334-1.1202128 1.6331852-1.8497873 2.3111112-.6031915.6047407-1.2504255 1.1054814-1.935 1.4954814l-.4777659.4805186-4.3247873 4.3506666-.0296808.0298519-.0315958.0269629-2.1532978 1.8171111-.2661702.2253334h-.3485107-3.8948936l-3.968617 3.9914815-1.3547873 1.3616296-.6769148.6808148-.6769149-.6808148-1.3538298-1.3616296-4.80925535-4.837926-3.2687234-3.2875555-1.63436171-1.6437778h2.3112766 4.62255319 2.67223407l-4.71063832-4.7368148-.6769149-.6808148.6769149-.6808148 4.93851062-4.9650371.6769149-.6798518.6769149.6808148 2.7296809 2.7454074c.9363829-.8820741 2.1485106-1.4685185 3.4037234-1.6562963.278617-1.4694815 1.0187234-2.834963 2.168617-3.9885926.5696808-.572 1.1843617-1.0438519 1.8335106-1.4107407l.2901064-.2917778 4.3094681-4.31985187c.5830851-1.0582963 1.4256383-1.78918519 2.0364893-2.12718519l.4471277-.24748148c.3829787-.7617037.9047872-1.47622222 1.5539362-2.12622222 1.510851-1.51666667 3.3165957-2.31881482 5.22-2.31881482.0871276 0 .1752127.00192593.2594681.00577778 1.9484042.06933334 3.8441489.97933334 5.4775532 2.62792593.1512765.15022222.3303191.34859259.5361702.5797037l.0526595.05874074c.1120213.12518519.2345745.26192593.370532.40733334l1.2657446 1.36066666.6328724.67985185-.6548936.65866667-.2508511.25325926zm-27.9288192 22.17414815h-9.57446804l4.78723404 4.8148148zm23.1864894-21.70422223c-.9220213 1.38666663-2.5180851 3.63037033-4.1984042 1.94133333l4.2510638-4.27651851c-.3810638-.41022222-.6711702-.754-.8923404-.97740741-2.2921277-2.31207407-4.8743617-2.34192593-6.8984043-.312-1.3528723 1.35681481-1.7071277 2.91007407-1.313617 4.38533332l-1.332766-1.52629628c-.385851.21474074-2.0182979 1.65918518-.7937234 3.84703708l-1.5252127-1.274963-2.0240426 2.0299259 2.7344681 2.7502222c-2.1121277-1.6861481-4.3889362-1.5205185-6.2157447.312-1.9560638 1.9615556-1.8181915 4.3381482-.3532979 6.293926l-.295851-.2946667c-1.9321277-1.9432593-4.0318085-1.2576296-5.0706383-.2128148-.8023405.8079259-1.2944681 1.9191852-1.0924468 2.6905185l-4.195532-4.2187407-2.22893613 2.2408148 8.25893613 8.3065185h4.4339362l-2.9767021-2.9938519c-.5893908-.6029568-.9604155-1.0987731-1.1531529-1.5232627-.3182349-.7008886-.1504161-1.2073234.3230465-1.680515.7334043-.7318519 1.583617-.2763704 3.0829787 1.2277777l2.9412766 2.9562963 2.2164894-2.2292592-2.7909575-2.8060741c2.0125532 1.5291852 4.4224468 1.612 6.5728724-.545037 1.3567021-1.2653334 1.7425532-2.4565185 1.7425532-2.4565185l-1.6755319-1.1314815c-.9229788 1.3866666-2.5152128 3.6361481-4.195532 1.9461481l4.2606383-4.2851852 2.655 2.6712593 2.3160639-2.3294074-3.3223405-3.3424445c-1.5520212-1.5609629-.6328723-3.0275555.0124469-3.5793333.3025531.6442222.7448936 1.2624445 1.3078723 1.8296296 2.1485106 2.1676297 4.9260638 2.6038519 7.3685106.1550371 1.3567022-1.2643704 1.7425532-2.4565185 1.7425532-2.4565185zm-3.6564894-1.35537321-2.0211702 2.03377777c-.9890425-1.18251851-.9392553-1.81422222-.3245744-2.43051851.7439361-.7462963 1.4993617-.43044445 2.3457446.39674074zm-12.4879787 12.56088884c-.9890425-1.1825185-.9411702-1.819037-.3284042-2.4353333.7448936-.7462963 1.5003191-.4304444 2.3467021.3967408z" fill="#0f1621" fill-opacity=".7"/><path d="m17.2765957 31.0029116-4.787234 4.8148148-4.78723404-4.8148148zm23.1864894-21.70422223 1.6755319 1.13148153s-.385851 1.1921481-1.7425532 2.4565185c-2.4424468 2.4488148-5.22 2.0125926-7.3685106-.1550371-.5629787-.5671851-1.0053192-1.1854074-1.3078723-1.8296296-.6453192.5517778-1.5644681 2.0183704-.0124469 3.5793333l3.3223405 3.3424445-2.3160639 2.3294074-2.655-2.6712593-4.2606383 4.2851852c1.6803192 1.69 3.2725532-.5594815 4.195532-1.9461481l1.6755319 1.1314815s-.3858511 1.1911851-1.7425532 2.4565185c-2.1504256 2.157037-4.5603192 2.0742222-6.5728724.545037l2.7909575 2.8060741-2.2164894 2.2292592-2.9412766-2.9562963c-1.4993617-1.5041481-2.3495744-1.9596296-3.0829787-1.2277777-.4734626.4731916-.6412814.9796264-.3230465 1.680515.1927374.4244896.5637621.9203059 1.1531529 1.5232627l2.9767021 2.9938519h-4.4339362l-8.25893613-8.3065185 2.22893613-2.2408148 4.195532 4.2187407c-.2020213-.7713333.2901063-1.8825926 1.0924468-2.6905185 1.0388298-1.0448148 3.1385106-1.7304445 5.0706383.2128148l.295851.2946667c-1.4648936-1.9557778-1.6027659-4.3323704.3532979-6.293926 1.8268085-1.8325185 4.103617-1.9981481 6.2157447-.312l-2.7344681-2.7502222 2.0240426-2.0299259 1.5252127 1.274963c-1.2245745-2.1878519.4078724-3.63229634.7937234-3.84703708l1.332766 1.52629628c-.3935107-1.47525925-.0392553-3.02851851 1.313617-4.38533332 2.0240426-2.02992593 4.6062766-2.00007407 6.8984043.312.2211702.22340741.5112766.56718519.8923404.97740741l-4.2510638 4.27651851c1.6803191 1.689037 3.2763829-.5546667 4.1984042-1.94133333zm-16.1444681 11.20551563 2.0182979-2.0385925c-.846383-.8271852-1.6018085-1.1430371-2.3467021-.3967408-.612766.6162963-.6606383 1.2528148.3284042 2.4353333zm12.4879787-12.56088884c-.8463829-.82718519-1.6018085-1.14303704-2.3457446-.39674074-.6146809.61629629-.6644681 1.248.3245744 2.43051851z" fill="#fff" fill-opacity=".3"/></g></svg>'),h=am;ab(h)?e(h):new Ue("image",s).then(function(d){pe.drawImage(d,0,0);try{pe.getImageData(0,0,1,1),h=!1}catch(g){h=g.code===18}finally{am=h,e(h)}},o)}Yl.prototype.hy=function(e,o){dm[e]=o},Yl.prototype.addL11NString=Yl.prototype.hy;var dm={"de-DE":"Nutzungsbedingungen","en-US":"Terms of use","en-GB":"Terms of use","es-ES":"Condiciones de uso","fi-FI":"Palveluehdot","fr-FR":"Conditions d'utilisation","it-IT":"Condizioni di utilizzo","nl-NL":"Dienstvoorwaarden","pl-PL":"Warunki wiadczenia usugi","pt-BR":"Termos de servio","pt-PT":"Termos do servio","ru-RU":" ","tr-TR":"Servis Koullar","zh-CN":""};function hm(e,o,s,h,d,g){hm.g.constructor.call(this,isNaN(e)?15:e,o,s,h,d,g)}u(hm,zg),hm.prototype.Ll=function(e){for(var o,s,h=this.head,d=e;d;){if(e=d.entries){if(o=e.length){if(2>o&&(s=d.parent)&&s.hb===1){s.removeChild(d),h===d&&(h=s),s.entries=e,d=e[0].node=s;continue}}else if(delete d.entries,(s=d.parent)&&(s.removeChild(d),h===d&&(h=s),s.hb===1)){d=s.hb?s[0]||s[1]||s[2]||s[3]:null;continue}}break}this.head!==h&&(this.head=h,this.jd())},hm.prototype.Yd=function(e,o){if(Gg(this.root,e,o,e,o))return this.Vb(this.root,e,o,this.Ph);throw Error("Coordinates out of bounds")},hm.prototype.Vb=function(e,o,s,h){var d=e.entries;if(h)if(e.hb)d=this.Sj(e,o,s,h);else if(d){d=d[0];var g=e.th(+(d[1]>=e[8])|+(d[0]>=e[9])<<1);g.entries=e.entries,delete e.entries,d.node=g,this.jd(g),d=this.Sj(e,o,s,h)}else e.Qg(d=new im(o,s)),this.jd(e),Cg(this,d,!0);else d||this.jd(e),e.Qg(d=new im(o,s)),Cg(this,d,!0);return d},hm.prototype.Sj=function(e,o,s,h){return this.Vb(e.th(+(o>=e[8])|+(s>=e[9])<<1),o,s,h-1)};function im(e,o){this.id=Fg++,this[0]=o,this[1]=e}im.prototype.Nf=function(e){return this[e%2]};function jm(){this.Ae=new hm(10,180,90,0,0,!0)}m=jm.prototype,m.jc=0,m.I=null,m.C=function(){var e=this.I,o;return!e&&(o=Ag(this.Ae))&&(this.I=e=new J(-o[0],o[3],-o[2],o[1])),e},m.Yd=function(e){return++this.jc,this.I=null,this.Ae.Yd(e.lng,-e.lat)},m.remove=function(e){return(e=this.Ae.remove(e))&&(--this.jc,this.I=null),e},m.Fm=function(e,o,s){var h=this.Ae,d=e.Lc(),g=e.Jc(),_=-d.lat;d=d.lng;var j=-g.lat;return g=g.lng,e.pc()?h.ob(-180,_,g,j,s,o).concat(h.ob(d,_,180,j,s,o)):h.ob(d,_,g,j,s,o)};function km(e,o,s){var h="anonymous",d=1;this.Wg=A(this.Wg,this),O.call(this,s),this.X(e),s&&(e="crossOrigin",e in s&&(h=s[e]),e="opacity",e in s&&(d=s[e])),this.Rw(o,h),this.Ed(d)}u(km,O),t("H.map.Overlay",km),km.prototype.type=ni.OVERLAY,km.prototype.C=function(){return this.I},km.prototype.getBoundingBox=km.prototype.C,km.prototype.si=function(e){return C(e,J,this.si,0,e),this.X(e)},km.prototype.setBoundingBox=km.prototype.si,km.prototype.V=function(){return this.I},km.prototype.getGeometry=km.prototype.V,km.prototype.X=function(e){var o=this.I,s=!o;return C(e,J,this.X,0,e),(s||!o.da(e))&&(this.I=e,s||this.qa(li.SPATIAL)),this},km.prototype.setGeometry=km.prototype.X,km.prototype.Se=function(){return this.gb.getData()},km.prototype.getBitmap=km.prototype.Se,km.prototype.Rw=function(e,o){var s=this.gb;return s&&s.getState()!==1&&s.cancel(),this.gb=new yk(e,this.Wg,!0,B,o),this},km.prototype.setBitmap=km.prototype.Rw,km.prototype.Wg=function(e,o){this.gb=o,e===1&&this.qa(li.VISUAL)},km.prototype.Ue=function(){return this.Qc},km.prototype.getOpacity=km.prototype.Ue,km.prototype.Ed=function(e){var o=this.Qc,s=2>o;if(e-=0,0<=e&&1>=e)e!==o&&(this.Qc=e,s&&this.qa(li.VISUAL));else throw new D(this.Ed,0);return this},km.prototype.setOpacity=km.prototype.Ed,km.prototype.P=function(){var e=km.g.P.call(this);return e.geometry=dh(this.I).P(),e.properties.overlay=!0,e},km.prototype.forWorkerMessage=km.prototype.P;function lm(e){var o;bb(this,lm),lm.g.constructor.call(this,e),this.Wf=e=[];for(o in ni)e[ni[o]]=new ki}u(lm,L),t("H.map.provider.ObjectProvider",lm),lm.prototype.qr=xe,lm.prototype.providesByViewport=lm.prototype.qr,lm.prototype.Kc=function(e){return this.Wf[e||ni.ANY]},lm.prototype.getInvalidations=lm.prototype.Kc,lm.prototype.Hh=function(e,o){if(o!==li.NONE){var s=this.Wf[ni.ANY],h=s.Ld+1;s.update(h,o),s=this.Wf[e.type],s.update(h,o),e.Kc().update(h,o),this.jb(e)}},lm.prototype.invalidateObject=lm.prototype.Hh,lm.prototype.requestOverlays=lm.prototype.wg,lm.prototype.requestSpatials=lm.prototype.Nn,lm.prototype.requestSpatialsByTile=lm.prototype.On,lm.prototype.tw=!1,lm.prototype.requestMarkers=lm.prototype.pe,lm.prototype.requestDomMarkers=lm.prototype.oe;function mm(e,o){mm.g.constructor.call(this,!1,o),this.X(e)}u(mm,vi),t("H.map.Polyline",mm),mm.prototype.C=function(){return this.Hb.C()},mm.prototype.getBoundingBox=mm.prototype.C,mm.prototype.X=function(e){var o=this.X,s,h;if(C(e,lh)){var d=e.ha;if(s=d.length)for(h=0;h<s;h++)nm(d[h],o);else throw new D(o,0)}else nm(e,o);return this.Uf=!!d,this.Hb=e,this.qa(li.SPATIAL),this},mm.prototype.setGeometry=mm.prototype.X,mm.prototype.V=function(){return this.Hb},mm.prototype.getGeometry=mm.prototype.V,mm.prototype.clip=function(e){var o=this.Hb;return bh(this.Uf?o.ha[0]:o,e)},mm.prototype.clip=mm.prototype.clip,mm.prototype.xh=function(e){var o=this.Hb,s,h=[];if(this.Uf)for(o=o.ha,s=o.length;s--;)om(this,o[s],e,h);else om(this,o,e,h);return h.length?h:B},mm.prototype.getGeometriesForTile=mm.prototype.xh;function nm(e,o){if(!C(e,M)||2>e.Mj())throw new D(o,0)}function om(e,o,s,h){var d=bh(o,s.nm());if(d.length&&(o=s.pm(),e=wi(e,d,!1,o),d=e.length)){var g=s.Pj();o=o.w,s.x||yi(e,d,-o),s.x===(1<<s.z)-1&&yi(e,d,o),s=ng(e,g.left,g.top,g.right,g.bottom,!1),s.length&&h.push(new Xh(s))}}mm.prototype.P=function(){var e=mm.g.P.call(this),o=e.properties;return e.geometry=this.V().P(),o.style=this.J().P(),o.height=0,e},mm.prototype.forWorkerMessage=mm.prototype.P;function T(e){var o={};this.Eu=o.previousSibling=o.nextSibling=o,this.fD=new ue,T.g.constructor.call(this,e),e&&"objects"in e&&this.hd(e.objects)}u(T,O),t("H.map.Group",T),T.prototype.type=ni.GROUP,T.prototype.ti=function(e,o){return this.lr=!0,e=T.g.ti.call(this,e,o),this.lr=!1,e&&this.forEach(pm,!0),e},T.prototype.setProvider=T.prototype.ti;function pm(e,o,s){e.ti(s.D)}T.prototype.contains=function(e){var o=this===e;if(!o&&this.ah&&C(e,O))for(;!o&&e;)e===this?o=!0:e=e.Ma;return o},T.prototype.contains=T.prototype.contains,T.prototype.Hk=function(){this.qo=B,this.forEach(qm,!0)},T.prototype.resetZInfo=T.prototype.Hk;function qm(e){e.Hk()}T.prototype.lr=!1,T.prototype.qa=function(e){var o=T.g.qa.call(this,e);return o&&!this.lr&&(this.Zt=e,this.forEach(rm,!0),delete this.Zt),o},T.prototype.invalidate=T.prototype.qa;function rm(e,o,s){e.qa(s.Zt)}T.prototype.forEach=function(e,o,s){var h;if(this.ah){var d=this.Eu,g=d.nextSibling;for(h=0;g!==d;){var _=g.nextSibling;e.call(s,g,h++,this),o&&C(g,T)&&g.forEach(e,o,s),g=_}}},T.prototype.forEach=T.prototype.forEach,T.prototype.bb=function(e){var o=[];return this.forEach(sm,e,o),o},T.prototype.getObjects=T.prototype.bb,T.prototype.C=function(){var e=null;return this.ah&&this.forEach(function(o){o.C&&(o=o.C())&&(e=e?e.yd(o):o)}),e},T.prototype.getBoundingBox=T.prototype.C;function sm(e){this.push(e)}T.prototype.ah=0,T.prototype.wz=function(){return this.ah},T.prototype.getChildCount=T.prototype.wz,T.prototype.Y=function(e){var o=this.Eu,s=o.previousSibling;if(C(e,O,this.Y,0),e.contains(this))throw new wb(this.Y,"The new object contains the parent group");var h=e.sm(!0),d=e.Ma;if(d!==this){if(d){d=e.previousSibling;var g=e.nextSibling;d.nextSibling=g,g.previousSibling=d}e.Ma=this,O.g.ea.call(e,this),s.nextSibling=e,e.previousSibling=s,e.nextSibling=o,o.previousSibling=e,this.ah++}return e.ds=this.fD.next(),e.Hk(),o=e.ti(this.D,this.Y),e.sm(!0)!==h&&e.qa(li.VOLATILITY),o||e.qa(li.Z_ORDER),e},T.prototype.addObject=T.prototype.Y,T.prototype.hd=function(e){var o;fb(e,this.hd,0);var s=e.length;for(o=0;o<s;o++)this.Y(e[o])},T.prototype.addObjects=T.prototype.hd,T.prototype.Na=function(e){if(!e||e.Ma!==this)throw new wb(this.Na,"object not found");var o=e.previousSibling,s=e.nextSibling;return o.nextSibling=s,s.previousSibling=o,e.Ma=null,O.g.ea.call(e,null),delete e.previousSibling,delete e.nextSibling,C(e.D,Q)&&e.ti(null,this.Na),this.ah--,e},T.prototype.removeObject=T.prototype.Na,T.prototype.ug=function(e){var o;fb(e,this.ug,0);var s=e.length;for(o=0;o<s;o++)this.Na(e[o])},T.prototype.removeObjects=T.prototype.ug,T.prototype.ia=function(){var e=this.bb();this.ug(e)},T.prototype.removeAll=T.prototype.ia,T.prototype.ye=function(e){for(var o=this.bb(),s=0,h=o.length,d=[],g,_,j;s<h;s++)j=o[s],j instanceof T?(g=e?e(j.getData()):j.getData(),_=qi(this,g,!!e),g={type:"Feature"},g.properties=_,j.gi&&(g.id=j.gi),g.geometry={},g.geometry.type="GeometryCollection",g.geometry.geometries=tm(this,j.bb()),d.push(g)):d.push(j.ye(e));return{type:"FeatureCollection",features:d}},T.prototype.toGeoJSON=T.prototype.ye;function tm(e,o){for(var s=0,h=o.length,d,g=[];s<h;s++)d=o[s],d=d instanceof T?{type:"GeometryCollection",geometries:tm(e,d.bb())}:d instanceof Li||d instanceof km||d instanceof mm||d instanceof zi?d.V().ye():{type:"FeatureCollection",features:Ae},g.push(d);return g}T.prototype.P=function(){var e=T.g.P.call(this);return e.type="Group",e},T.prototype.forWorkerMessage=T.prototype.P;function um(e,o){var s,h="anonymous";if(this.uid=vm.next(),um.g.constructor.call(this),o){var d="size";if(d in o){var g=o[d];if(!g||isNaN(g.w)||isNaN(g.h))throw new D(um,1,d);this.co=new Hi(g.w,g.h)}if(d="anchor",d in o){if(g=o[d],!g||isNaN(g.x)||isNaN(g.y))throw new D(um,1,d);this.Db=new F(g.x,g.y)}d="hitArea",d in o&&(g=o[d],C(g,Ii,um,1),this.Am=o[d]),d="asCanvas",d in o&&(s=o[d]),d="crossOrigin",d in o&&(h=o[d]),g=o.stickHeight,g===+g&&0<g&&(this.jD=g),d="stickColor",g=o[d],d in o&&gb(g)&&(this.iD=g)}e=new yk(e,A(this.Wg,this),s,this.co,h),o=this.o=e.getState(),o!==0?this.Wg(o,e):this.El=e}u(um,K),t("H.map.Icon",um);var vm=new ue;um.State={ERROR:-1,LOADING:0,READY:1},um.prototype.getState=function(){return this.o},um.prototype.getState=um.prototype.getState,um.prototype.Wg=function(e,o){if(this.gb=o.getData(),e===1){var s=this.co;s||(s=this.co=o.mc()),this.Db||(this.Db=new F(s.w/2|0,s.h))}this.El&&(this.o=e,delete this.El,this.dispatchEvent("statechange"))},um.prototype.gb=z,um.prototype.Se=function(){return this.gb},um.prototype.getBitmap=um.prototype.Se,um.prototype.mc=function(){return this.co||z},um.prototype.getSize=um.prototype.mc,um.prototype.Db=z,um.prototype.yp=function(){return this.Db},um.prototype.getAnchor=um.prototype.yp,um.prototype.Am=z,um.prototype.Sz=function(){return this.Am},um.prototype.getHitArea=um.prototype.Sz,um.prototype.disposeInternal=function(){um.g.disposeInternal.call(this),this.gb?(this.gb.removeAttribute("src"),delete this.gb):(this.El.cancel(),delete this.El)};function Q(e){e=e||{},Q.g.constructor.call(this,e),this.Ag=e=new T({min:e.min,max:e.max}),e.D=this,e.ea(this),e.qa(li.ADD),this.rk=new Kg,this.xi=new Kg,this.ek=new jm,this.jk=new Kg,this.bm=new jm,this.Zm=new Kg}u(Q,lm),t("H.map.provider.LocalObjectProvider",Q),Q.prototype.getCapabilities=function(){return Kf.PROVIDES_BY_VIEWPORT|Kf.PROVIDES_WEBGL_RENDERABLE_OBJECTS|Kf.PROVIDES_DOM_MARKERS|Kf.CROP_LINES_BY_TILE},Q.prototype.mb=function(){if(!this.Ui&&(this.Ui=Q.g.mb.call(this),this.Ui instanceof Bf)){var e=new Pf(this.getCapabilities()|Kf.HAS_VOLATILE_DATA,this.uid+"_vol",this.min,this.max,this.Qc,this.tileSize);this.Ui.fk(e.Je())}return this.Ui},Q.prototype.getStyleInternal=Q.prototype.mb,Q.prototype.Xa=function(e,o){Q.g.Xa.call(this,e,o),this.Ui=null},Q.prototype.setStyleInternal=Q.prototype.Xa,Q.prototype.rd=function(){return this.Ag},Q.prototype.getRootGroup=Q.prototype.rd,Q.prototype.Hh=function(e,o){o&li.SPATIAL&&this.Y(e),Q.g.Hh.call(this,e,o)},Q.prototype.invalidateObject=Q.prototype.Hh,Q.prototype.Y=function(e){var o;if(C(e,O,this.Y,0),e.D!==this)throw new wb(this.Y,"foreign object");this.Na(e);var s=e.type;if(s===ni.MARKER)if((o=e.V())instanceof fd){var h=!0;s=this.ek}else s=this.jk;else s===ni.DOM_MARKER?(o=e.V())instanceof fd?(h=!0,s=this.bm):s=this.Zm:s=s===ni.OVERLAY?this.rk:this.xi;h=h?s.Yd(o):s.Lu(e.C()),h.Cs=e,e.As=h},Q.prototype.Na=function(e){var o;if(e){if(e.D!==this){if(C(e,O))throw new wb(this.Na,"foreign object")}else if(o=e.As){var s=e.type;s===ni.MARKER?this.ek.remove(o)||this.jk.remove(o):s===ni.DOM_MARKER?this.bm.remove(o)||this.Zm.remove(o):s===ni.OVERLAY?this.rk.remove(o):this.xi.remove(o),delete o.Cs,delete e.As}}},Q.prototype.removeObject=Q.prototype.Na;function wm(e,o,s,h,d,g,_){if(_=_||[],o.jc)for(e=o!==e.ek&&o!==e.jk,d=!d,o=o.Fm(s,g,g),s=o.length,g=0;g<s;g++){var j=o[g].Cs,$;if($=h!==void 0){for(var _t=Bb(h),_e=j;($=_e.zb<=_t&&_e.Oc>=_t)&&(_e=_e.Ma););$=!$}$||!d&&!j.Vd(!0)||(e||j.kc().getState()===1)&&_.push(j)}return _}Q.prototype.sr=function(){return 0<this.rk.jc},Q.prototype.providesOverlays=Q.prototype.sr,Q.prototype.wg=function(e,o,s){return wm(this,this.rk,e,o,s,!1).filter(function(h){return h.Se()})},Q.prototype.requestOverlays=Q.prototype.wg,Q.prototype.me=function(){return 0<this.xi.jc},Q.prototype.providesSpatials=Q.prototype.me,Q.prototype.Nn=function(e,o,s){return wm(this,this.xi,e,o,s,!1)},Q.prototype.requestSpatials=Q.prototype.Nn,Q.prototype.On=function(e,o){return wm(this,this.xi,e.nm(),e.zL,o,!1)},Q.prototype.requestSpatialsByTile=Q.prototype.On,Q.prototype.Uc=function(){return 0<this.ek.jc+this.jk.jc},Q.prototype.providesMarkers=Q.prototype.Uc,Q.prototype.pe=function(e,o,s){return xm(this,e,o,s,!1)},Q.prototype.requestMarkers=Q.prototype.pe;function xm(e,o,s,h,d){var g=wm(e,e.ek,o,s,h,d);return wm(e,e.jk,o,s,h,d,g),g}Q.prototype.Tc=function(){return 0<this.bm.jc+this.Zm.jc},Q.prototype.providesDomMarkers=Q.prototype.Tc,Q.prototype.oe=function(e,o,s){return ym(this,e,o,s,!1)},Q.prototype.requestDomMarkers=Q.prototype.oe;function ym(e,o,s,h,d){var g=wm(e,e.bm,o,s,h,d);return wm(e,e.Zm,o,s,h,d,g),g}function zm(e,o,s){var h=s.V(),d,g=Am.bind(null,e);e=Bm.bind(null,e),C(s,mm)?d=C(h,M)?g(h):h.ha.some(g):C(s,zi)?d=C(h,N)?e(h):h.ha.some(e):C(s,km)&&(d=e(dh(h))),d&&o.push(s)}function Am(e,o){t:{var s=o.S,h=ih(e,o);if(!h){o=o.S.length;for(var d=0;d<o;d+=3)if(gh(e,s[d],s[d+1])){e=!0;break t}}e=h}return e}function Bm(e,o){return jh(e,o)}function Cm(e,o,s){for(var h=e.length;h--;){var d=e[h],g=d.V();if(C(g,mg)){g=g.ha;for(var _=g.length,j;_--;)if(j=g[_],gh(o,j.lat,j.lng)){s.push(d);break}}else gh(o,g.lat,g.lng)&&s.push(d)}}Q.prototype.bb=function(e,o,s,h,d){var g=this,_=e.C(),j=[],$=Rd(),_t=1;if(_)for(;_t&ni.ANY;){if(_t&h)switch(_t){case ni.MARKER:$=$.then(function(){return xm(g,_,s,o,!0)}).then(function(_e){return Cm(_e,e,j)});break;case ni.DOM_MARKER:$=$.then(function(){return ym(g,_,s,o,!0)}).then(function(_e){return Cm(_e,e,j)});break;case ni.SPATIAL:$=$.then(function(){return wm(g,g.xi,_,s,o,!0)}).then(function(_e){_e.forEach(zm.bind(null,e,j))});break;case ni.OVERLAY:$=$.then(function(){return wm(g,g.rk,_,s,o,!0)}).then(function(_e){_e.forEach(zm.bind(null,e,j))})}_t<<=1}$.then(function(){return d(j)})},Q.prototype.Of=function(e,o,s){s=s||Be;var h=s.zoom,d=s.visiblesOnly;s=s.types;var g=ni.ANY;C(e,N,this.Of,0,"area"),db(o,"Function",this.Of,1,"callback"),db(h,"Number",this.Of,2,"options"),this.bb(e,ab(d)?!!d:!0,h,ab(s)?s&g:g,o)},Q.prototype.getObjectsWithin=Q.prototype.Of,Q.prototype.disposeInternal=function(){Q.g.disposeInternal.call(this),this.Ag.ia()};function Dm(){if(this.constructor=this.constructor,!gb("STATIC_DB"))throw new D(this.constructor,0);if(this.Ju=Em(),!this.Ju)throw new wb(this.constructor,"This browser does not support IndexedDB");this.JB="STATIC_DB",this.gf=[],this.Xh=[],this.$q=A(this.$q,this)}var Fm,Gm;m=Dm.prototype,m.put=function(e,o,s,h){if(!gb(e)&&!jb(e))throw new D(this.put,0);if(!Hm(o))throw new D(this.put,1);Im(this,function(d){Jm(d.put(o,e),s,h)},h)},m.get=function(e,o,s){var h;if(!gb(e)&&!jb(e))throw new D(this.get,0);if(!Za(o))throw new D(this.get,1);return Im(this,function(d){h=d.get(e),Jm(h,o,s)},s),{cancel:function(){h&&(h.onsuccess=ze)}}},m.remove=function(e,o,s){if(!gb(e)&&!jb(e))throw new D(this.remove,0);Im(this,function(h){Jm(h.delete(e),o,s)},s)},m.clear=function(e,o){Im(this,function(s){Jm(s.clear(),e,o)},o)},m.yl="data",m.Sx=500,m.$q=function(){var e=this.ng.result;e.objectStoreNames.contains(this.yl)||e.createObjectStore(this.yl)};function Km(e,o,s){if(e.ng)e.gf?(e.gf.push(o),s&&e.Xh.push(s)):e.pn?s&&s(e.pn):o(e.ng.result);else{e.ng=e.Ju.open("H_"+e.JB,1),e.ng.onupgradeneeded=e.$q;var h=e.ng.onerror=function(){clearTimeout(e.Uv),e.pn=this.error,e.Xh.forEach(function(d){d(e.pn)}),delete e.gf,delete e.Xh};e.Uv=setTimeout(function(){h.call({error:Error("DbOpenTimeoutError")})},e.Sx),e.ng.onsuccess=function(){clearTimeout(e.Uv),e.gf?(e.gf.forEach(function(d){d(this.result)},this),delete e.gf,delete e.Xh):(delete e.ng,delete e.pn,e.gf=[],e.Xh=[])},e.gf.push(o),s&&e.Xh.push(s)}}function Im(e,o,s){Km(e,function(h){h=h.transaction([e.yl],"readwrite"),o(h.objectStore(e.yl))},s)}function Jm(e,o,s){o&&(e.onsuccess=function(){o(this.result)}),s&&(e.onerror=function(){s(this.error)})}function Hm(e){var o=Object.prototype.toString.call(e);return o==="[object Blob]"||o==="[object ArrayBuffer]"||gb(e)||ya(e)}function Lm(){return Fm||(Fm=new Dm),Fm}t("H.util.IndexedDBStorage.getInstance",Lm);function Em(){return x.indexedDB||x.webkitIndexedDB||x.mozIndexedDB||x.msIndexedDB}function Mm(){var e="";if(!ab(Gm))if(window.location.protocol==="file:"&&-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&128<=window.location.href.length)Gm=!1;else{try{var o=Em();e="H_TEST_DB";var s=o&&o.open(e,1)}catch{}Gm=!!s&&s.onupgradeneeded===null,s&&o.deleteDatabase&&o.deleteDatabase(e)}return Gm}t("H.util.IndexedDBStorage.isSupported",Mm);function Nm(e,o){Za(e)&&(this.Tv=e),jb(o)&&(this.ml=o)}t("H.util.Request",Nm),Nm.State={PENDING:0,PROCESSING:1,COMPLETE:2,CANCELLED:3,ERROR:4};var Om=[0,1,2,3,4];Nm.prototype.o=0,Nm.prototype.getState=function(){return this.o},Nm.prototype.getState=Nm.prototype.getState,Nm.prototype.F=function(e){if(0>Om.indexOf(e))throw new D(this.F,0,e);(this.o!==e||e===1&&1<this.ml)&&(this.o=e,this.Tv&&this.Tv(this))},Nm.prototype.ml=1,Nm.prototype.IA=function(){return this.ml},Nm.prototype.getTotal=Nm.prototype.IA,Nm.prototype.Bn=0,Nm.prototype.tA=function(){return this.Bn},Nm.prototype.getProcessed=Nm.prototype.tA,Nm.prototype.Vt=0,Nm.prototype.Mz=function(){return this.Vt},Nm.prototype.getFailed=Nm.prototype.Mz;function Pm(e,o){e.Bn<e.ml&&(ab(o)||(o=2),o===0||o===1||e.o!==0&&e.o!==1||(e.Bn++,o!==2&&e.Vt++,e.F(e.Bn<e.ml?1:2)))}Nm.prototype.Wi=function(){},Nm.prototype.cancel=function(){this.o!==3&&(this.Wi(),this.F(3))},Nm.prototype.cancel=Nm.prototype.cancel;function Qm(e,o,s,h,d,g){var _;for(_=[];h<=d;h++){var j=_.concat,$=e,_t=s,_e=Bb(h);$.pixelProjection.Va(_e);var _r=$.Bj(_t);_t=$.Fh(_r,_e),_e=fg($,_t,_r.left>_r.right,_e),_=j.call(_,_e)}for(e=_.length,Nm.call(this,g,e),this.jx=s=[],this.Zq=A(this.Zq,this),this.Yq=A(this.Yq,this),this.F(1);e--;)g=_[e],s.push(hj(o,g[0],g[1],g[2],this.Zq,this.Yq))}u(Qm,Nm),Qm.prototype.Zq=function(){Pm(this,2)},Qm.prototype.Yq=function(){Pm(this,4)},Qm.prototype.Wi=function(){for(var e=this.jx,o=e.length;o--;)e[o].cancel();delete this.jx};function U(e,o,s){var h={};if(!(e instanceof HTMLElement))throw new D(U,0);if(U.g.constructor.call(this),this.Ea=Rm(s,U),this.wa=s=new ak,this.Fq=!1,s.addEventListener(s.j.Oi,this.Qv,!1,this),!C(e,Element))throw new D(U,0,e);s=this.G=e.ownerDocument.createElement("div");var d=s.style;if(d.position="relative",d.height=s.style.width="100%",d.overflow="hidden",d.webkitTapHighlightColor="transparent",d.webkitTapHighlightColor!=="transparent"&&(d.webkitTapHighlightColor="rgba(0,0,0,0)"),e.appendChild(s),this.ra=new lk(this.G,this.Ea),this.ra.addEventListener(this.ra.j.Oi,this.Qv,!1,this),e=this.O=new Vj(this.Ea.layers),e.addEventListener(e.j.Ni,this.Rq,!1,this),e.addEventListener(e.j.Ki,this.Rq,!1,this),e.addEventListener(e.j.Mi,this.Rq,!1,this),!this.qb&&Sm(this),this.oa=null,this.O.add(o,0),this.Ba=this.Yo(this.Ea.engineType!=null?this.Ea.engineType:Qf,this.Ea),this.jp=A(this.jp,this),o=this.Ea.imprint,o!==B&&typeof o!="object")throw new D(U,1,"imprint");this.Xd=o===null?o:new Yl(this,o),o=this.Ea.autoColor,this.ht=o===B||!!o,Tm(this),(o=this.Ea.zoom)&&(h.zoom=o),(o=this.Ea.bounds)&&(h.bounds=o),(o=this.Ea.center)&&(h.position=o),this.wa.Zc(h)}u(U,K),t("H.Map",U),U.prototype.draggable=U.prototype.draggable=!1;function Rm(e,o){if(e){var s=e.pixelRatio;if(s===B)e.pixelRatio=le();else if(!(0<s))throw new D(o,0,"pixelRatio: "+s)}else e={},e.pixelRatio=le();return e.renderBaseBackground||(e.renderBaseBackground={lower:3,higher:2}),e}U.prototype.by=333,U.prototype.disposeInternal=function(){this.ht=!1,this.Xd&&this.Xd.l(),this.Ba.dispose(),this.wa.l(),this.ra.l(),this.qb.l(),this.rc.l(),this.O.l();var e=this.G;e.parentNode.removeChild(e),delete this.G,K.prototype.disposeInternal.call(this)},U.prototype.A=function(){return this.G},U.prototype.getElement=U.prototype.A,U.prototype.lb=function(){return this.Ea.pixelRatio},U.prototype.getPixelRatio=U.prototype.lb;function Tm(e){e.Xd&&e.ht&&e.Xd.Ur({invert:e.oa&&e.oa.Ly})}U.prototype.Rq=function(e){var o=e.added,s=e.removed;o&&o.D&&o.D.ea(this),s&&s.D&&s.D.ea(null),s===this.qb&&(delete this.qb,delete this.rc),s===this.oa&&(this.oa=null),e.idx===0&&(this.dispatchEvent(new Zc(this.j.xl,this.oa=e.type!==this.O.j.Mi?o:0<this.O.aa.length?this.O.get(0):z,e.type!==this.O.j.Ki?s:1<this.O.aa.length?this.O.get(1):z)),Tm(this))},U.prototype.Qv=function(e){e.modifiers&&(this.Fq||(Um(this,"start"),this.Fq=!0),Um(this,"",e),this.sv&&x.clearTimeout(this.sv),this.sv=x.setTimeout(this.jp,this.by))};function Um(e,o,s){e.dispatchEvent(s?new mj(e.j.Ns,s.newValue,s.oldValue,s.modifiers):e.j.Ns+o)}U.prototype.jp=function(){Um(this,"end"),this.Fq=!1},U.prototype.Zn=function(e,o){return this.Ba.getCapabilities().lookAt&&this.wa.Zc({position:e},!!o),this},U.prototype.setCenter=U.prototype.Zn,U.prototype.wb=function(){var e=this.wa.Ib();return e?e.position:z},U.prototype.getCenter=U.prototype.wb,U.prototype.Vk=function(e,o){return this.wa.Vk(e,!!o),this},U.prototype.setZoom=U.prototype.Vk,U.prototype.Ub=function(){return this.wa.Ub()},U.prototype.getZoom=U.prototype.Ub,U.prototype.Ng=function(e,o,s){this.Ba.zoomAt(e,o,s)},U.prototype.zoomAt=U.prototype.Ng,U.prototype.NA=function(){return this.ra},U.prototype.getViewPort=U.prototype.NA,U.prototype.MA=function(){return this.wa},U.prototype.getViewModel=U.prototype.MA,U.prototype.aA=function(){return this.O},U.prototype.getLayers=U.prototype.aA,U.prototype.Vz=function(){return this.Xd},U.prototype.getImprint=U.prototype.Vz,U.prototype.capture=function(e,o,s,h,d,g){function _(_p,ty){_i?_p.cancel():(_l.save(),ty.capture(_s,_e,function(ry){_l.restore(),_p.done(ry)},function(ry){_p.done(null,ry),j(null)}))}function j(_p){_i||(_i=!0,e(_p))}var $=this.Ba,_t=$.getCapabilities(),_e=this.Ea.pixelRatio,_r=this.ra,_i=!1,_n=this,_s,_l;if(!Za(e))throw new D(this.capture,0,e);s=s||0,h=h||0,d=d||_r.width,g=g||_r.height;var Ap=zb(0,yb(s,d)),_h=zb(0,yb(h,g));s=yb(_r.width,zb(s,d)),h=yb(_r.height,zb(h,g)),_t.capture?$.capture(Ap,_h,s,h).then(function(_p){var ty=_n.Xd,ry=o||[];_s=_p,_l=_s.getContext("2d"),_s.style.width=_s.width/_e+"px",_s.style.height=_s.height/_e+"px";var ly=new Jk(10,_);ry=ry.concat(ty).filter(function(uy){return Za(uy&&uy.capture)}),ry.length?(_p=ry.pop(),ry.forEach(function(uy){ly.push(uy,ze)}),ly.push(_p,A(j,_n,_s)),ly.An()):j(_s)},function(){j(z)}):e(null)},U.prototype.capture=U.prototype.capture,U.prototype.Hz=function(){return this.Ba},U.prototype.getEngine=U.prototype.Hz,U.prototype.Yo=function(e,o){if(o=o?Rm(o,this.Yo):this.Ea,Tm(this),e===Rf.P2D)return new x.H.map.render.p2d.RenderEngine(this.ra,this.wa,this.O,o);if(e===Rf.WEBGL)return new S(this.ra,this.wa,this.O,o);if(e===Rf.HARP)return new x.H.map.render.harp.RenderEngine(this.ra,this.wa,this.O,o);throw new D(this.Yo,0,e)},U.prototype.al=function(e,o,s,h,d){if(o=ab(o)?C(o,J,this.al,1,o)&&o:this.wa.Ib().bounds.C(),d=d||this.oa,!C(d,eg))throw new D(this.al,4);var g=d.D,_=this.lb(),j=d.tileSize;if(2<=_&&256<j&&g instanceof kj&&(j/=2),_=this.Ub(),j=Math.log2(j)-8,s=ab(s)?+s:_,h=ab(h)?+h:_,!(s<=h))throw new D(this.al,B,"!(min <= max)");_=g.min;var $=g.max,_t=this.Ba.type===Rf.WEBGL?Bb:Ab;if(s=ac(_t(s)-j,_,$),h=ac(_t(h)-j,_,$),!(g&&C(g,R)&&Mm()&&g.Vi()))throw new wb(this.al,"Storing is not supported");return new Qm(d,g,o,s,h,e)},U.prototype.storeContent=U.prototype.al;function Vm(e){Nm.call(this,e)}u(Vm,Nm),Vm.prototype.iC=function(){Pm(this,2)},Vm.prototype.hC=function(){Pm(this,4)},U.prototype.zy=function(e){return e=new Vm(e),Lm().clear(A(e.iC,e),A(e.hC,e)),e},U.prototype.clearContent=U.prototype.zy,U.prototype.Bl=function(e,o){var s=this.O,h=s.indexOf(e),d=o!==+o;return o=d?s.aa.length-1:o,0>h?s.add(e,o):h-o&&(s.Dd(h),s.add(e,d?o-1:o)),this},U.prototype.addLayer=U.prototype.Bl,U.prototype.hi=function(e){var o=this.O.indexOf(e);return e!==this.oa&&e!==this.qb&&o!==-1&&this.O.Dd(o),this},U.prototype.removeLayer=U.prototype.hi,U.prototype.Cg=function(e){return this.oa!==e&&(this.O.aa.length&&this.O.get(0)!==this.qb?this.O.set(0,e):this.O.add(e,0),this.oa=e),this},U.prototype.setBaseLayer=U.prototype.Cg,U.prototype.sz=function(){return this.oa},U.prototype.getBaseLayer=U.prototype.sz,U.prototype.Ka=function(e){if(!gd(e))throw new D(this.Ka,0,e);return(e=this.Ba.geoToScreen(e))?$c(e):z},U.prototype.geoToScreen=U.prototype.Ka,U.prototype.Wa=function(e,o){var s;if(s=+E(e)||2*+E(o))throw new D(this.Wa,s-1,arguments[s-1]);return(s=this.Ba.screenToGeo(e,o))?hd(s):z},U.prototype.screenToGeo=U.prototype.Wa,U.prototype.Un=function(e,o){return this.Ba.screenToLookAtData(e,o)},U.prototype.screenToLookAtData=U.prototype.Un,U.prototype.Y=function(e){if(!C(e,O))throw new D(this.Y,0,e);return!this.qb&&Sm(this),this.rc.rd().Y(e),e},U.prototype.addObject=U.prototype.Y,U.prototype.Na=function(e){if(!C(e,O))throw new D(this.Na,0,e);return!this.qb&&Sm(this),this.rc.rd().Na(e),e},U.prototype.removeObject=U.prototype.Na,U.prototype.bb=function(e){return!this.qb&&Sm(this),this.rc.rd().bb(e)},U.prototype.getObjects=U.prototype.bb,U.prototype.hd=function(e){var o;fb(e,this.hd,0,e),!this.qb&&Sm(this);var s=e.length;for(o=0;o<s;o++)this.Y(e[o]);return this},U.prototype.addObjects=U.prototype.hd,U.prototype.ug=function(e){var o;fb(e,this.ug,0,e),!this.qb&&Sm(this);var s=e.length;for(o=0;o<s;o++)this.Na(e[o]);return this},U.prototype.removeObjects=U.prototype.ug,U.prototype.Bh=function(e,o,s){var h;if(h=+E(e)||2*+E(o))throw new D(this.Bh,h-1,arguments[h-1]);this.Ba.getObjectsAt(e,o,!0,function(d){s(d[0])})},U.prototype.getObjectAt=U.prototype.Bh,U.prototype.La=function(e,o,s,h){var d;if(d=+E(e)||2*+E(o))throw new D(this.Bh,d-1,arguments[d-1]);this.Ba.getObjectsAt(e,o,!1,s,!!h)},U.prototype.getObjectsAt=U.prototype.La,U.prototype.Of=function(e,o,s){s=s||{};var h=s.zoom;s.zoom=ab(h)?h:this.wa.Ub(),this.rc.Of(e,o,s)},U.prototype.getObjectsWithin=U.prototype.Of;function Sm(e){e.rc=new Q({max:24,engineType:e.Ea.engineType}),e.qb=new bl(e.rc,e.Ea),e.O.add(e.qb)}var Wm=vk.HARP,Rf={P2D:vk.P2D,WEBGL:vk.WEBGL,HARP:Wm};U.EngineType=Rf,U.prototype.j={ND:"mapviewchangestart",Ns:"mapviewchange",Os:"mapviewchangeend",xl:"baselayerchange"};function Xm(e,o,s,h){if(!e||!o||!s)throw new D(Xm,B,"Must specify name, version and revision parameter");this.name=e,this.version=o,this.revision=s,h&&Pa(this,h)}t("H.util.BuildInfo",Xm),Xm.prototype.toString=function(){var e,o=[];for(e in this)gb(this[e])&&o.push(this[e]);return o.join(";")};var Ym={};function Zm(e,o,s,h){if(!e)throw new D(Zm,1,"Must specify a name parameter");return Ym[e]||(Ym[e]=new Xm(e,o,s,h))}Xm.get=Zm;function $m(e,o){$m.g.constructor.call(this,e,o)}u($m,Li),t("H.map.Marker",$m),$m.prototype.type=ni.MARKER,$m.prototype.ro=1,$m.prototype.qa=function(e){if(e!==li.VISUAL||this.lw===1||this.icon.getState()===1)var o=$m.g.qa.call(this,e);return o||!1},$m.prototype.invalidate=$m.prototype.qa,m=$m.prototype,m.lw=0,m.Xu=function(e){return C(e,um)},m.qq=!1,m.Mv=function(){this.qa(li.VISUAL)},m.ve=function(e){var o=this.icon;return this.qq&&(o.removeEventListener("statechange",this.Mv,!1,this),delete this.qq),o&&(this.lw=o.getState()),$m.g.ve.call(this,e),e.getState()===0&&(this.qq=!0,Kc(e,"statechange",this.Mv,!1,this)),this},$m.prototype.setIcon=$m.prototype.ve,$m.prototype.tt=function(e){return new um(e.svg,e)},$m.prototype.P=function(){var e=this.getIcon(),o=e.jD||0,s=$m.g.forWorkerMessage.call(this),h=s.properties.icon;return h&&0<o&&Pa(h,{stick_color:e.iD,stick_height:o}),s},$m.prototype.forWorkerMessage=$m.prototype.P;function an(e,o,s){an.g.constructor.call(this,Ai,s),this.Zn(e),this.Yr(o),s&&this.jw in s&&this.Xr(s[this.jw])}u(an,zi),t("H.map.Circle",an),an.prototype.Zn=function(e){(e=hd(e)).da(this.Df)||(this.Df=e,bn(this))},an.prototype.setCenter=an.prototype.Zn,an.prototype.wb=function(){return this.Df},an.prototype.getCenter=an.prototype.wb,an.prototype.Yr=function(e){if(E(e=ac(e,0,637100079e-2*Pb/2)))throw new D(this.Yr,0,e);this.wr!==e&&(this.wr=e,bn(this))},an.prototype.setRadius=an.prototype.Yr,an.prototype.vA=function(){return this.wr},an.prototype.getRadius=an.prototype.vA,an.prototype.zn=60,an.prototype.Xr=function(e){if(!jb(e))throw new D(this.Xr,0,e);this.zn!==(e=ac(Ab(e),4,360))&&(this.zn=e,bn(this))},an.prototype.setPrecision=an.prototype.Xr,an.prototype.jw="precision",an.prototype.sA=function(){return this.zn},an.prototype.getPrecision=an.prototype.sA,an.prototype.X=function(){return this},an.prototype.setGeometry=an.prototype.X,an.prototype.V=function(){return this.Hb===Ai&&an.g.X.call(this,cn(this)),this.Hb},an.prototype.getGeometry=an.prototype.V;function bn(e){e.Hb!==z&&an.g.X.call(e,cn(e))}function cn(e){var o=e.Df,s=o.lat,h=e.wr,d=0,g=new M;if(Db(s)===90)for(s=o.mo(0,h,!0).lat;360>d;d+=120)g.tr(s,d-180,B);else for(e=e.zn,e=360/e;360>d;d+=e)g.sg(o.mo(d,h,!0));return o=new N(g),0>s&&o.Vw(eh.SOUTH),o}t("H.buildInfo",function(){return Zm("H-core","1.57.0","161a2e3",{region:"row"})});var Qf=Rf.WEBGL,dn,en="maps".concat("js-"),fn,gn,hn,jn,kn;if(fn=x.document.querySelector('script[src*="'+en+'"]'),!fn){for(gn=x.document.getElementsByTagName("script"),jn=new RegExp("^.*"+en),kn=0,hn=gn.length;kn<hn;kn++)if(jn.test(gn[kn].src)){fn=gn[kn];break}}dn=fn?fn.src.replace(/\/[^\/]*$/,"/"):"",t("H.getScriptPath",function(){return dn});function ln(){var e=decodeURIComponent(dn);if(e){e=e[e.length-1]==="/"?e.substring(0,e.length-1):e;var o=x.document,s="";o?(o=o.createElement("a"),o.href=e,s=o.href):/[\w]+:\/\//.test(e)&&(s=e),e=new URL(s),e.pathname+=e.pathname[e.pathname.length-1]==="/"?"styles":"/styles",e=e.toString()}else e="https://js.api.here.com/v3/3.1.57.0/styles";return e}t("H.getStylePath",ln);function mn(e){var o=e.ownerDocument;o=o.documentElement||o.body.parentNode||o.body;try{var s=e.getBoundingClientRect()}catch{s={top:0,right:0,bottom:0,left:0,height:0,width:0}}return{x:s.left+(typeof window.pageXOffset=="number"?window.pageXOffset:o.scrollLeft),y:s.top+(typeof window.pageYOffset=="number"?window.pageYOffset:o.scrollTop)}}var nn=(function(){return this}).apply(null);function on(e,o,s,h,d){on.g.constructor.call(this,"wheel"),this.delta=e,this.viewportX=o,this.viewportY=s,this.target=h,this.originalEvent=d}u(on,uc),t("H.mapevents.WheelEvent",on);function pn(e,o,s,h,d,g){if(isNaN(e))throw Error("x needs to be a number");if(isNaN(o))throw Error("y needs to be a number");if(isNaN(s))throw Error("pointer must have an id");this.viewportX=e,this.viewportY=o,this.target=null,this.id=s,this.type=h,this.dragTarget=null,this.button=ab(d)?d:-1,this.buttons=ab(g)?g:0,this.Pm=this.button}t("H.mapevents.Pointer",pn);function qn(e,o,s){if(isNaN(o))throw Error("x needs to be a number");if(isNaN(s))throw Error("y needs to be a number");e.viewportX=o,e.viewportY=s}pn.prototype.Yz=function(){return this.Pm},pn.prototype.getLastChangedButton=pn.prototype.Yz;function rn(e,o){e.Pm=o,e.buttons|=sn[+o]||0}function tn(e,o){e.Pm=o,e.buttons&=~(sn[+o]||0)}var sn=[1,4,2],un={NONE:-1,LEFT:0,MIDDLE:1,RIGHT:2};pn.Button=un;function vn(e){this.Da=e instanceof Array?e.slice(0):[]}m=vn.prototype,m.clear=function(){this.Da.splice(0,this.Da.length)},m.length=function(){return this.Da.length},m.item=function(e){return this.Da[e]||null},m.indexOf=function(e){for(var o=this.Da.length;o--;)if(this.Da[o].id===e)return o;return-1};function wn(e,o){return o=e.indexOf(o),o!==-1?e.Da[o]:null}m.remove=function(e){return e=this.indexOf(e),e!==-1?this.Da.splice(e,1)[0]:null};function xn(e,o){for(var s=e.Da.length,h=[];s--;)e.Da[s].type!==o&&h.push(e.Da[s]);e.Da=h}function yn(e,o){for(var s=e.Da.length;s--;)if(e.Da[s].dragTarget===o)return!0;return!1}m.push=function(e){if(e instanceof pn)return this.Da.push(e);throw Error("list needs a pointer")},m.Sa=function(){return this.Da},m.clone=function(){return new vn(this.Da)};function zn(e,o,s,h,d,g,_){zn.g.constructor.call(this,e),this.pointers=o,this.changedPointers=s,this.targetPointers=h,this.currentPointer=d,this.originalEvent=_,this.target=g}u(zn,uc),t("H.mapevents.Event",zn);function An(e,o,s){if(s=s||{},!(e instanceof U))throw Error("events: map instance required");if(!(o instanceof Array))throw Error("events: map array required");hc.call(this),this.fp=s.fp||300,this.zt=s.zt||50,this.mx=s.mx||50,this.nx=s.nx||500,this.Dq=s.Dq||900,this.Cq=s.Cq||8,this.map=e,this.ya=this.map.ra,this.element=this.ya.element,this.np=o,this.pointers=new vn,this.changedPointers=new vn,this.Zf={},this.Ja=null,this.em=!0,this.Nk={},this.rf={},this.bk=null,this.mj=A(this.mj,this),this.Qt={pointerdown:this.Ty,pointermove:this.Uy,pointerup:this.Vy,pointercancel:this.Sy},Bn(this)}u(An,hc);function Bn(e,o){var s,h=e.np.length;for(s=0;s<h;s++){var d=e.np[s],g=d.listener;typeof g=="function"&&(o?(d.target||e.element).removeEventListener(d.$a,g):(d.target||e.element).addEventListener(d.$a,g))}}function Cn(e,o,s){var h;if(typeof e.Qt[o]=="function"){o!=="pointermove"&&(e.em=!0);var d=0;for(h=e.changedPointers.length();d<h;d++){var g=e.changedPointers.item(d);e.element.contains(s.composedPath()[0])?Dn(e,g,e.It.bind(e,s,o,g)):e.It(s,o,g,null)}}e.changedPointers.clear()}m=An.prototype,m.It=function(e,o,s,h){En(s.id,this.Nk),this.Qt[o].call(this,s,h,e)};function Dn(e,o,s){if(e.Ja===o)s(o.target);else{var h=e.ya,d=o.viewportX;if(o=o.viewportY,0>d||0>o||d>=h.width||o>=h.height)s(z);else{var g=e.map;g.Bh(d,o,function(_){s(_||g)})}}}m.Vy=function(e,o,s){var h=e.id;e.target=o,Fn(this,e,s),Gn(this,o,"pointerup",s,e),e.type!=="mouse"&&Gn(this,o,"pointerleave",s,e),o=this.Zf[e.id];var d={x:e.viewportX,y:e.viewportY},g=s.timeStamp,_=e.target,j=this.bk;o&&o.target===_&&o.vk.kb(d)<this.mx&&g-o.ps<this.nx?(Gn(this,_,"tap",s,e),j&&j.target===_&&g-j.ps<this.fp?j.vk.kb({x:e.viewportX,y:e.viewportY})<this.zt&&(Gn(this,_,"dbltap",s,e),this.bk=null):this.bk={target:_,vk:new F(e.viewportX,e.viewportY),ps:s.timeStamp}):this.bk=null,this.Zf={},En(h,this.rf)};function Fn(e,o,s){o===e.Ja&&(Gn(e,o.dragTarget,"dragend",s,o),e.Ja=null,En(o.id,e.Nk)),o.dragTarget=null}m.mj=function(e,o){var s=this;Gn(this,e.dragTarget,"drag",o,e),En(e.id,this.Nk),this.Nk[e.id]=setTimeout(function(){s.mj(e,o)},150)};function En(e,o){o[e]&&(o[e].timeout?clearTimeout(o[e].timeout):clearTimeout(o[e]),delete o[e])}function Hn(e,o,s){var h=o.target,d=new F(o.viewportX,o.viewportY),g=o.id;En(g,e.rf);var _=setTimeout(function(){h&&h===o.target&&d.kb({x:o.viewportX,y:o.viewportY})<e.Cq&&(Gn(e,h,"longpress",s,o),delete e.Zf[o.id])},e.Dq);e.rf[g]={timeout:_,vk:d}}m.Uy=function(e,o,s){var h=e.dragTarget,d=e.id,g=e.target;e.target=o,g!==o&&(Gn(this,g,"pointerleave",s,e),Gn(this,o,"pointerenter",s,e)),h?this.Ja?(this.mj(e,s),this.rf[d]&&this.rf[d].vk.kb({x:e.viewportX,y:e.viewportY})>this.Cq&&En(d,this.rf)):this.em?this.em=!1:(this.Ja=e,Gn(this,h,"dragstart",s,e),this.mj(e,s),delete this.Zf[d],this.em=!0):(!this.Ja||this.Ja&&this.Ja.dragTarget!==o&&this.Ja.dragTarget!==this.map)&&Gn(this,o,"pointermove",s,e)},m.Ty=function(e,o,s){var h=!(/^(?:mouse|pen)$/.test(e.type)&&s.button!==0);if(o){e.target=o,this.Zf[e.id]={vk:new F(e.viewportX,e.viewportY),target:e.target,ps:s.timeStamp},e.type!=="mouse"&&Gn(this,o,"pointerenter",s,e);var d=Gn(this,o,"pointerdown",s,e);!this.Ja&&h&&(o.draggable&&!yn(this.pointers,o)?e.dragTarget=o:!this.map.draggable||d.defaultPrevented||yn(this.pointers,this.map)||(e.dragTarget=this.map)),Hn(this,e,s)}},m.Sy=function(e,o,s){var h=e.id;e.target=null,o?(Gn(this,o,"pointerleave",s,e),Gn(this,o,"pointercancel",s,e)):Gn(this,this.map,"pointercancel",s,e),Fn(this,e,s),this.Zf={},En(h,this.rf)};function Gn(e,o,s,h,d){if(o&&typeof o.dispatchEvent=="function"){var g=zn,_=e.pointers.Sa(),j=e.changedPointers.Sa();e=e.pointers;var $,_t=e.Da.length,_e=[];for($=0;$<_t;$++)e.Da[$].target===o&&_e.push(e.Da[$]);g=new g(s,_,j,_e,d,o,h),d.button=/^(?:longpress|(?:dbl)?tap|pointer(?:down|up))$/.test(s)?d.Pm:un.NONE,o.dispatchEvent(g)}return g}m.disposeInternal=function(){Bn(this,!0),this.pointers.clear(),this.changedPointers.clear();var e=this.Nk,o;for(o in e)En(o,e);e=this.rf;for(var s in e)En(s,e);delete this.element,delete this.np,delete this.pointers,delete this.changedPointers,delete this.map,this.bk=null,delete this.Zf,this.Ja=null,hc.prototype.disposeInternal.call(this)};function In(e){var o="onwheel"in document;this.ay=o,this.Zx=(o?"d":"wheelD")+"elta",this.aq=A(this.aq,this),In.g.constructor.call(this,e,[{$a:(o?"":"mouse")+"wheel",listener:this.aq}]),this.ra=this.map.ra}u(In,An),In.prototype.normalize=function(e,o,s){var h=this.Zx,d=e[h+(h+"Y"in e?"Y":"")],g;if(Xc&&x.getComputedStyle(this.ra.element).direction==="rtl"&&(o-=(x.devicePixelRatio-1)*this.ra.width),d){var _=Math.abs,j=_(d);d=(!(g=e[h+"X"])||3<=j/_(g))&&(!(g=e[h+"Z"])||3<=j/_(g))?(+(0<d)-+(0>d))*(this.ay?1:-1):0}return new on(d,o,s,null,e)},In.prototype.aq=function(e){if(!e.Px){var o=mn(this.element);o=this.normalize(e,e.pageX-o.x,e.pageY-o.y),o.delta&&(e.stopImmediatePropagation(),e.preventDefault(),this.map.Bh(o.viewportX,o.viewportY,this.Lp.bind(this,o)))}},In.prototype.Lp=function(e,o){var s=e.target=o||this.map,h,d;setTimeout(function(){s.dispatchEvent(e),e.defaultPrevented||(h=e.originalEvent,d=new x.WheelEvent("wheel",h),d.Px=!0,h.target.dispatchEvent(d))},0)};function Jn(e,o,s,h){Jn.g.constructor.call(this,"contextmenu"),this.items=[],this.viewportX=e,this.viewportY=o,this.target=s,this.originalEvent=h}u(Jn,uc),t("H.mapevents.ContextMenuEvent",Jn);function Kn(e){this.Xp=A(this.Xp,this),this.Zp=A(this.Zp,this),this.Yp=A(this.Yp,this),this.qn=!1,this.ih=-1,this.gv=0,Kn.g.constructor.call(this,e,[{$a:"contextmenu",listener:this.Xp},{target:e,$a:"longpress",listener:this.Zp},{target:e,$a:"dbltap",listener:this.Yp}])}u(Kn,An),m=Kn.prototype,m.Zp=function(e){var o=e.currentPointer;o.type==="touch"&&e.pointers.length===1&&Ln(this,o.viewportX,o.viewportY,e.originalEvent,e.target)},m.Yp=function(e){e.currentPointer.type==="touch"&&(this.gv=Date.now())},m.Xp=function(e){var o=this;this.ih===-1?this.ih=setTimeout(function(){var s=mn(o.element),h=e.pageX-s.x;s=e.pageY-s.y,o.ih=-1,Ln(o,h,s,e)},this.fp):(clearInterval(this.ih),this.ih=-1),e.preventDefault()};function Ln(e,o,s,h,d){var g=e.map,_=Date.now()-e.gv;d?!e.qn&&_>e.Dq&&(e.qn=!0,d.dispatchEvent(new Jn(o,s,d,h)),Kc(g.A(),Mn,e.Ht,!1,e)):g.Bh(o,s,e.Lp.bind(e,o,s,h))}m.Lp=function(e,o,s,h){Ln(this,e,o,s,h&&Za(h.dispatchEvent)?h:this.map)},m.Ht=function(){this.qn&&(this.qn=!1,this.map.dispatchEvent(new uc("contextmenuclose",this.map)))},m.disposeInternal=function(){var e=this.map.A();clearInterval(this.ih),e&&Sc(e,Mn,this.Ht,!1,this),An.prototype.disposeInternal.call(this)};var Mn=["mousedown","touchstart","pointerdown","wheel"];function Nn(e){var o=On(this);(window.PointerEvent||window.MSPointerEvent)&&o.push({$a:"MSHoldVisual",listener:"prevent"}),An.call(this,e,o)}u(Nn,An);function On(e){var o=!!window.PointerEvent,s,h,d=[];return e.$p=A(e.$p,e),"MSPointerDown MSPointerMove MSPointerUp MSPointerCancel MSPointerOut MSPointerOver".split(" ").forEach(function(g){s=g.toLowerCase().replace(/ms/g,""),h=o?s:g,d.push({$a:h,listener:e.$p,target:/^pointer(up|move)$/.test(s)?window:null})}),d}var Pn={2:"touch",3:"pen",4:"mouse"};Nn.prototype.$o=function(e,o){var s=e.pointerType;return typeof s=="number"&&(s=Pn[s]),e=new pn(o.x,o.y,e.pointerId,s,e.button,e.buttons),this.pointers.push(e),e},Nn.prototype.$p=function(e){var o=window.PointerEvent?e.type:e.type.toLowerCase().replace(/ms/g,""),s=mn(this.element),h=wn(this.pointers,e.pointerId),d=e.pageX-s.x;s=e.pageY-s.y;var g=Pn[e.pointerType]||e.pointerType;Xc&&x.getComputedStyle(this.ya.element).direction==="rtl"&&(d-=(x.devicePixelRatio-1)*this.ya.width),h||/^pointer(up|out|cancel)$/.test(o)||g==="touch"&&o!=="pointerdown"||(h=this.$o(e,{x:d,y:s})),h&&(/^pointer(up|cancel)$/.test(o)?(g==="touch"&&this.pointers.remove(h.id),tn(h,e.button)):o==="pointerdown"&&(e.pointerType==="touch"&&(xn(this.pointers,"mouse"),xn(this.pointers,"pen")),rn(h,e.button)),this.changedPointers.push(h),o!=="pointermove"?(qn(h,d,s),Cn(this,/^pointer(over|out)$/.test(o)?"pointermove":o,e)):(h.viewportX!==d||h.viewportY!==s)&&(qn(h,d,s),Cn(this,o,e))),this.changedPointers.clear()};function Qn(e){this.Gh=A(this.Gh,this),An.call(this,e,[{$a:"touchstart",listener:this.Gh},{$a:"touchmove",listener:this.Gh},{$a:"touchend",listener:this.Gh},{$a:"touchcancel",listener:this.Gh}]),this.Ax={touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",touchcancel:"pointercancel"},this.Iu=(e=(e=e.Xd)?e.A():null)?Array.prototype.slice.call(e.querySelectorAll("a"),0):[]}u(Qn,An),Qn.prototype.Gh=function(e){var o=e.touches,s=this.pointers.length(),h;if(e.type==="touchstart"&&s>=o.length){for(s=this.pointers.clone(),h=o.length;h--;)s.remove(o[h].identifier);for(h=s.length();h--;)this.pointers.remove(s.item(h).id);this.changedPointers=s,Cn(this,"pointercancel",e),this.changedPointers.clear()}if(this.Ax[e.type]){o=mn(this.ya.element),s=e.type,h=e.changedTouches;var d=h.length,g;for(this.changedPointers.clear(),g=0;g<d;g++){var _=h[g],j=wn(this.pointers,_.identifier),$=_.pageX-o.x,_t=_.pageY-o.y;if(j)if(s==="touchmove"){_=Math.abs(j.viewportX-$);var _e=Math.abs(j.viewportY-_t);(1<_||1<_e||_===1&&_e===1)&&(qn(j,$,_t),this.changedPointers.push(j))}else s==="touchend"&&(this.pointers.remove(j.id),this.changedPointers.push(j),tn(j,un.LEFT));else j=new pn($,_t,_.identifier,"touch",un.LEFT,1),this.pointers.push(j),this.changedPointers.push(j)}Cn(this,this.Ax[e.type],e),this.Iu.indexOf(e.target)===-1&&e.preventDefault()}},Qn.prototype.disposeInternal=function(){this.Iu=null,An.prototype.disposeInternal.call(this)};function Rn(e){this.Tf=A(this.Tf,this),An.call(this,e,[{$a:"mousedown",listener:this.Tf},{$a:"mousemove",listener:this.Tf,target:window},{$a:"mouseup",listener:this.Tf,target:window},{$a:"mouseover",listener:this.Tf},{$a:"mouseout",listener:this.Tf},{$a:"dragstart",listener:this.gC}])}u(Rn,An),Rn.prototype.$o=function(e){return e=new pn(e.x,e.y,1,"mouse"),this.pointers.push(e),e},Rn.prototype.Tf=function(e){var o=e.type,s=mn(this.element),h={x:e.pageX-s.x,y:e.pageY-s.y};s=this.pointers.item(0)||this.$o(h),this.changedPointers.push(s),qn(s,h.x,h.y),/^mouse(?:move|over|out)$/.test(o)?Cn(this,"pointermove",e):(/^mouse(down|up)$/.test(o)&&(h=e.which-1,nn.RegExp.$1==="up"?tn(s,h):rn(s,h)),Cn(this,o.replace("mouse","pointer"),e)),this.changedPointers.clear()},Rn.prototype.gC=function(e){e.preventDefault()};function Sn(e){var o=e.ra.element.style;if(Tn.indexOf(e)!==-1)throw Error("InvalidArgument: map is already in use");this.u=e,Tn.push(e),o.msTouchAction=o.touchAction="none",Yc||!window.PointerEvent&&!window.MSPointerEvent?(this.zx=new Qn(this.u),this.Cv=new Rn(this.u)):this.zx=new Nn(this.u),this.FD=new In(this.u),this.Dy=new Kn(this.u),this.u.bc(this.l,this),hc.call(this)}u(Sn,hc),t("H.mapevents.MapEvents",Sn);var Tn=[];mb(Tn),Sn.prototype.l=function(){delete this.u,this.zx.l(),this.FD.l(),this.Dy.l(),this.Cv&&this.Cv.l(),Tn.splice(Tn.indexOf(this.u),1),hc.prototype.l.call(this)},Sn.prototype.dispose=Sn.prototype.l,Sn.prototype.rz=function(){return this.u},Sn.prototype.getAttachedMap=Sn.prototype.rz;function Un(e,o){o=o===void 0?{}:o;var s;if(Un.g.constructor.call(this),Vn.indexOf(e)!==-1)throw new D(Un,0,"events are already used");this.u=s=e.u,this.qv=e,Vn.push(e),s.draggable=!0,this.ta=o.kinetics||{duration:600,ease:wl},this.IB=o.modifierKey||"Alt",this.enable(o.enabled),this.Fi=s.ra,this.sl=this.Fi.element,this.Rm=0,s.addEventListener("dragstart",this.Bd,!1,this),s.addEventListener("drag",this.hg,!1,this),s.addEventListener("dragend",this.df,!0,this),s.addEventListener("wheel",this.Sv,!1,this),s.addEventListener("dbltap",this.Kv,!1,this),s.addEventListener("pointermove",this.he,!1,this),Jc(this.sl,"contextmenu",this.bn,!1,this),e.bc(this.l,this)}u(Un,hc),t("H.mapevents.Behavior",Un);var Vn=[];mb(Vn),Un.prototype.Rb=0;var Wn={PANNING:1,PINCH_ZOOM:2,WHEEL_ZOOM:4,DBL_TAP_ZOOM:8,FRACTIONAL_ZOOM:16,TILT:32,HEADING:64};Un.Feature=Wn;var Xn=Wn.PANNING,Yn=Wn.PINCH_ZOOM,Zn=Wn.WHEEL_ZOOM,$n=Wn.DBL_TAP_ZOOM,ao=Wn.FRACTIONAL_ZOOM,bo=Wn.TILT,co=Wn.HEADING,eo=Xn|Yn|Zn|$n|ao|bo|co;Un.DRAGGING=Xn,Un.WHEELZOOM=Zn,Un.DBLTAPZOOM=$n,Un.FRACTIONALZOOM=ao;function fo(e,o){if(e!==+e||e%1||0>e||2147483647<e)throw new D(o,0,"integer in range [0...0x7FFFFFFF] required")}Un.prototype.disable=function(e){var o=this.Rb;e!==B?(fo(e,this.disable),o^=o&e):o=0,this.Fi.endInteraction(!0),this.Rb=o,this.u.draggable=0<(o&(Xn|bo|co|Yn))},Un.prototype.disable=Un.prototype.disable,Un.prototype.enable=function(e){var o=this.Rb;e!==B?(fo(e,this.enable),o|=e&eo):o=eo,this.Rb=o,this.u.draggable=0<(o&(Xn|bo|co|Yn))},Un.prototype.enable=Un.prototype.enable,Un.prototype.isEnabled=function(e){return fo(e,this.isEnabled),e===(this.Rb&e)},Un.prototype.isEnabled=Un.prototype.isEnabled;function go(e,o,s){var h=o.currentPointer.type==="touch",d=0,g;if(g=!h){g=e.IB;var _=o.originalEvent;g=_.getModifierState?_.getModifierState(g):!!_[g.replace(/^Control$/,"ctrl").toLowerCase()+"Key"]}return g?d|=bo|co:(d|=Xn,h&&(o=o.pointers,o.length===2&&(d|=Yn|co,s?55>Db(o[0].viewportY-o[1].viewportY)&&(d|=bo):e.iq&Kj.TILT&&(d|=bo)))),d&=e.Rb,(d&bo?Kj.TILT:0)|(d&co?Kj.HEADING:0)|(d&Yn?Kj.ZOOM:0)|(d&Xn?Kj.COORD:0)}function ho(e){var o=e.pointers;return e=o[0],o=o[1],e=[e.viewportX,e.viewportY],o&&e.push(o.viewportX,o.viewportY),e}m=Un.prototype,m.iq=0,m.Bd=function(e){var o=go(this,e,!0);if(this.iq=o){var s=this.Fi;if(e=ho(e),s.startInteraction(o,this.ta),s.interaction.apply(s,e),this.Rb&Zn&&!(this.Rb&ao)&&(o=e[0],s=e[1],this.Rm)){e=this.u.Ub();var h=(0>this.Rm?Cb:Bb)(e);e!==h&&(this.Rm=0,this.Ii(e,h,o,s))}}},m.hg=function(e){var o=go(this,e,!1);if(o!==this.iq)e.originalEvent.type!=="pointerout"&&e.originalEvent.type!=="pointerover"&&(this.df(e),this.Bd(e));else if(o){o=this.Fi;var s=ho(e);o.interaction.apply(o,s),e.originalEvent.preventDefault()}},m.df=function(e){go(this,e,!1)&&this.Fi.endInteraction(!this.ta)},m.Ii=function(e,o,s,h){var d=this.u.wa;if(isNaN(+e))throw Error("start zoom needs to be a number");if(isNaN(+o))throw Error("to zoom needs to be a number");+o-+e!==0&&(d.startControl(null,s,h),d.control(0,0,6,0,0,0),d.endControl(!0,function(g){g.zoom=o}))},m.Sv=function(e){if(!e.defaultPrevented&&this.Rb&Zn){var o=e.delta,s=this.u.Ub(),h=this.u,d=h.Ba.type;h=this.Rb&ao?s-o:(0>-o?Cb:Bb)(s)-o,(d===Rf.P2D||d===Rf.WEBGL||d===Rf.HARP)&&(this.Ii(s,h,e.viewportX,e.viewportY),this.Rm=o),e.preventDefault()}},m.he=function(){},m.Kv=function(e){var o=e.currentPointer,s=this.u.Ub(),h=e.currentPointer.type,d=this.u.Ba.type;(d===Rf.P2D||d===Rf.WEBGL||d===Rf.HARP)&&this.Rb&$n&&(e=h==="mouse"?e.originalEvent.button===0?-1:1:0<e.pointers.length?1:-1,e=this.Rb&ao?s-e:(0>-e?Cb:Bb)(s)-e,this.Ii(s,e,o.viewportX,o.viewportY))},m.bn=function(e){return this.Rb&$n?(e.preventDefault(),!1):!0},m.l=function(){var e=this.u;e&&(e.draggable=!1,e.removeEventListener("dragstart",this.Bd,!1,this),e.removeEventListener("drag",this.hg,!1,this),e.removeEventListener("dragend",this.df,!0,this),e.removeEventListener("wheel",this.Sv,!1,this),e.removeEventListener("dbltap",this.Kv,!1,this),e.removeEventListener("pointermove",this.he,!1,this),delete this.u),this.sl&&(this.sl.style.msTouchAction="",Sc(this.sl,"contextmenu",this.bn,!1,this),delete this.sl),delete this.Fi,delete this.ta,Vn.splice(Vn.indexOf(this.qv),1),delete this.qv,hc.prototype.l.call(this)},Un.prototype.dispose=Un.prototype.l,t("H.mapevents.buildInfo",function(){return Zm("H-mapevents","1.57.0","161a2e3",{region:"row"})}),R.prototype.Yn=da(3,function(e){var o=this.getCache(),s=this;if(e!==z){C(e,Ri,R.prototype.Yn,0);var h=e}else h=$i;h!==o&&o.ia(function(d,g,_){return s.cc(d)?(h.add(d,g,_),!0):!1}),this.jt=h}),Bf.prototype.Yb=da(0,function(e){this.ts=e,e=this.getState(),e!==df.INIT&&e!==df.LOADING&&If(this)});function io(e){return e=e.Ud("_#-;,:","_#-;,:","_#-;,:"),new RegExp("^"+e.replace(/[.*+?^${}()|[\]\\\/]/g,"\\$&").replace(/_#-;,:/g,"\\d+")+"$")}function jo(e,o){return Pa.apply(null,arguments),e}function ko(e,o){var s=x.console;s&&s.warn&&(e=cb(e)+" is deprecated and will be removed soon. ",o&&(e+=o),s.warn(e))}var lo={},mo=globalThis;function no(){}no.prototype.pop=function(e){return this[e]||(this[e]=[]),this[e].pop()||document.createElement("canvas")},no.prototype.push=function(e,o){this[o]||(this[o]=[]),this[o].push(e)};var oo=new no;t("H.service.util.eval",function(a){return eval(a)});function po(e,o){if(o=o===void 0?{}:o,!e.Hm)throw new wb(e);po.g.constructor.call(this);var s=qo(this,o);if(!s.baseUrl&&!s.platformBaseUrl)throw new D(e,0,'either "baseUrl" or "platformBaseUrl" must be specified');this.wc=(s.baseUrl?s.baseUrl:s.platformBaseUrl).clone(),e=s.baseUrl?o:s,e.host&&this.wc.Qk(e.host),e.subDomain&&this.wc.Ha(e.subDomain),e.path&&this.wc.Fg(e.path),ro(this.wc),this.Mc=s.headers||{}}u(po,K),t("H.service.Service",po);function qo(e,o){return e=e.Ca(),o?jo({},e,o):e}po.prototype.Ca=function(){return{}},po.prototype.i=function(){return this.wc},po.prototype.getUrl=po.prototype.i,po.prototype.s=function(e,o,s,h){return h=new Ue(h===void 0?"application/json":h,e.toString(),ge,{headers:this.Mc}),h.then(o,so(this,e,s)),h};function so(e,o,s){return function(h){return typeof h.json!="function"?Promise.reject(s(to(o,h))):h.json().then(function(d){return s(e.qd(d))},function(){return s(to(o,h))})}}po.prototype.qd=function(e){return Error(e.message)};function to(e,o){return Error((o.statusText?"["+o.statusText+"] ":"")+e+" request failed")}function uo(e,o){C(e,vo,uo,0);var s={};Object.assign(s,o),s.min=s.min||0,s.max=s.max||20,s.tileSize=s.tileSize||512,s.getURL=function(h,d,g){return e.Rf(h,d,g).clone().B({size:s.tileSize})},kj.call(this,s),this.$=e}u(uo,kj),t("H.service.rasterTile.Provider",uo),uo.prototype.U=function(e,o){var s=this.$;return s.U().query(s.Ci.Rn+"."+s.J(),o,e)},uo.prototype.getCopyrights=uo.prototype.U,uo.prototype.Vi=function(){return Mm()},uo.prototype.sd=function(){return Mm()?Lm():uo.g.sd.call(this)};function V(e,o,s,h,d,g){if(e&&o)this.$r(e),this.Qk(o),this.Fg(s),this.Wr(d),this.Nw(g),this.Tk(h);else throw new D(V,B,'Parameters "scheme" and "host" must be specified')}t("H.service.Url",V);function wo(e,o){var s=x.document,h,d="";if(s){if(d=s.createElement("a"),o){var g=(h=s.getElementsByTagName("base")[0])&&h.href,_=s.head,j=h||_.appendChild(s.createElement("base"));j.href=o}d.href=e,d=d.href,o&&(h?h.href=g:_.removeChild(j))}else/[\w]+:\/\//.test(e)&&(d=e);g=/(?:(\w+):\/\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\/[^?#]*)?(\?[^#]+)?(#.*)?/.exec(d),e=g[1],_=g[4],o=g[5],j=g[6],s=g[7],h=g[8],!g[2]&&_&&/@/.test(_)&&(_=_.split("@")[1]),g=V,j=j&&0<j.length?j.substr(1):"",d={};var $,_t;if(s)for($=/([?&]?([^=&+]+))(=([^&]+))?/g;_t=$.exec(s);)d[decodeURIComponent(_t[2])]=_t[4]?decodeURIComponent(_t[4]):void 0;return new g(e,_,j,d,isNaN(+o)?void 0:+o,h&&0<h.length?h.substr(1):"")}V.parse=wo,V.prototype.clone=function(){var e={},o;for(o in this.Fa)e[o]=this.Fa[o];return new V(this.oi,this.Qj,this.hf,e,this.uk,this.Db)},V.prototype.clone=V.prototype.clone,V.prototype.$r=function(e){if(!e||typeof e!="string")throw new D(this.$r,0,'The "scheme" parameter must be a non-empty string.');return this.oi=e,this},V.prototype.setScheme=V.prototype.$r,V.prototype.AA=function(){return this.oi},V.prototype.getScheme=V.prototype.AA,V.prototype.Qk=function(e){if(!e||typeof e!="string"||e.charAt(0)==="-"||e.charAt(0)==="."||e.charAt(e.length-1)===".")throw new D(this.Qk,0,'The "host" parameter is not a valid host name.');return this.Qj=e,this},V.prototype.setHost=V.prototype.Qk,V.prototype.Tz=function(){return this.Qj},V.prototype.getHost=V.prototype.Tz,V.prototype.Fg=function(e){return this.hf=e||void 0,this},V.prototype.setPath=V.prototype.Fg,V.prototype.mA=function(){return this.hf},V.prototype.getPath=V.prototype.mA,V.prototype.Tk=function(e){if(e)if(typeof e=="object")this.Fa=e;else throw new D(this.Tk,0,'Parameter "params" must be an object.');else this.Fa={};return this},V.prototype.setQuery=V.prototype.Tk,V.prototype.Cu=function(){return!xo(this)},V.prototype.hasQuery=V.prototype.Cu,V.prototype.getQuery=function(){return this.Fa},V.prototype.getQuery=V.prototype.getQuery,V.prototype.Wr=function(e){if(e===void 0)this.uk=e;else{var o=ac(+e<<0,0,65535);if(o!=e)throw new D(this.Wr,0,'Parameter "port" must be an integer in range [0...65535]');this.uk=o}return this},V.prototype.setPort=V.prototype.Wr,V.prototype.rA=function(){return this.uk},V.prototype.getPort=V.prototype.rA,V.prototype.Nw=function(e){return this.Db=e||void 0,this},V.prototype.setAnchor=V.prototype.Nw,V.prototype.yp=function(){return this.Db},V.prototype.getAnchor=V.prototype.yp,V.prototype.B=function(e){if(typeof e!="object")throw new D(this.B,0,'Parameter "other" must be an object.');var o=this.Fa,s;for(s in e)e.hasOwnProperty(s)&&typeof e[s]!="function"&&(o[s]=e[s]);return this},V.prototype.mergeQuery=V.prototype.B,V.prototype.Ha=function(e){if(!e||typeof e!="string")throw new D(this.Ha,0,'Parameter "subDomain" must be a non-empty string');return e.substr(e.length-1)==="."&&(e=e.substr(0,e.length-1)),this.Qk(e+"."+this.Qj)},V.prototype.addSubDomain=V.prototype.Ha,V.prototype.v=function(e){if(!e||typeof e!="string")throw new D(this.v,0,'Parameter "subPath" must be a non-empty string');return this.Fg((this.hf?this.hf+"/":"")+e)},V.prototype.addSubPath=V.prototype.v,V.prototype.toString=function(){return[this.oi+"://",this.Qj,this.uk?":"+this.uk:"",this.hf||!xo(this)||this.Db?"/":"",this.hf?encodeURI(this.hf):"",yo(this),this.Db?"#"+encodeURIComponent(this.Db):""].join("")},V.prototype.toString=V.prototype.toString;function zo(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(o){return"%"+o.charCodeAt(0).toString(16)})}function yo(e){var o=[],s=e.Fa,h={},d;for(d in s){if(s.hasOwnProperty(d)&&typeof s[d]!="function"){var g=e.Fa[d];h.Og=zo(d),C(g,Ao)?g.jo.forEach(function(_){return function(j){o.push(_.Og+"="+zo(j))}}(h)):C(g,Bo)?o.push(h.Og+"="+g.jo.map(function(_){return zo(_)}).join(g.Qy)):o.push(g===void 0?h.Og:h.Og+"="+zo(g))}h={Og:h.Og}}return 0<o.length?"?"+o.join("&"):""}function ro(e){var o=Zm("H-service","1.57.0","161a2e3",{region:"row"});return e.Fa.xnlp="CL_JSMv3."+o.version,e}function xo(e){var o,s=0;for(o in e.Fa)if(e.Fa.hasOwnProperty(o)&&typeof e.Fa[o]!="function"&&(s++,0<s))break;return!s}function Co(e,o){if(fb(e))for(var s=0;s<e.length;s++){var h=e[s];if(!gb(h)&&!jb(h)){var d="The Array does not contain only strings and numbers";break}}else d="Not an Array";if(d)throw new D(o,0,e);return e}function Ao(e){this.jo=Co(e,Ao)}V.MultiValueQueryParameter=Ao,Ao.prototype.LA=function(){return this.jo},Ao.prototype.getValues=Ao.prototype.LA;function Bo(e,o){if(this.jo=Co(e,Bo),!/^[!\$\(\)\*\+,;]$/.test(o))throw new D(Bo,1,'Invalid delimiter "'+o+'"');this.Qy=o}V.DelimitedQuerySubValues=Bo;function X(e){e=jo({},this.Oy,e);var o=e.apikey||e.apiKey,s=e.baseUrl;if(s=o?s?0:"baseUrl":"apikey")throw new D(X,0,'"'+s+'" must be specified');this.Qw(e.baseUrl),this.ct=o,this.kd.B({apikey:o}),this.Mc=e.headers||{},this.UC=Na(e.servicesConfig||{})}t("H.service.Platform",X),X.prototype.Oy={apikey:null,baseUrl:new V("https","hereapi.com")},X.prototype.Qw=function(e){this.kd=ro(e.clone()),this.ct=e=this.ct,this.kd.B({apikey:e})},X.prototype.setBaseUrl=X.prototype.Qw,X.prototype.Ic=function(){return this.kd},X.prototype.getBaseUrl=X.prototype.Ic,X.prototype.Ta=function(e,o){try{return e.Hm=!0,new e(jo({platformBaseUrl:this.Ic(),headers:this.Mc},this.UC[e.CONFIG_KEY]||{},o||{}))}finally{e.Hm=!1}},X.prototype.createService=X.prototype.Ta,X.prototype.Yl=function(e,o,s){var h=this;if(!H.map.render.harp)throw Error("HARP engine module not found");if(!ya(e)&&!gb(e))throw new D(this.Yl,0,"is invalid: must be either a configuration object or a URL");if(!Za(o))throw new D(this.Yl,1,"is invalid: must be a Function");if(!Za(s))throw new D(this.Yl,2,"is invalid: must be a Function");var d=new H.map.render.harp.Style(e);d.addEventListener("change",function(){var g=d.getState();if(g===-1)s(Error("H.service.platform#createHybridLayers method failed to load style configuration"));else if(g===2){g={dark:!0};var _=h.Qp({resource:"background",queryParams:{style:"satellite.day"}}),j=d.Rd(),$={styles:[{technique:"raster",attr:{gamma:1,brightness:1}}]};j.definitions&&(j.definitions["Satellite.Texture.Gamma"]!==void 0&&($.styles[0].attr.gamma=j.definitions["Satellite.Texture.Gamma"]),j.definitions["Satellite.Texture.Brightness"]!==void 0&&($.styles[0].attr.brightness=j.definitions["Satellite.Texture.Brightness"])),_=new uo(_,{engineType:Wm,style:new H.map.render.harp.Style($)}),o({raster:new Dk(_,g),vector:h.Lj().md(d,{engineType:Wm},g),traffic:h.Tp().md(d,{engineType:Wm},g)})}}),d.load()},X.prototype.createHybridLayers=X.prototype.Yl;function Do(e){Do.g.constructor.call(this,Do,e),this.Iw=qo(this,e).reverseSubDomain,ko(Do,"Use HERE Geocoding and Search API v7 instead.")}u(Do,po),t("H.service.GeocodingService",Do),Do.prototype.Ca=function(){return{subDomain:"geocoder.ls",reverseSubDomain:"reverse",path:"6.2"}},Do.CONFIG_KEY="geocoding",Do.prototype.qd=function(e){return Error(e.Details||e.message||e.error)},Do.prototype.xp=function(e,o,s){return e=this.i().clone().v("geocode.json").B(e),this.s(e,o,s)},Do.prototype.geocode=Do.prototype.xp,Do.prototype.Fr=function(e,o,s){return e=this.i().clone().v("reversegeocode.json").B(e),this.Iw&&e.Ha(this.Iw),this.s(e,o,s)},Do.prototype.reverseGeocode=Do.prototype.Fr,Do.prototype.search=function(e,o,s){return e=this.i().clone().v("search.json").B(e),this.s(e,o,s)},Do.prototype.search=Do.prototype.search,X.prototype.Pz=function(e){return this.Ta(Do,e)},X.prototype.getGeocodingService=X.prototype.Pz;function Eo(e){Eo.g.constructor.call(this,Eo,e)}u(Eo,po),t("H.service.publicTransit.Service",Eo),Eo.prototype.Ca=function(){return{subDomain:"transit.router",path:"v8"}},Eo.CONFIG_KEY="publicTransit",Eo.prototype.yA=function(e,o,s){return e=this.i().clone().v("routes").B(e),this.s(e,o,s)},Eo.prototype.getRoutes=Eo.prototype.yA,Eo.prototype.Fz=function(e,o,s){return e=this.i().clone().v("departures").B(e),this.s(e,o,s)},Eo.prototype.getDepartures=Eo.prototype.Fz,Eo.prototype.CA=function(e,o,s){return e=this.i().clone().v("stations").B(e),this.s(e,o,s)},Eo.prototype.getStations=Eo.prototype.CA,Eo.prototype.qd=function(e){return Error(JSON.stringify(e))},X.prototype.uA=function(e){return this.Ta(Eo,e)},X.prototype.getPublicTransitService=X.prototype.uA;function Fo(e){Fo.g.constructor.call(this,Fo,e)}u(Fo,po),t("H.service.SearchService",Fo),Fo.CONFIG_KEY="search",Fo.prototype.Ca=function(){return{subDomain:"search",path:"v1"}},Fo.prototype.qd=function(e){return e=[e.title,e.action,e.cause].filter(function(o){return o}),Error(e.join(". "))},Fo.prototype.xp=function(e,o,s){return e=this.i().clone().Ha("geocode").v("geocode").B(e),this.s(e,o,s)},Fo.prototype.geocode=Fo.prototype.xp,Fo.prototype.Fr=function(e,o,s){return e=this.i().clone().Ha("revgeocode").v("revgeocode").B(e),this.s(e,o,s)},Fo.prototype.reverseGeocode=Fo.prototype.Fr,Fo.prototype.oy=function(e,o,s){return e=this.i().clone().Ha("autosuggest").v("autosuggest").B(e),this.s(e,o,s)},Fo.prototype.autosuggest=Fo.prototype.oy,Fo.prototype.Ry=function(e,o,s){return e=this.i().clone().Ha("discover").v("discover").B(e),this.s(e,o,s)},Fo.prototype.discover=Fo.prototype.Ry,Fo.prototype.vB=function(e,o,s){return e=this.i().clone().Ha("lookup").v("lookup").B(e),this.s(e,o,s)},Fo.prototype.lookup=Fo.prototype.vB,Fo.prototype.sy=function(e,o,s){return e=this.i().clone().Ha("browse").v("browse").B(e),this.s(e,o,s)},Fo.prototype.browse=Fo.prototype.sy,X.prototype.BA=function(e){return this.Ta(Fo,e)},X.prototype.getSearchService=X.prototype.BA;function Go(e,o,s){s=s||{};var h=+s.min,d=+s.max;s.min=h?ac(h,1,17):1,s.max=d?ac(d,1,17):17,Go.g.constructor.call(this,s),C(e,Ho,Go,0),C(o,cf,Go,1),this.$=e,o.Yb&&o.Yb("OMV"),this.Xa(o,!0),this.Hl=io(this)}u(Go,R),t("H.service.trafficVectorTile.Provider",Go),Go.prototype.Vc=xe,Go.prototype.providesOMV=Go.prototype.Vc,Go.prototype.cc=function(e){return this.Hl.test(e)},Go.prototype.cacheFilter=Go.prototype.cc,Go.prototype.Ud=function(e,o,s){return this.$.Rf(e,o,s).toString()},Go.prototype.getTileKey=Go.prototype.Ud,Go.prototype.Sb=function(){return this.vf},Go.prototype.getCache=Go.prototype.Sb,Go.prototype.MAX_STORE_TIME=2592e6,Go.prototype.Vi=function(){return Mm()},Go.prototype.sd=function(){return Mm()?Lm():Go.g.sd.call(this)},Go.prototype.s=function(e,o,s,h,d){return this.$.Oa(e,o,s,h,d)},Go.prototype.requestInternal=Go.prototype.s,Go.prototype.Cb=function(e){e.Yb&&e.Yb("OMV"),this.Xa(e)},Go.prototype.setStyle=Go.prototype.Cb,Go.prototype.J=function(){return Go.g.mb.apply(this)},Go.prototype.getStyle=Go.prototype.J,Go.prototype.vf=new Ri(256),Go.prototype.U=function(){return null},Go.prototype.getCopyrights=Go.prototype.U;function Ho(e){Ho.g.constructor.call(this,Ho,e),this.Aq=(e||Be).layer||"traffic",this.le="mc",this.iz="omv"}u(Ho,po),t("H.service.trafficVectorTile.Service",Ho),Ho.prototype.Ca=function(){return{subDomain:"traffic.vector",path:"v2"}},Ho.CONFIG_KEY="trafficVectorTile",Ho.prototype.md=function(e,o,s){o=o||{};var h={min:0,max:22};return ya(s)&&jo(h,s),new Dk(new Go(this,e,o),h)},Ho.prototype.createLayer=Ho.prototype.md,Ho.prototype.Oa=function(e,o,s,h,d){return this.s(this.Rf(e,o,s),function(g){return g.arrayBuffer().then(h,d)},d,"arraybuffer")},Ho.prototype.Rf=function(e,o,s){return this.i().clone().v("traffictiles/"+this.Aq+"/"+this.le+"/"+s+"/"+e+"/"+o+"/"+this.iz)},Ho.prototype.rm=function(e){return ln()+"/"+e},Ho.prototype.$z=function(){return this.Aq},Ho.prototype.getLayerName=Ho.prototype.$z,X.prototype.Tp=function(e){return this.Ta(Ho,e)},X.prototype.getTrafficVectorTileService=X.prototype.Tp;function Io(e){Io.g.constructor.call(this,Io,e)}u(Io,po),t("H.service.traffic.Service7",Io),Io.prototype.Ca=function(){return{subDomain:"data.traffic",path:"v7"}},Io.CONFIG_KEY="traffic_v7",Io.prototype.IC=function(e,o,s,h){return e=this.i().clone().v(["incidents",e].join("/")).B(o||{}),this.s(e,s,h)},Io.prototype.requestIncidentById=Io.prototype.IC,Io.prototype.GC=function(e,o,s){return e=this.i().clone().v("flow").B(e||{}),this.s(e,o,s)},Io.prototype.requestFlowByArea=Io.prototype.GC,Io.prototype.LC=function(e,o,s){return e=this.i().clone().v("incidents").B(e||{}),this.s(e,o,s)},Io.prototype.requestIncidentsByArea=Io.prototype.LC;var Jo="A21 A22 F01 F02 F08 F04 F05 F07 F03 F06 A2F F13 A25 A2C F12 D1B F1B A27 E12 A3A A24 A3D A3F F1F F25 F2C E32 A33 F29 D26 D36 F26 D0F F0F F2B E0C D3A A45 D23 D11 F2E F19 F14 F39 A4A A4B A5C D38 F2A F1A D0A F1C A48 D25 D1D F32 A46 A3E D24 E1C E32 A5F D2E D22 D0A".split(" ");function Ko(e,o,s,h){Ko.g.constructor.call(this,{min:10,max:21,engineType:h}),C(e,Lo,Ko,0),this.$=e,this.Fa=s||Mo,this.Fa.responseattributes="sh,fc",this.yr=setInterval(A(this.reload,this),o||18e4),this.vb===Rf.WEBGL?this.Xa(new Bf(e.rm("traffic/flow.yaml")),!0):this.Xa(new H.map.render.harp.Style({styles:[{when:["==",["geometry-type"],"LineString"],technique:"solid-line",renderOrder:10002,attr:{color:["case",[">=",["get","JF"],10],"black",[">=",["get","JF"],8],"red",[">=",["get","JF"],4],"yellow","green"],width:3,metricUnit:"Pixel"}}]}))}u(Ko,R),t("H.service.traffic.flow.Provider",Ko),Ko.prototype.rr=xe,Ko.prototype.providesGeoJSON=Ko.prototype.rr,Ko.prototype.J=function(){return this.mb()},Ko.prototype.getStyle=Ko.prototype.J,Ko.prototype.Cb=function(e){e.Yb&&e.Yb("GeoJSONTileSource"),this.Xa(e)},Ko.prototype.setStyle=Ko.prototype.Cb;var Mo={locationreferences:"tmc,shp"};Ko.prototype.disposeInternal=function(){Ko.g.disposeInternal.call(this),clearInterval(this.yr)},Ko.prototype.s=function(e,o,s,h,d){return this.$.requestFlowByTile(e,o,s,function(g){g.type&&g.type.indexOf("Error")!==-1?d(g.Details):h(g)},d,this.Fa)},Ko.prototype.requestInternal=Ko.prototype.s,Ko.prototype.nd=function(e,o,s,h,d){var g,_,j,$,_t={type:"FeatureCollection",features:[]},_e,_r=h.RWS.length;for(g=0;g<_r;g++){var _i=h.RWS[g],_n=_i.RW,_s=_n.length,_l=Jo.indexOf(_i.EXTENDED_COUNTRY_CODE+_i.EBU_COUNTRY_CODE)!==-1;for(_i=0;_i<_s;_i++){var Ap=_n[_i].FIS,_h=Ap.length;for(Ap=0;Ap<_h;Ap++){var _p=_n[_i].FIS[Ap].FI,ty=_p.length;for(_=0;_<ty;_++){var ry=_p[_],ly=[],uy=ry.CF[0],py=!!uy.SSS,fy={type:"Feature",properties:uy,geometry:{type:"MultiLineString",coordinates:ly}};for(fy.properties.LHT=_l,ry.SHP.length&&(fy.properties.FC=ry.SHP[0].FC),py&&(_e=[]),uy=0;uy<ry.SHP.length;uy++){var my=ry.SHP[uy].value,xy=my.length;for(j=0;j<xy;j++){var Ly=py?_e:void 0,My=new Gh(my[j].trim()),Ry=[],Sy={};for(My.yi();($=My.eb())!==-1;)$===No?(Sy.lat=+String.fromCharCode.apply(Ko,My.mh()),My.next(),My.yi()):$===Oo?(Sy.lng=+String.fromCharCode.apply(Ko,My.mh()),Ry.push([Sy.lng,Sy.lat]),Ly&&Ly.push(hd(Sy)),Sy=[],My.next(),My.yi()):My.next();Sy.lng=+String.fromCharCode.apply(Ko,My.mh()),Ry.push([Sy.lng,Sy.lat]),Ly&&Ly.push(hd(Sy)),$=Ry,ly.push($)}}_t.features.push(fy)}}}}return Ko.g.nd.call(this,e,o,s,_t,d)},Ko.prototype.createTileInternal=Ko.prototype.nd;var Oo=32,No=44;function Po(){this.ud={}}Po.prototype.kc=function(e,o){var s=e+o,h;return(h=this.ud[s])?h:(e=Qo.MARKER.replace("{{icon}}",Ro[e]||Ro.OTHER),e=e.replace("{{color}}",So[o]||So.BLOCKING),o={size:{w:26,h:33},anchor:{x:13,y:30},hitArea:new Ii(Ji.POLYGON,To.MARKER)},this.ud[s]=h=new um(e,o))};var Qo={MARKER:'<svg width="26" height="33" enable-background="new 0 0 26 33" viewBox="0 0 26 33" xmlns="http://www.w3.org/2000/svg"><path d="m26 33h-26v-33h26z" fill="#8c8c8c" opacity="0"/><path d="m17 29.566c0 1.116-1.791 2.022-4 2.022s-4-.906-4-2.022c0-1.118 1.791-2.026 4-2.026s4 .908 4 2.026" fill="#878787" opacity=".6"/><path d="m1.795 17.971c-1.562-1.555-1.574-3.828-.028-5.655l8.343-10.021c.769-.895 1.795-1.384 2.894-1.384 1.117 0 2.197.521 2.889 1.394l8.338 10.014c1.588 1.854 1.578 4.022-.029 5.65l-11.202 11.202z" fill="{{color}}"/>{{icon}}</svg>'},Ro={CONGESTION:'<path style="fill:#FFFFFF;" d="M12.966,1.177c0.965,0,1.894,0.442,2.496,1.204l8.378,10.258c1.362,1.592,1.482,3.477,0,4.979L12.994,28.464L2.143,17.618c-1.381-1.375-1.38-3.348,0-4.979l8.314-10.258C11.174,1.547,12.085,1.177,12.966,1.177 M12.967,0.177L12.967,0.177c-1.247,0-2.408,0.551-3.269,1.552l-8.332,10.28c-1.711,2.022-1.688,4.567,0.07,6.317l10.85,10.845l0.707,0.707l0.707-0.707l10.847-10.846c1.784-1.807,1.803-4.292,0.053-6.337L16.237,1.748C15.462,0.769,14.236,0.177,12.967,0.177L12.967,0.177z M16.645,10.405l-2.025-2.22c-0.48-0.51-1.15-0.8-1.84-0.8H9.53c-0.69,0-1.36,0.29-1.84,0.8l-1.94,2.22c-0.39,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.44l0.255-0.539c0.204-0.431,0.456-0.837,0.753-1.21l0.962-1.211l0.83-0.9c0.32-0.35,0.72-0.63,1.15-0.82H8.23c-0.28,0-0.55-0.07-0.79-0.22l-0.28-0.17l1.27-1.45c0.28-0.31,0.68-0.48,1.1-0.48h3.25c0.42,0,0.82,0.17,1.1,0.48l1.354,1.54H16.645z M18.31,12.205c-0.35-0.37-0.81-0.63-1.3-0.74c-0.18-0.04-0.36-0.06-0.54-0.06h-3.24c-0.7,0-1.37,0.29-1.84,0.8l-1.13,1.22l-0.82,1c-0.38,0.63-0.59,1.35-0.59,2.09v1.64c0,0.69,0.56,1.25,1.25,1.25h1.75v-1h5.99v1h1.75c0.69,0,1.25-0.56,1.25-1.25v-1.64c0-0.74-0.2-1.46-0.59-2.09L18.31,12.205z M12.1,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C12.35,16.993,12.238,17.105,12.1,17.105z M18.59,17.105h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C18.84,16.993,18.728,17.105,18.59,17.105z M18.56,14.505c-0.24,0.15-0.51,0.22-0.79,0.22h-5.85c-0.28,0-0.55-0.07-0.78-0.22l-0.29-0.17l1.27-1.45c0.15-0.16,0.33-0.28,0.53-0.37c0.18-0.07,0.38-0.11,0.58-0.11h3.24c0.24,0,0.48,0.06,0.68,0.16c0.16,0.08,0.3,0.19,0.42,0.32l1.27,1.45L18.56,14.505z M8.42,13.03h-1c-0.138,0-0.25-0.112-0.25-0.25v-1c0-0.138,0.112-0.25,0.25-0.25h1c0.138,0,0.25,0.112,0.25,0.25v1C8.67,12.918,8.559,13.03,8.42,13.03z"/>',ROADWORKS:'<path d="m13.004 1.411c.964 0 1.894.441 2.496 1.204l8.346 10.023c1.363 1.592 1.482 3.477 0 4.979l-10.846 10.847-10.852-10.846c-1.381-1.375-1.379-3.348 0-4.979l8.346-10.023c.717-.835 1.628-1.205 2.51-1.205m0-1c-1.248 0-2.408.551-3.268 1.552l-8.356 10.035c-1.718 2.033-1.695 4.578.064 6.328l10.85 10.845.706.707.707-.707 10.846-10.846c1.784-1.808 1.803-4.293.053-6.337l-8.337-10.012c-.769-.973-1.996-1.565-3.265-1.565zm-.575 15.264c.018-.332-.13-.651-.394-.851l-2.945-2.235-.21.36c-.22.39-.41.78-.58 1.19l-.677 2.129-1.364 3.051h1.314l2.109-4.672 1.317 1.212.138 3.46h1.092zm6.16-1.327c-.401-.54-1.209-.539-1.609.001l-1.17 1.58-2.29-1.74-.139-4.054c-.011-.276-.134-.535-.342-.716l-.7-.61c-.185-.161-.422-.25-.667-.25h-1.885c-.335 0-.648.168-.833.447l-1.144 1.723 7.58 5.76-1.86 2.51c-.098.132-.004.32.161.32h6.648l1.142-1.077zm-8.79-2.989-.876-.665.841-1.018.965.043zm1.63 1.24.969-1.781.118 2.61zm2.76-5.79c-.64 0-1.16.52-1.16 1.16 0 .65.52 1.17 1.16 1.17s1.16-.52 1.16-1.17c0-.64-.52-1.16-1.16-1.16z" fill="#fff"/>',ACCIDENT:'<path style="fill:#FFFFFF;" d="M12.998,1.091c0.964,0,1.894,0.442,2.496,1.204l8.346,10.344c1.363,1.592,1.482,3.477,0,4.979L12.994,28.465L2.143,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.344C11.205,1.462,12.115,1.091,12.998,1.091 M12.998,0.091L12.998,0.091c-1.248,0-2.408,0.551-3.269,1.552L1.364,12.011c-1.708,2.021-1.685,4.566,0.073,6.316l10.85,10.845l0.707,0.707l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337l-8.327-10.32C15.494,0.684,14.268,0.091,12.998,0.091L12.998,0.091z M7.83,18.982l-3.309-1.855l0.945,1.855H7.83z M16.111,19h3.942l1.596-2L16.111,19z M10.512,20.064l1.021-1.021l1.632,0.076c0.329,0.018,0.651-0.022,0.963-0.123c0.626-0.206,1.122-0.76,1.288-1.44l0.264-1.089l2.066-0.93c0.373-0.17,0.673-0.42,0.861-0.731c0.275-0.449,0.405-0.97,0.369-1.498L18.9,11.676l1.021-1.021l-0.724-0.724l-0.427,0.427l-0.121-0.364c-0.201-0.603-0.54-1.151-0.989-1.6l-1.159-1.159c-0.5-0.5-1.31-0.5-1.809,0l-1.267,1.267l0.724,0.724l-5.066,5.066l-0.724-0.724l-1.267,1.267c-0.5,0.5-0.5,1.31,0,1.809l1.159,1.159c0.449,0.449,0.997,0.788,1.6,0.989l0.364,0.121l-0.427,0.427L10.512,20.064z M14.901,10.349l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0l-0.732-0.732C14.803,10.604,14.803,10.446,14.901,10.349z M9.472,15.777l0.732-0.732c0.098-0.098,0.256-0.098,0.354,0l0.732,0.732c0.098,0.098,0.098,0.256,0,0.354l-0.732,0.732c-0.098,0.098-0.256,0.098-0.354,0L9.472,16.13C9.375,16.033,9.375,15.874,9.472,15.777z M11.391,17.615c0.069-0.271,0.206-0.518,0.405-0.717l4.961-4.961c0.195-0.195,0.445-0.337,0.717-0.405l0.344-0.083l0.137,1.925c0.022,0.318-0.058,0.63-0.221,0.901c-0.101,0.166-0.279,0.271-0.409,0.329L14.8,15.74l-0.38,1.574c-0.083,0.344-0.318,0.615-0.612,0.713c-0.188,0.058-0.38,0.083-0.579,0.072l-1.925-0.138L11.391,17.615z"/>',OTHER:'<path style="fill:#FFFFFF;" d="M13.004,1.411c0.964,0,1.894,0.441,2.496,1.204l8.346,10.023c1.363,1.592,1.482,3.477,0,4.979L13,28.465L2.148,17.618c-1.381-1.375-1.379-3.348,0-4.979l8.346-10.023C11.211,1.781,12.122,1.411,13.004,1.411 M13.004,0.411L13.004,0.411c-1.248,0-2.408,0.551-3.268,1.552L1.38,11.998c-1.718,2.033-1.694,4.579,0.064,6.328l10.85,10.845L13,29.878l0.707-0.707l10.846-10.846c1.784-1.808,1.803-4.293,0.053-6.337L16.269,1.976C15.5,1.003,14.273,0.411,13.004,0.411L13.004,0.411z M14.716,20.139c0,0.947-0.758,1.724-1.724,1.724c-0.947,0-1.704-0.777-1.704-1.724c0-0.928,0.757-1.704,1.704-1.704C13.958,18.435,14.716,19.211,14.716,20.139z M14.204,16.33H11.78l-0.537-8.533h3.5L14.204,16.33z"/>'},So={BLOCKING:"#323232",VERYHIGH:"#d5232f",HIGH:"#ffa100"},To={MARKER:[24.1,17.8,14.2,28.42,16.8,29.4,12.8,31.4,8.79,29.4,11.23,28.42,1.7,17.8,1.7,12.1,10,1.9,12.9,.498,15.8,1.9,24.1,12.1,24.1,17.8]};function Uo(e){if(!e||!Za(e.requestData))throw new D(Uo,0,"options.requestData");Uo.g.constructor.call(this,e),this.EC=e.requestData,this.uC=!!e.providesDomMarkers}u(Uo,R),t("H.map.provider.MarkerTileProvider",Uo),Uo.prototype.s=function(e,o,s,h,d){var g=this;return this.EC(e,o,s,function(_){for(var j=[],$,_t,_e=_.length;_e--;)_t=_[_e],_t.qD=g.getTileKey(e,o,s),_t.ea(g),$=_t.kc(),(C(_t,Pi)||$.getState()===1)&&j.push(_[_e]);h(j)},d)},Uo.prototype.requestInternal=Uo.prototype.s,Uo.prototype.Hh=function(e,o){o===li.VISUAL&&(e=this.Sb().get(e.qD))&&(e.valid=!1,this.jb(e))},Uo.prototype.invalidateObject=Uo.prototype.Hh,Uo.prototype.Tc=function(){return this.uC},Uo.prototype.providesDomMarkers=Uo.prototype.Tc,Uo.prototype.Uc=xe,Uo.prototype.providesMarkers=Uo.prototype.Uc;function Vo(e,o,s){s=s||{},s.criticality||(s.criticality="major,critical"),C(e,Lo,Vo,0),Uo.call(this,{max:20,min:8,requestData:A(this.JC,this),engineType:s.engineType}),this.ud=new Po,this.$=e,this.Fa=s,this.reload=A(this.reload,this),this.yr=setInterval(this.reload,o||18e4)}u(Vo,Uo),t("H.service.traffic.incidents.Provider",Vo);var Wo={minor:"HIGH","low impact":"HIGH",major:"VERYHIGH",critical:"BLOCKING"};Vo.prototype.JC=function(e,o,s,h,d){var g=this,_=this.ud;return this.$.requestIncidentsByTile(e,o,s,function(j){var $=[];j=j.TRAFFIC_ITEMS;var _t;if(j)for(j=j.TRAFFIC_ITEM,_t=j.length;_t--;){var _e=j[_t],_r=_e.TRAFFIC_ITEM_TYPE_DESC;switch(_r){case"ACCIDENT":case"CONGESTION":var _i=_r;break;case"CONSTRUCTION":_i="ROADWORKS";break;default:_i="OTHER"}_i=_.kc(_i,Wo[_e.CRITICALITY.DESCRIPTION]),_r=_e.LOCATION.GEOLOC.ORIGIN,_r=new $m({lat:_r.LATITUDE,lng:_r.LONGITUDE},{provider:g,icon:_i}),_r.setData(_e),$.push(_r)}h($)},d,this.Fa)},Vo.prototype.l=function(){Uo.prototype.l.call(this),clearInterval(this.yr)},Vo.prototype.dispose=Vo.prototype.l;function Xo(e){function o(_e){h.contains(d)&&h.removeChild(d),_t&&clearTimeout(_t),delete Xo.Br[g],_e&&e.Ot&&e.Ot.call($,_e)}if(!e.url||!e.Oo)throw Error('Parameter "options" must specify at least a URL and a callback.');if(typeof e.Oo!="function")throw Error("Parameters options.callback must be a function");var s=e.VD||document,h=s.getElementsByTagName("head")[0],d=s.createElement("script");s=e.url instanceof V?e.url:wo(e.url,e.TD);var g=Xo.PC++,_=e.vy||"callback",j=e.Oo,$={},_t=null;return $.id=g,$.cancel=function(){o("cancelled")},e.timeout!==0&&(_t=x.setTimeout(function(){o("timeout")},e.timeout||3e4)),Xo.Br[g]=function(_e){o(),j.call($,_e)},d.type="text/javascript",d.src=s.toString()+(s.Cu()?"&":"?")+_+"="+(e.WD?"H.service.jsonp.handleResponse("+g+")":encodeURI("H.service.jsonp.handleResponse("+g+")")),h.appendChild(d),$}t("H.service.jsonp",Xo),Xo.RA=function(e){return(e=Xo.Br[e])?e:function(){}},Xo.handleResponse=Xo.RA,Xo.PC=0,Xo.Br={};function Lo(e){Lo.g.constructor.call(this,Lo,e),this.wy=qo(this,e).callbackKey,this.Xe=!1}u(Lo,po),t("H.service.traffic.Service",Lo),Lo.prototype.Ca=function(){return{subDomain:"traffic.ls",path:"traffic/6.1",callbackKey:"jsoncallback"}},Lo.CONFIG_KEY="traffic",Lo.prototype.ut=function(e,o){return new Dk(new Ko(this,void 0,e,o),{max:22})},Lo.prototype.createFlowLayer=Lo.prototype.ut,Lo.prototype.vt=function(e){return new hg(new Vo(this,void 0,e))},Lo.prototype.createIncidentsLayer=Lo.prototype.vt;function Yo(e,o,s,h){return e.Xe||(ko(Lo,"Use HERE Traffic API v7 instead."),e.Xe=!0),Xo({url:o,Oo:s,Ot:function(d){h(Error("["+d+"] "+o+" request failed"))},vy:e.wy})}Lo.prototype.KC=function(e,o,s){return e=this.i().clone().v("incidents.json").B(e),Yo(this,e,o,s)},Lo.prototype.requestIncidents=Lo.prototype.KC,Lo.prototype.HC=function(e,o,s,h,d,g){return e=this.i().clone().v(["flow/json",s,e,o].join("/")).B(g||{}),Yo(this,e,h,d)},Lo.prototype.requestFlowByTile=Lo.prototype.HC,Lo.prototype.MC=function(e,o,s,h,d,g){return e=this.i().clone().v(["incidents/json",s,e,o].join("/")).B(g||{}),Yo(this,e,h,d)},Lo.prototype.requestIncidentsByTile=Lo.prototype.MC,Lo.prototype.rm=function(e){return ln()+"/"+e},X.prototype.Sp=function(e,o){if(o=o||6,o===6)o=Lo;else if(o===7)o=Io;else throw new D(this.Sp,1,"allowed values are 6 and 7");return this.Ta(o,e)},X.prototype.getTrafficService=X.prototype.Sp;function Zo(e){ko(Zo,"Use HERE Geocoding and Search API v7 instead."),Zo.g.constructor.call(this,Zo,e)}u(Zo,po),t("H.service.PlacesService",Zo),Zo.prototype.Ca=function(){return{subDomain:"places.ls",path:"places/v1"}},Zo.CONFIG_KEY="places",Zo.EntryPoint={SEARCH:"discover/search",SUGGEST:"suggest",EXPLORE:"discover/explore",AROUND:"discover/around",HERE:"discover/here",CATEGORIES:"categories/places"},Zo.prototype.request=function(e,o,s,h){return this.K(e,o,s,h)},Zo.prototype.request=Zo.prototype.request,Zo.prototype.K=function(e,o,s,h){return e=this.i().clone().v(e).B(o||{}),this.s(e,s,h)},Zo.prototype.search=function(e,o,s){return this.K("discover/search",e,o,s)},Zo.prototype.search=Zo.prototype.search,Zo.prototype.oD=function(e,o,s){return this.K("suggest",e,o,s)},Zo.prototype.suggest=Zo.prototype.oD,Zo.prototype.dz=function(e,o,s){return this.K("discover/explore",e,o,s)},Zo.prototype.explore=Zo.prototype.dz,Zo.prototype.my=function(e,o,s){return this.K("discover/around",e,o,s)},Zo.prototype.around=Zo.prototype.my,Zo.prototype.TA=function(e,o,s){return this.K("discover/here",e,o,s)},Zo.prototype.here=Zo.prototype.TA,Zo.prototype.yy=function(e,o,s){return this.K("categories/places",e,o,s)},Zo.prototype.categories=Zo.prototype.yy,Zo.prototype.gz=function(e,o,s,h){return e=wo(e).B(this.i().getQuery()).B(h||{}),this.s(e,o,s)},Zo.prototype.follow=Zo.prototype.gz,X.prototype.nA=function(e){return this.Ta(Zo,e)},X.prototype.getPlacesService=X.prototype.nA;function $o(e){$o.g.constructor.call(this,$o,e),this.tu=e.getToken}u($o,po),t("H.service.iml.Service",$o),$o.prototype.Ca=function(){return{host:"interactive.data.api.platform.here.com",path:"interactive/v1/catalogs"}},$o.prototype.qd=function(e){function o(){for(var h=fa(s),d=h.next();!d.done;d=h.next()){d=d.value;var g=d.format;if(d.keys.every(function(_){return e[_]}))return g()}return JSON.stringify(e)}var s=[{keys:["code","title","cause","action"],format:function(){return e.code+": "+e.title+"; cause: "+e.cause+"; action: "+e.action}},{keys:["error","error_description"],format:function(){return e.error+": "+e.error_description}},{keys:["error","errorMessage"],format:function(){return e.error+": "+e.errorMessage}}];return Error(ya(e)?o():e)},$o.prototype.Dh=function(e,o,s,h,d){var g=this.Dh;return ap(g,0,e,o),bp(g,2,s,h),e=this.i().clone().v(e+"/layers/"+o+"/statistics").B(d||{}),this.K(e,"GET",s,h)},$o.prototype.getStatistics=$o.prototype.Dh,$o.prototype.lm=function(e,o,s,h,d,g,_,j,$){var _t=$?"":".mvtf";return e=this.i().clone().v(h+"/layers/"+d+"/tile/web/"+s+"_"+e+"_"+o+_t).B(Object.assign({clip:!0},j)),this.K(e,"GET",$?g:function(_e){return _e.arrayBuffer().then(g)},_,void 0,$?"application/json":"arraybuffer")},$o.prototype.getFeaturesByTile=$o.prototype.lm,$o.prototype.hu=function(e,o,s,h,d,g){var _=this.hu;return cp(_,e),ap(_,1,o,s),bp(_,3,h,d),e=dp(this,e,o,s,g),this.K(e,"GET",h,d)},$o.prototype.getFeatureById=$o.prototype.hu,$o.prototype.Te=function(e,o,s,h,d,g){var _=this.Te;return ep(_,e),ap(_,1,o,s),bp(_,3,h,d),e=fp(this,e,o,s,g),this.K(e,"GET",h,d)},$o.prototype.getFeaturesById=$o.prototype.Te,$o.prototype.wh=function(e,o,s,h,d){var g=this.wh;if(!ya(e)||!(e.bbox||e.north&&e.east&&e.south&&e.west))throw new D(g,0,'must be an object with either "bbox" or a full set of "north", "east", "south" and "west"');return ap(g,1,o,s),bp(g,3,h,d),e=this.i().clone().v(o+"/layers/"+s+"/bbox").B(e),this.K(e,"GET",h,d)},$o.prototype.getFeaturesByBoundingBox=$o.prototype.wh,$o.prototype.ju=function(e,o,s,h,d){var g=this.ju;if(!(ya(e)&&e.radius&&(e.lat&&(e.lng||e.lon)||e.refCatalogHrn&&e.refLayerId&&e.refFeatureId)))throw new D(g,0,'must be an object with "radius" and a combination of either "lat"+"lng" or "refCatalogHrn"+"refLayerId"+"refFeatureId"');return ap(g,1,o,s),bp(g,3,h,d),e=this.i().clone().v(o+"/layers/"+s+"/spatial").B(e),this.K(e,"GET",h,d)},$o.prototype.getFeaturesByPointAndRadius=$o.prototype.ju,$o.prototype.iu=function(e,o,s,h,d,g){var _=this.iu;if(!ya(e)||!e.radius)throw new D(_,0,'must be an object with "radius"');return gp(_,1,o),ap(_,2,s,h),bp(_,4,d,g),e=this.i().clone().v(s+"/layers/"+h+"/spatial").B(e),this.K(e,"POST",d,g,o)},$o.prototype.getFeaturesByGeometryAndRadius=$o.prototype.iu,$o.prototype.Lw=function(e,o,s,h,d){var g=this.Lw;return ap(g,0,e,o),bp(g,2,s,h),e=this.i().clone().v(e+"/layers/"+o+"/search").B(d||{}),this.K(e,"GET",s,h)},$o.prototype.searchFeatures=$o.prototype.Lw,$o.prototype.Zu=function(e,o,s,h,d){var g=this.Zu;return ap(g,0,e,o),bp(g,2,s,h),e=this.i().clone().v(e+"/layers/"+o+"/iterate").B(d||{}),this.K(e,"GET",s,h)},$o.prototype.iterateFeatures=$o.prototype.Zu,$o.prototype.mf=function(e,o,s,h,d,g){var _=this.mf;return gp(_,0,e),ap(_,1,o,s),bp(_,3,h,d),o=hp(this,o,s,g),this.K(o,"PUT",h,d,e)},$o.prototype.putFeatures=$o.prototype.mf,$o.prototype.kf=function(e,o,s,h,d,g){var _=this.kf;return gp(_,0,e),ap(_,1,o,s),bp(_,3,h,d),o=hp(this,o,s,g),this.K(o,"POST",h,d,e)},$o.prototype.postFeatures=$o.prototype.kf,$o.prototype.Hf=function(e,o,s,h,d){var g=this.Hf;return ep(g,e),ap(g,1,o,s),bp(g,3,h,d),e=fp(this,e,o,s),this.K(e,"DELETE",h,d)},$o.prototype.deleteFeatures=$o.prototype.Hf,$o.prototype.vw=function(e,o,s,h,d,g,_){var j=this.vw;return cp(j,e),gp(j,1,o),ap(j,2,s,h),bp(j,4,d,g),e=dp(this,e,s,h,_),this.K(e,"PUT",d,g,o)},$o.prototype.putFeature=$o.prototype.vw,$o.prototype.bw=function(e,o,s,h,d,g,_){var j=this.bw;return cp(j,e),gp(j,1,o),ap(j,2,s,h),bp(j,4,d,g),e=dp(this,e,s,h,_),this.K(e,"PATCH",d,g,o)},$o.prototype.patchFeature=$o.prototype.bw,$o.prototype.Ct=function(e,o,s,h,d){var g=this.Ct;return cp(g,e),ap(g,1,o,s),bp(g,3,h,d),e=dp(this,e,o,s),this.K(e,"DELETE",h,d,void 0,"text/plain")},$o.prototype.deleteFeature=$o.prototype.Ct;function hp(e,o,s,h){return e.i().clone().v(o+"/layers/"+s+"/features").B(h||{})}function fp(e,o,s,h,d){return o=Object.assign({},d,{id:new Ao(o)}),hp(e,s,h,o)}function dp(e,o,s,h,d){return e.i().clone().v(s+"/layers/"+h+"/features/"+o).B(d||{})}$o.prototype.K=function(e,o,s,h,d,g){return g=g===void 0?"application/json":g,o={method:o,headers:Object.assign({},d?{"Content-Type":"application/geo+json"}:void 0,typeof this.tu=="function"?{Authorization:"Bearer "+this.tu()}:void 0,this.Mc)},d&&(o.data=JSON.stringify(d)),d=new Ue(g,e.toString(),ge,o),d.then(s,so(this,e,h)),d},$o.CONFIG_KEY="iml";function ap(e,o,s,h){db(s,"String",e,o,"must be a string"),db(h,"String",e,o+1,"must be a string")}function cp(e,o){db(o,"String",e,0,"must be a string")}function ep(e,o){if(!Array.isArray(o)||o.length===0||o.some(function(s){return typeof s!="string"}))throw new D(e,0,"must be a non-empty array of strings")}function gp(e,o,s){if(!ya(s))throw new D(e,o,"must be a GeoJSON object")}function bp(e,o,s,h){if(!Za(s))throw new D(e,o,"must be a function");if(!Za(h))throw new D(e,o+1,"must be a function")}X.prototype.Uz=function(e){return this.Ta($o,e)},X.prototype.getIMLService=X.prototype.Uz;function ip(e,o,s,h){if(ip.g.constructor.call(this,h?{min:h.min,max:h.max,engineType:h.engineType}:void 0),C(e,$o,ip,0),!gb(o))throw new D(ip,1,'"catalogHrn" must be a string');if(!gb(s))throw new D(ip,2,'"layerId" must be a string');this.$=e,this.$g=o,this.Mh=s,this.Ok=ya(h)&&ya(h.parameters)?h.parameters:{},this.Xa(this.Ep())}u(ip,R),t("H.service.iml.Provider",ip),ip.prototype.s=function(e,o,s,h,d){return this.$.lm(e,o,s,this.$g,this.Mh,h,d,this.Ok)},ip.prototype.requestInternal=ip.prototype.s,ip.prototype.Vc=xe,ip.prototype.providesOMV=ip.prototype.Vc,ip.prototype.J=function(){return this.mb()},ip.prototype.getStyle=ip.prototype.J,ip.prototype.Cb=function(e){C(e,Bf)&&e.Yb("MVT"),this.Xa(e)},ip.prototype.setStyle=ip.prototype.Cb,ip.prototype.Ep=function(){return this.vb===Rf.WEBGL?new Bf({sources:{iml:{type:"MVT"}},layers:{iml:{data:{source:"iml",layer:this.$g+":"+this.Mh},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#0258AE",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.$g+":"+this.Mh,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.$g+":"+this.Mh,when:["==",["geometry-type"],"Polygon"],technique:"polygon",color:"#E39E3C",renderOrder:201},{layer:this.$g+":"+this.Mh,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",width:"1px",renderOrder:202},{layer:this.$g+":"+this.Mh,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#0258AE",width:"2px",renderOrder:203}]})};function jp(e,o,s,h,d,g,_){var j=this;_=_||{},g=g||{};var $=e.i().clone().v(o+"/"+e.fb+"/"+s).B(g),_t=e.$c;this.$=e,this.qx=$,kj.call(this,{tileSize:h,max:h===512?19:20,min:h===512?2:0,getURL:function(_e,_r,_i){var _n=j.qx.clone();return _t&&_n.Ha(_t[(_i+_r+_e)%_t.length]),_n.v(_i+"/"+_e+"/"+_r+"/"+h+"/"+d),_n.toString()},crossOrigin:_.crossOrigin,headers:_.headers,uri:$.toString().replace(/_/g,"")+h,engineType:_.engineType}),this.sD=o,this.oi=s,this.Fa=g,this.Xo=s.split(".")[0],this.Be=A(this.Be,this),this.getCopyrights=this.U,this.Xe=!1,e.addEventListener("versionupdate",this.Be)}u(jp,kj),jp.prototype.MAX_STORE_TIME=2592e6,jp.prototype.s=function(e,o,s,h,d,g){return this.Xe||(ko(kp,"Use HERE Vector Tile API or Raster Tile API v3 instead."),this.Xe=!0),jp.g.s.call(this,e,o,s,h,d,g)},jp.prototype.requestInternal=jp.prototype.s,jp.prototype.disposeInternal=function(){kj.prototype.disposeInternal.call(this),this.$.removeEventListener("versionupdate",this.Be)},jp.prototype.U=function(e,o){return this.$.U().query(this.Xo,o,e)},jp.prototype.getCopyrights=jp.prototype.U,jp.prototype.Be=function(){var e=this.$;this.qx=e.i().clone().v(this.sD+"/"+e.fb+"/"+this.oi).B(this.Fa),this.reload(!1)},jp.prototype.Vi=function(){return Mm()},jp.prototype.sd=function(){return Mm()?Lm():jp.g.sd.call(this)};function lp(){this.qs={}}function mp(e,o){for(var s in o)o.hasOwnProperty(s)&&e.Bo(s,o[s])}lp.prototype.Bo=function(e,o){e=this.qs[e]||(this.qs[e]=[]);var s,h=o.length;for(s=0;s<h;s++){var d=new lo.Rs(o[s]);e.push(d)}},lp.prototype.query=function(e,o,s){e=this.qs[e];var h,d=e?e.length:0,g=[];for(h=0;h<d;h++)e[h].Vf(o,s)&&g.push(e[h]);return g},lo.Rs=function(e){var o,s=e.boxes;if(this.alt=e.alt,this.label=e.label,this.min=e.minLevel,this.max=e.maxLevel,this.Gn=[],s&&(o=s.length)){var h=s[0],d=new J(h[0],h[1],h[2],h[3]);for(this.Gn.push(d),this.rn=new J(h[0],h[1],h[2],h[3]),e=1;e<o;e++)h=s[e],d=new J(h[0],h[1],h[2],h[3]),this.Gn.push(d),this.rn.yd(d,!1,this.rn)}},lo.Rs.prototype.Vf=function(e,o){if(e>=this.min&&e<=this.max)if((e=this.Gn.length)&&this.rn){if(this.rn.Vf(o)){for(;e--;)if(this.Gn[e].Vf(o))return!0}}else return!0;return!1};function kp(e){kp.g.constructor.call(this,kp,e),e=qo(this,e),this.$c=e.shards,(this.Qa=e.ignoreTypes?null:e.type)&&this.i().Ha(this.Qa),this.fb=e.version,this.ec=new lp,this.pr={},this.Wl=0,this.fb==="newest"&&this.rp()}u(kp,po),t("H.service.MapTileService",kp),kp.prototype.Ca=function(){return{subDomain:"maps.ls",path:"maptile/2.1",type:"base",version:"newest",shards:["1","2","3","4"]}},kp.CONFIG_KEY="maptile";function np(e,o){for(var s={},h=e[o+"s"][o],d=h.length;d--;)s[h[d].id]=h[d];e[o+"s"]=s}kp.prototype.uu=function(){return this.Qa},kp.prototype.getType=kp.prototype.uu,kp.prototype.Wp=function(){return this.fb},kp.prototype.getVersion=kp.prototype.Wp,kp.prototype.cs=function(e){this.fb=e},kp.prototype.U=function(){return this.Wl||(this.fb&&this.fb!=="newest"||this.Qa==="traffic")&&this.Jf(),this.ec},kp.prototype.getCopyrights=kp.prototype.U,m=kp.prototype,m.ss=function(e){e=e.response;var o;if(np(e,"map"),np(e,"scheme"),np(e,"tiletype"),np(e,"format"),np(e,"resolution"),np(e,"language"),this.fb==="newest"&&this.Qa!=="traffic")for(o in e.maps)e.maps[o].hash&&e.maps[o].newest&&(this.cs(e.maps[o].hash),this.dispatchEvent("versionupdate"));this.fq=e,this.dispatchEvent("infoupdate")},m.pl=function(e){mp(this.ec,e),this.dispatchEvent("copyrightupdate")},m.rp=function(){var e=this,o=this.i().clone().v("info").B({output:"json"});this.$c&&o.Ha(this.$c[0]),this.s(o,function(s){e.ss(s)},function(s){throw s})},m.Jf=function(){var e=this,o=this.i().clone().v("copyright").v(e.fb).B({output:"json"});this.$c&&o.Ha(this.$c[0]),this.Wl=1,this.s(o,function(s){e.Wl=2,e.pl(s)},function(s){throw e.Wl=-1,s})},m.Kj=function(){return this.fq},kp.prototype.getInfo=kp.prototype.Kj,kp.prototype.nj=function(e,o,s,h,d,g){var _=this.i().clone().v(e+"/"+this.fb+"/"+o+"/"+s+"/"+h).B(d||{}).toString(),j=0,$,_t=_.length;if(_t!==0)for($=0;$<_t;$++){var _e=_.charCodeAt($);j=(j<<5)-j+_e,j|=0}return _=j,j=this.pr[_],j||(j=new jp(this,e,o,s,h,d,jo({headers:this.Mc},g||{})),this.pr[_]=j),j},kp.prototype.createTileProvider=kp.prototype.nj,kp.prototype.Od=function(e,o,s,h,d,g,_,j){return e=this.nj(e,o,s,h,d,j),new Dk(e,{opacity:g,dark:!!_})},kp.prototype.createTileLayer=kp.prototype.Od,X.prototype.Kp=function(e){return this.Ta(kp,e)},X.prototype.getMapTileService=X.prototype.Kp;function op(e,o,s,h){if(!Za(s))throw new D(e,o,"has invalid type");if(!Za(h))throw new D(e,o+1,"has invalid type")}function pp(e,o,s,h,d,g){op(pp,1,o,s),op(pp,2,h,d),(this.Tn=e.length)?(this.Ob=e,this.mn=o,this.dn=s,this.kk=0,this.vn=A(this.vn,this),this.Hy=h,this.Fy=d,this.Yh=Ta(),Pa(this.Yh,qp,g||{}),this.ks={},x.setTimeout(this.vn,0)):o(Ae,!0)}var qp={duration:100,oz:"geometry",nz:"WKT",TC:"searchAttributes",At:B};pp.prototype.vn=function(){for(var e=[],o=!1,s=Gj(),h;this.kk<this.Tn;){var d=this.Ob[this.kk];if(o=d.attributes,h=d.layerId||this.Yh.At,d.distance&&(o[this.Yh.TC]={nearest:new fd(d.nearestLat,d.nearestLon),distance:d.distance}),d=d[this.Yh.oz]){try{var g=nh(new Gh(d))}catch(_){this.dn(new x.Error(_.message)),o=!0;break}o[this.Yh.nz]=g}if((d=this.ks[h])||(d=this.ks[h]=this.Hy({layerId:h,columnNames:Object.keys(o)})),o=this.Fy(d,o),e.push(o),this.kk++,(o=this.kk===this.Tn)||Gj()-s>=this.Yh.duration){this.mn(e,o);break}}o?this.ks={}:this.kl=x.setTimeout(this.vn,0)},pp.prototype.cancel=function(){x.clearTimeout(this.kl),this.kk<this.Tn&&this.dn(new x.Error("parsing canceled"))},pp.prototype.cancel=pp.prototype.cancel;function rp(e,o){var s={};this.oC=e,Pa(s,o||s),lm.call(this,s),this.Jn={},e=this.Kc(ni.SPATIAL),e.update(e.Ld+1,li.ADD)}u(rp,lm),t("H.service.remote.ObjectProvider",rp),rp.prototype.l=function(){lm.prototype.l.call(this)},rp.prototype.dispose=rp.prototype.l,rp.prototype.pe=function(){return Ae},rp.prototype.requestMarkers=rp.prototype.pe,rp.prototype.oe=function(){return Ae},rp.prototype.requestDomMarkers=rp.prototype.oe,rp.prototype.wg=function(){return Ae},rp.prototype.requestOverlays=rp.prototype.wg,rp.prototype.Uc=xe,rp.prototype.providesMarkers=rp.prototype.Uc,rp.prototype.Tc=xe,rp.prototype.providesDomMarkers=rp.prototype.Tc,rp.prototype.me=xe,rp.prototype.providesSpatials=rp.prototype.me,rp.prototype.Nn=function(){return Ae},rp.prototype.requestSpatials=rp.prototype.Nn;function sp(e){return e.Vd(!0)}rp.prototype.On=function(e,o){return e=tp(this,e,up),o&&(e=e.filter(sp)),e},rp.prototype.requestSpatialsByTile=rp.prototype.On;function tp(e,o,s){var h=o.Ji&&o.Ji[s],d;return!h&&(d=o.ul)&&(delete o.ul,(o.Ji=e=e.oC.parse(e,o,d))&&(h=e[s])),h||Ae}rp.prototype.Y=function(e){var o=e.xb();if(this.Jn[o])throw new wb(this.Y,"Remote object "+o+" already added");return this.Jn[o]=e},rp.prototype.Na=function(e){delete this.Jn[e.xb()]};var up="spatials";function vp(e){e=e||{};var o=e.tileCacheSize||1024,s=e.resultType,h=e.styleCallback;if(ab(e.min)||(e.min=12),vp.g.constructor.call(this,e),wp.indexOf(s)===-1)throw new D(vp,2,"invalid resultType");if(this.resultType=s,h&&!Za(h))throw new D(vp,2,"invalid style callback");this.zi=h,this.na=e.pixelRatio||le(),this.Gc=A(this.Gc,this),this.Yn(new Ri(o,A(this.je,this))),this.createTileInternal=s===4||s===8?A(this.Gy,this):A(this.Ey,this)}u(vp,R),t("H.service.extension.TileProvider",vp),vp.prototype.rq=!1,vp.prototype.getCapabilities=function(){return vp.g.getCapabilities.call(this)|Kf.CROP_LINES_BY_TILE|Kf.CROP_POLYGONS_BY_TILE},vp.prototype.Oa=function(e,o,s,h){return this.rq?vp.g.Oa.call(this,e,o,s,h):B},vp.prototype.requestTile=vp.prototype.Oa,vp.prototype.Gc=function(e){this.dispatchEvent(new td("error",gb(e)?e:e+"",this))},vp.prototype.Uc=function(){return this.resultType===1},vp.prototype.providesMarkers=vp.prototype.Uc,vp.prototype.Tc=function(){return this.resultType===2},vp.prototype.providesDomMarkers=vp.prototype.Tc,vp.prototype.me=function(){return this.resultType===4||this.resultType===8},vp.prototype.providesSpatials=vp.prototype.me;function xp(e){var o=e.Ad;return o||(e.aw||(e.aw=e.pu(e.resultType,e.zi,e.Gc)),o=e.Ad=new rp(e.aw),o.ea(e),o.addEventListener(e.j.za,A(e.ge,e)),o.tw=!0),o}vp.prototype.Ey=function(e,o,s,h){var d=this.getTileKey(e,o,s);d=this.Sb().get(d);var g=this.resultType==2,_=[],j=xp(this);for(d?d.valid=!0:(e=d=new Wi(e,o,s,z),delete e.Ji,e.ul=h),h=g?tp(j,d,"domMarkers"):tp(j,d,"markers"),o=h.length;o--;)e=h[o],e.ys=d,(g||e.kc().getState()===1)&&_.push(e);return d.data=_,d},vp.prototype.ge=function(e){(e=e.target.ys)&&(e.valid=!1)},vp.prototype.$C=function(e){this.Ew=!!e},vp.prototype.setTileCanvasRendering=vp.prototype.$C,vp.prototype.Ew=!0,vp.prototype.Gy=function(e,o,s,h){var d=xp(this),g=this.getTileKey(e,o,s),_=this.tileSize,j=this.Sb().get(g);return j||(e=j=new Ok(g,e,o,s,_,this.na,s,d),delete e.Ji,e.ul=h),this.Ew?(h=oo.pop(_),j.L(h)||oo.push(h,_)):Uk(j),j},vp.prototype.je=function(e,o){var s;if(this.resultType===4||this.resultType===8){for(e=o.bb(),s=e.length;s--;)delete e[s].Fk[o.key];(e=o.Hn())&&(oo.push(e,this.tileSize),o.In())}else for(e=o.data,s=e.length;s--;)delete e[s].ys},vp.prototype.disposeInternal=function(){vp.g.disposeInternal.call(this),xp(this).l()};var yp={MARKER:1,DOM_MARKER:2,POLYLINE:4,POLYGON:8};vp.ResultType=yp;var wp=[1,2,4,8];function zp(e,o,s,h){h=h||Bp,this.Fk={},h.provider=e,this.invalidate=ye,zp.g.constructor.call(this,o,h),delete this.invalidate,s&&(this.BD=s),this.qa(li.ADD)}u(zp,ti),t("H.service.remote.Spatial",zp);var Bp={};zp.prototype.xb=function(){return this.BD||ti.prototype.xb.call(this)},zp.prototype.getId=zp.prototype.xb,zp.prototype.Sn=ze,zp.prototype.retain=zp.prototype.Sn,zp.prototype.release=xe,zp.prototype.release=zp.prototype.release;function Cp(e,o){this.gm=e,o&&(this.labels=o)}var Dp=new Cp(Ae);zp.prototype.xh=function(e){return(this.Fk[e.key]||Dp).gm},zp.prototype.getGeometriesForTile=zp.prototype.xh,zp.prototype.Hp=function(e){return(this.Fk[e.key]||Dp).labels},zp.prototype.getLabels=zp.prototype.Hp;function Ep(e,o,s){e.Fk[o.key]=new Cp(s,void 0)}function Fp(){}t("H.service.extension.dataView.ITable",Fp),Fp.prototype.zh=function(){},Fp.prototype.getMeta=Fp.prototype.zh,Fp.prototype.Ch=function(){},Fp.prototype.getRowCount=Fp.prototype.Ch,Fp.prototype.Td=function(){},Fp.prototype.getRow=Fp.prototype.Td,Fp.prototype.ab=function(){},Fp.prototype.getColumnNames=Fp.prototype.ab,Fp.prototype.Fj=function(){},Fp.prototype.getColumn=Fp.prototype.Fj,Fp.prototype.ua=function(){},Fp.prototype.getCell=Fp.prototype.ua,Fp.prototype.concat=function(){},Fp.prototype.concat=Fp.prototype.concat;function Gp(){}t("H.service.extension.dataView.IRow",Gp),Gp.prototype.ab=function(){},Gp.prototype.getColumnNames=Gp.prototype.ab,Gp.prototype.ua=function(){},Gp.prototype.getCell=Gp.prototype.ua,Gp.prototype.Qf=function(){},Gp.prototype.getTable=Gp.prototype.Qf;function Hp(e,o){this.$b=e,this.Kk=o}t("H.service.extension.dataView.ObjRow",Hp),Hp.prototype.ab=function(){return this.$b.ab()},Hp.prototype.getColumnNames=Hp.prototype.ab,Hp.prototype.ua=function(e){return this.$b.ua(this.Kk,e)},Hp.prototype.getCell=Hp.prototype.ua,Hp.prototype.Qf=function(){return this.$b},Hp.prototype.getTable=Hp.prototype.Qf;function Ip(){}t("H.service.extension.dataView.IColumn",Ip),Ip.prototype.ua=function(){},Ip.prototype.getCell=Ip.prototype.ua;function Jp(e,o){this.$b=e,this.Nl=o}t("H.service.extension.dataView.ObjColumn",Jp),Jp.prototype.ua=function(e){return this.$b.ua(e,this.Nl)},Jp.prototype.getCell=Jp.prototype.ua;function Kp(e,o,s){var h;if(o=o||(e&&e.length?Object.keys(e[0]):B),this.Ob=e,o)for(this.eh=o,this.To=e=Ta(),h=o.length;h--;)e[o[h]]=!0;s!==B&&(this.Lq=s)}t("H.service.extension.dataView.ObjTable",Kp),m=Kp.prototype,m.Lq=B,m.Ob=B,m.eh=B,m.To=B,m.zh=function(){return this.Lq},Kp.prototype.getMeta=Kp.prototype.zh,Kp.prototype.Ch=function(){return this.Ob?this.Ob.length:0},Kp.prototype.getRowCount=Kp.prototype.Ch,Kp.prototype.Td=function(e){var o=this.Ob;return o&&o[e]?new Hp(this,e):B},Kp.prototype.getRow=Kp.prototype.Td,Kp.prototype.ab=function(){return this.eh||Ae},Kp.prototype.getColumnNames=Kp.prototype.ab,Kp.prototype.Fj=function(e){return this.To[e]?new Jp(this,e):B},Kp.prototype.getColumn=Kp.prototype.Fj,Kp.prototype.ua=function(e,o){var s=this.Ob;return(e=s&&this.To[o]&&s[e])&&e[o]},Kp.prototype.getCell=Kp.prototype.ua,Kp.prototype.concat=function(){var e=arguments.length,o,s=this.eh,h=""+this.eh,d=(this.Ob||[]).slice();for(o=0;o<e;o++){var g=arguments[o];if(!(g instanceof Kp))throw new D(this.concat,o);if(g.Ob){if(s&&""+g.eh!==h)throw new D(this.concat,o,"Incompatible columns!");d=d.concat(g.Ob)}}return new Kp(d,this.eh,this.Lq)},Kp.prototype.concat=Kp.prototype.concat;function Lp(e,o,s){var h=e===8;this.zi=o,this.Pt=s||ze,(this.Mm=e===4||h)?this.We=h:this.Vu=e===1,this.cu=this.Mm?"$HProjGeometry":"geometry"}Lp.prototype.parse=function(e,o,s){var h,d={},g=[],_,j,$=0;for(_=s.length;$<_;$++){var _t=s[$],_e=_t.Rows;if(_t=_e.length){var _r=Object.keys(_e[0]).filter(function(_s){return _s!=="geometry"&&_s!=="$HProjGeometry"});for(_r=new Kp(_e,_r),j=0;j<_t;j++){var _i=_e[j];if(h=_i[this.cu]){if(delete _i[this.cu],_i=_r.Td(j))try{var _n=this.Mm?Mp(this,e,o,_i,h):Np(this,e,_i,h.path);_n.ea(e),g.push(_n)}catch(_s){this.Pt(_s.message)}}else this.Pt("Layer must contain geometries")}}}return d[this.Mm?"spatials":this.Vu?"markers":"domMarkers"]=g,d};function Mp(e,o,s,h,d){var g=[],_=d.paths,j=_.length,$=0,_t=e.zi&&e.zi(h);for(e=new zp(o,e.We,B,{style:_t||e.Py,data:h});$!==j;){o=g,h=o.push,_t=_[$++];for(var _e=0,_r=_t.length,_i=[];_e<_r;)_i.push(new F(_t[_e++],_t[_e++]));h.call(o,_i)}return Ep(e,s,[new Xh(g,d.interiorsIndex,d.outlinesIndex)]),e}function Np(e,o,s,h){h=new fd(h[0],h[1]);var d=e.zi&&e.zi(s);return e.Vu?(e={icon:d,data:s,provider:o},e=new $m(h,e)):(e={icon:d,data:s,provider:o},e=new Pi(h,e)),e}function Op(e){var o=Pp;if(!e||!gb(se(e.layerId,e.layer))||!jb(e.level)||ab(e.rowFilter)&&!Za(e.rowFilter)||ab(e.rowFilterContext)&&!ya(e.rowFilterContext))throw new D(o,1,ab("invalid layer config")?"invalid layer config":e)}function Pp(e,o,s){var h=this,d=o&&o.rowFilter,g=s.resultType;Pp.g.constructor.call(this,s),C(e,Qp,Pp,0),Op(o),d?(s=Na(o),s.rowFilter=d.toString()):s=Na(o),delete s.layer,s.layerId=se(o.layerId,o.layer),new Th().registerProcessor("pde","H.service.extension.worker.processor"),e=e.i().clone().v(Rp+"."+Sp).B({meta:1}),new Vh("pde",{message:[this.uid,0,{tileSize:this.tileSize,projected:!0,onlyOutline:g===4,serverUrl:e.toString(),layerConfigs:[s],horizontalMargin:1}]}).then(function(){h.rq=!0,h.jb()},this.Gc)}u(Pp,vp),t("H.service.extension.platformData.TileProvider",Pp),Pp.prototype.pu=function(e,o,s){return e=new Lp(e,o,s),e.Py=Tp,e};var Tp=new $h({strokeColor:"transparent",fillColor:"transparent",lineWidth:0,lineJoin:"round",lineCap:"round"});Pp.prototype.s=function(e,o,s,h,d){var g=this,_=this.getTileKey(e,o,s),j;_=this.Sb().get(_);var $={cancel:ze},_t=!0,_e=this.resultType;if(_&&(_e===4||_e===8?_.Ih()||(h(oo.pop(this.tileSize),null),_t=!1):(h(z),_t=!1)),_t){var _r=mo.setTimeout(function(){j=new Vh("pde",{message:[g.uid,1,[e,o,s]]}),j.then(h,d)},500);$.cancel=function(){j?j.cancel():mo.clearTimeout(_r)}}return $},Pp.prototype.requestInternal=Pp.prototype.s,Pp.prototype.disposeInternal=function(){Pp.g.disposeInternal.call(this),new Vh("pde",{message:[this.uid,3]})},Pp.ResultType=yp;function Up(e){this.xy=e}Up.prototype.cancel=function(){for(var e=this.xy,o=e.length;o--;)e[o].cancel();e.length=0},Up.prototype.cancel=Up.prototype.cancel;function Qp(e){Qp.g.constructor.call(this,Qp,e),ko(Qp)}u(Qp,po),t("H.service.extension.platformData.Service",Qp),Qp.prototype.Ca=function(){return{subDomain:"s.fleet.ls",path:"1"}},Qp.CONFIG_KEY="platformData",Qp.prototype.request=function(e,o,s,h,d){return this.K(e,o,s,h,d)},Qp.prototype.request=Qp.prototype.request,Qp.prototype.K=function(e,o,s,h,d){var g="text/plain";if(!e)throw new D(this.request,0,e);if(!o)throw new D(this.request,1,o);if(!h)throw new D(this.request,3,h);if(!d)throw new D(this.request,4,d);return e=this.i().clone().v(e+"."+o).B(s),o===Vp.JSON&&(g="application/json"),this.s(e,h,d,g)};var Rp="tiles";Qp.EntryPoint={DOC_ATTRIBUTES:"doc/attributes",DOC_LAYER:"doc/layer",DOC_LAYERS:"doc/layers",DOC_MAPS:"doc/maps",DOC_INDEXES:"doc/indexes",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SERVICE_CONFIGURATION:"serviceconfiguration",STATIC:"static",TILE:"tile",TILES:Rp,FILE:"file",INDEX:"index"};var Sp="json",Vp={TXT:"txt",JSON:Sp,HTML:"html",BIN:"bin"};Qp.EntryPointType=Vp,Qp.prototype.Od=function(e,o){var s=o&&o.resultType;return e=new Pp(this,e,o),s==1||s===2?new hg(e):new Dk(e)},Qp.prototype.createTileLayer=Qp.prototype.Od,Qp.prototype.Bg=function(e,o,s,h){var d=[],g,_=o.layer_id||o.layer_ids;return e=this.request(e,Sp,o,function(j){g=new pp(j.geometries,s,h,function($){return new Kp([],$.columnNames,$)},function($,_t){var _e=$.Td;return $.Ob?$.Ob.push(_t):$.Ob=[_t],_e.call($,$.Ob.length-1)},{At:_}),d.push(g)},function(j){h(new x.Error(j))}),d.push(e),new Up(d)};function Wp(e,o,s){if(!fb(e))throw new D(s,0,"has invalid type");if(!fb(o))throw new D(s,1,"has invalid type");if(e.length!==o.length||!e.length)throw new D(s,1,"specify one key attribute for each given layer id in the same order")}Qp.prototype.re=function(e,o,s,h,d,g){function _(_t,_e){_e&&j--,h(_t,!j)}var j,$=[];for(Wp(e,o,this.re),op(this.re,3,h,d),C(s,J,this.re,2),s={bbox:s.fa+","+s.W+";"+s.ga+","+s.ca},g&&Pa(s,g),e=s.layer_id?[s.layer_id]:e,g=0,j=e.length;g<j;g++)s.layer_id=e[g],s.key_attribute=o[g],$.push(this.Bg("search/bbox",s,_,d));return new Up($)},Qp.prototype.searchByBoundingBox=Qp.prototype.re,Qp.prototype.Xc=function(e,o,s,h,d,g,_){if(Wp(e,o,this.Xc),C(s,fd,this.Xc,2,"has invalid type"),!jb(h))throw new D(this.Xc,3,"has invalid type");return op(this.Xc,4,d,g),e={layer_ids:e.join(","),key_attributes:o.join(","),proximity:s.lat+","+s.lng+","+h},_&&Pa(e,_),this.Bg("search/proximity",e,d,g)},Qp.prototype.searchByProximity=Qp.prototype.Xc,Qp.prototype.Wc=function(e,o,s,h,d,g,_){var j="";if(Wp(e,o,this.Wc),!gb(s)&&!C(s,M))throw new D(this.Wc,1,"has invalid type");if(!jb(h))throw new D(this.Wc,2,"has invalid type");if(op(this.Wc,4,d,g),e={layer_ids:e.join(","),key_attributes:o.join(","),radius:h},gb(s))e.route_id=s;else{for(h=s.S,s=0,o=h.length;s<o;s+=3)j+=h[s]+","+h[s+1],s<o-3&&(j+=";");e.corridor=j}return _&&Pa(e,_),this.Bg("search/corridor",e,d,g)},Qp.prototype.searchByCorridor=Qp.prototype.Wc,X.prototype.oA=function(e){return this.Ta(Qp,e)},X.prototype.getPlatformDataService=X.prototype.oA;function Xp(e){Zo.g.constructor.call(this,Xp,e),ko(Xp)}u(Xp,po),t("H.service.extension.customRoute.Service",Xp),Xp.prototype.Ca=function(){return{subDomain:"s.fleet.ls",path:"2"}},Xp.CONFIG_KEY="customRoute",Xp.prototype.qd=function(e){return Error(e.issues&&e.issues.length?e.issues.map(function(o){return o.message}).join(". "):e)},Xp.prototype.Xg=function(e,o,s){return op(this.Xg,1,o,s),e=this.i().clone().v("calculateroute.json").B(e),this.s(e,o,s)},Xp.prototype.calculateRoute=Xp.prototype.Xg,X.prototype.Ez=function(e){return this.Ta(Xp,e)},X.prototype.getCustomRoutingService=X.prototype.Ez;function Yp(e){Yp.g.constructor.call(this,Yp,e),ko(Yp)}u(Yp,po),t("H.service.extension.geofencing.Service",Yp),Yp.prototype.Ca=function(){return{subDomain:"fleet.ls",path:"2"}},Yp.CONFIG_KEY="geofencing",Yp.prototype.request=function(e,o,s,h){return this.K(e,o,s,h)},Yp.prototype.request=Yp.prototype.request,Yp.prototype.qd=function(e){return Error(e.issues&&e.issues.length?e.issues.map(function(o){return o.message}).join(". "):e.message||e.response_code)},Yp.prototype.K=function(e,o,s,h){if(!e)throw new D(this.request,0,e);if(!Za(s))throw new TypeError("onResult must be a function");if(!Za(h))throw new TypeError("onError must be a function");return e=this.i().clone().v(e+".json").B(o),this.s(e,s,h)},Yp.EntryPoint={SEARCH_PROXIMITY:"search/proximity"},X.prototype.Qz=function(e){return this.Ta(Yp,e)},X.prototype.getGeofencingService=X.prototype.Qz;function Zp(e){var o=$p;if(!e||!gb(e.layerId)||ab(e.rowFilter)&&!Za(e.rowFilter)||ab(e.rowFilterContext)&&!ya(e.rowFilterContext))throw new D(o,1,ab("invalid layer config")?"invalid layer config":e)}function aq(e){return gb(e)&&/^[A-Z][A-Z0-9_]*$/.test(e)}function bq(e){for(var o=e&&e.length,s=2<=o&&e[--o]==="WKT"&&e[--o]==="GEOMETRY_ID";s&&o--;)s=aq(e[o]);return s}function cq(e,o){var s="",h=[];if(o){var d=e.geometries;if(d&&d.length){var g=Object.keys(d[0].attributes);for(s=s+("Meta:	"+o+`
`)+g.join("	"),s+=`	WKT
`,e=0;e<d.length;e++){var _=d[e].attributes,j=d[e].geometry;for(o=0;o<g.length;o++)h.push(_[g[o]]);s+=h.join("	"),s+="	"+j+`
`,h=[]}}}else{if(j={},h=[],e.geometries)for(d=0;d<e.geometries.length;d++)o=e.geometries[d],j[o.layerId]||(j[o.layerId]=[]),j[o.layerId].push(o);for(g in j)h.push({layerId:g,geometries:j[g]});for(e=0;e<h.length;e++)s+=cq(h[e],h[e].layerId)}return s}t("H.service.extension.customLocation.Permission",{READ:"read",WRITE:"write",EXPORT:"export"}),t("H.service.extension.customLocation.Storage",{READONLY:"readonly",UPDATABLE:"updatable"});function dq(){if(eq)throw new wb(dq)}t("H.service.extension.customLocation.Table",dq);var eq=!0;function fq(e,o){var s;eq=!1;var h=new dq;eq=!0,h.Ym=Xa(x.JSON.parse(x.JSON.stringify(e))),e=e.columnNames;var d=Ta();for(s=e.length;s--;)d[e[s]]=s;if(h.So=d,h.Fc=e.length,o){if(o.length%e.length)throw new D(fq,1,"Invalid number of cells")}else o=[];return h.tb=o,h}dq.prototype.zh=function(){return this.Ym},dq.prototype.getMeta=dq.prototype.zh,dq.prototype.Ch=function(){return this.tb.length/this.Fc},dq.prototype.getRowCount=dq.prototype.Ch,dq.prototype.Td=function(e){return e<this.tb.length/this.Fc?new gq(this,e):B},dq.prototype.getRow=dq.prototype.Td,dq.prototype.zA=function(){var e=this.tb.length/this.Fc,o,s=new x.Array(e);for(o=0;o<e;o++)s[o]=new gq(this,o);return s},dq.prototype.getRows=dq.prototype.zA,dq.prototype.zo=function(e){var o=this.Fc,s=this.tb,h=s.length/this.Fc;if(!e||e.length%o)throw new D(this.zo,0,"Invalid number of cells");return this.tb=s.concat(e),h},dq.prototype.addCells=dq.prototype.zo,dq.prototype.jy=function(){for(var e=this.Fc,o=this.tb,s=this.tb.length/this.Fc;e--;)o.push(z);return this.Td(s)},dq.prototype.addRow=dq.prototype.jy,dq.prototype.ab=function(){return this.Ym.columnNames},dq.prototype.getColumnNames=dq.prototype.ab,dq.prototype.Fj=function(e){return this.So[e]===B?B:new hq(this,e)},dq.prototype.getColumn=dq.prototype.Fj,dq.prototype.ua=function(e,o){return this.tb[e*this.Fc+this.So[o]]},dq.prototype.getCell=dq.prototype.ua,dq.prototype.te=function(e,o,s){if(o=this.So[o],e>=this.tb.length/this.Fc)throw new D(this.te,0,"Row index out of bounds");if(o===B)throw new D(this.te,0,"Column unknown");this.tb[e*this.Fc+o]=s},dq.prototype.setCell=dq.prototype.te,dq.prototype.concat=function(e){var o=arguments.length,s,h=""+this.ab(),d=this.tb?this.tb.slice():[];for(s=0;s<o;s++){var g=arguments[s];if(!(g instanceof dq))throw new D(this.concat,s);if(""+g.ab()!==h)throw new D(this.concat,s,"Incompatible columns!");g.tb&&(d=d.concat(g.tb))}return fq(this.Ym,d)},dq.prototype.concat=dq.prototype.concat;var iq=/(\n|\t|\r|")/;dq.prototype.os=function(e,o){var s,h=this.Fc,d=this.ab(),g=[],_=[],j=this.tb,$=-1;for(s=0;s<h;s++)(!e||e.test(d[s]))&&(d[s]==="WKT"&&($=g.length),g.push(s));if(!(e=g.length))throw new D(this.os,1,"No columns filtered");if(jq(this,_,d,0,h,g,e,$),o){var _t=o.length;for(s=0;s<_t;s++)_.push(`
`),d=o[s],jq(this,_,j,d,h,g,e,$)}else for(_t=this.Ch(),d=0;d<_t;d++)_.push(`
`),jq(this,_,j,d,h,g,e,$);return _.join("")};function jq(e,o,s,h,d,g,_,j){var $;for($=0;$<_;$++){$&&o.push("	");var _t=s[h*d+g[$]];if($!==j){if(_t!==z){if(_t=String(_t),iq.test(_t))throw new D(e.os,0,'Invalid character (\\n, \\r, \\t, or ") in row '+h+" column "+e.Ym.columnNames[g[$]]);o.push(_t)}}else o.push(_t)}}function hq(e,o){this.$b=e,this.Nl=o}dq.Column=hq,hq.prototype.ua=function(e){return this.$b.ua(e,this.Nl)},hq.prototype.getCell=hq.prototype.ua,hq.prototype.te=function(e,o){this.$b.te(e,this.Nl,o)},hq.prototype.setCell=hq.prototype.te;function gq(e,o){this.$b=e,this.Kk=o}dq.Row=gq,gq.prototype.ab=function(){return this.$b.ab()},gq.prototype.getColumnNames=gq.prototype.ab,gq.prototype.ua=function(e){return this.$b.ua(this.Kk,e)},gq.prototype.getCell=gq.prototype.ua,gq.prototype.te=function(e,o){this.$b.te(this.Kk,e,o)},gq.prototype.setCell=gq.prototype.te,gq.prototype.Qf=function(){return this.$b},gq.prototype.getTable=gq.prototype.Qf;function kq(e){if(e===B)e="	";else if(!/^[^"\r\n]$/.test(e))throw new D(kq,0);this.Yx=String(e).charCodeAt(0),this.wd=A(this.wd,this),this.o=lq}var lq=0;m=kq.prototype,m.getState=function(){return this.o};function mq(e,o,s){var h=e.o;if(h!==o)throw h===1&&(e.o=lq),new wb(s,"Requires state: "+["READY","PARSE","PAUSE"][o]+" but found "+["READY","PARSE","PAUSE"][h])}m.abort=function(){mq(this,2,kq.prototype.abort),this.o=lq},m.wd=function(e){throw this.o=lq,new D(kq.prototype.parse,0,"Malformed DSV at row "+this.cd.Gr+" column "+this.cd.fj+": "+e)};function nq(e,o){var s=[];return e.parse(o,function(h,d,g){return 1>h&&(s[d]=g),0<h}),e.o=lq,s}m.parse=function(e,o,s){mq(this,lq,kq.prototype.parse),e=e.trim(),this.cd=new oq(e,this.Yx,this.wd),this.VB=o,this.Hv=s||ye,this.o=2,this.resume()},m.Hv=ye,m.resume=function(){var e=this.cd,o=[];mq(this,2,kq.prototype.resume),this.o=1;do{if(!e.cq){this.o=lq;break}if(d>e.fj){if(s!==void 0&&s!==d){this.cd.wd("The number of columns must be the same for all rows");return}var s=d}var h=e.Gr,d=e.fj,g=e.Ol,_=this.Hv(h,d,e);if(e.Ol>g)for(;e.next()!==-1;);else{for(;(g=e.next())!==-1;)o.push(g);_=String.fromCharCode.apply(z,o),o.length=0}pq(e),this.VB(h,d,_)&&(this.o=e.cq?2:lq)}while(this.o===1);this.o!=2&&s!==void 0&&0<d&&s!==d&&this.cd.wd("The number of columns must be the same for all rows")};function oq(e,o,s){this.cd=new Gh(e),this.Is=o,this.cq=!0,this.Ol=this.Gr=this.fj=0,pq(this),this.wd=s,this.Cc=[],this.Xf=!1}m=oq.prototype,m.Ol=0;function pq(e){var o=e.cd.eb();e.Yt=!1,(e.dB=o===34)&&e.cd.next()}function qq(e,o){var s=e.cd;switch(e.Yt=!0,o){case e.Is:e.fj++;break;case 13:s.next(),s.eb()!==10&&e.wd("CR without LF");case 10:e.fj=0,e.Gr++;break;case-1:e.cq=!1;break;default:e.wd("End of field expected")}return s.next(),-1}m.eb=function(){if(this.Yt)var e=-1;else{var o=this.cd;if(e=o.eb(),this.dB)switch(e){case 34:o.next(),e=o.eb(),e!==34&&(e=qq(this,e));break;case-1:this.wd("Closing quotation mark expected")}else switch(e){case 34:this.wd("Unexpected quotation mark");case this.Is:case 13:case 10:case-1:e=qq(this,e)}}return e},m.yi=function(){this.Xf=!0,this.Cc=[]},m.mh=function(){var e=this.Cc.slice();return this.Xf=!1,this.Cc=[],e},m.next=function(){var e=this.eb();return e!==-1&&this.cd.next(),this.Xf&&this.Cc.push(e),this.Ol++,e};function rq(e,o,s,h){if(h=h||{},!o)throw new D(rq,1,"has to be a function");if(!s)throw new D(rq,2,"has to be a function");for(this.mn=o,this.dn=s,this.bh=[],this.Mc={},this.xq=[],this.lh={},this.fs={},this.ls={},this.lx={},this.rj=h.duration||100,this.Gm=A(this.Gm,this),e=e.split("Meta:	").slice(1),o=0;o<e.length;o++){h=e[o].split(`
`),s=h[0].split("	")[0],h=h.slice(1).join(`
`),this.lh[s]=new kq,this.Mc[s]=nq(this.lh[s],h);var d={layerId:s,columnNames:this.Mc[s]};this.xq.push(s),this.lx[s]=fq(d),this.fs[s]=Gj(),sq(this,h,s),this.Gm(s)}}function sq(e,o,s){var h=[],d=e.Mc[s].length-1,g=e.lx[s];try{e.lh[s].parse(o,function(_,j,$){var _t=!1;return 0<_&&(h[j]=$,j===d&&(e.bh.push(g.Td(g.zo(h))),Gj()-e.fs[s]>e.rj&&(_t=!0))),_t},function(_,j,$){if(0<_&&j===d)return nh($)})}catch(_){e.dn(_)}}rq.prototype.cancel=function(){for(var e in this.ls)x.clearTimeout(this.ls[e])},rq.prototype.cancel=rq.prototype.cancel,rq.prototype.Gm=function(e){var o=this,s,h;this.ls[e]=x.setTimeout(function(){if(o.lh[e].getState()===2)o.fs[e]=Gj(),o.mn(o.bh,!1),o.bh=[],o.lh[e].resume(),o.Gm(e);else{for(s=!0,h=0;h<o.xq.length;h++)if(o.lh[o.xq[h]].getState()!==lq){s=!1;break}s&&(0<o.bh.length&&o.mn(o.bh,!0),o.bh=[])}},0)};function $p(e,o,s){var h=this,d=o&&o.rowFilter,g;$p.g.constructor.call(this,s),C(e,tq,$p,0);var _=s.resultType;if(Zp(o),d){var j=Na(o);j.rowFilter=d.toString()}else j=o;new Th().registerProcessor("cle","H.service.extension.worker.processor");var $=o.layerId;e.request(uq,vq,{detail_level:"all",layer_id:$},function(_t){_t=_t.layers;var _e;for(_e=0;_e<_t.length;_e++)if(_t[_e].layerId===$){j.level=_t[_e].level;break}g=e.i().clone().v(wq+"."+vq).B({meta:1}),new Vh("cle",{message:[h.uid,0,{tileSize:h.tileSize,projected:!0,onlyOutline:_===4,serverUrl:g.toString(),layerConfigs:[j],batchTiles:!1,horizontalMargin:1}]}).then(function(){h.rq=!0,h.jb()},h.Gc)},function(_t){h.Gc(_t.message)})}u($p,vp),t("H.service.extension.customLocation.TileProvider",$p),$p.prototype.pu=function(e,o,s){return new Lp(e,o,s)},$p.prototype.s=function(e,o,s,h,d){var g=this,_=this.getTileKey(e,o,s),j;_=this.Sb().get(_);var $={cancel:ze},_t=!0,_e=this.resultType;if(_&&(_e===4||_e===8?_.Ih()||(h(oo.pop(this.tileSize),null),_t=!1):(h(z),_t=!1)),_t){var _r=mo.setTimeout(function(){j=new Vh("cle",{message:[g.uid,1,[e,o,s]]}),j.then(h,d)},500);$.cancel=function(){j?j.cancel():mo.clearTimeout(_r)}}return $},$p.prototype.requestInternal=$p.prototype.s,$p.prototype.disposeInternal=function(){$p.g.disposeInternal.call(this),new Vh("cle",{message:[this.uid,3]})};function tq(e){tq.g.constructor.call(this,tq,e),ko(tq)}u(tq,po),t("H.service.extension.customLocation.Service",tq),tq.prototype.Ca=function(){return{subDomain:"fleet.ls",path:"2"}},tq.CONFIG_KEY="customLocation",tq.prototype.Od=function(e,o){var s=o&&o.resultType;return e=new $p(this,e,o),s===1||s===2?new hg(e):new Dk(e)},tq.prototype.createTileLayer=tq.prototype.Od;function xq(e,o,s,h){e=e===yq?"changes":"file";var d=o[e],g=gb(d),_=!g&&C(d,Blob);if(!g&&!_)throw new D(h,0,"Invalid "+e+" parameter");if(zq)d=_?d:He(d,"text/plain"),h=new x.FormData,h.append(e,d,d.name||e+".wkt"),s.method="POST",s.data=h,delete o[e];else if(_)throw new D(h,0,"Sending Blob data is not supported by the browser")}var zq=x.FormData&&!!x.FormData.prototype.append;tq.prototype.request=function(e,o,s,h,d){return this.K(e,o,s,h,d)},tq.prototype.request=tq.prototype.request,tq.prototype.K=function(e,o,s,h,d){var g="text/plain",_=e===Aq.LAYERS_UPLOAD||e===Aq.LAYERS_MODIFY||e===Aq.LAYERS_IMPORT,j=s,$={data:B,method:"GET",headers:this.Mc};if(!e)throw new D(this.request,0,e);if(!o)throw new D(this.request,1,o);op(this.request,3,h,d),_&&(C(s,Object,this.request,2,"Invalid request parameters"),j=Na(s),xq(e,j,$,this.request));var _t=this.i().clone().v(e+"."+o).B(j);return o===Bq.JSON&&(g="application/json"),e=new Ue(g,_t.toString(),ge,$),e.then(function(_e){var _r=_e.issues;_r&&_e.error_id&&_e.response_code?d(Error(_r[0].message)):h(_e)},function(_e){_e.type==="error"||_e.status===404?d(Error(_e.statusText||"Unable to load data")):_e.json().then(function(_r){d(Error("["+_r.issues[0].message+"] "+_t+" request failed"))},function(){d(Error("["+_e.statusText+"] "+_t+" request failed"))})}),e};var uq="layers/list",yq="layers/modify",wq="tiled/tile",Aq={LAYERS_DELETE:"layers/delete",LAYERS_GRANT:"layers/access/grant",LAYERS_LIST:uq,LAYERS_MODIFY:yq,LAYERS_UPLOAD:"layers/upload",LAYERS_IMPORT:"layers/import",SEARCH_ALL:"search/all",SEARCH_BBOX:"search/bbox",SEARCH_CORRIDOR:"search/corridor",SEARCH_PROXIMITY:"search/proximity",SEARCH_QUADKEY:"search/quadkey",SEARCH_TILE:wq};tq.EntryPoint=Aq;var vq="json",Bq={TXT:"txt",JSON:vq};tq.EntryPointType=Bq,tq.prototype.Tb=function(e,o,s){var h=this;return this.request("search/all","txt",{filter:'WKT==""',layer_id:e},function(d){var g=String(d).replace(/[\r\n]+$/g,"").split("	");h.request(uq,vq,{layer_id:e,detail_level:"all"},function(_){_=_.layers[0],_.columnNames=g,o(fq(_))},s)},s)},tq.prototype.getLayer=tq.prototype.Tb,tq.prototype.zu=function(e,o,s,h){function d(){return++_<g?j.request("layers/access/grant",vq,{layer_id:e,granted_app_id:o[_].grantedAppId,permissions:o[_].permissions.join(",")},d,h):j.Tb(e,s,h)}var g=o&&o.length,_=-1,j=this;return d()},tq.prototype.grantAccess=tq.prototype.zu,tq.prototype.Dt=function(e,o,s){return this.request("layers/delete",vq,{layer_ids:e},o,s)},tq.prototype.deleteLayer=tq.prototype.Dt,tq.prototype.md=function(e,o,s){function h(){setTimeout(function(){$.Tb(_,function(_i){setTimeout(d.bind(null,_i),_e)},function(){64e3>_t?(_t+=_e,h()):s(x.Error("Timeout"))})},_e),_e*=2}function d(_i){var _n=JSON.stringify(_i.ab()),_s=e.grants;if(_n!==JSON.stringify(j)){var _l="Results into different column names on the backend: "+_n;setTimeout(function(){$.Dt(_,function(){s(x.Error(_l))},function(Ap){s(x.Error(_l+". "+Ap.message))})},_e)}else _s&&_s.length?$.zu(_,_s,o,s):o(_i)}var g,_,j,$=this,_t=0,_e=1e3,_r=!e||!aq(_=e.layerId)&&(g="layerId")||!bq(j=e.columnNames)&&(g="columnNames")?0:Za(o)?Za(s)?-1:2:1;if(0<=_r)throw new D($.md,_r,g||arguments[_r]);return $.Tb(_,function(){s(x.Error("Layer exists already"))},function(){var _i={layer_id:_,file:j.join("	")},_n=e.level,_s=e.storage;_n!==B&&(_i.level=_n),_s!==B&&(_i.storage=_s),$.request("layers/upload",vq,_i,h,s)})},tq.prototype.createLayer=tq.prototype.md,tq.prototype.Bg=function(e,o,s,h){var d=[],g;return e=this.request(e,vq,o,function(_){_.geometries.length?(_=cq(_,o.layer_id),g=new rq(_,s,h),d.push(g)):s(Ae,!0)},h),d.push(e),new Up(d)},tq.prototype.Xc=function(e,o,s,h,d,g){if(!fb(e))throw new D(this.Xc,0,"has invalid type");if(C(o,fd,this.Xc,1,"has invalid type"),!jb(s))throw new D(this.Xc,2,"has invalid type");return op(this.Xc,3,h,d),e={layer_ids:e.join(","),proximity:o.lat+","+o.lng+","+s},g&&Pa(e,g),this.Bg("search/proximity",e,h,d)},tq.prototype.searchByProximity=tq.prototype.Xc,tq.prototype.Wc=function(e,o,s,h,d,g){var _="";if(!fb(e))throw new D(this.Wc,0,"has invalid type");if(!gb(o)&&!C(o,M))throw new D(this.Wc,1,"has invalid type");if(!jb(s))throw new D(this.Wc,2,"has invalid type");if(op(this.Wc,3,h,d),e={layer_ids:e.join(","),radius:s},gb(o))e.route_id=o;else{var j=o.S;for(o=0,s=j.length;o<s;o+=3)_+=j[o]+","+j[o+1],o<s-3&&(_+=",");e.corridor=_}return g&&Pa(e,g),this.Bg("search/corridor",e,h,d)},tq.prototype.searchByCorridor=tq.prototype.Wc,tq.prototype.re=function(e,o,s,h,d){function g($,_t){_t&&j--,s($,!j)}var _=[],j;if(!fb(e))throw new D(this.re,0,"has invalid type");for(C(o,J,this.re,1,"has invalid type"),op(this.re,2,s,h),o={bbox:o.fa+","+o.W+";"+o.ga+","+o.ca},d&&Pa(o,d),e=o.layer_id?[o.layer_id]:e,d=0,j=e.length;d<j;d++)o.layer_id=e[d],_.push(this.Bg("search/bbox",o,g,h));return new Up(_)},tq.prototype.searchByBoundingBox=tq.prototype.re,tq.prototype.Lr=function(e,o,s,h){var d,g=[];if(!gb(e))throw new D(this.Lr,0,"has invalid type");op(this.Lr,1,o,s);var _={layer_id:e};return h&&Pa(_,h),h=this.request("search/all",vq,_,function(j){j.geometries.length?(j=cq(j,e),d=new rq(j,o,s),g.push(d)):o(Ae,!0)},s),g.push(h),new Up(g)},tq.prototype.searchAll=tq.prototype.Lr;var Cq={delete:/^GEOMETRY_ID$/,append:/^(?!GEOMETRY_ID$)/};function Dq(e,o,s,h,d,g){function _(){_s++,h(this,_s===_i)}function j(ty){_s++,d(ty,this,_s===_i)}var $=o!=="append",_t,_e={},_r=Ta(),_i=0,_n=[],_s=0;if(!fb(s))throw new D(g,0,s);for(op(g,1,h,d),_t=s.length;_t--;){var _l=s[_t];if(C(_l,gq)){var Ap=_l.Qf().zh().layerId,_h=_l.ua("GEOMETRY_ID");if($){if(_h===z||String(_h)==="")var _p='GEOMETRY_ID must not be null or ""';_e[_h=Ap+"_"+_h]&&(_p="same GEOMETRY_ID for multiple rows"),_e[_h]=_l}else _h!==z&&String(_h)!==""&&(_p='GEOMETRY_ID must be null or ""')}else _p="Invalid type";if(_p)throw new D(g,0,"- Invalid row at index "+_t+", "+_p);_h=_r[Ap],_h||(_h=_r[Ap]=[],_i++),_h.push(_l)}for(Ap in _r){for(_h=_r[Ap],s=[],_t=_h.length;_t--;)s.push(_h[_t].Kk);_n.push(e.request(yq,vq,{layer_id:Ap,action:o,changes:_h[0].Qf().os(Cq[o]||null,s)},A(_,_h),A(j,_h)))}return new Up(_n)}tq.prototype.dt=function(e,o,s){return Dq(this,"append",e,o,s,this.dt)},tq.prototype.appendRows=tq.prototype.dt,tq.prototype.Fx=function(e,o,s){return Dq(this,"update",e,o,s,this.Fx)},tq.prototype.updateRows=tq.prototype.Fx,tq.prototype.Et=function(e,o,s){return Dq(this,"delete",e,o,s,this.Et)},tq.prototype.deleteRows=tq.prototype.Et,X.prototype.Dz=function(e){return this.Ta(tq,e)},X.prototype.getCustomLocationService=X.prototype.Dz;function vo(e){e=e===void 0?{}:e,vo.g.constructor.call(this,vo,e),this.Ci={Rn:e.resource||"base",Dn:e.projection||"mc",format:e.format||"png8"},this.Fn=e.queryParams||{}}u(vo,po),t("H.service.rasterTile.Service",vo),m=vo.prototype,m.J=function(){return this.Fn.style||"explore.day"},m.Rf=function(e,o,s){return this.i().clone().v(this.Ci.Rn+"/"+(this.Ci.Dn+"/")+(s+"/"+e+"/"+o+"/")+this.Ci.format).B(this.Fn)},m.Ca=function(){return{subDomain:"maps",path:"v3"}},m.U=function(){return this.ec||this.Jf(),this.ec},m.Jf=function(){this.ec=new lp,this.s(this.i().clone().v("copyright"),A(this.pl,this),ze)},m.pl=function(e){var o=e.copyrights;e=e.resources;var s={},h=this.Ci.Rn+"."+this.J();s[h]=[],e[this.Ci.Rn].styles[this.J()].forEach(function(d){o[d].forEach(function(g){var _=[];g.boundingBoxes.forEach(function(j){_.push([j.north,j.west,j.south,j.east])}),s[h].push({boxes:_,label:g.label,alt:g.alt,minLevel:g.minLevel,maxLevel:g.maxLevel})})}),mp(this.ec,s)},m.Kj=function(e,o){return this.s(this.i().clone().v("info"),e,o)},vo.prototype.getInfo=vo.prototype.Kj,vo.prototype.Nj=function(e,o){return this.s(this.i().clone().v("politicalViews"),e,o)},vo.prototype.getPoliticalViews=vo.prototype.Nj,vo.prototype.Oz=function(e,o){return this.s(this.i().clone().v("features"),e,o)},vo.prototype.getFeatures=vo.prototype.Oz,vo.prototype.Ip=function(e,o){return this.s(this.i().clone().v("languages"),e,o)},vo.prototype.getLanguages=vo.prototype.Ip,vo.CONFIG_KEY="rasterTile",X.prototype.Qp=function(e){return this.Ta(vo,e)},X.prototype.getRasterTileService=X.prototype.Qp;function Eq(e){Eq.g.constructor.call(this,Eq,e),ko(Eq,"Use HERE Routing API v8 instead.")}u(Eq,po),t("H.service.RoutingService",Eq),Eq.prototype.Ca=function(){return{subDomain:"route.ls",path:"routing/7.2"}},Eq.prototype.qd=function(e){return Error(e.details)},Eq.CONFIG_KEY="routing",Eq.prototype.Xg=function(e,o,s){return e=this.i().clone().v("calculateroute.json").B(e),this.s(e,o,s)},Eq.prototype.calculateRoute=Eq.prototype.Xg,Eq.prototype.Mo=function(e,o,s){return e=this.i().clone().Ha("isoline").v("calculateisoline.json").B(e),this.s(e,o,s)},Eq.prototype.calculateIsoline=Eq.prototype.Mo;function Fq(e){Fq.g.constructor.call(this,Fq,e)}u(Fq,po),t("H.service.RoutingService8",Fq),Fq.CONFIG_KEY="routing_v8",Fq.prototype.Ca=function(){return{subDomain:"router",path:"v8/routes"}},Fq.prototype.qd=function(e){return Error((e&&e.status===void 0?401:e.status)===401?e.error_description:e.title,{cause:e})},Fq.prototype.Xg=function(e,o,s){return e=this.i().clone().B(e),this.s(e,o,s)},Fq.prototype.calculateRoute=Fq.prototype.Xg,Fq.prototype.Mo=function(e,o,s){return e=this.i().clone().Ha("isoline").Fg("v8/isolines").B(e),this.s(e,o,s)},Fq.prototype.calculateIsoline=Fq.prototype.Mo,X.prototype.ru=function(e,o){if(o=+o||7,o===7)o=Eq;else if(o===8)o=Fq;else throw new D(this.ru,1,"allowed values are 7 and 8");return this.Ta(o,e)},X.prototype.getRoutingService=X.prototype.ru;function Gq(e,o,s){var h=this,d=s||{},g=+d.min,_=+d.max;d.tileSize=d.tileSize||512,d.min=g?ac(g,1,17):1,d.min+=Yi(d.tileSize,1),d.max=_?ac(_,1,17):17,Gq.g.constructor.call(this,d),C(e,Hq,Gq,0),C(o,cf,Gq,1),this.$=e,o.Yb&&o.Yb("OMV"),this.Xa(o,!0),this.xn=!1,s&&(s.politicalView&&(this.yn=s.politicalView),Iq(this,s.lg,s.lg2),this.xn=!!s.pois),this.xw=function(){h.Hl=io(h),h.reload(!1)},e.addEventListener("versionupdate",this.xw),this.Hl=io(this),Gq.prototype.Xo=function(){var j=/^v2\/vectortiles\/(.+)\/mc$/.exec(e.i().hf);return j?j[1]:B+""}()}u(Gq,R),t("H.service.omv.Provider",Gq),Gq.prototype.Vc=xe,Gq.prototype.providesOMV=Gq.prototype.Vc,Gq.prototype.cc=function(e){return this.Hl.test(e)},Gq.prototype.cacheFilter=Gq.prototype.cc,Gq.prototype.Ud=function(e,o,s){return this.$.Rf(e,o,s).toString()},Gq.prototype.getTileKey=Gq.prototype.Ud,Gq.prototype.Sb=function(){return this.PB},Gq.prototype.getCache=Gq.prototype.Sb,Gq.prototype.qA=function(){return this.yn},Gq.prototype.getPoliticalView=Gq.prototype.qA,Gq.prototype.YC=function(e){var o=this.yn;this.yn=e,this.dispatchEvent(new Zc("politicalviewchange",this.yn,o))},Gq.prototype.setPoliticalView=Gq.prototype.YC,Gq.prototype.MAX_STORE_TIME=2592e6,Gq.prototype.Vi=function(){return Mm()},Gq.prototype.sd=function(){return Mm()?Lm():Gq.g.sd.call(this)},Gq.prototype.s=function(e,o,s,h,d){return this.$.Oa(e,o,s,h,d)},Gq.prototype.requestInternal=Gq.prototype.s,Gq.prototype.Cb=function(e){e.Yb&&e.Yb("OMV"),this.Xa(e)},Gq.prototype.setStyle=Gq.prototype.Cb,Gq.prototype.J=function(){return Gq.g.mb.apply(this)},Gq.prototype.getStyle=Gq.prototype.J,Gq.prototype.mb=function(){var e=Gq.g.mb.apply(this),o=e.getState()===df.READY,s=e.Rd();return o&&s&&s.global&&(this.pq&&(this.mw&&(s.global.ux_language=this.mw),this.Wt&&(s.global.ux_language_fallback=this.Wt)),this.xn&&s.global.poi&&s.global.poi.default&&(s.global.poi.default.visible=this.xn),this.pq||this.xn)&&(e=new Bf(s,e.Ic())),e},Gq.prototype.getStyleInternal=Gq.prototype.mb;function Iq(e,o,s){var h=gb(o),d=gb(s);h&&(e.mw=o),d&&(e.Wt=s),(h||d)&&(e.Zj=[],h=/^([a-zA-Z]{2})(-|$)/,(d=h.exec(o))&&(d[1]==="zh"?e.Zj.push(o):e.Zj.push(d[1])),(d=h.exec(s))&&(d[1]==="zh"?e.Zj.push(s):e.Zj.push(d[1])),e.pq=!0)}Gq.prototype.pq=!1;var Jq=["en"];Gq.prototype.Ip=function(){return this.Zj||Jq},Gq.prototype.getLanguages=Gq.prototype.Ip,Gq.prototype.disposeInternal=function(){Gq.g.disposeInternal.call(this),this.$.removeEventListener("versionupdate",this.xw)},Gq.prototype.PB=new Ri(256),Gq.prototype.U=function(e,o){return this.$.U().query(this.Xo,o,e)},Gq.prototype.getCopyrights=Gq.prototype.U;function Hq(e){Hq.g.constructor.call(this,Hq,e);var o=qo(this,e).mapVersion;this.Fn=e.queryParams||{},this.dk=ab(o)?o:Kq[this.i().toString()],ab(this.dk)||Lq(this)}u(Hq,po),t("H.service.omv.Service",Hq),Hq.prototype.Ca=function(){return{subDomain:"vector",path:"v2/vectortiles/base/mc"}},Hq.CONFIG_KEY="omv";var Kq={};mb(Kq),Hq.prototype.eA=function(){return this.dk},Hq.prototype.getMapVersion=Hq.prototype.eA;function Lq(e){e.s(e.i().clone().v("../../info"),function(o){o=o.mapVersion;var s=e.i().toString();e.dk=o,o!==Kq[s]&&(Kq[s]=o,e.dispatchEvent("versionupdate"))},function(){})}Hq.prototype.md=function(e,o,s){o=o||{};var h={min:0,max:22};return ya(s)&&jo(h,s),new Dk(new Gq(this,e,o),h)},Hq.prototype.createLayer=Hq.prototype.md,Hq.prototype.Oa=function(e,o,s,h,d){return this.s(this.Rf(e,o,s),function(g){return g.arrayBuffer().then(h,d)},d,"arraybuffer")},Hq.prototype.Rf=function(e,o,s){return e=this.i().clone().v(s+"/"+e+"/"+o+"/omv"),ab(this.dk)&&e.B({mv:this.dk}).B(this.Fn),e},Hq.prototype.rm=function(e){return ln()+"/"+e},Hq.prototype.Nj=function(e,o){if(!Za(e))throw new D(this.Nj,0,'"onResult" must be a function');if(!Za(o))throw new D(this.Nj,1,'"onError" must be a function');return this.s(this.i().clone().Fg("v2/vectortiles/pviews"),e,o)},Hq.prototype.getPoliticalViews=Hq.prototype.Nj,X.prototype.Lj=function(e){return this.Ta(Hq,e)},X.prototype.getOMVService=X.prototype.Lj,Hq.prototype.Jf=function(){this.ec=new lp,this.s(this.i().clone().v("../../copyrights"),A(this.pl,this),ze)},Hq.prototype.pl=function(e){mp(this.ec,e),this.dispatchEvent("copyrightupdate")},Hq.prototype.U=function(){return this.ec||this.Jf(),this.ec},Hq.prototype.getCopyrights=Hq.prototype.U;function Mq(e){if(this.ns=!!e.toBypassToken,!this.ns&&!e.token)throw new D(Mq,0,'"token" must be specified');ko(Mq,"Use HERE IML service instead."),Mq.g.constructor.call(this,Mq,e),this.xx=e.token,this.st={},this.Vl={}}u(Mq,po),t("H.service.xyz.Service",Mq),Mq.prototype.Ca=function(){return{host:"xyz.api.here.com",path:"hub/spaces"}},Mq.prototype.qd=function(e){return Error(e.errorMessage||e.message)},Mq.prototype.Np=function(e,o,s){return db(e,"String",this.Np,0,'"projectId" must be a string'),Nq(this.Np,1,o,s),e=Oq(this.i().clone().Fg("project-api/projects/"+e)),this.s(e,o,s)},Mq.prototype.getProject=Mq.prototype.Np,Mq.prototype.su=function(e,o,s){return Nq(this.su,0,e,o),s=Pq(this,this.i().clone().B(s||{})),this.s(s,e,o)},Mq.prototype.getSpaces=Mq.prototype.su,Mq.prototype.qm=function(e,o,s){return db(e,"String",this.qm,0,'"spaceId" must be a string'),Nq(this.qm,1,o,s),e=Pq(this,this.i().clone().v(e)),this.s(e,o,s)},Mq.prototype.getSpace=Mq.prototype.qm,Mq.prototype.Dh=function(e,o,s){return db(e,"String",this.Dh,0,'"spaceId" must be a string'),Nq(this.Dh,1,o,s),e=Pq(this,this.i().clone().v(e+"/statistics")),this.s(e,o,s)},Mq.prototype.getStatistics=Mq.prototype.Dh,Mq.prototype.lm=function(e,o,s,h,d,g,_){return e=Pq(this,this.i().clone().v(h+"/tile/web/"+s+"_"+e+"_"+o+".mvtf").B(Object.assign({clip:!0},_))),this.s(e,function(j){return j.arrayBuffer().then(d)},g,"arraybuffer")},Mq.prototype.search=function(e,o,s,h){return db(e,"String",this.search,0,'"spaceId" must be a string'),Nq(this.search,1,o,s),e=Pq(this,this.i().clone().v(e+"/search").B(h||{})),this.s(e,o,s)},Mq.prototype.search=Mq.prototype.search,Mq.prototype.Te=function(e,o,s,h){if(db(e,"String",this.Te,0,'"spaceId" must be a string'),!ya(o))throw new D(this.Te,1,'"params" must be an object');return Nq(this.Te,2,s,h),e=Pq(this,this.i().clone().v(e+"/features").B(o)),this.s(e,s,h)},Mq.prototype.getFeaturesById=Mq.prototype.Te,Mq.prototype.wh=function(e,o,s,h){if(db(e,"String",this.wh,0,'"spaceId" must be a string'),!ya(o))throw new D(this.Te,1,'"params" must be an object');return Nq(this.wh,2,s,h),e=Pq(this,this.i().clone().v(e+"/bbox").B(o)),this.s(e,s,h)},Mq.prototype.getFeaturesByBoundingBox=Mq.prototype.wh,Mq.prototype.U=function(e){var o=this.st[e];return o||(this.Vl[e]||this.Jf(e),null)},Mq.prototype.mf=function(e,o,s,h,d){if(db(e,"String",this.mf,0,'"spaceId" must be a string'),!ya(o))throw new D(this.mf,1,'"geojsonObject" must be an object');if(Nq(this.mf,2,s,h),d&&!ya(d))throw new D(this.mf,4,'"opt_params" must be an object');return Qq(this,e,s,h,"PUT",o,d)},Mq.prototype.putFeatures=Mq.prototype.mf,Mq.prototype.kf=function(e,o,s,h,d){if(db(e,"String",this.kf,0,'"spaceId" must be a string'),!ya(o))throw new D(this.kf,1,'"featureCollection" must be an object');if(Nq(this.kf,2,s,h),d&&!ya(d))throw new D(this.kf,4,'"opt_params" must be an object');return Qq(this,e,s,h,"POST",o,d)},Mq.prototype.postFeatures=Mq.prototype.kf,Mq.prototype.Hf=function(e,o,s,h){if(db(e,"String",this.Hf,0,'"spaceId" must be a string'),!ya(o))throw new D(this.Hf,1,'"params" must be an object');return Nq(this.Hf,2,s,h),Qq(this,e,s,h,"DELETE",B,o)},Mq.prototype.deleteFeatures=Mq.prototype.Hf;function Qq(e,o,s,h,d,g,_){var j=Object.assign(e.ns?{}:{authorization:"Bearer "+e.xx},{"Content-Type":"application/geo+json"},e.Mc);return d={method:d,headers:j},g&&(d.data=JSON.stringify(g)),o=Oq(e.i().clone().v(o+"/features").B(_||{})),g=new Ue("application/json",o.toString(),ge,d),g.then(s,so(e,o,h)),g}Mq.prototype.Jf=function(e){var o=this;this.Vl[e]=Rq,this.qm(e,function(s){o.Vl[e]=Sq,o.st[e]=s.copyright,o.dispatchEvent("copyrightupdate")},function(s){throw o.Vl[e]=Tq,s})};function Pq(e,o){return e.ns?o:Oq(o).B({access_token:e.xx})}function Oq(e){var o=Object.assign({},e.getQuery());return delete o.apikey,e.Tk(o)}Mq.CONFIG_KEY="xyz";var Rq=1,Sq=2,Tq=-1;function Nq(e,o,s,h){if(!Za(s))throw new D(e,o,'"onResult" must be a function');if(!Za(h))throw new D(e,o+1,'"onError" must be a function')}X.prototype.OA=function(e){return this.Ta(Mq,e)},X.prototype.getXYZService=X.prototype.OA;function Uq(e,o,s){var h;if(Uq.g.constructor.call(this,s?{min:s.min,max:s.max,engineType:s.engineType}:void 0),C(e,Mq,Uq,0),!gb(o))throw new D(Uq,1,'"spaceId" must be a string');if(this.$=e,this.Gg=o,this.Ok={},s&&(["limit","simplificationLevel","tags"].forEach(function(d){d in s&&(this.Ok[d]=s[d])},this),e=s.parameters))for(h in e)this.Ok[h]=e[h];this.Xa(this.Ep())}u(Uq,R),t("H.service.xyz.Provider",Uq),Uq.prototype.s=function(e,o,s,h,d){return this.$.lm(e,o,s,this.Gg,h,d,this.Ok)},Uq.prototype.requestInternal=Uq.prototype.s,Uq.prototype.U=function(){return this.$.U(this.Gg)},Uq.prototype.getCopyrights=Uq.prototype.U,Uq.prototype.Vc=xe,Uq.prototype.providesOMV=Uq.prototype.Vc,Uq.prototype.J=function(){return this.mb()},Uq.prototype.getStyle=Uq.prototype.J,Uq.prototype.Cb=function(e){C(e,Bf)&&e.Yb("MVT"),this.Xa(e)},Uq.prototype.setStyle=Uq.prototype.Cb,Uq.prototype.Ep=function(){return this.vb===Rf.WEBGL?new Bf({sources:{xyz:{type:"MVT"}},layers:{xyz:{data:{source:"xyz",layer:this.Gg},points:{filter:{$geometry:"point"},draw:{points:{collide:!1,order:200,color:"#92CF48",size:[[10,"8px"],[14,"12px"],[18,"16px"]]}}},polygons:{filter:{$geometry:"polygon"},draw:{polygons:{order:201,color:"#E39E3C"},lines:{order:202,color:"#755DA5",width:"1px"}}},lines:{filter:{$geometry:"line"},draw:{lines:{order:203,color:"#000000",width:"2px",join:"round",cap:"round"}}}}}}):new H.map.render.harp.Style({styles:[{layer:this.Gg,when:["==",["geometry-type"],"Point"],technique:"circles",renderOrder:200,color:"#92CF48",size:["interpolate",["linear"],["zoom"],10,8,14,12,18,16]},{layer:this.Gg,when:["==",["geometry-type"],"Polygon"],technique:"polygon",color:"#E39E3C",renderOrder:201},{layer:this.Gg,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#755DA5",width:"1px",renderOrder:202},{layer:this.Gg,when:["==",["geometry-type"],"LineString"],technique:"solid-line",color:"#000000",width:"2px",renderOrder:203}]})},X.prototype.Xl=function(e,o,s,h,d,g){function _(my,xy,Ly){xy=my.rm(xy),xy=_n?new Bf(xy):new H.map.render.harp.Style(xy);var My={engineType:_t};_r&&_r.politicalView&&(My.politicalView=_r.politicalView),s&&(My.lg=s),h&&(My.lg2=h),g&&(My.pois=g);var Ry;return Ly&&(Ry={dark:Ly}),my.md(xy,My,Ry)}function j(my,xy,Ly,My,Ry){return my.Od(xy,Ly,_s,My,_l,1,Ry,_e)}var $=this,_t=Qf,_e={crossOrigin:"anonymous"};if(ya(e)){var _r=e;"crossOrigin"in _r&&(_e.crossOrigin=_r.crossOrigin),e=_r.tileSize,o=_r.ppi,s=_r.lg,h=_r.lg2,d=_r.style,g=_r.pois,_r.engineType!==void 0&&(_t=_r.engineType,_e.engineType=_t)}var _i=_t===Rf.HARP,_n=_t===Rf.WEBGL,_s=e||512,_l={};if(0>[72,250,320,500].indexOf(+o)){if(o!==B)throw new D(this.Xl,1,o)}else _l.ppi=+o;if(s&&(_l.lg=s),h&&(_l.lg2=h),d&&(_l.style=d),g&&(_l.pois=!!g),_i&&!H.map.render.harp)throw new D(this.Xl,0,"HARP engine is not supported, module not found");e={},d=this.Kp();var Ap=this.Kp({type:"aerial"}),_h=this.Sp(),_p=_h.vt(_l.lg?{lg:_l.lg,i18n:!0,engineType:_t}:{engineType:_t});if(jo(e,{raster:{normal:{xbase:j(d,"xbasetile","normal.day","png8",!1),xbasenight:j(d,"xbasetile","normal.night","png8",!0),base:j(d,"basetile","normal.day","png8",!1),basenight:j(d,"basetile","normal.night","png8",!0),map:j(d,"maptile","normal.day","png8",!1),mapnight:j(d,"maptile","normal.night","png8",!0),trafficincidents:_p,transit:j(d,"maptile","normal.day.transit","png8",!1),labels:j(d,"labeltile","normal.day","png",!1)},satellite:{xbase:j(Ap,"xbasetile","hybrid.day","jpg",!0),base:j(Ap,"basetile","hybrid.day","jpg",!0),map:j(Ap,"maptile","hybrid.day","jpg",!0),labels:j(Ap,"labeltile","hybrid.day","png",!0)},terrain:{xbase:j(Ap,"xbasetile","terrain.day","jpg",!1),base:j(Ap,"basetile","terrain.day","jpg",!1),map:j(Ap,"maptile","terrain.day","jpg",!1),labels:j(Ap,"labeltile","terrain.day","png",!1)}}}),_i||_n){jo(e,{vector:{normal:{traffic:_h.ut(void 0,_t),trafficincidents:_p}}}),Ap=this.Lj({queryParams:{content:"default,transit"}}),d=this.Tp(),_h=this.Lj({queryParams:{content:"default,advanced_roads,advanced_pois,transit"}});var ty=this.Lj({queryParams:{content:"default,hillshade,contours,transit"}});if(_n)e.vector.normal.map=_(Ap,"omv/miami/normal.day.yaml"),e.vector.normal.truck=_(Ap,"omv/miami/truck.day.yaml");else if(_i){e.vector.normal.map=_(Ap,"harp/oslo/normal.day.json"),e.vector.normal.truck=_(Ap,"harp/oslo/normal.day.json"),e.vector.normal.logistics=_(_h,"harp/oslo/logistics.day.json"),e.vector.normal.logisticsnight=_(_h,"harp/oslo/logistics.night.json"),_p=_(ty,"harp/oslo/topo.day.json"),ty=_(ty,"harp/oslo/topo.night.json");var ry=function(my){if(my=my.target,my.getState()===2){my.removeEventListener("change",ry);var xy=my.getEnabledFeatures()||[];[{feature:"terrain",mode:"hillshade"},{feature:"contours",mode:"all"}].forEach(function(Ly){var My=xy.findIndex(function(Ry){return Ry.feature===Ly.feature});xy.splice(My,My===-1?0:1,Ly)}),my.setEnabledFeatures(xy)}};_p.D.J().addEventListener("change",ry),ty.D.J().addEventListener("change",ry),e.vector.normal.topo=_p,e.vector.normal.toponight=ty;var ly={ppi:72<o?400:100,size:256<_s?512:256,features:"pois:"+(g===!0||gb(g)&&/[^0]/.test(g)?"all":"disabled")};s&&(ly.lang=s),h&&(ly.lang2=h),_r&&_r.politicalView&&(ly.pview=_r.politicalView),o={dark:!0},_p=function(my,xy,Ly,My,Ry){var Sy=jo({},ly);return/^explore\./.test(Ly)||delete Sy.features,my=$.Qp({format:xy,resource:my,queryParams:jo({style:Ly},Sy)}),Ry=new uo(my,{engineType:_t,style:Ry}),new Dk(Ry,My)},jo(e.raster.normal,{base:_p("background","png8","explore.day"),basenight:_p("background","png8","explore.night",o),map:_p("base","png8","explore.day"),mapnight:_p("base","png8","explore.night",o),labels:_p("label","png","explore.day")}),jo(e.raster.satellite,{xbase:_p("background","jpeg","satellite.day",o),base:_p("background","jpeg","explore.satellite.day",o),map:_p("base","jpeg","explore.satellite.day",o),labels:_p("label","png","explore.satellite.day")}),jo(e.vector.normal,{mapnight:_(Ap,"harp/oslo/normal.night.json",!0),lite:_(Ap,"harp/oslo/lite.day.json"),litenight:_(Ap,"harp/oslo/lite.night.json",!0),ism:_(Ap,"harp/oslo/road.network.day.json"),ismnight:_(Ap,"harp/oslo/road.network.night.json",!0),roadnetwork:_(Ap,"harp/oslo/road.network.day.json"),roadnetworknight:_(Ap,"harp/oslo/road.network.night.json",!0)}),ty={styles:[{technique:"raster",attr:{gamma:["step",["zoom"],.9,13,1],brightness:["step",["zoom"],.6,12,.7,13,.8,14,.8,17,.9]}}]};for(var uy=[],py=0;6>py;py++){var fy=new H.map.render.harp.Style(JSON.parse(JSON.stringify(ty)));fy=_p("background","jpeg","satellite.day",o,fy),uy.push(fy)}e.hybrid={day:{raster:uy[0],vector:_(Ap,"harp/oslo/hybrid.day.json",!0),traffic:_(d,"harp/oslo/hybrid.day.json",!0)},night:{raster:uy[1],vector:_(Ap,"harp/oslo/hybrid.night.json",!0),traffic:_(d,"harp/oslo/hybrid.night.json",!0)},liteday:{raster:uy[2],vector:_(Ap,"harp/oslo/lite.hybrid.day.json",!0),traffic:_(d,"harp/oslo/lite.hybrid.day.json",!0)},litenight:{raster:uy[3],vector:_(Ap,"harp/oslo/lite.hybrid.night.json",!0),traffic:_(d,"harp/oslo/lite.hybrid.night.json",!0)},logistics:{raster:uy[4],vector:_(_h,"harp/oslo/logistics.hybrid.day.json",!0),traffic:_(d,"harp/oslo/logistics.hybrid.day.json",!0)},logisticsnight:{raster:uy[5],vector:_(_h,"harp/oslo/logistics.hybrid.night.json",!0),traffic:_(d,"harp/oslo/logistics.hybrid.night.json",!0)}}}Ap={traffic:{}},Ap.traffic.map=_(d,_n?"traffic/vector.tile.yaml":"harp/oslo/normal.day.json"),_i&&(Ap.traffic.logistics=_(d,"harp/oslo/logistics.day.json"),Ap.traffic.logisticsnight=_(d,"harp/oslo/logistics.night.json"),Ap.traffic.mapnight=_(d,"harp/oslo/normal.night.json"),Ap.traffic.lite=_(d,"harp/oslo/lite.day.json"),Ap.traffic.litenight=_(d,"harp/oslo/lite.night.json"),Ap.traffic.topo=_(d,"harp/oslo/topo.day.json"),Ap.traffic.toponight=_(d,"harp/oslo/topo.night.json")),jo(e.vector,Ap)}return e},X.prototype.createDefaultLayers=X.prototype.Xl,t("H.service.buildInfo",function(){return Zm("H-service","1.57.0","161a2e3",{region:"row"})});function Vq(e,o){var s,h=0;if(!ya(e)||Ma(e))throw new D(Vq,0,e);for(s in e){var d=+s;if(h++,!(jb(d)&&0<=d&&1>=d&&gb(e[s])))throw new D(Vq,0,e)}if(2>h)throw new D(Vq,0,"Specify at least 2 stops");this.lD=e,this.Pu=!!o}t("H.data.heatmap.Colors",Vq);var Wq=new Vq({0:"#008","0.2":"#0b0","0.5":"#ff0","0.7":"#f00"},!0);Vq.DEFAULT=Wq;function Xq(e,o,s,h,d){d&1&&Yq(e,e,o,s,h,0),d&2&&Yq(e,e,o,s,h,1),d&4&&Yq(e,e,o,s,h,2),d&8&&Yq(e,e,o,s,h,3)}function Yq(e,o,s,h,d,g){for(var _=(s+1)*(s+1),j,$=4*h,_t=s+1,_e,_r=[{r:0,kz:0,b:0,a:0,next:null}],_i=1,_n=["r","g","b","a"][g],_s=2*s+1,_l,Ap;_i<_s;_i++)_r[_i]={r:0,kz:0,b:0,a:0,next:null},_r[_i-1].next=_r[_i];_r[2*s].next=_r[0];var _h=4*(h-1);for(j=0;j<d;j++){var _p=j*$,ty=e[_p+g],ry=ty*_t*(s+2)/2;for(_s=ty*_t,_i=0;_i<=s;_i++)_r[_i][_n]=ty;var ly=0;for(_i=1;_i<=s;_i++){var uy=_i<h?_p+4*_i:_p+_h;uy=e[uy+g],ry+=uy*(_t-_i),ly+=uy,_r[s+_i][_n]=uy}uy=_r[0],_l=_r[_t],_i=_p,Ap=4*_t;var py=_p+_h;for(ty=0;ty<h;ty++){o[_i+g]=ry/_,ry-=_s;var fy=ty+_t<h?_i+Ap:py;if(fy=e[fy+g],ly+=fy,ry+=ly,_s-=uy[_n],_s+=_l[_n],ly-=_l[_n],uy[_n]=fy,uy=uy.next,_l=_l.next,_i+=4,!ry)for(;(_e=4*(ty+_t))<$&&e[_p+g+_e]===0;)ty++,_i+=4}}for(_p=(d-1)*$,ty=0;ty<h;ty++){for(e=4*ty,j=o[e+g],ry=j*_t*(s+2)/2,_s=j*_t,_i=0;_i<=s;_i++)_r[_i][_n]=j;for(ly=0,_i=1;_i<=s;_i++)uy=_i<d?e+_i*$:e+_p,uy=o[uy+g],ry+=uy*(s-_i+1),ly+=uy,_r[s+_i][_n]=uy;for(uy=_r[0],_l=_r[_t],_i=e,py=_t*$,_h=e+_p,j=0;j<d;j++)if(o[_i+g]=ry/_,ry-=_s,fy=j+_t<d?_i+py:_h,fy=o[fy+g],ly+=fy,ry+=ly,_s-=uy[_n],_s+=_l[_n],ly-=_l[_n],uy[_n]=fy,uy=uy.next,_l=_l.next,_i+=$,!ry)for(;(_e=j+_t)<d&&o[_e*$+g+e]===0;)j++,_i+=$}}function Zq(e,o,s){this.WA=o=e>>o,this.yB=Math.log(o)*Math.LOG2E,this.Cc=e=document.createElement("CANVAS"),this.ty=e.getContext("2d"),this.uy=e.width=e.height=3*o;var h=document.createElement("canvas");e=s.Pu;var d=s.lD;o=[];var g;h.width=256,h.height=1,h=h.getContext("2d");for(_ in d)d.hasOwnProperty(_)&&o.push({stop:parseFloat(_),value:d[_]});d=o.length,o.sort(this.kD),0<o[0].stop&&o.unshift({stop:0,value:o[0].value}),1>o[d-1].stop&&o.push({stop:1,value:o[d-1].value}),d=o.length;var _=h.createLinearGradient(0,0,256,0);for(g=0;g<d;g++){if(!e&&$){var j=$.stop+(o[g].stop-$.stop)/2;_.addColorStop(j,$.value),_.addColorStop(j,o[g].value)}_.addColorStop(o[g].stop,o[g].value);var $=o[g]}h.fillStyle=_,h.fillRect(0,0,256,1),this.By=h.getImageData(0,0,256,1).data,this.XA=s.Pu}Zq.prototype.kD=function(e,o){return e.stop-o.stop},Zq.prototype.Rx="#000",Zq.prototype.fy="#080";function $q(e,o){this.canvas=e,this.size=o}function ar(e,o,s){this.bf=e=ac(e,0,30),this.Qa=o,this.oj=s,this.gs=[],this.ci=[];do this.ci[e]=[],this.gs[e]=new br;while(e--);o===cr?(this.Ts=dr,this.normalize=er):(this.Ts=fr,this.normalize=gr),this.gk=1/0,this.Xm=-1/0}var hr=Math.log(.5);function er(e){return this.ip?Math.round((e-this.gk)/this.ip*255):127}function gr(e){return this.bu===void 0?127:Math.round(255*Math.pow(e,this.bu))}ar.prototype.xc=function(e){var o,s,h=e.value;h===void 0&&(h=1),h>this.Xm&&(this.Xm=h,this.ip=this.Xm-this.gk),h<this.gk&&(this.gk=h,this.ip=this.Xm-this.gk);var d=ld.Re(e).scale(1073741823).floor();h=this.bf;var g=d.x>>30-h;for(d=d.y>>30-h,s=this.Ts;-1<h;){this.ci[h][d]||(this.ci[h][d]=[]),(o=this.ci[h][d][g])||(o=this.ci[h][d][g]=new s(g,d,h)),o.xc(e,h);var _=this.gs[h];_.zv>o.dd&&(_.zv=o.dd),_.Qh<o.dd&&(_.Qh=o.dd),_.yv>o.Ac&&(_.yv=o.Ac),_.Iq<o.Ac&&(_.Iq=o.Ac),h--,g>>=1,d>>=1}};function ir(e,o,s,h,d){var g=1<<o,_,j;return h=$b(h,g),g=0<=s&&s<g&&(_=e.ci[o])&&(j=_[s])&&(g=j[h])||null,!g&&d&&0<=o&&(g=ir(e,o-1,s>>1,h>>1,d)),g}function jr(e,o,s,h,d,g){for(var _,j=[];s<=h;s++)for(_=d;_<=g;_++)j.push(ir(e,o,s,_,!1));return j}function kr(e,o){var s=0,h=0,d=ir(e,0,0,0,!1),g;return o.fm||(o.z===e.bf?o.Aj=o.Ac:(lr(e,o,function(_){var j=mr(e,_),$=4-j.length;if(_.z!==e.bf){for(g=0;g<j.length;g++)s+=j[g].Ac,h++;s+=$*d.Ac,h+=$}}),o.Aj=s/h),o.fm=!0),o.Aj}function lr(e,o,s){o=[o];for(var h,d;0<o.length;)d=o.shift(),h=mr(e,d),s(d),o.push.apply(o,h)}function mr(e,o){var s=[],h,d,g;for(d=0;1>=d;d++)for(g=0;1>=g;g++)(h=ir(e,o.z+1,2*o.x+d,2*o.y+g,!1))&&s.push(h);return s}ar.prototype.clear=function(){ar.call(this,this.bf,this.Qa,this.oj)};function fr(e,o,s){this.x=e,this.y=o,this.z=s,this.Ac=this.dd=this.count=0,this.fm=!1,this.Aj=0}fr.prototype.xc=function(e,o){this.count++,this.dd+=e.value||1,this.Ac=this.dd/Math.pow(2,2*(30-o))};function dr(e,o,s){this.x=e,this.y=o,this.z=s,this.Ac=this.dd=this.count=0,this.fm=!1,this.Aj=0}dr.prototype.xc=function(e){e=e.value,this.dd+=e!==void 0?e:1,this.Ac=this.dd/++this.count,this.fm=!1};function br(){this.zv=this.yv=1/0,this.Qh=this.Iq=-1/0}function nr(e){var o=e||{},s=+o.sampleDepth,h=o.pointSize;e=+o.coarseness;var d=o.colors,g={min:o.min,max:o.max,engineType:o.engineType},_=o.tileSize,j=+o.dataMax;if(o.tileSize&&(g.tileSize=_),R.call(this,g),this.Eg(o.opacity),this.Qa=o.type==="value"?cr:or,this.sampleDepth_=jb(s)?ac(Math.round(s),1,8):4,this.Jw=this.Qa===or?jb(h)?ac(Math.round(7-h),0,6):2:1,this.et=!!o.assumeValues,o=this.max,this.oj=jb(j)?ac(Math.round(j),this.min,o+this.sampleDepth_):o,e=jb(e)?ac(Math.round(e),0,3):1,d&&!C(d,Vq))throw new D(nr,0,"colors");this.Bi=new ar(o+this.sampleDepth_+this.Jw,this.Qa,this.oj),this.rD=new Zq(this.tileSize,e,d||Wq),this.rg=A(this.rg,this),this.kg=A(this.kg,this),this.Mn=new Jk(20,this.rg)}u(nr,R),t("H.data.heatmap.Provider",nr),nr.prototype.Ed=function(e){this.Eg(e)},nr.prototype.setOpacity=nr.prototype.Ed,nr.prototype.Ue=function(){return this.Qc},nr.prototype.getOpacity=nr.prototype.Ue,nr.prototype.zk=xe,nr.prototype.providesRasters=nr.prototype.zk,nr.prototype.s=function(e,o,s,h,d){var g=this.et,_,j;if(ir(this.Bi,0,0,0,!1)){if(!g){var $=jr(this.Bi,s,o-1,o+1,e-1,e+1);for(_=$.length;_--&&!g;)if($[_]!==null){g=!0;break}}g&&(j=this.Mn.push([e,o,s,h,d],this.kg))}return g||h(null),j||jj},nr.prototype.requestInternal=nr.prototype.s,nr.prototype.rg=function(e,o){var s=e.done,h=o[0],d=o[1],g=o[2];o=document.createElement("canvas");var _=this.tileSize,j=o.getContext("2d");o.width=o.height=_;var $=this.rD,_t=this.Bi,_e=this.et,_r=this.Qa,_i=this.Jw,_n=$.WA,_s=$.ty,_l,Ap,_h=_r===or?_i===void 0?2:_i:1;_i=_h,_h=Math.min(this.sampleDepth_+_h,$.yB);var _p=$.uy,ty=_t.bf;if(_e&&_r===cr){for(Ap=-1;1>=Ap;Ap++)for(_e=-1;1>=_e;_e++){var ry=(ry=ir(_t,g,d+Ap,h+_e,!0))?_t.normalize(kr(_t,ry)):128;_s.fillStyle="rgba("+ry+",128,0,1)",_s.fillRect((_e+1)*_n,(Ap+1)*_n,_n,_n)}_e=_n-Math.floor(_n/10),Ap=3,ry=_s.getImageData(0,0,_p,_p),Xq(ry.data,_e,_p,_p,Ap),_s.putImageData(ry,0,0)}else _s.fillStyle=_e?$.fy:$.Rx,_s.fillRect(0,0,_p,_p);for(;_i<=_h&&g+_i<=ty;_i++){_e=_n>>_i,Ap=_n-_e;var ly=_r===or?127+Math.floor(128/(1<<_h-_i)):255;ry=(1<<_i)+2;var uy=1<<_i,py=h<<_i,fy=d<<_i;for(uy=jr(_t,g+_i,fy-1,fy+uy,py-1,py+uy),py=uy.length;py--;){fy=py%ry;var my=py/ry<<0;(_l=uy[py])&&(_l=_t.normalize(_l.Ac),_s.fillStyle="rgba("+_l+","+ly+",0,1)",_s.fillRect(fy*_e+Ap,my*_e+Ap,_e,_e))}ry=_s,ly=_e,uy=Ap,py=_n+2*_e,_e=_n+2*_e,fy=fy=3,my=_s.getImageData(uy,Ap,py,_e),Xq(my.data,ly,py,_e,fy),ry.putImageData(my,uy,Ap)}for(h=_s.getImageData(0,0,_p,_p),d=$.By,g=$.XA,_t=h.data,_h=0,_p=_t.length;_h<_p;_h+=4)_r=_t[_h],_i=_t[_h+1],d.length===4&&(_r=0),_t[_h]=d[4*_r],_t[_h+1]=d[4*_r+1],_t[_h+2]=d[4*_r+2],_t[_h+3]=d[4*_r+3]*(g?_i/255:10>_i?0:1);_s.putImageData(h,0,0),$=new $q($.Cc,_n),_n=$.size,j.drawImage($.canvas,_n,_n,_n,_n,0,0,_,_),s.call(e,o)},nr.prototype.kg=function(e,o,s){var h=e.data;e=h[3],h=h[4],s?h():e(o)},nr.prototype.Zs=function(e,o){var s;if(!fb(e))throw new D(this.Zs,0,e);if(s=e.length){for(;s--;)this.Bi.xc(e[s]);e=this.Bi;var h;s=e.gs;var d=e.bf,g=0;if(e.Qa===or){var _=s[e.bf].Qh;for(h=e.bf;0<=h&&s[h].Qh===_;h--)g=h;for(_=s[0].Qh,h=0;h<=g&&_===s[h].Qh;h++)d=h;g>e.oj&&(g=e.oj),_=Math.round(d+(g-d)/2),e.bu=hr/Math.log(s[_].Iq)}this.reload(!!o)}},nr.prototype.addData=nr.prototype.Zs,nr.prototype.clear=function(){this.Bi.clear(),this.reload(!0)},nr.prototype.clear=nr.prototype.clear;var or=0,cr=1;function pr(e,o){this.Ya=e,this.Oe=o}pr.prototype.create=function(e,o){var s=e.coordinates;switch(e.type){case"Point":var h=new $m(qr(s));break;case"LineString":h=new mm(rr(s));break;case"Polygon":h=new zi(sr(s));break;case"MultiPoint":var d=0,g=s.length;if(h=[],this.Oe){for(;d<g;d++)h.push(qr(s[d]));s=new $m(new mg(h))}else{for(;d<g;d++)h.push(new $m(qr(s[d])));s=new T,s.hd(h)}h=s,g="multiPoint";break;case"MultiLineString":if(d=0,g=s.length,h=[],this.Oe){for(;d<g;d++)h.push(rr(s[d]));s=new mm(new lh(h))}else{for(;d<g;d++)h.push(new mm(rr(s[d])));s=new T,s.hd(h)}h=s,g="multiLineString";break;case"MultiPolygon":if(h=[],d=0,g=s.length,this.Oe){for(;d<g;d++)h.push(sr(s[d]));s=new zi(new kh(h))}else{for(;d<g;d++)h.push(new zi(sr(s[d])));s=new T,s.hd(h)}h=s,g="multiPolygon";break;case"GeometryCollection":s=h=new T,d=e.geometries,g=0;for(var _=d.length;g<_;g++)this.create(d[g],s);g="geometryCollection"}return h&&(s=h,d=e.properties,e=e.id,_={},d&&(this.Oe?_=d:_.properties=d),g&&!this.Oe&&(_[g]=!0),e&&s.Zr(e),s.setData(_),this.Ya(h)),o&&h&&o.Y(h),h},pr.prototype.create=pr.prototype.create;function qr(e){return new fd(e[1],e[0])}function sr(e){for(var o=rr(e[0]),s=[],h,d=1,g=e.length;d<g;d++)h=rr(e[d]),s.push(h);return new N(o,s)}function rr(e){for(var o=0,s=e.length,h=new M;o<s;o++)h.sg(qr(e[o]));return h}function tr(e){bb(this,tr),this.url=e,this.gj=[],this.ae=z,this.lj=A(this.lj,this),K.call(this)}u(tr,K),t("H.data.AbstractReader",tr);var ur={ERROR:-1,LOADING:0,VISIT:1,READY:2};tr.State=ur,tr.prototype.state=ur.READY,tr.prototype.j={ey:"statechange"},tr.prototype.Tb=function(){if(!this.ae){this.ae=new Q;var e=this.ae.rd();e.hd(this.gj)}return new bl(this.ae)},tr.prototype.getLayer=tr.prototype.Tb,tr.prototype.lA=function(){return this.gj.concat([])},tr.prototype.getParsedObjects=tr.prototype.lA,tr.prototype.i=function(){return this.url},tr.prototype.getUrl=tr.prototype.i,tr.prototype.bD=function(e){if(this.state===ur.LOADING||this.state===ur.VISIT)throw Error("InvalidState: state "+this.state);return this.gj=[],this.ae=z,this.url=e,this},tr.prototype.setUrl=tr.prototype.bD,tr.prototype.getState=function(){return this.state},tr.prototype.getState=tr.prototype.getState,tr.prototype.F=function(e,o,s){this.state=e,this.dispatchEvent(new vr(o||this,this.j.ey,e,s||""))},tr.prototype.parse=function(){var e=this;ab(this.url)?(this.F(ur.LOADING),new Ue("text/plain",this.url).then(function(o){try{e.lj(o)}catch(s){e.F(ur.ERROR,z,s.message)}},function(){e.F(ur.ERROR,z,"Error loading file")})):e.F(ur.ERROR,z,"File url was not set")},tr.prototype.parse=tr.prototype.parse;function vr(e,o,s,h){vr.g.constructor.call(this,o,e),this.state=s,this.message=h}u(vr,uc),tr.Event=vr;function wr(e,o){o=o||{},this.Ya=o.style||this.gh,(this.Oe=!!o.disableLegacyMode)||window.console.warn("H.data.geojson.Reader: Legacy parser is enabled in GeoJSON Reader. Features like Multi-Geometries, Polygon interiors and GeoJSON feature properties might not work as expected. To maximise compatibility with the remote services it is recommended to set the `disableLegacyMode` flag to true."),tr.call(this,e)}u(wr,tr),t("H.data.geojson.Reader",wr),wr.prototype.lj=function(e){var o,s;try{var h=typeof e=="string"?JSON.parse(e):e;if(typeof h=="object"){var d=new pr(this.Ya,this.Oe);switch(h.type){case"FeatureCollection":if(o=h.features){var g=new T;for(this.Rg(g),s=0;s<o.length;s++){var _=xr(o[s]);(_=d.create(_))&&g.Y(_)}}break;case"Feature":_=xr(h),(_=d.create(_))&&this.Rg(_);break;default:(_=d.create(h))&&this.Rg(_)}this.F(ur.READY)}else this.F(ur.ERROR,z,"Invalid syntax")}catch(j){this.F(ur.ERROR,z,"Parse error. "+j.message)}},wr.prototype.nC=function(e){this.F(ur.LOADING),this.lj(e)},wr.prototype.parseData=wr.prototype.nC,wr.prototype.gh=function(){};function xr(e){var o={};if(e.geometry){var s=e.geometry;o.type=s.type,o.properties=e.properties,s.coordinates&&(o.coordinates=s.coordinates),s.geometries&&(o.geometries=s.geometries),e.id&&(o.id=e.id)}return o}wr.prototype.Rg=function(e){this.ae&&this.ae.rd().Y(e),this.gj.push(e),this.F(ur.VISIT,e)};function yr(){}t("H.data.utils.Dom",yr),yr.prototype.sh=function(e){return!!e&&/^\s*(1|true)\s*$/i.test(this.Ua(e))},yr.prototype.getBoolean=yr.prototype.sh,yr.prototype.Ua=function(e){var o;try{if(e.nodeType===Node.ATTRIBUTE_NODE)return e.value;var s="",h=0,d=e.childNodes;for(o=d.length;h<o;h++)d[h].nodeType!==Node.COMMENT_NODE&&(s+=d[h].nodeValue.replace(/^\s+|\s+$/g,""))}catch{}return s||""},yr.prototype.getString=yr.prototype.Ua,yr.prototype.mm=function(e){return parseFloat(this.Ua(e))||0},yr.prototype.getFloat=yr.prototype.mm,yr.prototype.$v=function(e){var o=e.split(/\s+/),s=o.length,h=!(o&&s==1),d=h?1:3,g=[],_;for(h||(o=e.split(","),s=o.length),_=0;_<s;_+=d)if(e=this.fr(h?o[_]:_+3>o.length?null:o.slice(_,_+3)))g.push(e);else return[];return g},yr.prototype.parseCoords=yr.prototype.$v,yr.prototype.fr=function(e){if(!e)return null;var o=e instanceof Array&&0<e.length&&4>e.length?e:e.split(",");e=parseFloat(o[0]);var s=parseFloat(o[1]);return o=parseFloat(o[2]),isNaN(s)||isNaN(e)?null:new fd(s,e,isNaN(o)?void 0:o)},yr.prototype.parseCoord=yr.prototype.fr,yr.prototype.km=function(e){return e=this.Ua(e),/^[0-9a-fA-F]{8}$/.test(e)?"#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)+e.substr(0,2):"#000000ff"},yr.prototype.getColor=yr.prototype.km;function zr(){this.VA={4:function(e){return["#",e.charAt(1),e.charAt(1),e.charAt(2),e.charAt(2),e.charAt(3),e.charAt(3),"ff"].join("")},5:function(e){return["#",e.charAt(1),e.charAt(1),e.charAt(2),e.charAt(2),e.charAt(3),e.charAt(3),e.charAt(4),e.charAt(4)].join("")},7:function(e){return e+"ff"},9:function(e){return e}},this.QC={4:function(e){return[Ar(e.charAt(1)),Ar(e.charAt(2)),Ar(e.charAt(3)),255]},5:function(e){return[Ar(e.charAt(1)),Ar(e.charAt(2)),Ar(e.charAt(3)),Ar(e.charAt(4))]},7:function(e){return e=parseInt(e.substring(1),16),[e>>16&255,e>>8&255,e&255,255]},9:function(e){return e=parseInt(e.substring(1),16),[e>>24&255,e>>16&255,e>>8&255,e&255]}}}t("H.data.utils.ColorHelper",zr);function Ar(e){return e=parseInt(e,16),(e<<4)+e}function Br(e){return 16>e?"0"+Math.round(e).toString(16):Math.round(e).toString(16)}function Cr(e,o,s){return/^(#|rgb).*/.test(o)?(s||(s="",o.charAt(0)==="#"?s=e.VA[o.length]?o:"":o.substr(0,3)==="rgb"&&(o=o.match(/\d+(\.\d+)?/g),s=o.length,s=2<s&&5>s?["#",Br(+o[0]),Br(+o[1]),Br(+o[2]),3<s?Br(255*+o[3]):"ff"].join(""):""),o=s),e=e.QC[o.length](o),e[3]=Math.round(e[3]/255*100)/100,e):[0,0,0,255]}zr.prototype.ux=function(e,o){var s="";if(!/^(#|rgb).*/.test(e)){for(s="",e=0;6>e;e++)s+="ABCDEF0123456789".charAt(Math.floor(16*Math.random()));return s+"ff"}for(e=Cr(this,e,o),o=0;4>o;o++)s+=""+Br(3>o?Math.floor(Math.random()*(e[o]-0+1))+0:255*e[o]);return s},zr.prototype.toRandomRGBA=zr.prototype.ux;function Dr(e){e=e.childNodes;for(var o,s=e.length,h=new yr,d=new zr;s--;)switch(o=e[s],o.nodeName){case"color":this.color=h.km(o);break;case"colorMode":this.Ay=h.Ua(o)}this.Ay==="random"&&(this.color="#"+d.ux(this.color,!1))}t("H.data.kml.ColorStyle",Dr);function Er(e){var o=e.childNodes,s=o.length,h=new yr;for(this.Ml=new Dr(e);s--;)e=o[s],e.nodeName==="width"&&(this.width=h.mm(e))}t("H.data.kml.LineStyle",Er);function Fr(e){e=e.childNodes;for(var o,s=e.length,h=new yr;s--;)switch(o=e[s],o.nodeName){case"bgColor":this.bgColor=h.km(o);break;case"textColor":this.textColor=h.km(o);break;case"text":this.text=h.Ua(o);break;case"displayMode":this.displayMode=h.Ua(o)}}t("H.data.kml.BalloonStyle",Fr);function Gr(e){var o=e.childNodes,s=o.length,h=new yr;for(this.outline=this.fill=!0,this.Ml=new Dr(e);s--;)switch(e=o[s],e.nodeName){case"fill":this.fill=h.sh(e);break;case"outline":this.outline=h.sh(e)}}t("H.data.kml.PolyStyle",Gr);function Hr(e){var o=e.childNodes,s=new yr;for(this.offsetX=this.offsetY=0,e=o.length;e--;){var h=o[e];switch(h.nodeName){case"href":this.href=s.Ua(h)}}}t("H.data.kml.Icon",Hr);function Ir(e){e=e.attributes;for(var o,s=e.length;s--;)switch(o=e[s],o.name){case"x":this.x=parseFloat(o.value);break;case"y":this.y=parseFloat(o.value);break;case"xunits":this.Ye=yr.prototype.Ua(o)==="fraction";break;case"yunits":this.Zd=yr.prototype.Ua(o)==="fraction"}}t("H.data.kml.HotSpot",Ir);function Jr(e){var o;if(e){e=e.childNodes;var s=e.length;for(o=new yr;s--;){var h=e[s];switch(h.nodeName){case"scale":this.scale=o.mm(h);break;case"Icon":this.icon=h=new Hr(h);break;case"hotSpot":this.Fu=h=new Ir(h)}}}}t("H.data.kml.IconStyle",Jr);function Kr(e){var o=e.childNodes,s=o.length;for(this.id=e.getAttribute("id");s--;)switch(e=o[s],e.nodeName){case"IconStyle":this.Hu=e=new Jr(e);break;case"LineStyle":this.Nh=e=new Er(e);break;case"PolyStyle":this.gw=e=new Gr(e);break;case"BalloonStyle":this.Dl=e=new Fr(e)}}t("H.data.kml.Style",Kr);function Lr(e,o){e=e.childNodes;var s=e.length,h=new yr;for(this.nD=o;s--;)switch(o=e[s],o.nodeName){case"key":this.key=h.Ua(o);break;case"styleUrl":this.bl=h.Ua(o)}}t("H.data.kml.Pair",Lr),Lr.prototype.J=function(){if(this.bl){var e=this.key==="highlight";e=this.nD.Rp(this.bl.substr(1),e)}return e},Lr.prototype.getStyle=Lr.prototype.J;function Mr(e,o){var s=e.childNodes,h=s.length;for(this.hs=o,this.id=e.getAttribute("id"),this.un=[];h--;)e=s[h],e.nodeName==="Pair"&&(e=new Lr(e,this.hs),this.un.push(e))}t("H.data.kml.StyleMap",Mr),Mr.prototype.J=function(e){var o=null;e=e?"highlight":"normal";for(var s=this.un.length;s--;)this.un[s].key===e&&(o=this.un[s].J());return o},Mr.prototype.getStyle=Mr.prototype.J;function Nr(){this.ix={}}t("H.data.kml.StyleContainer",Nr),Nr.prototype.Ao=function(e){e&&e.id&&(this.ix["style_"+e.id]=e)},Nr.prototype.addStyle=Nr.prototype.Ao,Nr.prototype.Rp=function(e,o){return e=this.ix["style_"+e],e instanceof Mr&&(e=e.J(o)),e},Nr.prototype.getStyleById=Nr.prototype.Rp;function Or(e){e=e.childNodes;for(var o,s=e.length,h=null,d=new yr;s--;)o=e[s],o.nodeName==="coordinates"&&(h=d.Ua(o));this.jv=null,h&&(this.jv=d.fr(h)||null)}t("H.data.kml.Point",Or),Or.prototype.vh=function(){return this.jv};function Pr(e){e=e.childNodes;for(var o,s=e.length,h=new yr;s--;)if(o=e[s],o.nodeName==="coordinates"){o=h.Ua(o);var d=[],g=new yr;try{d=g.$v(o)}catch{d=[]}this.Tl=2>d.length?[]:d}}t("H.data.kml.Line",Pr),Pr.prototype.vh=function(){for(var e=new M,o=this.Tl?this.Tl.length:0;o--;)e.sg(this.Tl[o]);return e};function Qr(){}Qr.prototype.elevation=0,Qr.prototype.Ut=0;function Rr(e){var o=e.childNodes,s=o.length;for(this.Tt=new M,this.Ou=[];s--;){var h=o[s],d=h.nodeName;if(d==="outerBoundaryIs"||d==="innerBoundaryIs"){var g=h.childNodes;for(h=g.length;h--;){var _=g[h];if(_.nodeName==="LinearRing"){var j=new Pr(_);if(d==="outerBoundaryIs"){this.Tt=j.vh();var $=void 0,_t=e,_e=j.Tl;j=new yr;var _r=_t.querySelector("altitudeMode");if(_r&&_r.parentNode===_t&&!/^\s*clampTo/.test(j.Ua(_r))&&_e){_r=_e.length;for(var _i=0;_i<_r&&$!==0;_i++){var _n=_e[_i].alt;_n?$?_n!==$&&($=0):$=_n:$=0}(_e=_t.querySelector("*|altitudeOffset"))&&_e.parentNode===_&&_e.namespaceURI==="http://www.google.com/kml/ext/2.2"&&(_=j.mm(_e))&&($+=_),$&&($=yb(2047,$),(_=_t.querySelector("extrude"))&&_.parentNode===_t&&j.sh(_)?this.Ut=$:this.elevation=$)}}else this.Ou.push(j.vh())}}}}}u(Rr,Qr),t("H.data.kml.Polygon",Rr);function Sr(e,o){var s=e&&e.childNodes||[],h=new yr;if(!e||!o)throw Error("Node or stylesContainer is not defined");for(this.visibility=!0,this.qC=e,e=s.length;e--;){var d=s[e];switch(d.nodeName){case"name":this.name=h.Ua(d);break;case"description":this.description=h.Ua(d);break;case"visibility":this.visibility=h.sh(d);break;case"open":this.open=h.sh(d);break;case"styleUrl":(this.bl=h.Ua(d))&&(d=this.bl.substr(1),this.ez=o.Rp(d,!1));break;case"Style":this.nv=d=new Kr(d)}}}t("H.data.kml.Feature",Sr);function Tr(e,o){var s=document.createElement("CANVAS");s.width=1,s.height=1,this.hs=e,this.eq={},this.hr={},this.Zy=new um(s),this.kd=o||""}Tr.prototype.create=function(e){return this.oh=new Sr(e,this.hs),Ur(this,e)};function Ur(e,o,s){o=o.childNodes;for(var h=o.length,d,g={},_;h--;){var j=o[h];switch(j.nodeName){case"Point":j=new Or(j),_=Vr(e,"Marker"),(j=j.vh())&&(d=new $m(j,_),_.gr&&Kc(_.gr,"statechange",A(e.cC,e,_.gr,d,_),!1));break;case"LineString":j=new Pr(j),_=Vr(e,"Polyline"),d=new mm(j.vh(),_);break;case"LinearRing":j=new Pr(j),_=Vr(e,"Polyline"),d=new mm(j.vh(),_);break;case"Polygon":j=new Rr(j),_=Vr(e,"Polygon"),_.elevation=j.elevation,_.extrusion=j.Ut,d=new zi(new N(j.Tt,j.Ou),_);break;case"MultiGeometry":d=Ur(e,j,new T)}d&&(e.oh.name&&(g.name=e.oh.name),e.oh.description&&(g.description=e.oh.description),_&&_.Dl&&(g.balloonStyle=_.Dl),g.kmlNode=e.oh.qC,d.setData(g),s&&s.Y(d))}return s||d}Tr.prototype.cC=function(e,o,s){var h=s.anchor,d=s.scale;s=d+"_"+h.x+h.y+h.Ye+h.Zd+"_"+s.href;var g={};if(e.getState()===1){var _=this.eq[s];if(!_){var j=h.x,$=h.y;(_=e.mc())&&(_={w:_.w*d,h:_.h*d},g.size=_),j=h.Ye&&_?_.w*j:j*d,$=h.Zd&&_?_.h*(1-$):!h.Zd&&_?_.h-$*d:$*d,g.anchor={x:j,y:$},_=new um(e.Se(),g),this.eq[s]=_}o.ve(_)}delete this.hr[s]};function Vr(e,o){var s=e.oh,h={visibility:s.visibility},d=new zr,g=1,_={x:0,y:0,Ye:!1,Zd:!1},j=Wr(e,s.ez);switch(s.nv&&(j=Wr(e,s.nv,j)),o){case"Marker":if(j&&j.Hu){if(d=j.Hu,d.scale&&(g=d.scale),d.Fu){var $=d.Fu;_={x:$.x,y:$.y,Ye:$.Ye,Zd:$.Zd}}d.icon&&d.icon.href?(o=d.icon.href,Xr.test(o)||(o=e.kd+o),d=g+"_"+_.x+_.y+_.Ye+_.Zd+"_"+o,$=e.eq[d]||e.hr[d],$||($=new um(o),e.hr[d]=$),$.getState()===0?(h.icon=e.Zy,h.gr=$,h.href=o,h.anchor=_,h.scale=g):$.getState()===1&&(h.icon=$)):g!==1&&($||(_={x:14,y:4,Ye:!1,Zd:!1}),d=um,e=e.Dp(),$={w:28*g,h:36*g},g={size:new Hi($.w,$.h),anchor:new F(_.Ye?$.w*_.x:_.x*g,_.Zd?$.h*(1-_.y):$.h-_.y*g),hitArea:new Ii(Ji.POLYGON,[0*g,16*g,0*g,7*g,8*g,0*g,18*g,0*g,26*g,7*g,26*g,16*g,18*g,34*g,8*g,34*g])},h.icon=new d(e,g))}break;case"Polyline":h.style={},j&&j.Nh&&(g=j.Nh,h.style.strokeColor="rgba("+Cr(d,g.Ml.color,!0)+")",0<=g.width&&(h.style.lineWidth=g.width));break;case"Polygon":h.style={},j&&(j.Nh&&(g=j.Nh,h.style.strokeColor="rgba("+Cr(d,g.Ml.color,!0)+")",0<=g.width&&(h.style.lineWidth=g.width)),j.gw&&(g=j.gw,h.style.fillColor=g.fill?"rgba("+Cr(d,g.Ml.color,!0)+")":"rgba(0,0,0,0)",g.outline||(h.style.lineWidth=0)))}return h.Dl=j.Dl,h}function Wr(e,o,s){s=s||{};for(var h in o)o.hasOwnProperty(h)&&(s[h]=typeof o[h]=="object"?Wr(e,o[h],s[h]):o[h]);return s}var Xr=/^[^:\/]+:/;Tr.prototype.Dp=function(){return'<svg xmlns="http://www.w3.org/2000/svg" width="28px" height="36px"><path d="M 19 31 C 19 32.7 16.3 34 13 34 C 9.7 34 7 32.7 7 31 C 7 29.3 9.7 28 13 28 C 16.3 28 19 29.3 19 31 Z" fill="#000" fill-opacity=".2"/><path d="M 13 0 C 9.5 0 6.3 1.3 3.8 3.8 C 1.4 7.8 0 9.4 0 12.8 C 0 16.3 1.4 19.5 3.8 21.9 L 13 31 L 22.2 21.9 C 24.6 19.5 25.9 16.3 25.9 12.8 C 25.9 9.4 24.6 6.1 22.1 3.8 C 19.7 1.3 16.5 0 13 0 Z" fill="#fff"/><path d="M 13 2.2 C 6 2.2 2.3 7.2 2.1 12.8 C 2.1 16.1 3.1 18.4 5.2 20.5 L 13 28.2 L 20.8 20.5 C 22.9 18.4 23.8 16.2 23.8 12.8 C 23.6 7.07 20 2.2 13 2.2 Z" fill="#18d"/></svg>'};function Yr(e){var o=e?e.lastIndexOf("/"):-1;this.Ak=[],tr.call(this,e),0<=o&&(this.gB=e.substr(0,o)+"/")}u(Yr,tr),t("H.data.kml.Reader",Yr),Yr.prototype.lj=function(e){var o,s=null;if(gb(e)&&e.trim()!=""){try{var h=new DOMParser().parseFromString(e,"text/xml")}catch{this.F(ur.ERROR,z,"Error parsing KML document");return}if(h.getElementsByTagName("parsererror").length)this.F(ur.ERROR,z,"Error parsing KML document");else if((e=h.childNodes&&h.childNodes[0].nodeName==="kml"?h.childNodes[0]:void 0)&&(o=Zr(e.childNodes,"Document")[0]),o=o||e){h=new Nr;for(var d=Zr(o.childNodes,"Style"),g=Zr(o.childNodes,"StyleMap"),_=d.length;_--;)e=new Kr(d[_]),h.Ao(e);for(_=g.length;_--;)e=new Mr(g[_],h),h.Ao(e);for(this.NB=new Tr(h,this.gB),e=o.childNodes,o=e.length;o--;)d=e[o],h=s,d.nodeName==="Placemark"?(d=this.NB.create(d))&&this.Rg(d,h):d.nodeName==="Folder"&&(d={group:new T,node:d},this.Rg(d.group,h),this.Ak.push(d)),!o&&(h=this.Ak.shift())&&(e=h.node.childNodes,s=h.group,o=e.length);this.F(ur.READY)}else this.F(ur.ERROR,z,"Invalid KML document")}else this.F(ur.ERROR,z,"Unable to create objects from the empty data")},Yr.prototype.Rg=function(e,o){o?o.Y(e):(this.ae&&this.ae.rd().Y(e),this.gj.push(e),this.F(ur.VISIT,e))};function Zr(e,o){for(var s=e.length,h,d=[];s--;)h=e[s],h.nodeName===o&&d.push(h);return d}t("H.data.buildInfo",function(){return Zm("H-data","1.57.0","161a2e3",{region:"row"})}),zg.prototype.ze=da(2,function(e,o){this.root.ze(e,jb(o)?o:this.Ph)}),Dg.prototype.ze=da(1,function(e,o){var s=0,h;if(!e(this)&&o--)for(;3>=s;s++)(h=this[s])&&h.ze(e,o)});function $r(e){hc.call(this),this.fc=[];var o;e?Pa(o={},as,e):o=as,this.options=o,hc.call(this)}u($r,hc);var bs={clusters:[],noisePoints:[]},as={projection:ld,min:0,max:22,eps:32,minWeight:2};m=$r.prototype,m.ue=function(e){this.fc=e,this.od=!0},m.xc=function(e){this.fc.push(e),this.od=!0},m.Al=function(e){this.fc=this.fc.concat(e),this.od=!0},m.Dk=function(e){this.fc=this.fc.filter(function(o){return o!==e}),this.od=!0},m.disposeInternal=function(){$r.g.disposeInternal.call(this),delete this.fc},$r.prototype.disposeInternal=$r.prototype.disposeInternal,$r.prototype.Ow=ze;function cs(e,o,s,h,d,g){this.Co=o,e&&(this.parent=e,o&1?(s=e[8],d=e[5]):(s=e[7],d=e[8]),o&2?(h=e[9],g=e[6]):(h=e[4],g=e[9])),this[7]=s,this[5]=d,this[8]=(s+d)/2,this[4]=h,this[6]=g,this[9]=(h+g)/2}m=cs.prototype,m.hb=0,m.th=function(e){return this[e]||(++this.hb,this[e]=new cs(this,e))},m.removeChild=function(e){var o=e.Co;this[o]===e&&(delete this[o],delete e.parent,--this.hb)},m.ze=function(e,o){for(var s=0,h=this;h=h.parent;)++s;ds(this,e,o,s)};function ds(e,o,s,h){var d,g;if(!o(e,h)&&s--)for(++h,d=0;4>d;d++)(g=e[d])&&ds(g,o,s,h)}m.Qg=function(e){(this.entries||(this.entries=[])).push(e)},m.dj=0,m.ej=0,m.Ec=0;function es(e){this.Ph=e||10,this.Ck=this.Bk=this.Zi=this.Yi=2147483648,this.Em()}m=es.prototype,m.Em=function(){this.head=this.root=new cs(null,NaN,this.Yi-this.Bk,this.Zi-this.Ck,this.Yi+this.Bk,this.Zi+this.Ck)},m.Ll=function(){fs(this,this.root),this.Em()};function fs(e,o){var s,h;for(s=0;4>s;s++)(h=o[s])&&(fs(e,h),delete o[s]);delete o.parent,delete o.entries}m.jd=function(e){var o=this.head,s;if(e){var h=e;if(h!==o)for(o=h;h=h.parent;)(h.entries||1<h.hb)&&(o=h)}else for(;!o.entries&&2>(s=o.hb)&&s;)o=h;this.head=o},m.Yd=function(e,o,s,h){var d=this.root;if(!(e>=d[7]&&o>=d[4]&&e<=d[5]&&o<=d[6]))throw Error("Coordinates out of bounds");return this.Vb(this.root,e,o,s,this.Ph,h)},m.Vb=function(e,o,s,h,d,g){var _=e.entries;return d?e.hb?_=this.Sj(e,o,s,h,d,g):_?(_=_[0],_=e.th(+(_[1]>=e[8])|+(_[0]>=e[9])<<1),_.entries=e.entries,_.dj=e.dj,_.ej=e.ej,_.Ec=e.Ec,_.dh=e.dh,_.cj=e.cj,_.aj=e.aj,_.bj=e.bj,delete e.entries,this.jd(_),_=this.Sj(e,o,s,h,d,g)):(e.Qg(_=new gs(o,s,h,g)),this.jd(e)):(_||this.jd(e),e.Qg(_=new gs(o,s,h,g))),e.dj+=o*h,e.ej+=s*h,e.Ec+=h,e.dh===B?(e.dh=e.aj=o,e.cj=e.bj=s):(o<e.dh?e.dh=o:o>e.aj&&(e.aj=o),s<e.cj?e.cj=s:s>e.bj&&(e.bj=s)),_},m.Sj=function(e,o,s,h,d,g){return this.Vb(e.th(+(o>=e[8])|+(s>=e[9])<<1),o,s,h,d-1,g)},m.ze=function(e,o){ds(this.root,e,o===+o?o:this.Ph,0)};function gs(e,o,s,h){this[0]=o,this[1]=e,this.weight=s,this.data=h}function hs(e,o,s){this.pa=e,this.dm=o,this.de=s}t("H.clustering.fastgrid.NoisePoint",hs),hs.prototype.xa=function(){return this.Sc||(this.Sc=this.pa.Za(this.dm[1],this.dm[0],1)),this.Sc},hs.prototype.getPosition=hs.prototype.xa,hs.prototype.Wd=function(){return this.dm.weight},hs.prototype.getWeight=hs.prototype.Wd,hs.prototype.Yf=ye,hs.prototype.isCluster=hs.prototype.Yf,hs.prototype.Sd=function(){return this.de-this.pa.hh},hs.prototype.getMinZoom=hs.prototype.Sd,hs.prototype.getData=function(){return this.dm.data},hs.prototype.getData=hs.prototype.getData;function is(e,o,s,h){this.pa=e,this.tc=o,this.de=s,this.Jq=h,this.wp=Ia(this.wp,this),this.up=Ia(this.up,this)}t("H.clustering.fastgrid.Cluster",is),is.prototype.xa=function(){return this.Sc||(this.Sc=this.pa.Za(this.tc.dj,this.tc.ej,this.tc.Ec)),this.Sc},is.prototype.getPosition=is.prototype.xa,is.prototype.Wd=function(){return this.tc.Ec},is.prototype.getWeight=is.prototype.Wd,is.prototype.Yf=xe,is.prototype.isCluster=is.prototype.Yf,is.prototype.Sd=function(){return this.de?this.de-this.pa.hh:-1/0},is.prototype.getMinZoom=is.prototype.Sd,is.prototype.om=function(){return this.Jq-this.pa.hh},is.prototype.getMaxZoom=is.prototype.om,is.prototype.C=function(){return this.I||(this.I=Zf(this.pa.Za(this.tc.dh,this.tc.cj,1),this.pa.Za(this.tc.aj,this.tc.bj,1),!0)),this.I},is.prototype.getBoundingBox=is.prototype.C,is.prototype.vp=function(e){this.$t=e,this.tc.ze(this.wp,Wb)},is.prototype.forEachEntry=is.prototype.vp,is.prototype.wp=function(e,o){var s=!1,h,d;if(e.Ec>=this.pa.Av&&e!==this.tc&&e.Ec!==this.tc.Ec&&(this.$t(new is(this.pa,e,0,o)),s=!0),!s&&(h=e.entries))for(e=h.length,d=0;d<e;d++)this.$t(new hs(this.pa,h[d],o));return s},is.prototype.zj=function(e){this.hz=e,this.tc.ze(this.up,Wb)},is.prototype.forEachDataPoint=is.prototype.zj,is.prototype.up=function(e,o){var s;if(e=e.entries){var h=e.length;for(s=0;s<h;s++)this.hz(new hs(this.pa,e[s],o))}return!1};function js(e){$r.call(this,e),e=this.options,this.le=e.projection,this.hk=e.min,this.eg=e.max,this.Av=e.minWeight,this.hh=7-Ab(Eb(zb(1,e.eps))/Ob),this.vr=new es(zb(this.hk,this.eg+this.hh))}u(js,$r),m=js.prototype,m.ue=function(e){var o=0,s=e.length,h,d=new F(0,0),g=this.le,_=this.vr;for(js.g.ue.call(this,e),_.Ll();o<s;o++)g.Re(h=e[o],d).scale(4294967296).floor(),_.Yd(d.x,d.y,h.wt,h.data);this.od=!0},m.xc=function(e){js.g.xc.call(this,e),this.ue(this.fc)},m.Al=function(e){for(var o=e.length,s=js.g.xc;o--;)s.call(this,e[o]);this.ue(this.fc)},m.Dk=function(e){js.g.Dk.call(this,e),this.ue(this.fc)},m.Za=function(e,o,s,h){return this.le.Za(e/s/4294967296,o/s/4294967296,h)},m.es=function(e){if(this.od){var o={clusters:[],noisePoints:[]};ks(this,this.vr.root,0,this.eg+this.hh,-1/0,o,null),this.od=!1,e(o)}};function ks(e,o,s,h,d,g,_){var j=o.Ec,$;if(_&&(_.node.Ec!==j?(g.clusters.push(new is(e,_.node,_.depth,s-1)),_=null):d++),_||(j>=e.Av?(_={node:o,depth:s},d=s):ls(e,o,d+1,g)),o.hb&&h--)for(s++,j=0;4>j;j++)($=o[j])&&(ks(e,$,s,h,d,g,_),_=null);_&&g.clusters.push(new is(e,_.node,_.depth,e.eg+e.hh))}function ls(e,o,s,h){o=o.entries;var d;if(o){var g=o.length;for(h=h.noisePoints,d=0;d<g;d++)h.push(new hs(e,o[d],s))}else for(d=0;4>d;d++)(g=e[d])&&ls(e,g,s,h)}m.disposeInternal=function(){js.g.disposeInternal.call(this),this.vr=null},js.prototype.disposeInternal=js.prototype.disposeInternal;function ms(e,o){this.ir=e,this.de=o}t("H.clustering.grid.NoisePoint",ms),ms.prototype.xa=function(){return hd(this.ir)},ms.prototype.getPosition=ms.prototype.xa,ms.prototype.Wd=function(){return this.ir.wt},ms.prototype.getWeight=ms.prototype.Wd,ms.prototype.Yf=ye,ms.prototype.isCluster=ms.prototype.Yf,ms.prototype.Sd=function(){return this.de},ms.prototype.getMinZoom=ms.prototype.Sd,ms.prototype.getData=function(){return this.ir.data},ms.prototype.getData=ms.prototype.getData;function ns(e,o,s){this.Jq=this.de=s,this.jr=[],this.us=0,this.I=Zf(e,o,!0)}t("H.clustering.grid.Cluster",ns),ns.prototype.Pi=function(e){this.Sc||(this.Sc=hd(e)),this.us+=e.wt||1,this.jr.push(e)},ns.prototype.xa=function(){return this.Sc},ns.prototype.getPosition=ns.prototype.xa,ns.prototype.Wd=function(){return this.us},ns.prototype.getWeight=ns.prototype.Wd,ns.prototype.Yf=xe,ns.prototype.isCluster=ns.prototype.Yf,ns.prototype.Sd=function(){return this.de},ns.prototype.getMinZoom=ns.prototype.Sd,ns.prototype.om=function(){return this.Jq},ns.prototype.getMaxZoom=ns.prototype.om,ns.prototype.C=function(){return this.I},ns.prototype.getBoundingBox=ns.prototype.C,ns.prototype.vp=function(e){this.zj(e)},ns.prototype.forEachEntry=ns.prototype.vp,ns.prototype.zj=function(e){var o=this;if(!Za(e))throw new D(this.zj,0,e);this.jr.forEach(function(s){e(new ms(s,o.de+1))})},ns.prototype.forEachDataPoint=ns.prototype.zj;function os(e){$r.call(this,e)}u(os,$r),os.prototype.es=function(e){var o=this.options,s=o.min,h=o.max,d=[],g=[],_;if(this.od){for(_=this.fc;s<=h;s++){for(var j,$=void 0,_t,_e,_r,_i,_n,_s,_l,Ap=s,_h=_,_p=d,ty=g,ry=o.eps,ly=o.projection,uy=o.minWeight,py=_h.length,fy=Math.pow(2,Ap+8),my=[];_l=_h[--py];)if(!_l.Bs){for(_e=ly.Re(_l).scale(fy).floor(),_s=fy,_n=_e.x,_i=_e.y,_t=my.length;_t--;)j=my[_t],_r=j.xa(),j.zs||(j.zs=ly.Re(_r).scale(fy).floor()),_r=j.zs,_r=_r.kb(_e),_r<_s&&(_s=_r,$=j);$&&$.C().Ff(_l)||($=new ns(ly.wn({x:(_n-ry)/fy,y:(_i-ry)/fy}),ly.wn({x:(_n+ry)/fy,y:(_i+ry)/fy}),Ap),my.push($)),$.Pi(_l),$=null}for(py=my.length;py--;)if(j=my[py],_t=j.Wd(),_t<uy)for(j=j.jr,_t=j.length;_l=j[--_t];)ty.push(new ms(_l,Ap)),_l.Bs=!0;else _p.push(j)}for(s=0,h=_.length;s<h;s++)delete _[s].Bs;this.od=!1,e({clusters:d,noisePoints:g})}};function ps(e){this.na=e,this.py=11,e=document.createElement("canvas");var o=e.getContext("2d"),s=this.na,h=14*s;e.width=h,e.height=h,o.scale(s,s),o.beginPath(),o.strokeStyle="#FFFFFF",o.fillStyle="#1080DD",o.arc(7,7,6,0,2*Math.PI,!1),o.fill(),o.lineWidth=1,o.stroke(),this.LB=new um(e,{size:{w:14,h:14},anchor:{x:7,y:7}}),this.ot={},this.pt={}}t("H.clustering.theme.Circular",ps);function qs(e,o,s){var h,d=document.createElement("canvas"),g=d.getContext("2d"),_=e.na,j=o*_;return d.width=j,d.height=j,g.scale(_,_),_=o+":"+s,(h=e.ot[_])?g.putImageData(h,0,0):(o/=2,g.beginPath(),g.strokeStyle="rgba("+s+",0.2)",g.fillStyle="rgba("+s+",1)",g.arc(o,o,o/5*3,0,2*Math.PI,!1),g.fill(),g.lineWidth=o/5*4,g.stroke(),e.ot[_]=g.getImageData(0,0,j,j)),d}ps.prototype.xz=function(e){var o=e.Wd(),s=this.pt[o];if(!s){if(10>o){s=qs(this,28,"118,209,0");var h={x:11,y:18}}else 25>o?(s=qs(this,38,"255,105,0"),h={x:13,y:23}):50>o?(s=qs(this,38,"240,60,0"),h={x:13,y:23}):100>o?(s=qs(this,38,"181,0,21"),h={x:13,y:23}):1e3>o?(s=qs(this,48,"181,0,21"),h={x:15,y:28}):(s=qs(this,66,"181,0,21"),h={x:20,y:38});var d=s.getContext("2d");d.fillStyle="#FFFFFF",d.font="bold "+this.py+"px Arial",d.fillText(String(o),h.x,h.y),h=s.width/this.na,s=new um(s,{size:{w:h,h},anchor:{x:h/2,y:h/2}}),this.pt[o]=s}return o=new $m(e.xa(),{icon:s,min:e.Sd(),max:e.om()}),o.setData(e),o},ps.prototype.getClusterPresentation=ps.prototype.xz,ps.prototype.iA=function(e){var o=new $m(e.xa(),{icon:this.LB,min:e.Sd()});return o.setData(e),o},ps.prototype.getNoisePresentation=ps.prototype.iA;function rs(e){if($r.call(this,e),e=this.options,e.projection!==ld)throw new D(rs,0,"Other projection than mercator not supported yet");this.le=e.projection,this.lp=e.eps,this.GB=e.minWeight,this.dw=new md(this.le),new Th().registerProcessor("cluster","H.clustering.dynamicgrid.worker"),this.gg=A(this.gg,this),this.Pq=A(this.Pq,this)}u(rs,$r),rs.prototype.Ow=function(e,o){this.Jy=e,this.Ky=Bb(o)},rs.prototype.es=function(e,o){var s=this.Lg,h=this.Jy,d=this.Ky||0,g=!s||!(s.zoom===d&&s.Si.da(h));if(h&&(this.od||g)){if(s&&3>s.state&&s.cancel(),this.od=!1,s=this.lp,s>=128*Gb(2,d))var _=ss;else{g=this.dw,g.Va(d);var j=g.Gb(h.Lc());_=g.Gb(h.Jc()),j.y-=s,_.y+=s,j=g.sk(j);var $=g.sk(_);_=new J(j.lat,j.lng,$.lat,$.lng),s=g.Za(s,0).lng+180,_=_.ce(j.lat,j.lng-s,$.lat,j.lng).ce(j.lat,$.lng,$.lat,$.lng+s)}for(s=_,j=this.fc,_=[],g=j.length;g--;)s.Ff(j[g])&&_.push(j[g]);0<_.length?(this.Lg=new ts(h,d,_,this.lp,this.GB,this.le!==ld,e,o),this.Lg.then(this.gg,this.Pq)):e(bs)}},rs.prototype.gg=function(e){Ba(e)||(e=new x.Uint32Array(e));for(var o=this.Lg,s=o.dC,h=0,d=e[h++],g=Array(d),_=0,j=[],$=e.length,_t=this.Lg.My,_e=this.Lg.zoom;d--;)g[_++]=new ms(_t[e[h++]],_e);for(;h<$;){d=e[h++],_=_t[e[h]];var _r=this.dw,_i=this.lp;_r.Va(this.Lg.zoom);var _n=_r.Gb(_);for(_=_r.Za(_n.x-_i,_n.y-_i),_r=_r.Za(_n.x+_i,_n.y+_i),_=new J(_.lat,_.lng,_r.lat,_r.lng),_=new ns(_.Lc(),_.Jc(),_e);d--;)_.Pi(_t[e[h++]]);j.push(_)}s.call(o,{clusters:j,noisePoints:g})},rs.prototype.Pq=function(e){gb(e)&&this.Lg.UB(e)};var ss=new J(90,-180,-90,180);rs.prototype.disposeInternal=function(){rs.g.disposeInternal.call(this)},rs.prototype.disposeInternal=rs.prototype.disposeInternal;function ts(e,o,s,h,d,g,_,j){this.Si=e,this.zoom=o,this.My=s,this.dC=_,this.UB=j,e=s.length,_=3*e,j=new(x.Float64Array||Array)(_);for(var $;e--;)$=s[e],j[--_]=$.lat,j[--_]=$.lng,j[--_]=$.wt;fe.call(this,"cluster",{message:[j,h,d,o,g]},void 0)}u(ts,Vh),t("H.clustering.DataPoint",function(e,o,s,h){this.lat=e,this.lng=o,this.wt=s===+s?s:1,this.data=h});function us(e,o){o=o||{};var s={},h=o.min||0,d=zb(h,o.max||22);switch(h={min:h,max:d},us.g.constructor.call(this,h),this.na=o.pixelRatio||le(),Pa(s,as,h,o.clusteringOptions||{}),s.minWeight=zb(as.minWeight,s.minWeight),s.strategy){case vs.DYNAMICGRID:if(s.projection!==ld)throw new D(us,1,"Unsupported projection");this.pa=new rs(s);break;case vs.GRID:this.pa=new os(s);break;default:this.pa=new js(s)}this.pa.ue(e),this.fl=o.theme||new ps(this.na),this.No=A(this.No,this),this.gg=A(this.gg,this),ws(this)}u(us,Q),t("H.clustering.Provider",us),us.prototype.disposeInternal=function(){us.g.disposeInternal.call(this),this.Ag.ia(),this.pa.l(),delete this.pa,delete this.Qm,delete this.fl,x.clearTimeout(this.hp)};var vs={FASTGRID:0,GRID:1,DYNAMICGRID:2};us.Strategy=vs,us.prototype.dy=150,us.prototype.No=function(){this.dispatchEvent("start"),this.pa.es(this.gg,ze)};function ws(e,o,s){e.hp&&x.clearTimeout(e.hp),o&&e.pa.Ow(o,s),e.hp=x.setTimeout(e.No,e.dy)}us.prototype.gg=function(e){this.Qm=e,xs(this),this.dispatchEvent("end")},us.prototype.ue=function(e){this.pa.ue(e),ws(this)},us.prototype.setDataPoints=us.prototype.ue,us.prototype.xc=function(e){this.pa.xc(e),ws(this)},us.prototype.addDataPoint=us.prototype.xc,us.prototype.Al=function(e){this.pa.Al(e),ws(this)},us.prototype.addDataPoints=us.prototype.Al,us.prototype.Dk=function(e){this.pa.Dk(e),ws(this)},us.prototype.removeDataPoint=us.prototype.Dk,us.prototype.EA=function(){return this.fl},us.prototype.getTheme=us.prototype.EA,us.prototype.ZC=function(e){this.fl=e,this.Qm&&(this.Ag.ia(),xs(this))},us.prototype.setTheme=us.prototype.ZC;function xs(e){var o=e.Qm.clusters,s=e.Qm.noisePoints,h=o.length,d=s.length,g=0<h+d;for(e.Ag.ia();d--;){var _=s[d];e.Ag.Y(e.fl.getNoisePresentation(_))}for(;h--;)s=o[h],e.Ag.Y(e.fl.getClusterPresentation(s));g&&e.jb()}us.prototype.Tc=function(){return!0},us.prototype.providesDomMarkers=us.prototype.Tc,us.prototype.Uc=function(){return!0},us.prototype.providesMarkers=us.prototype.Uc,us.prototype.me=function(){return!0},us.prototype.providesSpatials=us.prototype.me,us.prototype.xk=function(e,o){ws(this,e,o)},us.prototype.preprocessData=us.prototype.xk,t("H.clustering.buildInfo",function(){return Zm("H-clustering","1.57.0","161a2e3",{region:"row"})});function ys(e,o){t:{for(var s=e.length,h=typeof e=="string"?e.split(""):e,d=0;d<s;d++)if(d in h&&o.call(void 0,h[d],d,e)){o=d;break t}o=-1}return 0>o?null:typeof e=="string"?e.charAt(o):e[o]}var zs={};function As(e){var o=e.ownerDocument,s=o.documentElement;o=o.defaultView;var h=e.getBoundingClientRect();return e=h.left,h=h.top,isNaN(o.pageXOffset)?(e+=s.scrollLeft,h+=s.scrollTop):(e+=o.pageXOffset,h+=o.pageYOffset),new F(e,h)}function Bs(e,o,s){o=jb(o)?o+"px":o,s=jb(s)?s+"px":s,e.style[Hh("transform")]="translate("+o+","+s+")"}var Cs,Ds=navigator.userAgent,Es=-1<Ds.indexOf("Android")&&-1<Ds.indexOf("Mozilla/5.0")&&-1<Ds.indexOf("AppleWebKit"),Fs=/AppleWebKit\/([\d.]+)/,Gs=Fs.exec(Ds)===null?null:parseFloat(Fs.exec(Ds)[1]);Cs=Es&&Gs!==null&&537>Gs;var Hs=globalThis,Is=document.createElement("T");function Js(){this.Zw=this.Gt()}Js.prototype.Gt=function(){var e=navigator,o=[];return e&&(e.msPointerEnabled?o.push(Ks):e.pointerEnabled&&o.push(Ls)),1>o.length&&("TouchEvent"in Hs&&o.push(Ms),o.push(Ns)),o.push(Os),o},Js.prototype.detectEventSets=Js.prototype.Gt,Js.prototype.addEventListener=function(e,o,s,h){for(var d=this.Zw,g,_=d.length,j=!1;_--;)(g=d[_][o])&&(j=!0,e.addEventListener(g,s,h||!1));j||e.addEventListener(o,s,h||!1)},Js.prototype.removeEventListener=function(e,o,s,h){for(var d=this.Zw,g,_=d.length,j=!1;_--;)(g=d[_][o])&&(j=!0,e.removeEventListener(g,s,h||!1));j||e.removeEventListener(o,s,h||!1)};var Ls={start:"pointerdown",end:"pointerup",move:"pointermove",cancel:"pointercancel",over:"pointerover",out:"pointerout",hover:"pointerhover"},Ks={start:"MSPointerDown",end:"MSPointerUp",move:"MSPointerMove",cancel:"MSPointerCancel",over:"MSPointerOver",out:"MSPointerOut",hover:"MSPointerHover"},Ms={start:"touchstart",end:"touchend",move:"touchmove",cancel:"touchcancel"},Ns={start:"mousedown",end:"mouseup",move:"mousemove",over:"mouseover",out:"mouseout",hover:"mousehover"},Os={start:"keydown",end:"keyup"};function Ps(e){return!(e instanceof KeyboardEvent)||e.code==="Enter"}function Qs(e,o,s,h){return e=e.createElement(o),s&&(e.className=s),h&&(e.innerHTML=h),e}function Rs(e,o){for(var s=1,h=arguments.length;s<h;s++)e.appendChild(arguments[s])}var Ss=new Js;function Ts(e,o,s){Ss.addEventListener(e,o,s,void 0)}function Us(e,o,s){Ss.removeEventListener(e,o,s,void 0)}function Y(e,o){K.call(this),this.Qa=e||"div",this.Le=o?o.split(" "):[],this.ub=!1,this.Le.push("H_el")}u(Y,K),t("H.ui.base.Element",Y),Y.prototype.L=function(e){if(!e)throw Error("Wrong document object");return this.G=Qs(e,this.Qa,this.Le.join(" ")),this.renderInternal(this.G,e),this.va(this.ub,!0),this.Fd(this.yx),this.Zb(this.Kd),this.tf(this.kx),this.G},Y.prototype.subscribe=function(){},Y.prototype.unsubscribe=function(){},Y.prototype.N=function(){},Y.prototype.renderInternal=Y.prototype.N,Y.prototype.mq=function(){return this.ub},Y.prototype.isDisabled=Y.prototype.mq,Y.prototype.va=function(e,o){return e=!!e,(e!==this.ub||o)&&((this.ub=e)?this.Ga("H_disabled"):this.Bb("H_disabled")),this},Y.prototype.setDisabled=Y.prototype.va,Y.prototype.ep=null,Y.prototype.getData=function(){return this.ep},Y.prototype.getData=Y.prototype.getData,Y.prototype.setData=function(e){this.ep=e},Y.prototype.setData=Y.prototype.setData,Y.prototype.Fd=function(e){var o=this.A();this.yx=e,o&&(e?(o.setAttribute("title",e),o.setAttribute("aria-label",e)):(o.removeAttribute("title"),o.removeAttribute("aria-label")))},Y.prototype.setTooltip=Y.prototype.Fd,Y.prototype.G=null,Y.prototype.A=function(){return this.G},Y.prototype.getElement=Y.prototype.A,Y.prototype.Kd=!0,Y.prototype.Zb=function(e){var o=this.A();this.Kd=e,o&&(o.style.display=e?"":"none")},Y.prototype.setVisibility=Y.prototype.Zb,Y.prototype.Vd=function(){return this.Kd},Y.prototype.getVisibility=Y.prototype.Vd,Y.prototype.kx=-1,Y.prototype.tf=function(e){this.kx=e;var o=this.A();o&&(o.tabIndex=e)},Y.prototype.setTabIndex=Y.prototype.tf,Y.prototype.Ga=function(e){var o=this.A();return 0>this.Le.indexOf(e)&&this.Le.push(e),o&&(o.className=this.Le.join(" ")),this},Y.prototype.addClass=Y.prototype.Ga,Y.prototype.Bb=function(e){e=this.Le.indexOf(e);var o=this.A();return-1<e&&this.Le.splice(e,1),o&&(o.className=this.Le.join(" ")),this},Y.prototype.removeClass=Y.prototype.Bb;function Vs(e){(e=e.A())&&e.parentNode&&e.parentNode.removeChild(e)}Y.prototype.disposeInternal=function(){Y.g.disposeInternal.call(this),Vs(this),this.ep=this.G=null,delete this.yx};function Ws(e){e=e||{},Y.call(this,"div","H_btn"),this.we(e.label||" "),this.Fd(e.tooltip||""),this.setData(e.data),this.va(!!e.disabled),this.tf(0),this.F(Xs.UP,!0),e.onStateChange&&this.addEventListener("statechange",e.onStateChange),this.cn=A(this.cn,this),this.Vh=A(this.Vh,this)}u(Ws,Y),t("H.ui.base.Button",Ws),Ws.prototype.va=function(e,o){return e&&this.Bb("H_active"),Ws.g.va.call(this,e,o)},Ws.prototype.setDisabled=Ws.prototype.va,Ws.prototype.N=function(e){Ts(e,"start",this.cn),Ts(e,"end",this.Vh),Ts(e,"out",this.Vh),this.we(this.Wb,!0)},Ws.prototype.renderInternal=Ws.prototype.N,Ws.prototype.getState=function(){return this.o},Ws.prototype.getState=Ws.prototype.getState,Ws.prototype.F=function(e,o){return e!==this.o&&(this.o=e,e===Xs.DOWN?this.Ga("H_active"):this.Bb("H_active"),o||this.dispatchEvent("statechange")),this},Ws.prototype.setState=Ws.prototype.F,Ws.prototype.Gp=function(){return this.Wb},Ws.prototype.getLabel=Ws.prototype.Gp,Ws.prototype.we=function(e,o){return(o||e!==this.Wb)&&(this.Wb=e,(o=this.A())&&(o.innerHTML=e)),this},Ws.prototype.setLabel=Ws.prototype.we,Ws.prototype.cn=function(e){!this.ub&&Ps(e)&&(this.F(Xs.DOWN),e.preventDefault())},Ws.prototype.Vh=function(e){!this.ub&&Ps(e)&&(this.F(Xs.UP),e.preventDefault())},Ws.prototype.disposeInternal=function(){var e=this.A();e&&(Us(e,"start",this.cn),Us(e,"end",this.Vh),Us(e,"out",this.Vh)),Y.prototype.disposeInternal.call(this)};var Xs={UP:"up",DOWN:"down"};Ws.State=Xs;function Ys(e){Ws.call(this,e),this.TB=function(o){Ps(o)&&o.preventDefault()},this.ie=A(function(o){!this.ub&&Ps(o)&&(this.toggleState(),o.preventDefault())},this)}u(Ys,Ws),t("H.ui.base.PushButton",Ys),Ys.prototype.N=function(e){Ts(e,"start",this.ie),Ts(e,"end",this.TB),this.we(this.Wb,!0)},Ys.prototype.renderInternal=Ys.prototype.N,Ys.prototype.vx=function(){var e=Xs.DOWN;return this.F(this.getState()===e?Xs.UP:e),this},Ys.prototype.toggleState=Ys.prototype.vx,Ys.prototype.disposeInternal=function(){var e=this.A();e&&Us(e,"start",this.ie),Ws.prototype.disposeInternal.call(this)};function Zs(e,o,s){Y.call(this,e,o),this.dc=s?[].concat(s):[]}u(Zs,Y),t("H.ui.base.Container",Zs),Zs.prototype.va=function(e,o){var s=this.dc?this.dc.length:0;for(Y.prototype.va.call(this,e,o);s--;)this.dc[s].va(e,o);return this},Zs.prototype.setDisabled=Zs.prototype.va,Zs.prototype.Ra=function(e){var o=this.A();return this.dc.push(e),o&&(e.L(o.ownerDocument),o.appendChild(e.A())),this},Zs.prototype.addChild=Zs.prototype.Ra,Zs.prototype.Dj=function(){return[].concat(this.dc)},Zs.prototype.getChildren=Zs.prototype.Dj,Zs.prototype.removeChild=function(e){var o=this.dc.indexOf(e),s=this.A();0<=o&&(this.dc.splice(o,1),s&&s.removeChild(e.A()))},Zs.prototype.removeChild=Zs.prototype.removeChild,Zs.prototype.ia=function(){var e=this.A();e&&this.dc.forEach(function(o){e.removeChild(o.A())}),this.dc=[]},Zs.prototype.N=function(e,o){for(var s=0,h=this.dc.length;s<h;s++)e.appendChild(this.dc[s].L(o))},Zs.prototype.renderInternal=Zs.prototype.N,Zs.prototype.disposeInternal=function(){this.ia(),this.dc.forEach(this.Xy,this),Y.prototype.disposeInternal.call(this)},Zs.prototype.Xy=function(e){e.l()};function $s(e){e=e||{},Zs.call(this,"div","H_rdo"),this.ms=new Y("div","H_rdo_title"),this.Ti=new Zs("div","H_rdo_buttons"),this.Ra(this.ms),this.Ra(this.Ti),this.Iv=A(function(o){o.target.getState()===Xs.DOWN?(this.Mw(o.target,!0),this.dispatchEvent(at)):o.target.F(Xs.DOWN,!0)},this),this.addEventListener("statechange",this.Iv),this.bs(e.title||""),e.onActiveButtonChange&&this.addEventListener(at,e.onActiveButtonChange),e.buttonsOptions&&e.buttonsOptions.forEach(function(o){this.yo(new Ys(o))},this)}u($s,Zs),t("H.ui.base.RadioGroup",$s);var at="activebuttonchange";$s.prototype.N=function(e,o){Zs.prototype.renderInternal.call(this,e,o),this.bs(this.io,!0)},$s.prototype.renderInternal=$s.prototype.N,$s.prototype.ia=function(){this.Ti.ia()},$s.prototype.bs=function(e,o){return(e!==this.io||o)&&(this.io=e,this.ms.A()&&(this.ms.A().innerHTML=this.io)),this},$s.prototype.setTitle=$s.prototype.bs,$s.prototype.GA=function(){return this.io},$s.prototype.getTitle=$s.prototype.GA,$s.prototype.yo=function(e){if(!(e instanceof Ys))throw Error("PushButton expected");return e.ea(this),this.Ti.Ra(e),this},$s.prototype.addButton=$s.prototype.yo,$s.prototype.xC=function(e){return this.Ti.removeChild(e),e.ea(null),this},$s.prototype.removeButton=$s.prototype.xC,$s.prototype.Cj=function(){return this.Ti.Dj()},$s.prototype.getButtons=$s.prototype.Cj,$s.prototype.Mw=function(e,o){for(var s=this.Cj(),h=s.length;h--;)s[h].F(s[h]===e?Xs.DOWN:Xs.UP,o)},$s.prototype.setActiveButton=$s.prototype.Mw,$s.prototype.disposeInternal=function(){this.removeEventListener("statechange",this.Iv),this.ia(),Zs.prototype.disposeInternal.call(this)};var bt={TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right",LEFT_TOP:"left-top",LEFT_MIDDLE:"left-middle",LEFT_BOTTOM:"left-bottom",RIGHT_TOP:"right-top",RIGHT_MIDDLE:"right-middle",RIGHT_BOTTOM:"right-bottom",BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right"};t("H.ui.LayoutAlignment",bt);function ct(){Zs.call(this,"div","H_ctl"),this.map=null,this.Ee="top-left"}u(ct,Zs),t("H.ui.Control",ct),ct.prototype.Pa=function(e){this.map=e},ct.prototype.L=function(e){return Zs.prototype.L.call(this,e)},ct.prototype.N=function(e,o){Zs.prototype.renderInternal.call(this,e,o),this.Yc(this.Ee)},ct.prototype.renderInternal=ct.prototype.N,ct.prototype.qk=function(){},ct.prototype.onUnitSystemChange=ct.prototype.qk,ct.prototype.lc=function(){return this.map},ct.prototype.getMap=ct.prototype.lc,ct.prototype.la=function(){return this.uB},ct.prototype.getLocalization=ct.prototype.la,ct.prototype.pz=function(){return this.Ee},ct.prototype.getAlignment=ct.prototype.pz,ct.prototype.Yc=function(e){return typeof e=="string"&&bt[e.replace("-","_").toUpperCase()]===e&&(this.Ee=e,this.dispatchEvent("alignmentchange")),this},ct.prototype.setAlignment=ct.prototype.Yc;function dt(){this.o=et.CLOSED,Zs.call(this,"div","H_overlay")}u(dt,Zs),t("H.ui.base.OverlayPanel",dt),dt.prototype.F=function(e,o){return(e!==this.o||o)&&(this.o=e,e===et.OPEN?this.Ga("H_open"):this.Bb("H_open")),this},dt.prototype.setState=dt.prototype.F,dt.prototype.getState=function(){return this.o},dt.prototype.getState=dt.prototype.getState,dt.prototype.fw=function(e){var o=e.Ee;e=e.A();var s=this.A(),h=s.style;if(this.Bb("H_top"),this.Bb("H_middle"),this.Bb("H_bottom"),this.Bb("H_left"),this.Bb("H_center"),this.Bb("H_right"),h.bottom=h.top=h.left=h.right=h.margin="",/top/g.test(o)){this.Ga("H_top"),h.top="0",h.margin="0 12px";var d=-1}else/bottom/g.test(o)?(this.Ga("H_bottom"),h.bottom="0",h.margin="0 12px",d=1):(this.Ga("H_middle"),h.top="50%",h.margin="0 12px",h.marginTop=-Math.round(.5*s.offsetHeight)+"px",d=0);/left/g.test(o)?(this.Ga("H_left"),h.left=e.offsetWidth+"px",h.marginLeft="12px"):/right/g.test(o)?(this.Ga("H_right"),h.right=e.offsetWidth+"px",h.marginRight="12px"):(this.Ga("H_center"),h.left="50%",0>d?(h.top=e.offsetHeight+"px",h.marginTop="12px"):0<d&&(h.bottom=e.offsetHeight+"px",h.marginBottom="12px"),h.marginLeft=-Math.round(.5*s.offsetWidth)+"px",e.appendChild(s))},dt.prototype.pointToControl=dt.prototype.fw;var et={OPEN:"open",CLOSED:"closed"};dt.State=et;function ft(e){C(e,rd,ft,1),Y.call(this,"div","H_context_menu_item"),this.Kb=e,this.lk=A(this.lk,this),this.Ce=A(this.Ce,this),this.Kb.addEventListener("update",this.Ce)}u(ft,Y),t("H.ui.context.Item",ft),ft.prototype.lk=function(e){var o=this.Kb,s=o.callback;s&&!o.isDisabled()&&(this.dispatchEvent("click"),s(e))},ft.prototype.N=function(){var e=this,o=this.A();Ts(o,"click",this.lk),Ts(o,"keyup",function(s){s.code.code==="Enter"&&e.lk(s)}),this.tf(-1),this.Ce()},ft.prototype.renderInternal=ft.prototype.N,ft.prototype.Ce=function(){var e=this.A(),o=this.Kb;o.callback?this.Ga("H_clickable"):this.Bb("H_clickable"),o.isDisabled()?this.Ga("H_disabled"):this.Bb("H_disabled"),o=o.getLabel(),Is.textContent=o,e.innerHTML=Is.innerHTML.split(`
`).join("<br/>")},ft.prototype.disposeInternal=function(){Y.prototype.disposeInternal.call(this),this.Kb.removeEventListener("update",this.Ce)};var gt={};gt=function(e,o,s){hc.call(this),this.qh=-1,this.G=e,this.Nm=o,this.Lv=s,this.ie=A(this.ie,this),e.focus(),Ts(e,"keydown",this.ie)},u(gt,hc),gt.prototype.disposeInternal=function(){this.qh=-1,this.Ex(),gt.g.disposeInternal.call(this),Us(this.G,"keydown",this.ie);var e=this.Lv;this.G=this.Nm=this.Lv=null,e()},gt.prototype.ie=function(e){if(e instanceof KeyboardEvent){var o=this.Nm.length-1,s=/^Arrow(Down|Up)$/.exec(e.code);s?(e={Up:-1,Down:1}[s[1]])&&(this.qh=0>this.qh&&0>e?o:ac(this.qh+e,0,o),this.Ex()):e.code==="Enter"?(o=this.Nm[this.qh],o instanceof Ws?(o.Jb()instanceof $s?o.F(Xs.DOWN):o.vx(),this.l()):o instanceof ft&&(o.lk(),this.l())):e.code==="Escape"&&this.l()}},gt.prototype.Ex=function(){var e=this;this.Nm.forEach(function(o,s){s===e.qh?o.Ga("H_focused"):o.Bb("H_focused")})};function ht(e){e=e||{},ct.call(this),this.be=new dt,this.se=this.se.bind(this),this.Dc=this.Dc.bind(this),this.Pc=this.Pc.bind(this),this.um=this.um.bind(this),this.Yc(e.alignment||"bottom-right"),it(this,e.baseLayers,e.layers)}u(ht,ct),t("H.ui.MapSettingsControl",ht);function jt(e,o){var s=[];return e.concat(o).forEach(function(h){s=s.concat(h.layer)}),s}function kt(e,o,s){var h=e.lc();if(h){e=jt(e.Ge,e.$f);var d=jt(o,s);e.forEach(function(g){d.includes(g)||h.hi(g)})}}function it(e,o,s){kt(e,o,s),e.vq=NaN,e.Ge=fb(o)?o:[],e.$f=fb(s)?s:[],e.Af&&(e.Af.ia(),e.ck.ia(),lt(e))}ht.prototype.subscribe=function(){var e=this.lc();if(e){var o=this.Jb();o&&(o=o.A())&&Jc(o,"pointerdown",this.Pc),Jc(e,"pointerdown",this.Pc),e=e.O,Jc(e,"add",this.se),Jc(e,"remove",this.se),Jc(e,"set",this.se)}},ht.prototype.Pc=function(e){this.be.getState()===et.OPEN&&(e.currentTarget!==this.lc()&&this.be.A().contains(e.target)||this.Dc())},ht.prototype.unsubscribe=function(){var e=this.lc();if(e){var o=this.Jb();o&&(o=o.A())&&Sc(o,"pointerdown",this.Pc),Sc(e,"pointerdown",this.Pc),e=e.O,Sc(e,"add",this.se),Sc(e,"remove",this.se),Sc(e,"set",this.se)}},ht.prototype.N=function(e,o){var s=this.la().translate("layers.choose");ct.prototype.renderInternal.call(this,e,o),this.subscribe(),this.sc=new Ys({tooltip:s,label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><path fill-rule="evenodd" d="M6.7,14.6 L4.5,16 L12,20.6 L19.5,16 L17.3,14.6 L19.1,13.5 L23,16 L12,23 L1,16 L4.9,13.5 L6.7,14.6 Z M12,2 L23,9 L12,16 L1,9 L12,2 Z"></path></svg>',onStateChange:A(function(d){var g=this;d.target.getState()===Xs.DOWN?(this.be.F(et.OPEN),this.be.fw(this),this.Yj=new gt(this.A().ownerDocument.body,this.Af.Cj().concat(this.ck.Dj()),function(){g.sc.F(Xs.UP),g.sc.A().blur()})):x.setTimeout(function(){g.be.F(et.CLOSED),g.Yj.l()})},this)}),this.Af=new $s({title:s,onActiveButtonChange:(function(){var d=this.vq;t:{for(var g=this.Af.Cj(),_=g.length;_--;)if(g[_].getState()===Xs.DOWN){g=g[_];break t}g=null}if(g=g.getData(),g=this.Ge[g].layer,_=fb(g),this.map.Cg(_?g[0]:g),(d=this.Ge[d])&&(d=d.layer,fb(d)))for(var j=d.length;1<j--;)this.map.hi(d[j]);if(_)for(d=g.length;1<d--;)this.map.Bl(g[d],1);mt(this,g),this.um(),this.Dc()}).bind(this)}),this.ck=new Zs("div","H_grp"),this.Au=new Y("div","H_separator"),this.Ra(this.sc),this.Ra(this.be),this.be.Ra(this.Af),this.be.Ra(this.Au),this.be.Ra(this.ck),lt(this);var h=this;Ts(this.sc.A(),"focus",function(){h.sc.F(Xs.DOWN)}),Ts(this.sc.A(),"blur",function(){h.Dc()})},ht.prototype.renderInternal=ht.prototype.N;function mt(e,o){if(e.map.Ba.type===Wm){var s=H.map.render.harp.Style;o=[].concat(o);for(var h=0;!g&&h<o.length;h++){var d=o[h].D;if(d.Vc()&&d.J){d=d.J();var g=d.getConfig()||d.getUrl()}}if(g){var _=function(j){j=j.D,j.Vc()&&j.J&&j.J()instanceof s&&j.Cb(new s(g))};e.$f.forEach(function(j){j=j.layer,fb(j)?j.forEach(_):j&&_(j)})}}}function lt(e){var o=e.la();e.Ge.forEach(function(s,h){var d=s.layer;s=new Ys({label:nt(o,s.label),data:h,disabled:!d||fb(d)&&!d.length}),s.tf(-1),this.Af.yo(s)},e),e.$f.forEach(function(s,h){var d=s.layer;s=new Ys({label:nt(o,s.label),onStateChange:this.YB.bind(this,s.layer),data:h,disabled:!d||fb(d)&&!d.length}),s.tf(-1),this.ck.Ra(s)},e),e.Au.Zb(!(!e.$f.length||!e.Ge.length)),x.setTimeout((function(){this.map&&(this.se(),this.sc.va(!(this.Ge&&this.Ge.length||this.$f&&this.$f.length)))}).bind(e))}ht.prototype.se=function(){var e=this.map.oa,o=this.map.O;this.vq=NaN,this.Ge.forEach(function(s,h){s=s.layer,s=e===(fb(s)?s[0]:s),this.Af.Cj()[h].F(Xs[s?"DOWN":"UP"],!0),s&&(this.vq=h)},this),this.$f.forEach(function(s,h){s=s.layer;var d=fb(s);h=this.ck.Dj()[h],!s||d&&!s.length?h.va(!0):h.F(Xs[o.indexOf(d?s[0]:s)!==-1?"DOWN":"UP"],!0)},this)},ht.prototype.YB=function(e,o){e=fb(e)?e:[e],o=o.target.getState()===Xs.DOWN;for(var s=0;s<e.length;s++)o?this.map.Bl(e[s]):this.map.hi(e[s]);this.um(),this.Dc()},ht.prototype.um=function(){var e=ot(this);e&&(e.vo.D.J().fk(e.D.J().Rd()),this.map.hi(e),e.l(),delete e.vo),pt(this)&&qt(this,this.map.oa)};function qt(e,o){var s=window.H.service&&window.H.service.omv.Provider,h=o.D;if(s&&o.D instanceof s&&h.J().vj){var d=h.J(),g=(function(){var _=rt.ground.filter(function(_t){return!!d.Op("layers."+_t)}),j=rt.water.filter(function(_t){return!!d.Op("layers."+_t)});if(_.concat(j).length){var $={};gf($,d.vj(_)),gf($,d.vj(j,!1,!0)),delete $.global,_=new Bf($,d.Ic()),_=h.$.md(_),_.vo=o,this.map.Bl(_)}d.removeEventListener(ff.CHANGE,g)}).bind(e);d.getState()!==df.READY?d.addEventListener(ff.CHANGE,g):g()}}function ot(e){return ys(e.map.O.Sa(),function(o){return!!o.vo})}function pt(e){e=e.map.O.Sa();var o=window.H.service&&window.H.service.traffic.flow.Provider;return!!o&&e.some(function(s){return s.D instanceof o})}var rt={water:["water.water-labels"],ground:"road_labels continent_label island_label roads.shields roads.directions truck-restriction.signs places landuse.label".split(" ")};function nt(e,o){return/^layers?/.test(o)&&e.xm(o)?e.translate(o):o}ht.prototype.Dc=function(){this.sc.F(Xs.UP),this.sc.A().blur()},ht.prototype.disposeInternal=function(){ht.g.disposeInternal.call(this),this.unsubscribe()};var st={btn:'<svg class="H_icon" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><g fill-rule="evenodd"><g transform="translate(3 2)"><path d="m18 13v7h-18v-7h2v5h2v-2h2v2h2v-3h2v3h2v-2h2v2h2v-5z"></path><path d="m2.3.3c.7 0 1.3.1 1.8.4s.9.6 1.1 1 .4.9.4 1.4c0 .5-.1 1-.3 1.4s-.57 1-1 1.6-1.3 1.3-2.3 2.2h3.9l-.2 1.7h-6.16v-1.6c1.1-1.1 2-2 2.5-2.6s.9-1 1-1.4.3-.8.3-1.2c0-.4-.1-.7-.3-.9s-.5-.3-.9-.3c-.3 0-.6 0-.9.2s-.5.4-.8.7l-1.3-1c.4-.5.9-.9 1.4-1.2s1.2-.4 1.8-.4zm14.4 9.7h-2.3l-.2-3.8c 0-.9-.1-1.7-.1-2.4 0-.5 0-1 0-1.5l-1.5 6.7h-2.2l-1.6-6.7c.1.8.1 1.6.1 2.3 0 .5 0 1.1 0 1.7l-.2 3.8h-2.2l.7-9.7h2.9l1.5 6.6 1.4-6.6h2.9z"></path></g></g></svg>',point:'<svg height="22" viewBox="0 0 12 12" width="22" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="m6 12c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6z" fill="#fff"></path><path d="m6 10c2.2 0 4-1.8 4-4s-1.8-4-4-4-4 1.8-4 4 1.8 4 4 4z" fill="#2ed5c9" stroke="#272c36" stroke-width="2"></path></g></svg>'};function tt(e,o,s){Pi.call(this,e,{icon:ut,visibility:s}),vt(this,o)}u(tt,Pi);function vt(e,o){e.iB=o,e.G&&(e.G.textContent=o)}var ut=new Ni(Qs(Hs.document,"span","H_dm_label"),{onAttach:function(e,o,s){s.G=e,vt(s,s.iB)},onDetach:function(e,o,s){delete s.G}});function wt(e,o){K.call(this),this.Me=e,this.Wb=new tt(this.vD,""),o.push(this.Wb),this.td=new T({objects:o,data:this}),this.$n=this.$n.bind(this)}u(wt,K),m=wt.prototype,m.Ze=!1,m.vD={lat:0,lng:0},m.we=function(e,o){vt(this.Wb,e),this.Wb.X(o)},m.Sk=function(e){(this.Kd=e)?this.$n():(this.kl&&x.clearTimeout(this.kl),this.kl=x.setTimeout(this.$n,100))},m.kl=0,m.$n=function(){this.Wb.Zb(this.Kd)};function xt(e,o){o&&(e.nextSibling=o,o.previousSibling=e)}function yt(e,o,s,h){var d=new M,g=[];xt(e,this),xt(this,o),d.sg(e.xa()),d.sg(o.xa()),this.Oh=new mm(d,{style:s.Nh}),this.xu=new mm(d,{style:{strokeColor:"transparent",lineWidth:Math.min(100,this.Oh.J().lineWidth+2*(h||5))}}),s.outlineStyle&&(this.cr=new mm(d,{style:s.outlineStyle}),g.push(this.cr)),g.push(this.Oh,this.xu),wt.call(this,s,g),this.dv=this.cv=-1,e=this.td,e.addEventListener("pointermove",this.he,!0,this),e.addEventListener("pointerleave",this.Wq,!0,this)}u(yt,wt),yt.prototype.Ij=function(){var e=this.Oh.V();return e.wj(0).kb(e.wj(1))};function zt(e,o,s){var h=e.Oh.V();h.Yk(3*+s,3,[o.lat,o.lng,0]),e.cr&&e.cr.X(h),e.xu.X(h),e.Oh.X(h)}yt.prototype.he=function(e){var o=e.currentPointer;e=this.previousSibling.xa();var s=this.nextSibling.xa(),h=this.Me.ex,d=o.viewportX;o=o.viewportY,(this.cv!==d||this.dv!==o)&&(this.cv=d,this.dv=o,h.X(this.Me.hA(e,s,{x:d,y:o})),h.Zb(!0))},yt.prototype.Wq=function(){this.Me.ex.Zb()},yt.prototype.Nr=function(){this.we(this.Me.Jt(this.Ij()),this.Oh.C().wb())};function At(e,o,s){s=o.Jj(s||0),this.dg=new $m(e,{icon:s,zIndex:0}),this.dg.draggable=!0,wt.call(this,o,[this.dg]),e=this.td,e.addEventListener("dragstart",this.Bd,!0,this),e.addEventListener("drag",this.hg,!0,this),e.addEventListener("dragend",this.df,!0,this)}u(At,wt),m=At.prototype,m.kh=0,m.j={zf:"change"},m.Ij=function(){return this.kh},m.xa=function(){return this.dg.V()};function Bt(e){var o=0;e.nextSibling&&e.previousSibling&&(e.nextSibling.Ze||e.previousSibling.Ze?e.nextSibling.Ze&&!e.previousSibling.Ze&&(o=2):o=1),o=e.Me.Jj(o),e.dg.ve(o)}m.hg=function(e){var o=e.currentPointer;e=o.viewportX,o=o.viewportY,(this.jB!==e||this.kB!==o)&&(this.jB=e,this.kB=o,this.dg.X(this.Me.map.Wa(e-this.uv.x,o-this.uv.y)),this.dispatchEvent(new uc(this.j.zf,this)))},m.Bd=function(e){var o=e.currentPointer,s=o.viewportX;o=o.viewportY;var h=this.Me.map.Ka(this.xa());this.dg.ui(1),this.uv={x:s-h.x,y:o-h.y},e.stopPropagation()},m.df=function(){this.dg.ui(0)},m.Nr=function(e){this.kh=e,this.we(this.Me.Jt(e),this.xa())};function Ct(e,o){this.Ia=o,this.uc=e,this.nb={Ze:!0},Dt(this,this.nb),this.hn=A(this.hn,this)}t("H.ui.distanceMeasurement.Model",Ct),m=Ct.prototype,m.Im=function(){return this.nb.nextSibling===this.nb},m.Sk=function(e){for(var o=this.nb,s=o.nextSibling;s!==o;)s.Sk(s.previousSibling===o?!1:e),s=s.nextSibling};function Et(e,o){var s=o||e.nb.nextSibling,h=0,d=0;if(o&&!Ft(e,o))throw new D(e.Ek,0,o);for(s instanceof At?h=s.Ij():s instanceof yt&&(h=s.previousSibling.Ij()),o=s;o&&o!==e.nb;o=o.nextSibling,d++)o.Nr(h),d%2===1&&(h+=o.Ij())}m.Pi=function(e){var o=this.nb.previousSibling,s=this.Im();return e=new At(e,this.Ia,s?0:2),this.uc.Y(e.td),xt(e,this.nb),e.addEventListener(e.j.zf,this.hn),s?Dt(this,e):(Gt(this,o,e),Bt(o),Et(this,o)),e},m.insertBefore=function(e,o){var s,h=1;if(o){if(!Ft(this,o))throw new D(this.insertBefore,1,o);(s=o.previousSibling.Ze)&&(h=0),e=new At(e,this.Ia,h),e.addEventListener(e.j.zf,this.hn),this.uc.Y(e.td),s?(s=this.nb.nextSibling,Gt(this,e,s),Dt(this,e),o=e,Bt(s)):(s=o.previousSibling,o=s.previousSibling,h=s.nextSibling,this.uc.Na(s.td),Gt(this,o,e),Gt(this,e,h)),Et(this,o)}else e=this.Pi(e);return e},m.ia=function(){Dt(this,this.nb),this.uc.ia()},m.Ek=function(e){var o=this.nb,s=e.previousSibling,h=e.nextSibling;if(!Ft(this,e))throw new D(this.Ek,0,e);if(this.uc.Na(e.td),s===o){var d=h;d!==o?(e=d.nextSibling,Dt(this,e),e.Nr(0),Bt(e),Et(this,e)):Dt(this,this.nb)}else h===o?(d=s,e=d.previousSibling,xt(e,o),Bt(e)):s&&h&&(Gt(this,s.previousSibling,h.nextSibling),this.uc.ug([h.td,s.td]),Et(this,s.previousSibling));d&&d!==o&&this.uc.Na(d.td)};function Ft(e,o){for(var s=e.nb.nextSibling,h=!1;s!==e.nb;){if(s===o){h=!0;break}s=s.nextSibling}return h}function Gt(e,o,s){o=new yt(o,s,e.Ia),e.uc.Y(o.td)}function Dt(e,o){e.nb.nextSibling=o,o.previousSibling=e.nb}m.hn=function(e){e=e.target;var o=e.previousSibling,s=e.nextSibling,h=e.xa();if(!s.Ze){zt(s,h,!1);var d=e}o.Ze||(zt(o,h,!0),d=o.previousSibling),Et(this,d)};var Ht={IMPERIAL:"imperial",METRIC:"metric"};t("H.ui.UnitSystem",Ht);function It(e){e=e||{};var o,s=e.lineStyle;ct.call(this),this.Lo=new Ys({label:st.btn,onStateChange:A(this.ff,this)}),this.Ra(this.Lo),(o=e.distanceFormatter)&&(this.Kt=o),s&&(this.lv=s,this.Vv=B),this.Yc(e.alignment||"right-bottom"),this.ud={},this.ud[0]=e.startIcon,this.ud[2]=e.endIcon,this.ud[1]=e.stopoverIcon,this.ud[3]=e.splitIcon}u(It,ct),t("H.ui.DistanceMeasurement",It),m=It.prototype,m.Qb=Ht.METRIC,m.Tx=22,m.lv={strokeColor:"rgb(39,44,54)",lineWidth:5},m.Vv={strokeColor:"white",lineWidth:7},m.Wk=function(){var e=this.map,o,s={};this.Wj||(this.rc=new Q,this.qb=new bl(this.rc,{pixelRatio:this.map.lb()}),this.uc=o=this.rc.rd(),this.uc.Yw(!0),o.addEventListener("dragstart",this.Bd,!0,this),o.addEventListener("dragend",this.Xk,!0,this),o.addEventListener("pointerenter",this.Xk,!0,this),o.addEventListener("pointerleave",this.Wq,!0,this),o.addEventListener("tap",this.eC,!0,this),this.Zk=Jt(this),s.Jt=A(this.Kt,this),s.Jj=A(this.Jj,this),s.hA=A(this.ou,this),s.map=this.map,s.ex=this.Zk,s.Nh=this.lv,s.outlineStyle=this.Vv,this.Kb=new Ct(this.uc,s),this.Wj=!0),this.Zk&&this.uc.Y(this.Zk),e.addEventListener("tap",this.Ov,!0,this),e.O.add(this.qb)},m.Ai=function(){var e=this.map;this.Wj&&(e.removeEventListener("tap",this.Ov,!0,this),e.hi(this.qb),this.Kb.ia())};function Jt(e){function o(){var j=s.mc();return j={anchor:s.Db.clone().scale(g).floor(),size:new Hi(Bb(j.w*g),Bb(j.h*g)),hitArea:h},new um(s.Se(),j)}var s=e.Jj(3),h=new Ii(Ji.NONE,[]),d,g=s===e.Hs?.5:1;if(s.getState()===1)var _=o();else _=new um("<svg/>",{hitArea:h}),s.addEventListener("statechange",function(){s.getState()===1&&d.ve(o())});return d=new $m(e.map.wb(),{visibility:!1,icon:_})}m.Kt=function(e){var o="m",s=0;return this.Qb==="metric"?1e3<=e&&(e/=1e3,o="km",s=1):(e/=.3048,o="ft",5280<=e&&(e/=5280,o="mi",s=1)),e.toFixed(s)+" "+this.la().translate("scale."+o)},m.ou=function(e,o,s){var h=this.map.Ka(e);return o=this.map.Ka(o),s=new F(s.x,s.y).nu(h,o),this.map.Wa(s.x,s.y)||hd(e)},m.N=function(e,o){var s=this.map.Ba.type===Rf.P2D?this.map.lb():1;s*=this.Tx;var h=s/2;ct.prototype.renderInternal.call(this,e,o),this.Qb=Ht.METRIC,this.Hs=new um(st.point,{anchor:{x:h,y:h},size:{w:s,h:s},hitArea:new Ii(Ji.CIRCLE,[h,h,h])}),this.Lo.Fd(this.la().translate("distance.measurement"))},It.prototype.renderInternal=It.prototype.N,m=It.prototype,m.Jj=function(e){return this.ud[e]||this.Hs},m.Xk=function(){this.Kb.Sk(!0)},m.Bd=function(){this.Kb.Sk()},m.Wq=function(e){e.currentPointer.type!=="touch"&&this.Kb.Sk()},m.eC=function(e){var o=e.currentPointer,s=e.target.Ma,h;s&&(s=s.getData())instanceof wt&&(h=s),s=h,e=e.originalEvent,e=e.metaKey||e.altKey,s&&(e&&s instanceof At?this.Kb.Ek(s):s instanceof yt&&(e=s.previousSibling.xa(),h=s.nextSibling.xa(),o={x:o.viewportX,y:o.viewportY},this.Kb.insertBefore(this.ou(e,h,o),s.nextSibling),this.Zk.Zb()),this.Xk())},m.Ov=function(e){var o=e.currentPointer;e=e.target,e!==this.map&&e.getProvider&&e.getProvider()===this.rc||(this.Kb.Pi(this.map.Wa(o.viewportX,o.viewportY)),this.Zk.Zb(),this.Xk())},m.ff=function(e){e.target.getState()==="down"?this.Wk():this.Ai()},m.qk=function(e){this.Qb=e,this.Wj&&(Et(this.Kb),this.Xk())},It.prototype.onUnitSystemChange=It.prototype.qk,It.prototype.disposeInternal=function(){this.Ai(),this.Wj&&(this.rc.l(),this.qb.l()),It.g.disposeInternal.call(this)},It.prototype.Pa=function(e){e?this.Lo.getState()===Xs.DOWN&&(this.map=e,this.Wk()):(this.Ai(),this.Wj=!1),ct.prototype.Pa.apply(this,arguments)},It.prototype.setMap=It.prototype.Pa;var Kt=[];t("H.ui.i18n.defaultLocales",Kt);var Lt={},Mt=[];function Nt(e,o){Lt[e]=o,Kt.indexOf(e)===-1&&Kt.push(e),Mt.length?Ot(e,o):Mt=Object.keys(o)}function Ot(e,o){for(var s=Mt,h=s.length,d;h--;)if(d=s[h],!o[d])throw Error("'"+d+"' key missing in translation map for "+e)}Nt("zh-CN",{"layers.normal":"","layers.satellite":"","layers.terrain":"","layer.transit":"","layer.traffic":"","layer.incidents":"","layers.choose":"",minimap:"Minimap","scale.switchToImperial":"","scale.switchToMetric":"","scale.km":"","scale.m":"","scale.mi":"","scale.ft":"","zoom.out":"","zoom.in":"","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"","traffic.MISCELLANEOUS":"","traffic.ACCIDENT":"","traffic.OTHER_NEWS":"","traffic.OTHER":"","traffic.PLANNED_EVENT":"","traffic.ROAD_HAZARD":"","traffic.ROAD_CLOSURE":"","traffic.WEATHER":"","traffic.CONGESTION":"","traffic.CONSTRUCTION":"","traffic.DISABLED_VEHICLE":"","traffic.LANE_RESTRICTION":"","traffic.from":"","traffic.until":"","distance.measurement":"Measure distance"}),Nt("pt-BR",{"layers.normal":"Exibio do mapa","layers.satellite":"Satlite","layers.terrain":"Terreno","layer.transit":"Transporte pblico","layer.traffic":"Condies do trnsito","layer.incidents":"Mostrar incidentes no trnsito","layers.choose":"Escolher exibio",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"milhas","scale.ft":"ps","zoom.out":"Menos zoom","zoom.in":"Mais zoom","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte pblico","traffic.MISCELLANEOUS":"Miscelnea","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras notcias","traffic.OTHER":"Outras notcias","traffic.PLANNED_EVENT":"Evento planejado","traffic.ROAD_HAZARD":"Risco na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Clima","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Construo","traffic.DISABLED_VEHICLE":"Veculo incapacitado","traffic.LANE_RESTRICTION":"Restrio de pista","traffic.from":"Hora de incio:","traffic.until":"Tempo final estimado:","distance.measurement":"Measure distance"}),Nt("tr-TR",{"layers.normal":"Harita grnm","layers.satellite":"Uydu","layers.terrain":"Arazi","layer.transit":"Toplu ulam","layer.traffic":"Trafik durumlar","layer.incidents":"Trafik olaylarn gster","layers.choose":"Grnm se",minimap:"Minimap","scale.switchToImperial":"Mile dntr","scale.switchToMetric":"Kilometreye dntr","scale.km":"km","scale.m":"m","scale.mi":"mil","scale.ft":"ft","zoom.out":"Uzaklatr","zoom.in":"Yaknlatr","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Toplu ulam","traffic.MISCELLANEOUS":"eitli","traffic.ACCIDENT":"Kaza","traffic.OTHER_NEWS":"Dier haberler","traffic.OTHER":"Dier haberler","traffic.PLANNED_EVENT":"Planl etkinlik","traffic.ROAD_HAZARD":"Yol tehlikesi","traffic.ROAD_CLOSURE":"Yol kapal","traffic.WEATHER":"Hava durumu","traffic.CONGESTION":"Younluk","traffic.CONSTRUCTION":"Yol almas","traffic.DISABLED_VEHICLE":"Ara arzas","traffic.LANE_RESTRICTION":"erit kstlamas","traffic.from":"Balang zaman:","traffic.until":"Tahmini biti zaman:","distance.measurement":"Measure distance"}),Nt("nl-NL",{"layers.normal":"Kaartweergave","layers.satellite":"Satelliet","layers.terrain":"Terrein","layer.transit":"Openbaar vervoer","layer.traffic":"Verkeerssituatie","layer.incidents":"Toon verkeersincidenten","layers.choose":"Weergave kiezen",minimap:"Minimap","scale.switchToImperial":"Overgaan naar mijlen","scale.switchToMetric":"Wijzigen naar km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Uitzoomen","zoom.in":"Inzoomen","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Openbaar vervoer","traffic.MISCELLANEOUS":"Diversen","traffic.ACCIDENT":"Ongeval","traffic.OTHER_NEWS":"Meer informatie","traffic.OTHER":"Meer informatie","traffic.PLANNED_EVENT":"Geplande afzetting","traffic.ROAD_HAZARD":"Gevaar op de weg","traffic.ROAD_CLOSURE":"Rijbaan afgesloten","traffic.WEATHER":"Weer","traffic.CONGESTION":"Verkeersopstopping","traffic.CONSTRUCTION":"Wegwerkzaamheden","traffic.DISABLED_VEHICLE":"Voertuig met pech","traffic.LANE_RESTRICTION":"Rijstrookbeperking","traffic.from":"Begintijd:","traffic.until":"Geschatte eindtijd:","distance.measurement":"Measure distance"}),Nt("de-DE",{"layers.normal":"Kartenansicht","layers.satellite":"Satellit","layers.terrain":"Gelnde","layer.transit":"ffentliche Verkehrsmittel","layer.traffic":"Verkehrslage","layer.incidents":"Verkehrsstrungen anzeigen","layers.choose":"Ansicht auswhlen",minimap:"Minimap","scale.switchToImperial":"Umrechnung in Meilen","scale.switchToMetric":"Umrechnung in Kilometer","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Verkleinern","zoom.in":"Vergrern","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"ffentliche Verkehrsmittel","traffic.MISCELLANEOUS":"Diverse","traffic.ACCIDENT":"Unfall","traffic.OTHER_NEWS":"Anderes Ereignis","traffic.OTHER":"Anderes Ereignis","traffic.PLANNED_EVENT":"Geplantes Ereignis","traffic.ROAD_HAZARD":"Verkehrshindernis","traffic.ROAD_CLOSURE":"Fahrbahn gesperrt","traffic.WEATHER":"Wetter","traffic.CONGESTION":"Verkehrsstau","traffic.CONSTRUCTION":"Baustelle","traffic.DISABLED_VEHICLE":"Liegengebliebenes Fahrzeug","traffic.LANE_RESTRICTION":"Fahrstreifensperrung","traffic.from":"Beginn:","traffic.until":"Voraussichtliches Ende:","distance.measurement":"Measure distance"}),Nt("fi-FI",{"layers.normal":"Karttankym","layers.satellite":"Satelliitti","layers.terrain":"Maasto","layer.transit":"Julkinen liikenne","layer.traffic":"Liikenneolosuhteet","layer.incidents":"Nyt liikennetapahtumat","layers.choose":"Valitse nkym",minimap:"Minimap","scale.switchToImperial":"Vaihda maileihin","scale.switchToMetric":"Vaihda kilometreihin","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Loitonna","zoom.in":"Lhenn","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Julkinen liikenne","traffic.MISCELLANEOUS":"Erittelemtn syy","traffic.ACCIDENT":"Onnettomuus","traffic.OTHER_NEWS":"Muu tapahtuma","traffic.OTHER":"Muu tapahtuma","traffic.PLANNED_EVENT":"Suunniteltu tapahtuma","traffic.ROAD_HAZARD":"Vaara tiell","traffic.ROAD_CLOSURE":"Tie suljettu","traffic.WEATHER":"S","traffic.CONGESTION":"Ruuhka","traffic.CONSTRUCTION":"Rakennusty","traffic.DISABLED_VEHICLE":"Pyshtynyt ajoneuvo","traffic.LANE_RESTRICTION":"Kaista rajoitus","traffic.from":"Alkamisaika:","traffic.until":"Arvioitu pttymisaika:","distance.measurement":"Measure distance"}),Nt("it-IT",{"layers.normal":"Vista mappa","layers.satellite":"Satellite","layers.terrain":"Terreno","layer.transit":"Mezzi pubblici","layer.traffic":"Condizioni del traffico","layer.incidents":"Mostra incidenti stradali","layers.choose":"Scegli vista",minimap:"Minimap","scale.switchToImperial":"Passa a miglia","scale.switchToMetric":"Passa a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom indietro","zoom.in":"Zoom avanti","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Mezzi pubblici","traffic.MISCELLANEOUS":"Varie","traffic.ACCIDENT":"Incidente","traffic.OTHER_NEWS":"Altre notizie","traffic.OTHER":"Altre notizie","traffic.PLANNED_EVENT":"Evento pianificato","traffic.ROAD_HAZARD":"Strada dissestata","traffic.ROAD_CLOSURE":"Strada chiusa","traffic.WEATHER":"Maltempo","traffic.CONGESTION":"Ingorgo","traffic.CONSTRUCTION":"Lavori in corso","traffic.DISABLED_VEHICLE":"Veicolo in panne","traffic.LANE_RESTRICTION":"Restrizione di corsia","traffic.from":"Ora di inizio:","traffic.until":"Ora di fine stimata:","distance.measurement":"Measure distance"}),Nt("fr-FR",{"layers.normal":"Carte","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Transports publics","layer.traffic":"Conditions de circulation","layer.incidents":"Afficher les incidents de circulation","layers.choose":"Choisir la vue",minimap:"Minimap","scale.switchToImperial":"Passer en miles","scale.switchToMetric":"Passer en km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom arrire","zoom.in":"Zoom avant","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transports publics","traffic.MISCELLANEOUS":"Divers","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Autre","traffic.OTHER":"Autre","traffic.PLANNED_EVENT":"vnement prvu","traffic.ROAD_HAZARD":"Danger routier","traffic.ROAD_CLOSURE":"Chausse ferme","traffic.WEATHER":"Mto","traffic.CONGESTION":"Embouteillage","traffic.CONSTRUCTION":"Travaux","traffic.DISABLED_VEHICLE":"Vhicule en panne","traffic.LANE_RESTRICTION":"Restriction de voie","traffic.from":"Date ou heure de dbut:","traffic.until":"Date et heure de fin estimes:","distance.measurement":"Measure distance"}),Nt("en-US",{"layers.normal":"Map view","layers.satellite":"Satellite","layers.terrain":"Terrain","layer.transit":"Public transport","layer.traffic":"Traffic conditions","layer.incidents":"Show traffic incidents","layers.choose":"Choose view",minimap:"Minimap","scale.switchToImperial":"Change to miles","scale.switchToMetric":"Change to km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Zoom out","zoom.in":"Zoom in","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Public transport","traffic.MISCELLANEOUS":"Miscellaneous","traffic.ACCIDENT":"Accident","traffic.OTHER_NEWS":"Other news","traffic.OTHER":"Other news","traffic.PLANNED_EVENT":"Planned event","traffic.ROAD_HAZARD":"Road hazard","traffic.ROAD_CLOSURE":"Roadway closed","traffic.WEATHER":"Weather","traffic.CONGESTION":"Congestion","traffic.CONSTRUCTION":"Construction","traffic.DISABLED_VEHICLE":"Disabled vehicle","traffic.LANE_RESTRICTION":"Lane restriction","traffic.from":"Start time:","traffic.until":"Estimated end time:","distance.measurement":"Measure distance"}),Nt("pt-PT",{"layers.normal":"Vista do mapa","layers.satellite":"Satlite","layers.terrain":"Terreno","layer.transit":"Transportes pblicos","layer.traffic":"Condies de trnsito","layer.incidents":"Mostrar incidentes de trnsito","layers.choose":"Escolher vista",minimap:"Minimap","scale.switchToImperial":"Mudar para milhas","scale.switchToMetric":"Mudar para km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Diminuir","zoom.in":"Aumentar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transportes pblicos","traffic.MISCELLANEOUS":"Diversos","traffic.ACCIDENT":"Acidente","traffic.OTHER_NEWS":"Outras notcias","traffic.OTHER":"Outras notcias","traffic.PLANNED_EVENT":"Evento planeado","traffic.ROAD_HAZARD":"Perigo na estrada","traffic.ROAD_CLOSURE":"Estrada fechada","traffic.WEATHER":"Meteorologia","traffic.CONGESTION":"Congestionamento","traffic.CONSTRUCTION":"Construo","traffic.DISABLED_VEHICLE":"Veculo avariado","traffic.LANE_RESTRICTION":"Limitao da faixa de rodagem","traffic.from":"Hora de incio:","traffic.until":"Hora de fim prevista:","distance.measurement":"Measure distance"}),Nt("es-ES",{"layers.normal":"Mapa","layers.satellite":"Satlite","layers.terrain":"Terreno","layer.transit":"Transporte pblico","layer.traffic":"Estado del trfico","layer.incidents":"Mostrar incidentes de trfico","layers.choose":"Elija una vista",minimap:"Minimap","scale.switchToImperial":"Cambiar a millas","scale.switchToMetric":"Cambiar a km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Alejar","zoom.in":"Acercar","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transporte pblico","traffic.MISCELLANEOUS":"Varios","traffic.ACCIDENT":"Accidente","traffic.OTHER_NEWS":"Ms noticias","traffic.OTHER":"Ms noticias","traffic.PLANNED_EVENT":"Acto programado","traffic.ROAD_HAZARD":"Riesgo en carretera","traffic.ROAD_CLOSURE":"Carretera cerrada","traffic.WEATHER":"Tiempo","traffic.CONGESTION":"Atasco","traffic.CONSTRUCTION":"Construccin","traffic.DISABLED_VEHICLE":"Vehculo averiado","traffic.LANE_RESTRICTION":"Restriccin de carril","traffic.from":"Inicio:","traffic.until":"Finalizacin estimada:","distance.measurement":"Measure distance"}),Nt("ru-RU",{"layers.normal":" ","layers.satellite":"","layers.terrain":"","layer.transit":" ","layer.traffic":" ","layer.incidents":"  ","layers.choose":" ",minimap:"Minimap","scale.switchToImperial":" ","scale.switchToMetric":" ","scale.km":"","scale.m":"","scale.mi":"","scale.ft":"","zoom.out":"","zoom.in":"","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":" ","traffic.MISCELLANEOUS":" ","traffic.ACCIDENT":"","traffic.OTHER_NEWS":" ","traffic.OTHER":" ","traffic.PLANNED_EVENT":" ","traffic.ROAD_HAZARD":" ","traffic.ROAD_CLOSURE":" ","traffic.WEATHER":"","traffic.CONGESTION":"","traffic.CONSTRUCTION":"","traffic.DISABLED_VEHICLE":" ","traffic.LANE_RESTRICTION":"  ","traffic.from":" :","traffic.until":"  :","distance.measurement":" "}),Nt("pl-PL",{"layers.normal":"Widok mapy","layers.satellite":"Satelita","layers.terrain":"Teren","layer.transit":"Transport publiczny","layer.traffic":"Warunki drogowe","layer.incidents":"Poka zdarzenia drogowe","layers.choose":"Wybierz widok",minimap:"Minimap","scale.switchToImperial":"Zmie na mile","scale.switchToMetric":"Zmie na km","scale.km":"km","scale.m":"m","scale.mi":"mi","scale.ft":"ft","zoom.out":"Oddal","zoom.in":"Przybli","zoom.rectangle":"Zoom rectangle","traffic.MASS_TRANSIT":"Transport publiczny","traffic.MISCELLANEOUS":"Inne zdarzenie","traffic.ACCIDENT":"Wypadek","traffic.OTHER_NEWS":"Inne wiadomoci","traffic.OTHER":"Inne wiadomoci","traffic.PLANNED_EVENT":"Zdarzenie planowane","traffic.ROAD_HAZARD":"Niebezpieczestwo na drodze","traffic.ROAD_CLOSURE":"Jezdnia zamknita","traffic.WEATHER":"Pogoda","traffic.CONGESTION":"Korek","traffic.CONSTRUCTION":"Budowa","traffic.DISABLED_VEHICLE":"Uszkodzony pojazd","traffic.LANE_RESTRICTION":"Ograniczenie pasa ruchu","traffic.from":"Data rozpoczcia:","traffic.until":"Przybliona data zakoczenia:","distance.measurement":"Measure distance"});function Pt(e,o){if(!gb(e))throw new TypeError("string locale code required");if(ya(o))Ot(e,o);else{if(Kt.indexOf(e)===-1)throw Error("Default locale '"+e+"' does nto exist.");o=Lt[e]}this.u=o||{},this.Tm=e}t("H.ui.i18n.Localization",Pt),Pt.prototype.dA=function(){return this.Tm},Pt.prototype.getLocale=Pt.prototype.dA,Pt.prototype.Xz=function(){return Object.keys(this.u)},Pt.prototype.getKeys=Pt.prototype.Xz,Pt.prototype.xm=function(e){return!(!this.u||!this.u[e])},Pt.prototype.hasKey=Pt.prototype.xm,Pt.prototype.translate=function(e){var o=this.u[e];if(!gb(o))throw Error("Translation missing for key '"+e+"'.");return o},Pt.prototype.translate=Pt.prototype.translate;function Qt(e){e=e||{},ct.call(this),this.Ga("H_scalebar"),this.Yc(e.alignment||"right-bottom"),this.maxWidth=150,this.update=A(this.update,this),this.$u=this.Ir=this.Mk=this.dl=null,this.tf(0)}u(Qt,ct),t("H.ui.ScaleBar",Qt),Qt.prototype.N=function(e,o){ct.prototype.renderInternal.call(this,e,o),e.innerHTML='<svg height="12" version="1.1" xmlns="http://www.w3.org/2000/svg"><polyline style="fill:none; stroke:white; stroke-width:4" points="2,2 2,10 98,10 98,2"/><polyline style="fill:none; stroke:black; stroke-width:2" points="2,2 2,10 98,10 98,2"/></svg><div style="padding: 0 0 0 10px"></div>',e.style.direction="ltr",this.dl=e.firstChild,o=this.dl.childNodes,this.Mk=o[0],this.Ir=o[1],this.$u=e.lastChild,this.Qb=Ht.METRIC,this.Wy=A(function(s){!this.ub&&Ps(s)&&(this.dispatchEvent("toggleunitsystem"),s.preventDefault())},this),this.ie=A(function(s){!this.ub&&Ps(s)&&s.preventDefault()},this),Ts(e,"start",this.ie),Ts(e,"end",this.Wy),this.Fd(this.la().translate("scale.switchToImperial")),this.update()},Qt.prototype.renderInternal=Qt.prototype.N,Qt.prototype.Pa=function(e){this.map&&this.map.removeEventListener("mapviewchange",this.update),e&&e.addEventListener("mapviewchange",this.update),ct.prototype.Pa.apply(this,arguments)},Qt.prototype.setMap=Qt.prototype.Pa,Qt.prototype.capture=function(e,o,s){var h=this.A(),d=h.ownerDocument,g=d.createElement("canvas"),_=g.getContext("2d"),j=d.createElementNS("http://www.w3.org/2000/svg","svg"),$=d.createElementNS("http://www.w3.org/2000/svg","foreignObject"),_t=De(h,d,!1);d=parseFloat(h.offsetWidth)+1;var _e=parseFloat(h.offsetHeight),_r=d*e;e*=_e,g.width=_r,g.height=e,j.setAttribute("xmlns","http://www.w3.org/2000/svg"),j.setAttribute("width",_r),j.setAttribute("height",e),j.setAttribute("viewBox","0 0 "+d+" "+_e),$.setAttribute("width","100%"),$.setAttribute("height","100%"),j.appendChild($),_t.setAttribute("width","100%"),_t.setAttribute("height","100%"),_t.setAttribute("xmlns","http://www.w3.org/1999/xhtml");var _i=window.getComputedStyle(h);"box-shadow display align-items font font-family font-size height text-shadow direction".split(" ").forEach(function(_n){_t.style.setProperty(_n,_i.getPropertyValue(_n))}),$.appendChild(_t),h=te(j.outerHTML),new Ue("image",h).then(function(_n){_.drawImage(_n,0,0),o(g)},s)},Qt.prototype.capture=Qt.prototype.capture,Qt.prototype.qk=function(e){this.Qb=e,this.Fd(e==="imperial"?this.la().translate("scale.switchToMetric"):this.la().translate("scale.switchToImperial")),this.update()},Qt.prototype.onUnitSystemChange=Qt.prototype.qk,Qt.prototype.update=function(){var e;if(this.A()){this.dl=this.dl,this.Mk=this.Mk;var o=this.maxWidth,s=0;if(e=this.map){var h=e.ra,d=Math.round(.5*h.width),g=Math.round(.5*h.height);0<d&&0<g&&(h=e.Wa(d,g))&&(e=e.Wa(d+1,g))&&(s=100*h.kb(e))}s&&(this.Qb===Ht.IMPERIAL?1609.344>s?(d=s/.3048006,e=this.la().translate("scale.ft")):(d=s/1609.344,e=this.la().translate("scale.mi")):1e3>s?(d=s,e=this.la().translate("scale.m")):(d=s/1e3,e=this.la().translate("scale.km")),s=Math.pow(10,Math.floor(Math.log(d)/Math.LN10)),d=s/d*100,d<o/5?(s*=5,d*=5):d<o/2?(s*=2,d*=2):d>o&&(s/=2,d/=2),d=Math.round(d),this.dl.setAttribute("width",d),this.$u.textContent=s+" "+e,this.Mk.points.getItem(2).x=this.Ir.points.getItem(2).x=this.Mk.points.getItem(3).x=this.Ir.points.getItem(3).x=d-2)}};function Rt(e){C(e,Array,Rt,1),Zs.call(this,"div","H_context_menu"),this.BB=e,this.u=null,this.Dc=this.Dc.bind(this)}u(Rt,Zs),t("H.ui.context.Menu",Rt),Rt.prototype.disposeInternal=function(){Rt.g.disposeInternal.call(this),this.Yj&&this.Yj.l(),this.Yj=null},Rt.prototype.disposeInternal=Rt.prototype.disposeInternal,Rt.prototype.N=function(){Zs.prototype.N.apply(this,arguments),this.BB.forEach(function(e){e===sd?e=new Y("div","H_context_menu_item_separator"):(e=new ft(e),e.addEventListener("click",this.Dc)),this.Ra(e),this.tf(0)},this),Jc(this.A(),["mousedown","touchstart","pointerdown","wheel"],function(e){e.stopPropagation()}),this.Yj=new gt(this.A(),this.Dj().filter(function(e){return e instanceof ft?(e=e.Kb,e.callback&&!e.isDisabled()):!1}),this.Dc)},Rt.prototype.renderInternal=Rt.prototype.N,Rt.prototype.setPosition=function(e,o){if(this.u){var s=this.A(),h=s.offsetWidth,d=s.offsetHeight,g=this.u,_=g.ra.width;g=g.ra.height,e+h>_&&e>_/2&&(e-=h),o+d>g&&o>g/2&&(o-=d),Bs(s,e,o)}},Rt.prototype.setPosition=Rt.prototype.setPosition,Rt.prototype.Dc=function(){this.u&&this.u.dispatchEvent(new uc("contextmenuclose",this.u))},Rt.prototype.Pa=function(e){this.u=e},Rt.prototype.setMap=Rt.prototype.Pa;function St(e){e=e||{};var o;this.yf=!!e.vertical,this.nB=e.length||this.Ux,this.zb=jb(o=e.min)?o:this.Wx,this.Oc=zb(this.zb,jb(o=e.max)?o:this.Vx),this.hD=E(o=e.step)?this.Xx:o,this.Ei=Tt(this,jb(o=e.value)?o:(this.zb+this.Oc)/2),this.Pc=A(this.Pc,this),this.he=A(this.he,this),this.kn=A(this.kn,this),this.jn=A(this.jn,this),this.tk=e.pointerArea,Y.call(this,"div","H_slider"+(this.yf?"":" H_l_horizontal"))}u(St,Y),t("H.ui.base.Slider",St),m=St.prototype,m.Ms=1,m.Wx=0,m.Vx=100,m.Xx=1,m.Ux="16em",m.bo=function(e,o){var s=this.yf,h=s?"top":"left";return(!this.Ja||o)&&(e=ac(e,this.zb,this.Oc),this.Lh&&(o=100*(e-this.zb)/(this.Oc-this.zb),s=(s?-1:1)*o,this.Lh.style[h]=s+"%",this.xD.style[h]=100+s+"%"),this.Ei=Tt(this,e)),this.Ei},St.prototype.setValue=St.prototype.bo,St.prototype.KA=function(){return this.Ei},St.prototype.getValue=St.prototype.KA,m=St.prototype,m.Wk=function(){if(!this.jq){Ts(this.A(),"start",this.Pc);var e=this.tk;Ts(e,"move",this.he),Ts(e,"end",this.kn),Ts(e,"out",this.jn),this.jq=!0}},m.Ai=function(){if(this.jq){Us(this.A(),"start",this.Pc);var e=this.tk;Us(e,"move",this.he),Us(e,"end",this.kn),Us(e,"out",this.jn),this.jq=!1}};function Tt(e,o){var s=e.hD;return o=ac(o,e.zb,e.Oc),s?e.zb+Ab((o-e.zb)/s)*s:o}function Ut(e,o){var s=e.Cx,h=e.yf;e.Bx||(e.Bx=s["offset"+(h?"Height":"Width")]),o-=As(s)[h?"y":"x"],0>o&&(o=0),o=(e.Oc-e.zb)*o/e.Bx,o=Tt(e,h?e.Oc-o:e.zb+o),e.Ei!==o&&(e.bo(o,!0),e.dispatchEvent(new Zc(e.j.zf,o,e.Ei)))}function Vt(e,o){return(o.touches?o.targetTouches[0]:o)["page"+(e.yf?"Y":"X")]}function Wt(e,o){var s=!1,h=e.type;return h.indexOf("pointer")!==-1||h.indexOf("touch")!==-1?s=!0:C(e,MouseEvent)&&(s=e.which===o||e.buttons===o),s}function Xt(e){var o=e.touches;return o&&o.length===1||C(e,MouseEvent)}m.Pc=function(e){var o=this.yf;if(Wt(e,this.Ms)&&Xt(e)){var s=Vt(this,e),h=e.target;h===this.Lh||h.parentElement===this.Lh?(this.hB=s-As(this.Lh)[o?"y":"x"]-this.Lh.offsetWidth/2,this.A().className="H_slider H_slider_active"+(this.yf?"":" H_l_horizontal"),this.Ja=!0):Ut(this,s),e.preventDefault()}},m.kn=function(){this.Ja&&(this.A().className="H_slider "+(this.yf?"":" H_l_horizontal"),this.Ja=!1)},m.jn=function(e){this.Ja&&e.target===this.tk&&(this.Ja=!1)},m.he=function(e){this.Ja&&Xt(e)&&(Wt(e,this.Ms)?(Ut(this,Vt(this,e)-this.hB),e.preventDefault()):this.Ja=!1)},m.j={zf:"change"},m.N=function(e,o){var s=Qs(o,"div","H_slider_cont"),h=Qs(o,"div","H_slider_knob_cont"),d=Qs(o,"div","H_slider_knob"),g=Qs(o,"div","H_slider_knob_halo"),_=Qs(o,"div","H_slider_track");o=Qs(o,"div","H_slider_track H_slider_track_active"),e.appendChild(s),s.appendChild(_),_.appendChild(o),s.appendChild(h),h.appendChild(d),h.appendChild(g),this.Cx=_,this.xD=o,this.Lh=h,this.tk||(this.tk=e.ownerDocument.body),s.style[this.yf?"height":"width"]=this.nB,this.bo(this.Ei),this.Wk()},St.prototype.renderInternal=St.prototype.N,St.prototype.disposeInternal=function(){this.Ai()},St.prototype.va=function(e,o){return e?this.Ai():this.Cx&&this.Wk(),Y.prototype.va.call(this,e,o)},St.prototype.setDisabled=St.prototype.va;var Yt={in:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><g><path d="m5 10.6h5.6v-5.6h2.8v5.6h5.6v2.8h-5.6v5.6h-2.8v-5.6h-5.6v-2.8z"></path></g></svg>',out:'<svg version="1.1" class="H_icon" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><path d="m5 10.6h14v2.8h-14z"/></svg>'};function Zt(e){e=e||{};var o=e.slider;ct.call(this),this.on=A(this.on,this),this.ql=A(this.ql,this),this.Jd=A(this.Jd,this),o&&(this.Xq=A(this.Xq,this),this.Du=o,this.gD=e.sliderSnaps,this.Ga("H_zoom_slider")),this.tl=new Ws({label:Yt.in,onStateChange:this.on}),this.so=new Ws({label:Yt.out,onStateChange:this.on}),this.Ga("H_zoom"),this.Ga("H_grp"),this.jz=e.fractionalZoom!==!1,this.setZoomSpeed(e.zoomSpeed||4),this.Yc(e.alignment||"right-middle")}u(Zt,ct),t("H.ui.ZoomControl",Zt),Zt.prototype.PA=function(){return this.Ox},Zt.prototype.getZoomSpeed=Zt.prototype.PA,Zt.prototype.cD=function(e){this.Ox=e},Zt.prototype.setZoomSpeed=Zt.prototype.cD,Zt.prototype.Pa=function(e){this.map!==e&&(this.map&&this.map.removeEventListener("mapviewchange",this.ql),$t(this)),ct.prototype.Pa.apply(this,arguments),this.map&&(this.Jd(),e.addEventListener("mapviewchange",this.ql),e.addEventListener("baselayerchange",this.Jd))},Zt.prototype.setMap=Zt.prototype.Pa,Zt.prototype.disposeInternal=function(){ct.prototype.disposeInternal.apply(this,arguments),this.map.removeEventListener("baselayerchange",this.Jd),$t(this)},Zt.prototype.N=function(e,o){ct.prototype.renderInternal.call(this,e,o),this.tl.Fd(this.la().translate("zoom.in")),this.so.Fd(this.la().translate("zoom.out"))},Zt.prototype.renderInternal=Zt.prototype.N,Zt.prototype.Yc=function(e){var o=this.Ee;return ct.prototype.Yc.call(this,e),o!==e&&this.Jd(),this},Zt.prototype.setAlignment=Zt.prototype.Yc,Zt.prototype.ql=function(){var e=this.map,o=e.Ub(),s=e.lb()-1;e=e.oa||e.Ba.getCapabilities().lookAt.zoom,this.Du&&this.vi.bo(o),this.ub||(this.tl.va(o+s>=e.max),this.so.va(o<=e.min))},Zt.prototype.va=function(e,o){return Zt.g.va.call(this,e,o),this.ql(),this},Zt.prototype.setDisabled=Zt.prototype.va;function $t(e){e.removeChild(e.vi),e.vi=null,e.oa&&(e.oa.removeEventListener("minchange",e.Jd),e.oa.removeEventListener("maxchange",e.Jd),e.oa=null)}Zt.prototype.on=function(e){e=e.target;var o=e===this.tl?1:-1,s=0<o?Math.ceil:Math.floor,h=this.map,d,g=this;h&&(e.getState()==="down"?(h.wa.startControl(),h.wa.control(0,0,o*this.Ox,0,0,0)):h.wa.endControl(!0,function(_){d=g.jz?_.zoom:s(_.zoom),_.zoom=d}))},Zt.prototype.Xq=function(e){this.map&&this.map.Vk(e.newValue)},Zt.prototype.Jd=function(){var e=this.Ee,o=this.lc();if(/^top/g.test(e)||/^bottom/g.test(e)){var s=this.so;e=this.tl;var h=!1}else s=this.tl,e=this.so,h=!0;if(this.removeChild(s),this.removeChild(e),this.Ra(s),this.Du&&o){$t(this),o=h;var d=(h=(s=this.map)&&s.oa)||s.Ba.getCapabilities().lookAt.zoom;(this.oa=h)&&(h.addEventListener("minchange",this.Jd),h.addEventListener("maxchange",this.Jd)),this.vi=new St({step:this.gD?1:0,vertical:o,min:d.min,max:d.max,value:s.Ub(),pointerArea:s.A()}),this.vi.addEventListener(this.vi.j.zf,this.Xq),this.Ra(this.vi)}this.Ra(e)};function au(e,o){o=o||{};var s=this;Y.call(this,"div","H_ib H_ib_top"),this.Rv=A(function(h){s.ub||!Ps(h)&&h instanceof KeyboardEvent&&h.code!=="Escape"||(s.close(),h.preventDefault())},this),this.update=A(this.update,this),this.am=A(this.am,this),this.setPosition(e),this.Pk(o.content),o.onStateChange&&this.addEventListener("statechange",o.onStateChange),this.F(bu.OPEN)}u(au,Y),t("H.ui.InfoBubble",au),au.prototype.u=null,au.prototype.xa=function(){return this.Sc},au.prototype.setPosition=function(e){this.Sc=hd(e),this.update()},au.prototype.setPosition=au.prototype.setPosition,au.prototype.Pa=function(e){this.u=e},au.prototype.N=function(e,o){this.Jo=Qs(o,"div","H_ib_body"),this.tailEl_=Qs(o,"div","H_ib_tail"),this.$i=Qs(o,"div","H_ib_close H_btn",'<svg version="1.1" class="H_icon" viewBox="0 0 12 12"><path d="m8.12 6 3.66-3.66c.29-.29.29-.76 0-1.05l-1.06-1.06c-.29-.29-.76-.29-1.05 0l-3.66 3.66-3.66-3.66c-.29-.29-.76-.29-1.05 0l-1.06 1.06c-.29.29-.3.76 0 1.05l3.66 3.66-3.66 3.66c-.29.29-.29.76 0 1.05l1.06 1.06c.29.29.76.29 1.05 0l3.66-3.66 3.66 3.66c.29.29.76.29 1.05 0l1.06-1.06c.29-.29.3-.76 0-1.05z"></path></svg>'),this.$i.setAttribute("tabindex","0"),this.fh=Qs(o,"div","H_ib_content","&nbsp;"),this.Jo.appendChild(this.$i),this.Jo.appendChild(this.fh),Ts(this.$i,"start",this.Rv),this.u.wa.addEventListener("sync",this.update),this.u.ra.addEventListener("sync",this.update),e.appendChild(this.Jo),e.appendChild(this.tailEl_),this.Pk(this.Rl)},au.prototype.renderInternal=au.prototype.N,au.prototype.am=function(){this.Bt||(this.Bt=setTimeout(this.update,0))},au.prototype.update=function(){var e=this.A(),o=this.u,s,h="none";if(this.Bt=0,o&&e&&this.getState()===bu.OPEN){if(s=o.Ka(this.Sc)){var d=s.x;s=s.y,o=o.ra.width,(d>=-o||d<=2*o||s>=-o||s<=2*o)&&(h="",Cs?(e.style.left=d-o+"px",e.style.top=s+"px"):Bs(e,d,s))}e.style.display=h,h===""&&(e.style.visibility="visible")}};var bu={OPEN:"open",CLOSED:"closed"};au.State=bu,au.prototype.o=bu.OPEN,au.prototype.getState=function(){return this.o},au.prototype.getState=au.prototype.getState,au.prototype.F=function(e){e!==this.o&&(this.o=e,this.dispatchEvent("statechange")),(e=this.A())&&(this.o===bu.OPEN?(e.style.display="block",e.style.visibility="hidden",this.am()):e.style.display="none")},au.prototype.setState=au.prototype.F,au.prototype.close=function(){this.F(bu.CLOSED)},au.prototype.close=au.prototype.close,au.prototype.open=function(){this.F(bu.OPEN)},au.prototype.open=au.prototype.open,au.prototype.zz=function(){return this.fh||null},au.prototype.getContentElement=au.prototype.zz,au.prototype.Pk=function(e){if(e)if(typeof e=="string"||typeof e.nodeType=="number"&&typeof e.nodeName=="string")this.Rl=e;else throw Error("InfoBubble content must be a string or HTML node.");else this.Rl="";this.A()&&(this.Rl?(this.fh.innerHTML="",typeof this.Rl=="string"?this.fh.innerHTML=e:typeof e.nodeType=="number"&&typeof e.nodeName=="string"&&this.fh.appendChild(e)):this.fh.innerHTML="&nbsp;",this.am())},au.prototype.setContent=au.prototype.Pk,au.prototype.disposeInternal=function(){this.close(),this.Pk(""),this.$i&&Us(this.$i,"end",this.Rv),this.u&&(this.u.wa.removeEventListener("sync",this.update),this.u.ra.removeEventListener("sync",this.update)),Y.prototype.disposeInternal.call(this)};function cu(e,o){this.vc=e,this.Bc=null,this.hk=0,this.eg=22,this.yD=o,this.en=A(this.en,this),this.Zo=A(this.Zo,this),e=this.vc.lc(),e.addEventListener("mapviewchange",this.bC,!1,this),this.vb=e.Ba.type,e=e.O,e.addEventListener("add",this.ig,!1,this),e.addEventListener("remove",this.jg,!1,this)}function du(e,o,s){var h=o.D;h&&(s!==void 0&&s)&&h.removeEventListener("tap",e.en),o?(h.addEventListener("tap",e.en),e.hk=h.min,e.eg=h.max):(e.hk=0,e.eg=22)}m=cu.prototype,m.bC=function(e){var o=e.newValue.zoom;this.Bc&&e.modifiers&e.ZOOM&&(o<this.hk||o>this.eg)&&this.Bc.close()},m.ig=function(e){e=e.added,eu(e)&&du(this,e)},m.jg=function(e){e=e.removed,eu(e)&&(this.Bc&&this.Bc.close(),du(this,e,!0))};function eu(e){return window.H.service&&(e.D instanceof window.H.service.traffic.incidents.Provider||e.D instanceof window.H.service.trafficVectorTile.Provider&&e.D.$.Aq==="incident")}m.en=function(e){var o,s=this.vb===Rf.HARP;e.target&&(o=e.target.getData())&&e.currentPointer.button===0&&(s?(o=this.vc.lc().Wa(e.currentPointer.viewportX,e.currentPointer.viewportY),(s=e.target.getData()?e.target.getData().properties.id:null)&&this.yD.requestIncidentById(s,{locationReferencing:"none",lang:this.vc.la().Tm,units:this.vc.Qb===Ht.METRIC?"metric":"imperial"},this.Dx.bind(this,o),console.error)):(s=e.target.V(),this.Dx(s,o)),e.stopPropagation())},m.Dx=function(e,o){if(this.vb===Rf.HARP){o=o.incidentDetails;var s=this.vc.la().Tm,h=o.type,d=h.split(/(?=[A-Z])/).join("_").toUpperCase();this.vc.la().xm("traffic."+d)&&(h=this.vc.la().translate("traffic."+d)),e={position:e,title:h,description:o.description.value,startTime:new Date(o.startTime).toLocaleString(s).split(",").join(" "),endTime:new Date(o.endTime).toLocaleString(s).split(",").join(" ")}}else s=o.TRAFFIC_ITEM_TYPE_DESC.replace(" ","_"),s=this.vc.la().xm("traffic."+s)?this.vc.la().translate("traffic."+s):o.TRAFFIC_ITEM_DESCRIPTION[o.TRAFFIC_ITEM_DESCRIPTION.length-1].value,e={position:e,title:s,description:o.TRAFFIC_ITEM_DESCRIPTION[0].value,startTime:o.START_TIME,endTime:o.END_TIME};this.Zo(e)},m.Zo=function(e){var o=e.position,s=e.title,h=e.description,d=e.startTime;e=e.endTime,this.Bc||(this.Bc=new au(o),this.Bc.Ga("H_tib"),this.vc.Ys(this.Bc)),this.Bc.setPosition(o),this.Bc.Pk('<div class="H_tib_content"><div class="H_rdo_title" dir="auto">{{title}}</div><div class="H_tib_desc" dir="auto"><span>{{desc}}</span><div class="H_tib_time"><span class="H_tib_left">{{traffic.from}}</span><span class="H_tib_right">{{from}}</span><br/><span class="H_tib_left">{{traffic.until}}</span><span class="H_tib_right">{{until}}</span></div></div>'.replace("{{title}}",s).replace("{{desc}}",h).replace("{{traffic.from}}",this.vc.la().translate("traffic.from")).replace("{{traffic.until}}",this.vc.la().translate("traffic.until")).replace("{{from}}",d).replace("{{until}}",e)),this.Bc.open()};function fu(e){e=e||{},ct.call(this),this.sc=new Ys({label:'<svg xmlns="http://www.w3.org/2000/svg" class="H_icon" viewBox="0 0 24 24"><g transform="translate(1 3)"><path fill-rule="nonzero" d="M5,0 L5,2 L2,2 L2,16 L5,16 L5,18 L2,18 C0.9,18 0,17 0,15.75 L0,2.25 C0,1 0.9,0 2,0 L5,0 Z M17,0 L20,0 C21.1,0 22,1 22,2.25 L22,15.75 C22,17 21.1,18 20,18 L17,18 L17,16 L20,16 L20,2 L17,2 L17,0 Z"></path><rect width="10" height="2" x="6" y="8"></rect><rect width="2" height="10" x="10" y="4"></rect></g></svg>',onStateChange:A(this.ff,this)}),this.Ra(this.sc),this.Yc(e.alignment||"right-bottom")}u(fu,ct),t("H.ui.ZoomRectangle",fu),m=fu.prototype,m.ff=function(e){var o=this.map,s=o.ra.element;e.target.getState()===Xs.DOWN?(o.addEventListener("dragstart",this.Bd,!0,this),o.addEventListener("drag",this.hg,!0,this),o.addEventListener("dragend",this.df,!0,this),e=s.ownerDocument.createElement("div"),e.className="H_zoom_lasso",s.appendChild(e),this.Om=e):(o.removeEventListener("dragstart",this.Bd,!0,this),o.removeEventListener("drag",this.hg,!0,this),o.removeEventListener("dragend",this.df,!0,this),s.removeChild(this.Om))},m.Bd=function(e){var o=this.Om.style,s=e.currentPointer,h=s.viewportX;s=s.viewportY,e.target===this.map&&(e.stopPropagation(),o.width="0px",o.height="0px",o.top=s+"px",o.left=h+"px",o.display="block",this.gx=s,this.fx=h)},m.hg=function(e){var o=e.currentPointer,s=o.viewportX,h=o.viewportY;o=this.fx;var d=this.gx,g=this.Om.style;e.target===this.map&&(e.stopPropagation(),e=s-o,s=h-d,g.left=o+(0>e?e:0)+"px",g.top=d+(0>s?s:0)+"px",g.width=Math.abs(e)+"px",g.height=Math.abs(s)+"px")},m.df=function(e){var o=this.map,s=e.currentPointer;e.target===this.map&&(e.stopPropagation(),this.Om.style.display="none",o.wa.Zc({bounds:$f([o.Wa(this.fx,this.gx),o.Wa(s.viewportX,s.viewportY)])},!0))},m.N=function(e,o){ct.prototype.renderInternal.call(this,e,o),this.sc.Fd(this.la().translate("zoom.rectangle"))},fu.prototype.renderInternal=fu.prototype.N;function gu(e,o){var s={},h={};s["top-left"]=Qs(o,"div",[hu,iu].join(" ")),s["top-center"]=Qs(o,"div",[hu,ju,ku,iu].join(" ")),s["top-right"]=Qs(o,"div",[hu,iu].join(" ")),s["left-top"]=Qs(o,"div",[hu,lu].join(" ")),s["left-middle"]=Qs(o,"div",[hu,mu,nu,lu].join(" ")),s["left-bottom"]=Qs(o,"div",[hu,lu].join(" ")),s["right-top"]=Qs(o,"div",[hu,lu].join(" ")),s["right-middle"]=Qs(o,"div",[hu,ou,nu,lu].join(" ")),s["right-bottom"]=Qs(o,"div",[hu,lu].join(" ")),s["bottom-left"]=Qs(o,"div",[hu,iu].join(" ")),s["bottom-center"]=Qs(o,"div",[hu,pu,ku,iu].join(" ")),s["bottom-right"]=Qs(o,"div",[hu,iu].join(" ")),h["top-left"]=Qs(o,"div",[ju,mu].join(" ")),h["top-right"]=Qs(o,"div",[ju,ou].join(" ")),h["bottom-left"]=Qs(o,"div",[pu,mu].join(" ")),h["bottom-right"]=Qs(o,"div",[pu,ou].join(" ")),Rs(h["top-left"],s["top-left"],s["left-top"]),Rs(h["top-right"],s["top-right"],s["right-top"]),Rs(h["bottom-left"],s["left-bottom"],s["bottom-left"]),Rs(h["bottom-right"],s["right-bottom"],s["bottom-right"]),Rs(e,h["top-left"],h["top-right"],h["bottom-left"],h["bottom-right"],s["top-center"],s["left-middle"],s["right-middle"],s["bottom-center"]),this.at=s}var ju="H_l_top",pu="H_l_bottom",mu="H_l_left",ou="H_l_right",ku="H_l_center",nu="H_l_middle",iu="H_l_horizontal",lu="H_l_vertical",hu="H_l_anchor";gu.prototype.update=function(){var e=this.at;qu(e["top-center"],!0),qu(e["bottom-center"],!0),qu(e["left-middle"],!1),qu(e["right-middle"],!1)};function qu(e,o){o?(o=e.offsetWidth,e.style.marginLeft=-Math.round(.5*o)+"px"):(o=e.offsetHeight,e.style.marginTop=-Math.round(.5*o)+"px")}gu.prototype.put=function(e,o){e=e?e.A():null;var s=o?this.at[o]:null;e&&s&&(e.parentElement&&e.parentElement.removeChild(e),s.insertBefore(e,/(bottom|right)$/.test(o)||/(center|middle)/.test(o)&&s.childNodes.length%2?s.firstChild:null)),this.update()};function ru(e,o){try{return e.Hm=!0,new e(o)}finally{e.Hm=!1}}function su(e,o){var s=e.A(),h=this;K.call(this),this.u=e,this.qj=s.ownerDocument,this.Gf={},this.Ie=[],this.G=Qs(this.qj,"div","H_ui"),this.setDirection(),this.QB=A(function(d){this.kv.put(d.target,d.target.Ee)},this),this.addEventListener("alignmentchange",this.QB),this.fC=A(function(){this.wx()},this),this.addEventListener("toggleunitsystem",this.fC),this.G.addEventListener("contextmenu",this.kw,!1),this.G.addEventListener("MSHoldVisual",this.kw,!1),this.u.addEventListener("contextmenu",this.bn,!1,this),this.u.addEventListener("contextmenuclose",this.Jv,!1,this),this.u.bc(this.l.bind(this)),this.Nd=null,this.rt=-1,this.kv=new gu(this.G,this.qj),this.Qb=Ht.METRIC,tu(this,"en-US"),o&&uu(this,o),s.appendChild(this.G),x.setTimeout(function(){h.kv.update()},1)}u(su,K),t("H.ui.UI",su),su.prototype.kw=function(e){for(var o=e.target;o&&!/\bH_ib_content\b/.test(o.className);)o=o.parentNode;o||e.preventDefault()},su.prototype.A=function(){return this.G},su.prototype.getElement=su.prototype.A,su.prototype.lc=function(){return this.u},su.prototype.getMap=su.prototype.lc,su.prototype.JA=function(){return this.Qb},su.prototype.getUnitSystem=su.prototype.JA,su.prototype.ao=function(e){var o=this.Gf,s;if(e!==this.Qb)for(s in this.Qb=e,o)o[s]instanceof ct&&o[s].onUnitSystemChange(this.Qb)},su.prototype.setUnitSystem=su.prototype.ao,su.prototype.setDirection=function(e){this.G.setAttribute("dir",e||getComputedStyle(this.lc().A()).direction)},su.prototype.setDirection=su.prototype.setDirection;function tu(e,o){if(gb(o))var s=o;else if(o instanceof Pt){s=o.Tm;var h=o}else throw Error("The locale parameter must be a string or a H.ui.i18n.Localization object.");if(s)if(h)e.Bq=h;else if(0<=Kt.indexOf(s))e.Bq=new Pt(s);else throw Error("Locale ["+s+"] is not supported.");else throw Error("No locale was defined.")}su.prototype.la=function(){return this.Bq},su.prototype.wx=function(){this.Qb===Ht.METRIC?this.ao(Ht.IMPERIAL):this.ao(Ht.METRIC)},su.prototype.toggleUnitSystem=su.prototype.wx,su.prototype.Ys=function(e){var o=this.Ie.length,s=this.G;if(0>this.Ie.indexOf(e)){e.ea(this),e.Pa(this.u);var h=e.L(this.qj);o=0<o?this.Ie[o-1].A().nextSibling:this.G.firstChild,s.insertBefore(h,o),this.Ie.push(e)}},su.prototype.addBubble=su.prototype.Ys,su.prototype.bn=function(e){var o=e.items;this.Nd&&this.Jv(),clearTimeout(this.rt),this.rt=x.setTimeout((function(){o.length&&(this.Nd=new Rt(o),this.G.insertBefore(this.Nd.L(this.qj),this.G.firstChild),this.Nd.ea(this),this.Nd.Pa(this.u),this.Nd.setPosition(e.viewportX,e.viewportY))}).bind(this),0)},su.prototype.Jv=function(){this.Nd&&(this.Nd.l(),this.Nd=null)},su.prototype.wC=function(e){var o=this.Ie.indexOf(e);-1<o&&(e.ea(null),e.Pa(null),this.Ie.splice(o,1),this.G.removeChild(e.A()))},su.prototype.removeBubble=su.prototype.wC,su.prototype.vz=function(){return this.Ie},su.prototype.getBubbles=su.prototype.vz,su.prototype.Pg=function(e,o){if(this.Gj(e))throw Error("A control with name ["+e+"] is already registered.");o.ea(this),o.Pa(this.u),o.uB=this.Bq,o.L(this.qj),o.onUnitSystemChange(this.Qb),this.Gf[e]=o},su.prototype.addControl=su.prototype.Pg,su.prototype.yC=function(e){var o=this.Gj(e);if(o)o.unsubscribe(),o.ea(null),o.Pa(null),Vs(o),delete this.Gf[e];else throw Error("Control ["+e+"] not found in this UI's controls.");return o},su.prototype.removeControl=su.prototype.yC,su.prototype.Gj=function(e){return this.Gf[e]},su.prototype.getControl=su.prototype.Gj,su.prototype.disposeInternal=function(){for(var e in this.Gf)zs.hasOwnProperty.call(this.Gf,e)&&this.Gf[e].l();this.Ie.forEach(function(o){o.l()}),(e=this.G.parentNode)&&e.removeChild(this.G),K.prototype.disposeInternal.call(this),delete this.G};function uu(e,o){var s,h;o.unitSystem&&e.ao(o.unitSystem),(h=o.locale)&&tu(e,h),(s=o.zoom)&&e.Pg("zoom",new Zt(ya(s)?s:null)),(s=o.zoomrectangle)&&e.Pg("zoomrectangle",new fu(ya(s)?s:null)),(s=o.mapsettings)&&e.Pg("mapsettings",new ht(ya(s)?s:null)),(s=o.scalebar)&&e.Pg("scalebar",new Qt(ya(s)?s:null)),(s=o.distancemeasurement)&&e.Pg("distancemeasurement",new It(ya(s)?s:null))}su.prototype.capture=function(e,o,s,h){var d=this.Gj("scalebar"),g=e.getContext("2d"),_=e.width,j=e.height,$=this.u.Xd,_t=5+($?$.A().childNodes[1].offsetHeight:0);d&&d.Vd()?d.capture(o,function(_e){g.drawImage(_e,_-_e.width-5*o,j-_e.height-_t*o),s(e)},h):s(e)},su.prototype.capture=su.prototype.capture,su.createDefault=function(e,o,s){var h=e.Ba.type;if(s=new su(e,{unitSystem:Ht.METRIC,zoom:{alignment:"right-bottom"},mapsettings:vu(h,o,e.oa),scalebar:{alignment:"bottom-right"},locale:s||"en-US"}),h===Rf.P2D){var d=s.Gj("mapsettings"),g=function(){if(d.lc()){var _t=vu(h,o,e.oa);it(d,_t.baseLayers,_t.layers)}};e.addEventListener(e.j.xl,g),s.bc(function(){e.removeEventListener(e.j.xl,g)}),d.bc(function(){e.removeEventListener(e.j.xl,g)})}if(h===Rf.HARP){if(window.H.service){var _=o.vector.traffic.map.D.$.i(),j=new window.H.service.Url(_.oi,_.Qj.split(".").slice(-2).join("."));j=ru(window.H.service.traffic.Service7,{platformBaseUrl:j});var $=j.i().getQuery();$.apikey=_.getQuery().apikey,j.i().Tk($),new cu(s,j)}}else new cu(s);return s},su.prototype.aD=function(){},su.prototype.setTrafficIncidentsHandle=su.prototype.aD;function wu(e,o,s,h){for(var d=e,g=0;d&&g<o.length;g++)d=d[o[g]];if(d&&d!==e)return e={label:s,layer:d},h.push(e),e}function vu(e,o,s){var h=[],d=[],g=o.raster;if(e===Rf.P2D&&g){if(wu(o,["raster","normal","map"],"layers.normal",h),wu(o,["raster","satellite","map"],"layers.satellite",h),wu(o,["raster","terrain","map"],"layers.terrain",h),s){for(var _ in g)if(g[_]&&g[_].map===s){var j=_;break}}wu(o,["raster","normal","trafficincidents"],"layer.incidents",d),wu(o,["raster",j,"transit"],"layer.transit",d)}else wu(o,["vector","normal","map"],"layers.normal",h),e===Rf.WEBGL?(wu(o,["raster","satellite","map"],"layers.satellite",h),wu(o,["vector","normal","traffic"],"layer.traffic",d),wu(o,["vector","normal","trafficincidents"],"layer.incidents",d)):(s=wu(o,["hybrid","day","vector"],"",[]),g=wu(o,["hybrid","day","raster"],"layers.satellite",h),g.layer=[g.layer,s.layer],window.H.service&&(s=o.vector.traffic.map.D.$.i(),o=ru(window.H.service.trafficVectorTile.Service,{baseUrl:s,layer:"flow"}),s=ru(window.H.service.trafficVectorTile.Service,{baseUrl:s,layer:"incident"}),j=ln()+"/harp/oslo/normal.day.json",g=new H.map.render.harp.Style(j),j=new H.map.render.harp.Style(j),o=o.createLayer(g,{engineType:e}),e=s.createLayer(j,{engineType:e}),d.push({label:"layer.traffic",layer:o},{label:"layer.incidents",layer:e})));return{alignment:"bottom-right",baseLayers:h,layers:d}}function xu(e,o){if(o=o||{},!(e&&e instanceof Dk))throw Error("Base layer is mandatory for overview UI element");ct.call(this),this.dr=new Ys({label:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="H_icon"><g fill-rule="evenodd" transform="translate(2 2)"><rect width="9" height="9" x="10" y="10"/><rect class="H_icon_stroke" width="18" height="18" x="1" y="1" fill="none" stroke="#000" stroke-width="2" rx="2"/></g></svg>',onStateChange:A(this.ff,this)}),this.Ra(this.dr),this.$h=new yu(e,o.zoomDelta,o.scaleX,o.scaleY),this.Yc(o.alignment||"right-bottom"),this.Ra(this.$h)}u(xu,ct),t("H.ui.Overview",xu),xu.prototype.Cg=function(e){return this.$h.Cg(e),this},xu.prototype.setBaseLayer=xu.prototype.Cg,xu.prototype.ff=function(e){e.target.getState()===Xs.DOWN?(e=this.$h,zu(e,!0),e.js(),e.Ga(e.Xs),e.u.addEventListener("mapviewchange",e.js,!1,e)):Au(this.$h)},xu.prototype.N=function(e,o){ct.prototype.renderInternal.call(this,e,o),this.dr.A().style.float=this.Ee.match("right")?"right":"left",this.$h.Pa(this.map),this.dr.Fd(this.la().translate("minimap"))},xu.prototype.renderInternal=xu.prototype.N,xu.prototype.disposeInternal=function(){this.$h.l(),Y.prototype.disposeInternal.call(this)};function yu(e,o,s,h){this.oa=e,this.Xs="H_overview_active",typeof o=="number"&&(this.Nx=o),typeof s=="number"&&(this.Yv=s),typeof h=="number"&&(this.Zv=h),Zs.call(this,"div","H_overview")}u(yu,ct),yu.prototype.Cg=function(e){this.ai.Cg(e)},yu.prototype.N=function(e,o){o=Qs(o,"div","H_overview_map"),Rs(e,o),this.Eq=o},yu.prototype.renderInternal=yu.prototype.N,yu.prototype.renderInternal=yu.prototype.N,m=yu.prototype,m.Nx=3,m.Yv=5,m.Zv=5,m.Pa=function(e){this.u=e,this.ai=new U(this.Eq,this.oa,{pixelRatio:this.u.lb(),engineType:this.u.Ba.type}),this.ai.Xd.A().style.display="none",this.Xv=this.ai.wa,this.rv=this.u.wa};function Au(e){!e.jh&&zu(e),e.Bb(e.Xs),e.u.removeEventListener("mapviewchange",e.js,!1,e)}m.js=function(e){e&&e.modifiers&e.SIZE&&zu(this,!0),e=this.rv.Ib(),e.zoom-=this.Nx,this.Xv.Zc(e)};function zu(e,o){var s=e.u.ra.element,h=e.A().style,d=s.offsetWidth/e.Yv/10;s=s.offsetHeight/e.Zv/10;var g=e.Eq.style;o?(h.width=d+"em",h.height=s+"em",g.width=d+"em",g.height=s+"em"):h.width=h.height="0em",e.ai.ra.resize()}m.disposeInternal=function(){yu.g.disposeInternal.call(this),Au(this),this.ai.l(),this.ai=this.Xv=this.rv=this.u=this.oa=this.Eq=null},t("H.ui.buildInfo",function(){return Zm("H-ui","1.57.0","161a2e3",{region:"row"})});function Bu(e,o){this.Wm=[],Bu.g.constructor.apply(this,arguments)}u(Bu,rj),m=Bu.prototype,m.Xt=function(){return this.yb.pe.apply(this.yb,arguments)},m.L=function(e,o,s,h,d,g,_){return this.Wm=[],Bu.g.L.apply(this,arguments)},m.na=1,m.Dw=function(e,o,s,h,d,g){var _=this.na=h.lb();d*=_,g*=_;var j=s.mc();o=j.w*_,j=j.h*_;var $=s.Db;this.Pd?(d-=$.x*_,g-=$.y*_):(d=Ab(d-$.x*_),g=Ab(g-$.y*_)),h.Qe(s.Se(),d,g,o,j),e.detail?e.detail.set(d,g,d+o,g+j):e.detail=new cg(d,g,d+o,g+j),this.Wm.push(e)},m.La=function(e,o,s){for(var h=this.Wm,d=h.length,g,_,j,$=Ae,_t=this.na;d--&&(g=h[d],_=g.detail,!(_.Ql(e,o)&&(g=g.tv,(!(j=g.kc().Am)||j.Bm((e-_.left)/_t,(o-_.top)/_t,0))&&0>$.indexOf(g)&&($===Ae&&($=[]),$.push(g),s)))););return $},m.Eh=function(){return"2d"},m.disposeInternal=function(){this.Wm=[],Bu.g.disposeInternal.call(this)},Bu.prototype.disposeInternal=Bu.prototype.disposeInternal;function Cu(e,o){if(!e)throw new D(Cu,0,e);Cu.g.constructor.call(this,e),this.ew={},this.tj=!(!o||!o.Pd),this.Rj=Du++}u(Cu,qj);var Du=0;Cu.prototype.L=function(e,o,s,h,d,g){var _=Ab(h),j=this.yb,$=_+(s.exp-j.pixelProjection.exp),_t=j.min,_e=j.max;h=j.tileSize;var _r=j.D.Qc,_i=this.Pb,_n=_i.Ue(),_s=_i.mc().w,_l=s.w,Ap=s.x,_h=s.y,_p={};if(_<_t||_>_e)return oj.DONE;for(d=j.requestTiles(e,$,d,g,this.Rj),e=d.total,d=d.tiles,g=d.length,this.le=s,this.SC=o,this.ws=$,_n!==_r&&_i.Ed(_r),s=h=h*_l/(Gb(2,$)*h),this.tj||(h%1&&(h=Bb(h),_l=s/h,Ap/=_l,_h/=_l,_l=Gb(2,$)*h),Ap=Bb(Ap),_h=Bb(_h)),this.DC=s,$=-h,_=_s+h,j=0;j<g;j++){if(_s=d[j],(_t=_s.data)&&_t.tagName){for(s=o.x-(Ap-_s.x*h),_r=o.y-(_h-_s.y*h),_i.Qe(_t,s,_r,h,h),_n=s;(_n-=_l)>$;)_i.Qe(_t,_n,_r,h,h);for(_n=s;(_n+=_l)<_;)_i.Qe(_t,_n,_r,h,h)}_p[this.ws+"_"+_s.x+"_"+_s.y]=_s}return this.ew=_p,g===e?oj.DONE:oj.PENDING},Cu.prototype.La=function(e,o,s){var h=this.DC,d=h/this.yb.tileSize,g=this.le,_=this.SC,j;if(ab(this.ws)&&g){e=g.x+(e-_.x),o=g.y+(o-_.y);var $=Bb(g.w/h),_t=g=Bb(e/h);_=Bb(o/h),Db(_t)>=$&&(_t%=$),0>_t&&(_t=$+_t),($=this.ew[this.ws+"_"+_t+"_"+_])&&$.La&&(j=$.La((e-h*g)/d,(o-h*_)/d,s))}return j||Ae},Cu.prototype.Eh=function(){return"2d"};var Eu={lookAt:{zoom:{min:-8,max:24},tilt:{min:0,max:0},incline:{min:0,max:0},heading:{min:180,max:180}},interaction:{ZOOM:Kj.ZOOM,COORD:Kj.COORD},capture:!0};t("H.map.render.p2d.capabilities",Eu);function Fu(e,o){o=o||{},C(e,bl,Fu,0),Fu.g.constructor.call(this,e),this.Pd=!!o.Pd,this.pC=o.Ab||0,this.tn=[],this.Wv={}}u(Fu,qj),Fu.prototype.L=function(e,o,s,h,d,g){var _,j=this.yb,$;h-=this.pC,this.tn.length=0;var _t=this.Wv;if(this.Wv=_={},h>=j.min&&h<=j.max){var _e=j.wg(e,h,d,g),_r=_e.overlays;if(e=_r.length)for(_r.sort(pi),h=this.Pb,d=this.Pd,g=0;g<e;g++){j=_r[g];var _i=j.C(),_n=s.Gb(_i.Lc()),_s=s.Gb(_i.Jc());_i=s.w,_n.x>=_s.x&&(_n.x-=_i),_i*=-((_n.x+_s.x)/_i>>1),_n.x+=_i,_n.add(o),_s.x+=_i,_s.add(o),d||(_n.round(),_s.round()),(_i=_t[$=j.xb()])?delete _t[$]:_i={lC:j},_[$]=_i;var _l=_n.x;_n=_n.y;var Ap=_s.x;_s=_s.y;var _h=Ap-_l,_p=_s-_n;h.Ed(j.Ue()),h.Qe(j.Se(),_l,_n,_h,_p),_i.details?_i.details.set(_l,_n,Ap,_s):_i.details=new cg(_l,_n,Ap,_s),this.tn.push(_i)}}return!_e||_e.requested&&_e.requested===_e.total||!_e.requested&&_r.length===_e.total?oj.DONE:oj.PENDING},Fu.prototype.La=function(e,o,s){for(var h=this.tn,d=h.length,g,_,j;d--;)if(g=h[d],_=g.details,_.Ql(e,o)){if(g=g.lC,j)j.push(g);else if(j=[g],s)break}return j||Ae},Fu.prototype.Eh=function(){return"2d"},Fu.prototype.disposeInternal=function(){delete this.tn,Fu.g.disposeInternal.call(this)},Fu.prototype.disposeInternal=Fu.prototype.disposeInternal;function Z(e,o,s,h){Z.g.constructor.call(this,e,o,s,h),this.Xb=new F(0,0),(s=h.renderBaseBackground)&&(this.Cw=s.lower,this.Bw=s.higher),this.tj=!!h.enableSubpixelRendering,this.Kg=Gu,this.hv=0,this.xs=this.av=!1,this.ma=new Jj,this.T=h=new ol,this.fg=A(this.fg,this),h.addEventListener(h.j.wo,this.fg),this.Ka=A(this.Ka,this),h=e.element,this.qc=e=h.ownerDocument.createElement("div"),e.style.position="absolute",e.style.width=e.style.height="100%",e.style.zIndex=0,h.insertBefore(e,h.firstChild),this.cl=new tl(this.qc,this.ja),this.Fe=[],this.gq(),this.vg=A(Z.prototype.vg,this),this.o=Hu,this.Qn(),this.zoom=Iu(this,this.De.Ub()+this.Ab),this.yc(),Ju(this,o.Ib().position,this.zoom),this.rb(),this.mg()}u(Z,nk),t("H.map.render.p2d.RenderEngine",Z),Z.prototype.type=vk.P2D;var Hu=2;Z.prototype.getState=function(){return this.o},Z.prototype.getState=Z.prototype.getState,Z.prototype.Ej=function(e,o){return e=o-e,Db(e)<this.pixelProjection.w/2?e:e-this.pixelProjection.w*o/Db(o)},Z.prototype.ar=function(e){var o=this,s=e.animate,h=e.newValue,d=e.modifiers;e=h.position;var g=h.bounds,_,j=this.zoom,$=this.xd,_t=0;if(d&nj.POSITION&&(_=o.pixelProjection.Gb(e)),d&nj.BOUNDS)h=Ku(this,g.C(),d&nj.ZOOM?h.zoom:B,d&nj.POSITION?e:B),this.De.Zc(h,s);else{d&nj.POSITION||(_=o.pixelProjection.Gb(h.position));var _e=_.x,_r=_.y;this.Jg(),this.Xb.set(0,0),h=this.Do(h);var _i=h.zoom,_n=h.position;if(s){var _s=_i-j,_l={x:$.x,y:$.y};s=this.pixelProjection.bi(_l).x;var Ap=this.pixelProjection.projection.Re(e);(Ap.x!==this.xd.x||Ap.y!==this.xd.y||_i!==this.zoom)&&(_e=this.Ej(s,_e),this.ad(function(_h){var _p=_h-_t;if(_i!==j){_=o.pixelProjection.bi(Ap);var ty=o.pixelProjection.bi(_l);_e=o.Ej(ty.x,_.x),_r=_.y-ty.y}_t=_h,o.Sg(_e*_p,_r*_p),j+=_s*_p,o.sb(j),o.rb(),o.ba()},this.vl,function(){Ju(o,_n,_i),o.sb(_i),o.rb(_n),o.ba()},this.wl))}else this.bd(),Ju(this,_n,_i),this.sb(_i),this.rb(_n);this.ba()}},Z.prototype.vl=300,Z.prototype.Wn=function(e){var o=jb(e);if(!o||o&&0>e)throw new D(this.Wn,1,"positive number required");this.vl=e},Z.prototype.setAnimationDuration=Z.prototype.Wn,Z.prototype.zp=function(){return this.vl},Z.prototype.getAnimationDuration=Z.prototype.zp,Z.prototype.wl=wl,Z.prototype.Xn=function(e){if(!Za(e))throw new D(this.Xn,1,"function required");this.wl=e},Z.prototype.setAnimationEase=Z.prototype.Xn,Z.prototype.Ap=function(){return this.wl},Z.prototype.getAnimationEase=Z.prototype.Ap,Z.prototype.Qn=function(){this.wl=wl,this.vl=300},Z.prototype.resetAnimationDefaults=Z.prototype.Qn,m=Z.prototype,m.Uq=function(e,o,s){var h;this.$j=Gj(),(h=this.Zh.ka.splice(e,1)[0])&&h.l&&h.l(),(h=this.Lf.ka.splice(e,1)[0])&&h.l&&h.l(),(h=this.ri.ka.splice(e,1)[0])&&h.l&&h.l(),(h=this.pi.ka.splice(e,1)[0])&&h.l&&h.l(),this.af=this.ib.Sa(),e===0&&(qk(this,o,!1),this.yc()),this.Fe=ul(this.cl,this.Sf(),this.Pf()),this.li(),s||this.ba()},m.gq=function(){var e=this.ib.Sa(),o=0,s=e.length;for([this.Zh={},this.Lf={},this.ri={},this.pi={}].forEach(function(h){h.Pe=[],h.ka=[]}),this.af=this.ib.Sa();o<s;o++)this.pk(o,e[o]);this.yc()},m.Vq=function(){this.yc(),this.ba()},m.hq=function(e,o,s){var h,d,g,_;if(o){var j={Pd:this.tj,Ab:this.Ab};o.L?C(o,Bj)?d=new Dj(o):C(o,xk)&&(_=new Dj(o)):(o.requestOverlays&&(h=new Fu(o,j)),o.requestTiles&&(d=new Cu(o,j)),o.requestMarkers&&(g=new Bu(o,j)),o.requestDomMarkers&&(_=new uj(o,j)))}s=s||0,this.Zh.ka.splice(e,s,h),this.Lf.ka.splice(e,s,d),this.ri.ka.splice(e,s,g),this.pi.ka.splice(e,s,_),this.af=this.ib.Sa(),this.Fe=ul(this.cl,this.Sf(),this.Pf())},m.Pf=function(){var e=[];return e=e.concat(this.Lf.ka),e=e.concat(this.Zh.ka),e=e.concat(this.ri.ka),e=e.concat(this.pi.ka),e=e.filter(ab)},m.Po=function(){return this.o===Hu},m.Do=function(e){var o=rk(this,rk(this,e.zoom)+this.Ab);return e=sk(this,e),e.zoom=o,e};function Ju(e,o,s){var h=e.pixelProjection;h.Va(s),e.xd=h.projection.Re(o),h.x=h.w*e.xd.x,h.y=h.h*e.xd.y}m.Wa=function(e,o){var s=this.ya.center,h=this.ja;return this.pixelProjection.Za((e-s.x)*h,(o-s.y)*h)},Z.prototype.screenToGeo=Z.prototype.Wa,Z.prototype.Un=function(e,o){return e=this.Wa(e,o),o=this.De.Ib(),o.position=e,o},Z.prototype.Ka=function(e){var o=this.ja,s=this.ya.center,h=s.x*o;s=s.y*o,e=this.pixelProjection.Gb(e);var d=this.pixelProjection.w;return new F(Ab((e.x-Ab(e.x/d)*d+h)/o),Ab((e.y+s)/o))},Z.prototype.geoToScreen=Z.prototype.Ka,Z.prototype.C=function(e,o){var s=this.rl[e||4];e=this.pixelProjection;var h=s.left-o,d=e.Za(h,s.top-o),g=s.right+o;return o=e.Za(g,s.bottom+o),g-h>=e.w&&(d.lng=-(o.lng=180)),Zf(d,o)},Z.prototype.La=function(e,o,s,h){var d=[],g=this.ja,_;for(e*=g,o*=g,g=[this.Zh,this.Lf,this.ri,this.pi],_=g.length;_--&&(!s||!d.length);)d=this.Mp(d,g[_].ka,e,o,s);h(d)},Z.prototype.getObjectsAt=Z.prototype.La,m=Z.prototype,m.Mp=function(e,o,s,h,d){for(var g=o.length,_;g--&&!((_=o[g])&&_.La&&(e=e.concat(_.La(s,h,d)),e.length&&d)););return e},m.xe=z,m.Sf=function(){var e=this.rl[2];return{w:e.right-e.left,h:e.bottom-e.top}},m.mg=function(){var e=this.Fe.length,o;Z.g.mg.call(this);var s=this.Sf();this.Xb.set(0,0);var h=s.w;for(o=s.h;e--;){s=this.Fe[e];var d=s.mc();d.w===h&&d.h===o||s.Uk(h,o)}this.xe=new Hi(h,o),this.ba()},m.getCapabilities=function(){return Eu},Z.prototype.getCapabilities=Z.prototype.getCapabilities,m=Z.prototype,m.Lk=function(){this.sa&&this.sa.R||Gj()-this.$j<this.Kg&&!this.ne?this.rh=Ej(this.vg):(this.ne&&(this.li(),this.pj()),this.o=Hu)},m.li=function(){this.Zh.Pe.length=0,this.Lf.Pe.length=0,this.ri.Pe.length=0,this.pi.Pe.length=0},m.vg=function(){var e;this.ef&&this.ef.before();var o=this.Lf.ka,s=this.ya.center.clone().scale(this.ja).round(),h=this.C(1,0),d=this.C(1,Lu),g=this.zoom,_=g-this.Ab,j=this.pixelProjection,$=this.Cw,_t=this.Bw,_e=o[0];o=this.Xb;var _r=this.Fe.length,_i=this.af;for(e=_i.length;_r--;){var _n=this.Fe[_r];C(_n,Aj)&&_n.clear()}if(_e){if($)for(;$;)_r=g-$,_e.L(h,s,j,_r,!0,o),--$;if(_t&&this.xs)for(_n=1;_n<=_t&&(_r=g+_n,j.Va(_r),$=this.C(2,0),j.Va(g),!_e.L($,s,j,_r,!0,o));_n++);}for(this.Kg=Gu;e--;)j=_i[e],C(j,Tf)&&j.D&&j.D.xk(d,_);h=this.Ln(h,s,g,!1,o,Mu,this.Lf,this.Zh),s=this.Ln(d,s,_,!1,o,Nu,this.ri,this.pi),this.ne=h&&s,this.sa&&this.sa.R&&this.Fo(),this.uf||(this.uf=this.De.Ib()),this.uf.bounds=this.C(4,0),this.De.rb(this.uf),this.uf=null,this.xe&&(this.ya.rb(this.xe),this.xe=z),g<this.hv?this.xs=!0:this.av&&(this.xs=!1),this.hv=g,this.av=h,this.ef&&this.ef.after(),this.Lk()},m.Ln=function(e,o,s,h,d,g,_){var j=Array.prototype.slice.call(arguments,6),$=j.length,_t=j[0].ka.length,_e=$*_t,_r=!!_e,_i;for(_i=0;_i<_e;_i++){if(g===Mu)var _n=_i%$,_s=Math.floor(_i/$);else _n=Math.floor(_i/_t),_s=_i%_t;var _l=j[_n].ka[_s];_n=j[_n].Pe,_l&&(_l=_l.L(e,o,this.pixelProjection,s,h,d,this.Ka),_l===oj.ACTIVE&&(this.Kg=1/0),_l!==oj.DONE||_n[_s]||(this.pj(this.af[_s]),_n[_s]=!0),_n[_s]||(_r=!1))}return _r},m.pj=function(e){this.dispatchEvent({type:this.j.Us,target:e||this})},m.disposeInternal=function(){var e=this.ib.Sa()[0],o=this.ya;Fj(this.rh),this.bd(!0),e&&qk(this,e,!1),this.Pf().forEach(function(s){s.l()}),o.element&&o.element.removeChild(this.qc),this.qc=null,this.o=3,Z.g.disposeInternal.call(this)},m.ba=function(){this.$j=Gj(),this.Po()&&(this.ne=!1,this.o=1,this.Lk())},m.zc=function(e,o){this.Sg(e*this.ja,o*this.ja),this.Xb.set(0,0),this.rb(),this.ba()},m.Sg=function(e,o){var s=this.pixelProjection,h=this.xd;s.x=Zb(s.x+e,s.w),s.y=zb(0,yb(s.w,s.y+o)),h.x=s.x/s.w,h.y=s.y/s.h},m.Ng=function(e,o,s){e=rk(this,rk(this,e)+this.Ab),this.sb(e,o,s)},Z.prototype.zoomAt=Z.prototype.Ng,Z.prototype.sb=function(e,o,s){var h=this.ja,d=this.ya.center;o===+o&&s===+s?(o=(o-d.x)*h,s=(s-d.y)*h,this.Xb.set(o,s),this.Sg(o,s),this.pixelProjection.Va(e),this.Sg(-o,-s)):(this.Xb.set(0,0),this.pixelProjection.Va(e)),this.zoom=e,this.rb(),this.ba()};function Ku(e,o,s,h){var d=e.getCapabilities().lookAt.zoom.max,g=o.wb(),_=h||g;if(o.Im()||s&&h)s=s===B?d:s;else{var j=new md(e.pixelProjection.projection);j.Va(d);var $=j.Gb(o.Lc()).round(),_t=j.Gb(o.Jc()).round();d=j.w,o.pc()&&($.x-=d),h?(g=j.Gb(_),o=2*zb(g.x-$.x,_t.x-g.x),$=2*zb(g.y-$.y,_t.y-g.y)):(o=_t.x-$.x,$=_t.y-$.y,_=g),s===B&&(g=e.rl[4],s=g.right-g.left,g=g.bottom-g.top,s=-8+yb(Eb(s/o*d)/Ob,Eb(g/$*d)/Ob)-e.Ab,s=rk(e,s))}return{zoom:Bb(s),position:_}}Z.prototype.Jg=function(){this.bd(!0),this.T.R&&this.hc(!0),this.ma.R&&this.ic(!0),this.bd(!0)},Z.prototype.Id=function(e,o){this.Jg(),this.Rk(o),this.ma.start(e,!!o)},Z.prototype.startInteraction=Z.prototype.Id,Z.prototype.Rk=function(e){if(e){var o={};o.wk=e.power,o.sj=e.ease,o.duration=e.duration,this.ta=o}};function Iu(e,o){return rk(e,rk(e,o-e.Ab)+e.Ab)}Z.prototype.vd=function(e,o,s,h,d){var g=!1;this.ma.R&&(o=this.ma.store(e,o,s,h,d),this.ma.$d(Kj.COORD)&&(e=this.ma.Ah(),0<Ij(e)&&(this.zc(-e.x,-e.y),g=!0)),o&&this.ma.$d(Kj.ZOOM)&&(e=this.ma.im(),o=this.ma.jm(),o=Eb(Gb(2,this.zoom)*o)/Ob,o!==this.zoom&&(o=Iu(this,o),this.sb(o,e.x,e.y),g=!0)),g&&this.ba())},Z.prototype.interaction=Z.prototype.vd,Z.prototype.ic=function(e){var o=this;if(this.ma.R&&!e){if(this.ta){e=this.ma.nc();var s=this.ma.Mf(),h=this.ta.duration,d=(this.ta.wk||1)*e,g=new Fl(-d/(0<h?h:1),d);!E(s.x)&&!E(s.y)&&0<d&&o.ma.$d(Kj.COORD)&&this.ad(function(_){d=g.Hj(_*h),E(d)||o.zc(Ab(-s.x*d),Ab(-s.y*d))},h,void 0,this.ta.sj)}this.ta=null,this.ma.clear()}},Z.prototype.endInteraction=Z.prototype.ic,Z.prototype.Hd=function(e,o,s){this.Jg(),this.T.start(o,s),this.Rk(e)},Z.prototype.startControl=Z.prototype.Hd,Z.prototype.control=function(e,o,s){if(E(+s))throw new D(this.control,2,s);if(E(e))throw new D(this.control,0,e);if(E(o))throw new D(this.control,1,o);this.T.R&&this.T.set(e,o,s,0,0,0)},Z.prototype.control=Z.prototype.control,Z.prototype.hc=function(e,o){var s=this,h;if(this.T.R){this.bd(!0);var d=Gj(),g=d-this.jj;if(1<=g){var _=rl(this.T);this.Qi(_,g)}if(!this.ta||e||o)typeof o=="function"&&(e=this.Ib(),e.zoom=this.zoom-this.Ab,o(e),e.zoom+=this.Ab,this.Go(e));else{o=this.T.nc();var j=this.T.Mf(),$=this.ta.duration,_t=(this.ta.wk||1)*o,_e=new Fl(-_t/(0<$?$:1),_t);!E(j.Lb)&&!E(j.Mb)&&0<_t&&this.ad(function(_r,_i,_n,_s){d&&(_n=_s-d,d=0),_t=_e.Hj(_r*$)*_n,E(_t)||((h=j.Nb*_t)&&s.sb(Iu(s,s.zoom+h),s.T.Ug,s.T.Vg),s.zc(Ab(j.Lb*_t),Ab(j.Mb*_t)))},$,void 0,this.ta.sj)}this.T.reset()}},Z.prototype.endControl=Z.prototype.hc,m=Z.prototype,m.Go=function(e){var o=this,s=this.xd,h=this.pixelProjection.projection.Re(e.position),d=this.pixelProjection.bi(h),g=d.y;d=d.x;var _=e.zoom;s=this.pixelProjection.bi(s),e=s.y;var j=s.x;s=this.zoom;var $=this.T.nc(),_t=this.T.Ug,_e=this.T.Vg,_r=0;if(d=this.Ej(j,d),d-=j,g-=e,s=_-s,e=Fb(d*d+g*g+s*s),$!==0&&e!==0){var _i=d/e,_n=g/e,_s=s/e,_l=$*$/(2*e);this.ad(function(Ap,_h){var _p;Ap!==1?(Ap=$*_h-_l*_h*_h/2,_h=Ap-_r,(_p=_s*_h)&&(_p=Iu(o,o.zoom+_p),o.sb(Iu(o,_p),_t,_e)),o.zc(Ab(_i*_h),Ab(_n*_h)),_r=Ap):(o.xd=h,o.sb(Iu(o,_),_t,_e),o.rb(),o.ba())},2*e/$)}},m.fg=function(e){var o=this,s=e.mt;this.Xb.set(0,0),s.Lb||s.Mb||s.Nb?(this.jj=Gj(),this.ad(function(h,d,g,_){o.jj=_,o.Qi(s,g)},Number.POSITIVE_INFINITY),this.ba()):this.bd(!0)},m.Qi=function(e,o){o=o||0,e.Nb&&this.sb(Iu(this,this.zoom+e.Nb*o),this.T.atX,this.T.atY),this.zc(e.Lb*o,e.Mb*o)},m.ad=function(e,o,s,h){this.sa&&this.sa.R&&this.sa.stop(!0),this.sa=new El(this,e,o,s,h),this.sa.start()},m.bd=function(e){this.sa&&this.sa.R&&this.sa.stop(e)},m.kp=function(){},Z.prototype.enter=Z.prototype.kp,Z.prototype.pp=function(e){pk(this.qc,e)},Z.prototype.exit=Z.prototype.pp,Z.prototype.capture=function(e,o,s,h){var d=this.qc.ownerDocument.createElement("canvas"),g=d.getContext("2d"),_=this.ja;for(d.width=(s-e)*_,d.height=(h-o)*_,s=0;s<this.Fe.length;s++)h=this.Fe[s],C(h,Aj)&&g.drawImage(h.A(),-e*_,-o*_);return Rd(d)};var Nu=0,Mu=1,Gu=1e3,Lu=256;function Ou(e){var o;if(e)for(Pu={},o=e.length;o--;)Pu[e[o]]=!0;this.hx={}}var Qu,Pu={};Ou.prototype.parse=function(e,o,s){var h,d,g,_,j;Qu=!1;try{s=JSON.parse(s)}catch{Qu=!0}if(s&&(h=s.metadata)){var $={spatials:[]};for(d in h)if((s=!Pu[d]&&(g=Ru[d]))&&((_=h[d])||(Qu=!0,_=void 0),s=_),s)for(s=_.length;s--;){var _t;(_t=_[s])||(Qu=!0,_t=void 0),(j=_t)&&g(o,e,this,d,j,$)}}else Qu=!0;return Qu?void 0:$},Ou.prototype.parse=Ou.prototype.parse;var Ru={"street labels":function(e,o,s,h,d,g){var _;if((_=d.vertices)||(Qu=!0,_=void 0),_){var j,$=_.length,_t;if((_t=0<$)||(Qu=!0,_t=void 0),_t)for(j=Array($/2);$;){var _e=_[--$];_t=_[--$],j[$/2]=new F(_t,_e)}j=j?{Rc:[j]}:B,$=+d["font size"]/e.lb(),_=s.hx[$],_||(Su.lineWidth=$,_=s.hx[$]=s.gh.fu(Su)),Tu(e,o,j,!1,_,d,h,g)}delete d.vertices},"city center labels":function(e,o,s,h,d,g){Tu(e,o,Uu(d,new Xh([])),!0,s.gh,d,h,g)},labels:function(e,o,s,h,d,g){var _;if((_=d["bounding boxes"])||(Qu=!0,_=void 0),_){for(var j=_.length,$=new Xh([]),_t;j--;){var _e;(_e=_[j])||(Qu=!0,_e=void 0),(_t=_e)&&Uu(_t,$)}Tu(e,o,$,!0,s.gh,d,h,g)}delete d["bounding boxes"]},buildings:function(e,o,s,h,d,g){var _=d.id,j=o.Jn[_],$,_t,_e,_r=[],_i=[];if(($=d)||(Qu=!0,$=void 0),$&&((_t=$.vertices)||(Qu=!0,_t=void 0),_t)){var _n;(_n=$.polygons)||(Qu=!0,_n=void 0),(_e=_n)&&_r.push.apply(_r,Vu(_t,_e)),($=$.outlines)||(Qu=!0,$=void 0),(_e=$)&&_i.push.apply(_i,Vu(_t,_e))}_e=_r.length,_r.push.apply(_r,_i),_i=new Xh(_r,Wb,_e),(_r=_r.length)||(Qu=!0,_r=void 0),_r&&(j?(Ep(j,e,[_i]),g.spatials.push(j)):(j=Tu(e,o,_i,!0,s.gh,d,h,g,_),o.Y(j)))}};Ru["transit stops"]=Ru.POIs=Ru.labels;var Wu=["box 2","box 1","annotation box","icon box"];function Uu(e,o){for(var s=Wu.length,h,d;s--;)if(h=Wu[s],d=e[h]){var g=d[0],_=d[1],j=d[2];d=d[3],o.Rc.push([new F(g,_),new F(g+j,_),new F(g+j,_+d),new F(g,_+d)]),delete e[h]}return o}function Vu(e,o){var s=o.length,h,d,g;if(0<s){for(d=Array(s);s--;)if((h=o[s])||(Qu=!0,h=void 0),h){var _=h.length;if(0<_)for(d[s]=g=Array(_);_--;){var j=2*h[_];g[_]=new F(e[j],e[j+1])}}}return d||[]}var Xu={};function Tu(e,o,s,h,d,g,_,j,$){return Xu.style=d,h=new zp(o,h,$,Xu),s&&Ep(h,e,[s]),Yu(g),g.category=_,h.setData(g),j.spatials.push(h),h.ea(o),h}Ou.prototype.gh=new $h({strokeColor:"transparent",fillColor:"transparent",lineWidth:0});var Su={};function Yu(e){var o,s=!1;switch(typeof e){case"object":if(e instanceof Array)for(o=e.length;o--;)Yu(e[o])?s=!0:delete e[o];else if(e)for(o in e)Yu(e[o])?s=!0:delete e[o];break;case"number":s=!0;break;default:s=!!e}return s}function Zu(e,o,s){s=s||{},o=o||{};var h=s.tileType||"maptile",d=s.scheme||"normal.day";if(R.call(this,{min:0,max:20}),o.pois===!0&&(o.pois="!F"),this.Fa=o,!(e&&e instanceof $u))throw Error("InvalidArgument: service required");this.$=e,this.Be=A(this.Be,this),this.$.addEventListener("versionupdate",this.Be),this.kd=e.i().clone().v(h+"/"+e.fb+"/"+d).B(av).B(o),this.$c=e.$c||null,this.na=s.pixelRatio||s.pixelratio||le(),this.tileSize=s.tileSize||256,this.tileType=h,this.scheme=d,this.vs=0,this.Ad=new rp(new Ou(s.categoryFilter)),this.Ad.ea(this),this.ge=A(this.ge,this),this.Ad.addEventListener("update",this.ge),this.Xe=!1,R.call(this,{min:0,max:20}),this.Yn(new Ri(s.tileCacheSize||256,A(this.je,this)))}u(Zu,R),t("H.service.metaInfo.TileProvider",Zu),Zu.prototype.je=function(e,o){e=o.bb();for(var s=e.length,h;s--;)h=e[s],delete h.Fk[o.key],h.release();o.data&&(oo.push(o.Hn(),this.tileSize),o.In())},Zu.prototype.ge=function(){this.dispatchEvent("update")},Zu.prototype.s=function(e,o,s,h,d){var g=this.kd.clone(),_=this.$c,j=this.tileSize,$=this.getTileKey(e,o,s);$=this.Sb().get($);var _t;if($&&!$.Ih()){h(oo.pop(this.tileSize),null);var _e={cancel:function(){}}}else{_&&g.Ha(_[(s+o+e)%_.length]),g.v(s+"/"+e+"/"+o+"/"+j+"/png8");var _r=mo.setTimeout(function(){_t=new Ue("text/plain",g.toString()),_t.then(function(_i){h(null,_i)},d)},500)}return this.Xe||(ko(Zu,"Use HERE Vector Tile API or Raster Tile API v3 instead."),this.Xe=!0),_e||{cancel:function(){_t?_t.cancel():mo.clearTimeout(_r)}}},Zu.prototype.requestInternal=Zu.prototype.s,Zu.prototype.nd=function(e,o,s,h,d){var g=this.Ad,_=h||oo.pop(this.tileSize);if(h)e=this.Sb().get(this.getTileKey(e,o,s)),e.L(h);else if(h=e=new Ok(this.Ud(e,o,s),e,o,s,this.tileSize,this.na,s+this.vs,g),delete h.Ji,h.ul=d,e.L(_))for(d=e.bb(),_=d.length;_--;)d[_].Sn();else oo.push(_,this.tileSize);return e},Zu.prototype.createTileInternal=Zu.prototype.nd,Zu.prototype.l=function(){this.Ad.l(),this.$.removeEventListener("versionupdate",this.Be),R.prototype.l.call(this)},Zu.prototype.dispose=Zu.prototype.l,Zu.prototype.Be=function(){var e=this.$;this.kd=e.i().clone().v(this.tileType+"/"+e.fb+"/"+this.scheme).B(av).B(this.Fa),this.reload(!1)};var av={metadata:"metaonly",mgen:"2"};function $u(e){$u.g.constructor.call(this,$u,e),e=qo(this,e),this.$c=e.shards,(this.Qa=e.ignoreTypes?null:e.type)&&this.i().Ha(this.Qa),this.fb=e.version,this.pr={},this.ec=new lp,this.fb==="newest"&&this.rp()}u($u,po),t("H.service.metaInfo.Service",$u),$u.prototype.Ca=function(){return{type:"base",version:"newest",subDomain:"maps.ls",path:"maptile/2.1",shards:["1","2","3","4"]}},$u.CONFIG_KEY="metaInfo";function bv(e,o){for(var s={},h=e[o+"s"][o],d=h.length;d--;)s[h[d].id]=h[d];e[o+"s"]=s}$u.prototype.uu=function(){return this.Qa},$u.prototype.Wp=function(){return this.fb},$u.prototype.getVersion=$u.prototype.Wp,$u.prototype.cs=function(e){this.fb=e},$u.prototype.U=function(){return this.ec},$u.prototype.getCopyrights=$u.prototype.U,$u.prototype.ss=function(e){e=e.response;var o;if(bv(e,"map"),bv(e,"scheme"),bv(e,"tiletype"),bv(e,"format"),bv(e,"resolution"),bv(e,"language"),this.fb==="newest"&&this.Qa!=="traffic")for(o in e.maps)e.maps[o].hash&&e.maps[o].newest&&(this.cs(e.maps[o].hash),this.dispatchEvent("versionupdate"));this.fq=e,this.dispatchEvent("infoupdate")},$u.prototype.rp=function(){var e=this,o=this.i().clone().v("info").B({output:"json"});this.$c&&o.Ha(this.$c[0]),this.s(o,function(s){e.ss(s)},function(s){throw s})},$u.prototype.Kj=function(){return this.fq},$u.prototype.getInfo=$u.prototype.Kj,$u.prototype.nj=function(e,o,s,h,d,g){return new Zu(this,h,{tileSize:e,pixelRatio:o,categoryFilter:s,tileType:d,scheme:g})},$u.prototype.createTileProvider=$u.prototype.nj,$u.prototype.Od=function(e,o,s,h,d,g){return new Dk(this.nj(e,o,s,h,d,g))},$u.prototype.createTileLayer=$u.prototype.Od,X.prototype.lu=function(e){return this.Ta($u,e)},X.prototype.getMetaInfoService=X.prototype.lu,function(){var e=X.prototype.createDefaultLayers;X.prototype.createDefaultLayers=function(o,s,h,d,g,_){var j=e.call(this,o,s,h,d,g,_),$={},_t=this.lu();typeof o=="object"&&(_=o,o=_.tileSize,s=_.ppi,h=_.lg,d=_.lg2,g=_.style,_=_.pois),o=o||256;var _e=s===320?2:1;if(0>[72,250,320,500].indexOf(+s)){if(s!==B)throw new D(this.Xl,1,s)}else $.ppi=+s;return h&&($.lg=h),d&&($.lg2=d),g&&($.style=g),_&&($.pois=_),j.raster.normal.metaInfo=_t.Od(o,_e,["buildings"],$),j}}(),H.__bootstrap__=`/*

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var l;function ba(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");}var ca=ba(this);function da(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}
var ea="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};function fa(a,b){if(b)a:{var c=ca;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&ea(c,a,{configurable:!0,writable:!0,value:b})}}
fa("Symbol",function(a){function b(f){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new c(d+(f||"")+"_"+e++,f)}function c(f,g){this.fc=f;ea(this,"description",{configurable:!0,writable:!0,value:g})}if(a)return a;c.prototype.toString=function(){return this.fc};var d="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",e=0;return b});
fa("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=ca[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&ea(d.prototype,a,{configurable:!0,writable:!0,value:function(){return ha(da(this))}})}return a});function ha(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}
function ka(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e}fa("Array.prototype.keys",function(a){return a?a:function(){return ka(this,function(b){return b})}});var la;
if("function"==typeof Object.setPrototypeOf)la=Object.setPrototypeOf;else{var ma;a:{var na={a:!0},oa={};try{oa.__proto__=na;ma=oa.a;break a}catch(a){}ma=!1}la=ma?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var pa=la;fa("Object.setPrototypeOf",function(a){return a||pa});var p=this||self;
function qa(a,b,c,d){a=a.split(".");d=d||p;a[0]in d||"undefined"==typeof d.execScript||d.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)if(a.length||void 0===b)d=d[e]&&d[e]!==Object.prototype[e]?d[e]:d[e]={};else if(!c&&ra(b)&&ra(d[e]))for(var f in b)b.hasOwnProperty(f)&&(d[e][f]=b[f]);else d[e]=b}function sa(){}function ta(a){var b=typeof a;return"object"!=b?b:a?Array.isArray(a)?"array":b:"null"}function ra(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}
function ua(a){return Object.prototype.hasOwnProperty.call(a,ya)&&a[ya]||(a[ya]=++za)}var ya="closure_uid_"+(1E9*Math.random()>>>0),za=0;function Aa(a,b,c){return a.call.apply(a.bind,arguments)}function Ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var e=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(e,d);return a.apply(b,e)}}return function(){return a.apply(b,arguments)}}
function Ca(a,b,c){Ca=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Aa:Ba;return Ca.apply(null,arguments)}function Da(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var d=c.slice();d.push.apply(d,arguments);return a.apply(this,d)}}function r(a,b){qa(a,b,!0,void 0)}
function Fa(a,b){function c(){}c.prototype=b.prototype;a.Z=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Cd=function(d,e,f){for(var g=Array(arguments.length-2),h=2;h<arguments.length;h++)g[h-2]=arguments[h];return b.prototype[e].apply(d,g)}};function Ga(a){if(Error.captureStackTrace)Error.captureStackTrace(this,Ga);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}Fa(Ga,Error);Ga.prototype.name="CustomError";var Ha=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"===typeof a)return"string"!==typeof b||1!=b.length?-1:a.indexOf(b,0);for(var c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};function Ia(){var a=Ja,b;for(b in a)return!1;return!0}function Ka(a){var b={},c;for(c in a)b[c]=a[c];return b}var La="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ma(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<La.length;f++)c=La[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var Na=this;var Oa=Ca,Pa=String,Qa=Na.Object.freeze||function(a){return a},t=[].pop(),Ra=/x/.exec("");function Sa(a){return Pa(a).split(","!==t?",":" ")}var Ta="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ua(a,b,c,d){if(!(b=a instanceof b)&&c)throw new x(c,d,void 0!==t?void 0:a);return b}function Va(a){return"function"==ta(a)}function Wa(a,b,c,d){var e;if(!(e="Array"===Xa(a))&&b)throw new x(b,c,d!==t?d:a);return e}
r("H.lang.isArray",function(a,b,c,d){return Wa(a,b,c,d)});function Ya(a){return"string"===typeof a}r("H.lang.isString",Ya);var $a=isNaN;function ab(a){return a===+a}r("H.lang.isNumber",ab);r("H.lang.isInteger",Number.isInteger?Number.isInteger:function(a){return"number"===typeof a&&0===a%1});function Xa(a){var b=Object[Ta[0]][Ta[6]].call(a).match(/^\\[object (\\w+)\\]$/);return b?b[1]:typeof a}var bb=[];0>bb.indexOf(bb)&&bb.push(bb);
function cb(a,b,c,d){var e="",f=2>arguments.length,g;f&&(b={H:Na.H},c="",d=bb.slice());db(b,!0,function(h,k){try{if(g=h[k],k=eb(h,g),!(ra(g)&&g.window===g&&g.self===g||ra(g)&&0<g.nodeType&&Va(g.cloneNode))&&ra(g)){if(g===a)return e=c+"."+k,!0;if(0>d.indexOf(g)&&(d.push(g),e=cb(a,g,c+"."+k,d)))return!0}}catch(m){}});f&&(e=e?e.substr(1).replace("."+Ta[0]+".","#"):"~"+(Va(a)?fb(a)+"()":Xa(a)));return e}
function eb(a,b){var c=[];db(a,!1,function(d,e){d[e]===b&&c.push(e)});return c.sort(gb)[0]}function gb(a,b){return b.length-a.length}var hb=Object[Ta[0]][Ta[2]];function db(a,b,c){var d;if(a){for(e in a)if((!b||hb.call(a,e))&&c(a,e,!0))return;for(d=Ta.length;d--;){var e=Ta[d];if((!b||hb.call(a,e))&&c(a,e,!1))break}}}function fb(a){return(a=/^\\s*function ([^\\( ]+)/.exec(a))?a[1]:"anonymous"}function ib(a,b,c){c[b]="#"+b}
function x(a,b,c){var d=arguments.length;b=b!==t?+b:b;if(b!==t){var e=(e=/^.*?\\(([^\\)]+)/.exec((""+a).replace(/(\\/\\*([\\s\\S]*?)\\*\\/)|(\\/\\/(.*)$)/gm,"")))?Sa(e[1].replace(/\\s+/g,"")):[];e.forEach(ib);e=e[b]||"#"+b}var f=a?cb(a):"";d=2<d?Pa(c):"";if(e||d)f+=" (Argument "+(e||"")+(d?" "+d:"")+")";d=Error(f);Object.setPrototypeOf(d,x.prototype);return d}Fa(x,Error);r("H.lang.InvalidArgumentError",x);x.prototype.name="InvalidArgumentError";
function jb(a,b){var c=[];a&&c.push(cb(a));1<arguments.length&&c.push(""+b);c=Error(c.join(" "));Object.setPrototypeOf(c,jb.prototype);return c}Fa(jb,Error);r("H.lang.IllegalOperationError",jb);jb.prototype.name="IllegalOperationError";var kb={};function lb(a){try{importScripts.apply(self,arguments)}catch(b){this.postError("invalid_script")}}function mb(a){delete kb[a];this.postMessage(a)}function nb(a,b,c){if(Va(b))var d=b;else try{d=self.eval("("+b+")"),Va(d)||(d=null)}catch(e){}d?(kb[a]=d,c||this.postMessage(a)):this.postError("invalid_processor")}function ob(a){this.Wb=a&&a[0];this.Ua=a&&a[1];this.kc=a&&a[2]||[]}ob.prototype.postError=function(a){this.postMessage(a,t,0)};
ob.prototype.postMessage=function(a,b,c){self.postMessage({processor:this.Wb,taskId:this.Ua,type:c===t?1:c,data:a},b||t)};var y=Math,pb=y.min,qb=y.max,rb=y.round,sb=y.floor,tb=y.ceil,ub=y.abs,vb=y.log,wb=y.sqrt,z=y.pow,xb=y.exp,yb=y.sin,zb=y.asin,Ab=y.cos,Cb=y.tan,Db=y.atan,Eb=y.atan2,Fb=y.LN2,A=y.PI,Gb=A/2,Hb=A/4,Ib=2*A,Jb=3*A,Kb=A/180,Lb=180/A,Mb=1/0;function Nb(a,b){var c;return 0>(c=a%b)===0>b?c:c+b}r("H.math.normalize",function(a,b,c){b-=c=c||0;a-=c;return a-sb(a/b)*b+c});function Ob(a,b,c){return(a-=0)>c?c:a<b?b:a}r("H.math.clamp",Ob);
function Pb(a,b,c){var d=0;(d-=0)||(d=0);return b<c?a>=b-d&&a<=c+d:a>=c-d&&a<=b+d}var Qb={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};r("H.math.CoverType",Qb);
function Rb(a,b,c){for(var d=c.length,e=d,f,g,h,k,m=c[0],n=0,q=0,u=0;1!=n&&1<e;){e-=0;g=c[--e];f=c[--e];k=c[e?e-0-1:(d+(e-0-1))%d];h=c[e?e-0-2:(d+(e-0-2))%d];if(f>=a-0&&f<=a+0&&g>=b-0&&g<=b+0||h>=a-0&&h<=a+0&&k>=b-0&&k<=b+0)n=1;else if(!n&&f===a)h===a&&(g<b&&k>b||g>b&&k<b)||(m<=a&&h>a||m>=a&&h<a)&&(g>=b?++q:++u),n=Pb(b,g,k)&&0>=wb(z((a-h)*(g-k)-(b-k)*(f-h),2)/(z(f-h,2)+z(g-k,2)))?2:0;else if(!n&&Pb(a,f,h)){if(f<a&&h>a||f>a&&h<a)m=g+(a-f)/(h-f)*(k-g),q+=m>b,u+=m<b;n=Pb(b,g,k)&&0>=wb(z((a-h)*(g-k)-
(b-k)*(f-h),2)/(z(f-h,2)+z(g-k,2)))?2:0}m=f}!n&&0!==u&&0!==q%2&&(n=3);return n}function Sb(a,b){return Rb(a.x,a.y,b)!==Qb.NONE}r("H.math.isPointInsidePolygon",Sb);function Tb(a){for(var b=a.length,c=new Float64Array(2*b),d=b&&a[0].x!==t;b--;){var e=a[b],f=b<<1;c[f]=d?e.x:e[0];c[f+1]=d?e.y:e[1]}return c}r("H.math.flatten",Tb);function B(a,b){this.x=+a;this.y=+b}r("H.math.Point",B);B.prototype.set=B;B.prototype.set=B.prototype.set;B.prototype.clone=function(a){a?(a.x=this.x,a.y=this.y):a=new B(this.x,this.y);return a};B.prototype.clone=B.prototype.clone;B.prototype.add=function(a){this.x+=a.x;this.y+=a.y;return this};B.prototype.add=B.prototype.add;B.prototype.sub=function(a){this.x-=a.x;this.y-=a.y;return this};B.prototype.sub=B.prototype.sub;B.prototype.scale=function(a,b){this.x*=a;this.y*=void 0===b?a:b;return this};
B.prototype.scale=B.prototype.scale;B.prototype.round=function(){this.x=rb(this.x);this.y=rb(this.y);return this};B.prototype.round=B.prototype.round;B.prototype.floor=function(){this.x=sb(this.x);this.y=sb(this.y);return this};B.prototype.floor=B.prototype.floor;B.prototype.ceil=function(){this.x=tb(this.x);this.y=tb(this.y);return this};B.prototype.ceil=B.prototype.ceil;B.prototype.S=function(a){return!(!a||this.x!==a.x||this.y!==a.y)};B.prototype.equals=B.prototype.S;
B.prototype.Kc=function(a,b){var c=b.x-a.x,d=b.y-a.y;var e=a;if(c||d)e=((this.x-a.x)*c+(this.y-a.y)*d)/(c*c+d*d),e=0>=e?a:1<=e?b:new B(a.x+e*c,a.y+e*d);return e};B.prototype.getNearest=B.prototype.Kc;B.prototype.eb=function(a){return wb(z(this.x-a.x,2)+z(this.y-a.y,2))};B.prototype.distance=B.prototype.eb;B.fromIPoint=function(a){if(!a)throw Error("invalid argument");return a instanceof B?a:new B(a.x,a.y)};function Ub(a,b,c){var d=a[b];a=a[b+1];this.Pb=[];this.Eb=0;this.oc=b;this.mc=[a-c,d-c,a+c,d+c]}Ub.prototype.Ia=function(a,b){var c=a[b];a=a[b+1];b=this.mc;return b[1]<=c&&c<=b[3]&&b[0]<=a&&a<=b[2]};Ub.prototype.T=function(){return this.oc};function Vb(a,b,c){var d=Ob(+a,-90,90);if(b&&$a(d))throw new x(b,c,a);return d}function Wb(a,b,c){var d=+a;if(-180>d||180<d)d=Nb(d+180,360)-180;if(b&&$a(d))throw new x(b,c,a);return d}function Xb(a,b,c){var d;if(a!==t&&$a(d=+a)&&b)throw new x(b,c,a);return d}r("H.geo.isDBC",function(a,b){return 0>a!==0>b&&180<ub(b-a)});function C(){var a=C;if(!0===(Ua(this,a)&&this.constructor===a))throw new TypeError("Illegal constructor "+cb(a));}r("H.geo.AbstractGeometry",C);C.prototype.getBoundingBox=C.prototype.pa;C.prototype.equals=C.prototype.S;C.prototype.Xa="";C.prototype.kb="";C.prototype.toString=function(){return this.dc([this.Xa.toUpperCase()," "]).join("")};C.prototype.toString=C.prototype.toString;C.prototype.sd=function(){return{type:this.kb,coordinates:this.cc()}};C.prototype.toGeoJSON=C.prototype.sd;
C.prototype.ib=function(){return{type:this.Xa,coordinates:this.jb(),boundingBox:this.pa().ib()}};C.prototype.forWorkerMessage=C.prototype.ib;function D(a,b,c){this.lat=Vb(a,D,0);this.lng=Wb(b,D,1);c!==t&&(this.alt=Xb(c,D,2))}Fa(D,C);r("H.geo.Point",D);D.prototype.S=function(a){return this===a||!!a&&this.lat===a.lat&&this.lng===a.lng&&(this.alt||0)===(a.alt||0)};D.prototype.equals=D.prototype.S;D.prototype.eb=function(a){if(this===a||this.lat===a.lat&&this.lng===a.lng)a=0;else{var b=this.lat*Kb;var c=a.lat*Kb;a=1.274200158E7*zb(pb(1,wb(z(yb((b-c)/2),2)+Ab(b)*Ab(c)*z(yb((this.lng*Kb-a.lng*Kb)/2),2))))}return a};
D.prototype.distance=D.prototype.eb;
D.prototype.vd=function(a,b,c){var d;if(c){if(d=b/6371000.79){b=a*Kb;a=Kb*this.lat;var e=yb(a);c=yb(d);var f=Ab(d);d=Kb*this.lng;var g=Ab(a);a=zb(g*Ab(b)*c+e*f);b=Eb(yb(b)*g*c,f-e*yb(a));b=(d+b+A)%(2*A)-A;b*=Lb;e=new D(a*Lb,(b+540)%360-180)}return e||this}a=(a%360+360)%360;if(0===(a+90)%180)return a=this.lng+b/(6371000.79*Ib*Ab(this.lat*Kb))*(270===a?-360:360),new D(this.lat,(a+540)%360-180);if(b/=6371000.79)a*=Kb,e=this.lat*Kb,c=this.lng*Kb,d=e+b*Ab(a),f=d-e,g=vb(Cb(d/2+Hb)/Cb(e/2+Hb)),g=$a(f/g)?
Ab(e):f/g,a=b*yb(a)/g,ub(d)>Gb&&(d=0<d?A-d:-(A+d)),d=new D(d*Lb,((c+a+Jb+(ub(e+f)>Gb?A:0))%Ib-A)*Lb);return d||this};D.prototype.walk=D.prototype.vd;D.prototype.pa=function(){return new E(this.lat,this.lng,this.lat,this.lng)};D.prototype.getBoundingBox=D.prototype.pa;function Yb(a,b,c){var d=ra(a)&&!($a(a.lat=Vb(a.lat))||$a(a.lng=Wb(a.lng))||a.alt!==t&&$a(a.alt=Xb(a.alt)));if(!d&&b)throw new x(b,c,a);return d}D.validate=Yb;function Zb(a){if(!a)throw new x(Zb,0,a);return new D(a.lat,a.lng,a.alt)}
D.fromIPoint=Zb;l=D.prototype;l.Xa="Point";l.dc=function(a){a.push("(",this.lng," ",this.lat,")");return a};l.kb="Point";l.cc=function(){return[this.lng,this.lat,this.alt||0]};l.jb=function(){return[this.lat,this.lng,this.alt||0]};function $b(){}function ac(a){return pb(1,qb(0,.5-vb(Cb(Hb+Gb*a/180))/A/2))}$b.prototype.Oa=function(a,b,c){c?(c.x=b/360+.5,c.y=ac(a)):c=new B(b/360+.5,ac(a));return c};$b.prototype.latLngToPoint=$b.prototype.Oa;$b.prototype.Ac=function(a,b){return this.Oa(a.lat,a.lng,b)};$b.prototype.geoToPoint=$b.prototype.Ac;function bc(a){return 0>=a?90:1<=a?-90:Lb*(2*Db(xb(A*(1-2*a)))-Gb)}
$b.prototype.ka=function(a,b,c){c?(c.lat=bc(b),c.lng=360*(1===a?1:Nb(a,1))-180):c=new D(bc(b),360*(1===a?1:Nb(a,1))-180);return c};$b.prototype.xyToGeo=$b.prototype.ka;$b.prototype.ed=function(a,b){return this.ka(a.x,a.y,b)};$b.prototype.pointToGeo=$b.prototype.ed;var cc=new $b;r("H.geo.mercator",cc);r("H.util.constants.DEFAULT_MIN_ZOOM_LEVEL",0);r("H.util.constants.DEFAULT_MAX_ZOOM_LEVEL",22);function G(a,b){this.projection=a||cc;this.ec=0;this.Da=this.exp=vb(b||256)/Fb;dc(this);this.y=this.x=0}r("H.geo.PixelProjection",G);var ec=ub(24)+ub(-8);G.prototype.hd=cc;G.prototype.projection=G.prototype.hd;G.prototype.x=0;G.prototype.x=G.prototype.x;G.prototype.y=0;G.prototype.y=G.prototype.y;G.prototype.w=z(2,ec);G.prototype.w=G.prototype.w;G.prototype.Rc=z(2,ec);G.prototype.h=G.prototype.Rc;
G.prototype.Aa=function(a){if($a(a))throw new x(this.Aa,0,a);var b=this.x/this.w;var c=this.y/this.h;this.ec=a;this.Da=this.exp+a;dc(this);this.x=b*this.w;this.y=c*this.h};G.prototype.rescale=G.prototype.Aa;function dc(a){a.Da>ec&&(a.Da=ec);a.w=z(2,a.Da);a.h=z(2,a.Da)}G.prototype.Ob=function(){return this.ec||0};G.prototype.getZoomScale=G.prototype.Ob;G.prototype.zc=function(a,b){a=this.projection.Oa(a.lat,a.lng,b);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};G.prototype.geoToPixel=G.prototype.zc;
G.prototype.xb=function(a,b){return this.projection.ka((a.x+this.x)/this.w,(a.y+this.y)/this.h,b)};G.prototype.pixelToGeo=G.prototype.xb;G.prototype.ka=function(a,b,c){return this.projection.ka((a+this.x)/this.w,(b+this.y)/this.h,c)};G.prototype.xyToGeo=G.prototype.ka;G.prototype.sb=function(a,b,c){a=this.projection.Oa(a,b,c);a.x=a.x*this.w-this.x;a.y=a.y*this.h-this.y;return a};G.prototype.latLngToPixel=G.prototype.sb;G.prototype.fd=function(a){return new B(a.x*this.w-this.x,a.y*this.h-this.y)};
G.prototype.pointToPixel=G.prototype.fd;var fc=new B(0,0);function gc(a,b,c,d,e){d[e]=b;d[e+1]=a}var hc=new G;function ic(a,b,c,d,e){hc.sb(a,b,fc);d[e]=fc.x;d[e+1]=fc.y}
r("H.clustering.dynamicgrid.worker",function(a,b,c,d,e){var f=e?gc:ic,g=0;e=!!self.ArrayBuffer;var h=a.byteLength?new Float64Array(a):a,k=h.length/3;a=[];var m=[],n=[],q=e?new Float64Array(2*k):[];k=0;var u=0;for(hc.Aa(d);g<h.length;){var I=h[g++];var K=h[g++];var w=h[g++];f(w,K,d,q,u);for(w=a.length;w--;)if(K=a[w],K.Ia(q,u)){var F=K;break}F||(F=new Ub(q,u,b),a.push(F));w=u/2;F.Eb+=I||1;F.Pb.push(w);F=null;u+=2}for(w=a.length;w--;)K=a[w],b=K.Eb>=c,f=K.Pb,d=f.length,b?(m.push(d),m=m.concat(f)):
(k+=d,n=n.concat(f));c=[k].concat(n).concat(m);c=e?(new Uint32Array(c)).buffer:c;this.postMessage(c,[c])});function E(a,b,c,d){jc(this,Vb(a,E,0),Wb(b,E,1),Vb(c,E,2),Wb(d,E,3))}Fa(E,C);r("H.geo.Rect",E);E.prototype.Xa="Polygon";E.prototype.dc=function(a){var b=this.l,c=this.g,d=this.j,e=this.i;a.push("(","(",c," ",b,",",e," ",b,",",e," ",d,",",c," ",d,",",c," ",b,")",")");return a};E.prototype.S=function(a){var b=this===a;!b&&Ua(a,E)&&(b=this.l===a.l&&this.g===a.g&&this.j===a.j&&this.i===a.i);return b};E.prototype.equals=E.prototype.S;
E.prototype.clone=function(){return new E(this.l,this.g,this.j,this.i)};E.prototype.clone=E.prototype.clone;function jc(a,b,c,d,e){a.g=c;a.i=e;b<d&&(c=b,b=d,d=c);a.l=b;a.j=d;a.Db=a.Za=a.$a=null;return a}E.prototype.Nb=function(){this.Db||(this.Db=new D(this.l,this.g));return this.Db};E.prototype.getTopLeft=E.prototype.Nb;E.prototype.Mb=function(){this.Za||(this.Za=new D(this.j,this.i));return this.Za};E.prototype.getBottomRight=E.prototype.Mb;E.prototype.Pc=function(){return this.l};
E.prototype.getTop=E.prototype.Pc;E.prototype.Cc=function(){return this.j};E.prototype.getBottom=E.prototype.Cc;E.prototype.Ic=function(){return this.g};E.prototype.getLeft=E.prototype.Ic;E.prototype.Nc=function(){return this.i};E.prototype.getRight=E.prototype.Nc;E.prototype.T=function(){this.$a||(this.$a=new D(this.j+(this.l-this.j)/2,kc(this.g,this.U())));return this.$a};E.prototype.getCenter=E.prototype.T;E.prototype.U=function(){return lc(this.g,this.i)};E.prototype.getWidth=E.prototype.U;
E.prototype.fa=function(){return this.l-this.j};E.prototype.getHeight=E.prototype.fa;E.prototype.Wc=function(){return this.g>this.i};E.prototype.isCDB=E.prototype.Wc;E.prototype.Yc=function(){return!this.U()&&!this.fa()};E.prototype.isEmpty=E.prototype.Yc;E.prototype.pa=function(){return new E(this.l,this.g,this.j,this.i)};E.prototype.getBoundingBox=E.prototype.pa;
E.prototype.Ha=function(a,b,c){var d=this.T();c||(a=Vb(a,this.Ha,0),b=Wb(b,this.Ha,1));b=this.V(a,b,c);a=b.T();return a.lat===d.lat&&a.lng===d.lng&&this.fa()===b.fa()&&this.U()===b.U()};E.prototype.containsLatLng=E.prototype.Ha;E.prototype.Ia=function(a,b){b||Yb(a,this.Ia,0);return this.Ha(a.lat,a.lng,b)};E.prototype.containsPoint=E.prototype.Ia;
E.prototype.Kb=function(a,b){var c=this.T();if(!b&&!Ua(a,E))throw new x(this.Kb,0,a);b=this.Pa(a,b);a=b.T();return a.lat===c.lat&&a.lng===c.lng&&this.fa()===b.fa()&&this.U()===b.U()};E.prototype.containsRect=E.prototype.Kb;E.prototype.V=function(a,b,c,d){if(!c){if($a(a=Vb(a)))throw new x(this.V,0,a);if($a(b=Wb(b)))throw new x(this.V,1,b);}return oc(this.l,this.g,this.j,this.i,a,b,a,b,d)};E.prototype.mergeLatLng=E.prototype.V;
E.prototype.Ub=function(a,b,c){b||Yb(a,this.Ub,0);return this.V(a.lat,a.lng,b,c)};E.prototype.mergePoint=E.prototype.Ub;E.prototype.Pa=function(a,b,c){if(!b&&!Ua(a,E))throw new x(this.Pa,0,a);return oc(this.l,this.g,this.j,this.i,a.l,a.g,a.j,a.i,c)};E.prototype.mergeRect=E.prototype.Pa;E.prototype.sa=function(a,b,c,d,e,f){e||(a=Vb(a,this.sa,0),b=Wb(b,this.sa,1),c=Vb(c,this.sa,2),d=Wb(d,this.sa,3));return oc(this.l,this.g,this.j,this.i,a,b,c,d,f)};E.prototype.mergeTopLeftBottomRight=E.prototype.sa;
E.prototype.Qb=function(a,b){var c=this.g<=this.i,d=a.g<=a.i,e=this.g<a.i,f=a.g<this.i;if(!b&&!Ua(a,E))throw new x(this.Qb,0,a);return this.j<=a.l&&a.j<=this.l&&(!c&&(!d||e||f)||!d&&(e||f)||e&&f)};E.prototype.intersects=E.prototype.Qb;function lc(a,b){a=b-a;return a+(0>a?360:0)}function kc(a,b){a+=b/2;return a-(180<a?360:0)}
function oc(a,b,c,d,e,f,g,h,k){c=pb(c,g);a=qb(a,e);e=lc(b,d);var m=kc(b,e);g=lc(f,h);var n=kc(f,g)-m;n+=0>n-1E-6?360:0;if(180>n-1E-6){m=b;var q=h}else n=360-n,m=f,q=d;n=n+e/2+g/2;360<=n+5E-7?(m=-180,q=180):n-5E-7<e?(m=b,q=d):n-5E-7<g&&(m=f,q=h);return k?jc(k,a,m,c,q):new E(a,m,c,q)}E.merge=oc;function pc(a,b,c){c||(Yb(a,pc,0),Yb(b,pc,1));return new E(a.lat,a.lng,b.lat,b.lng)}E.fromPoints=pc;
function qc(a,b){var c=1,d=a.length,e=null;var f=ta(a);if("array"!=f&&("object"!=f||"number"!=typeof a.length))throw new x(qc,0,a);if(0<d)for(f=a[0],e=pc(f,f,b);c<d;c++)f=a[c],e.V(f.lat,f.lng,b,e);return e}E.coverPoints=qc;function rc(a,b){var c=3,d=a.length,e;if(!(b||a&&null!=a.length))throw new x(rc,0,a);if(0<d)for(e=new E(a[0],a[1],a[0],a[1]);c<d;c+=3)e.V(a[c],a[c+1],b,e);return e}E.coverLatLngAlts=rc;
function sc(a,b){var c=1,d=a.length,e;if(b&&(!a||null==a.length))throw new x(sc,0,a);if(0<d)for(e=new E(a[0].l,a[0].g,a[0].j,a[0].i);c<d;c++)e.Pa(a[c],b,e);return e}E.coverRects=sc;
E.prototype.Yb=function(a,b){var c=this.g,d=this.l,e=this.i,f=this.j,g=this.T().lng;Yb(a,this.Yb,0);var h=a.lat-f-(d-f)/2;var k=a.lng-g;k=180<k||-180>k?-(g+a.lng):k;a=c+(0>k?2*k:0);a=-180>a?360+a:a;e+=0<k?2*k:0;e=180<e?e-360:e;d=0<h?d+2*h:d;90<=d&&(d=90);f=0>h?f+2*h:f;-90>=f&&(f=-90);return b?jc(b,d,a,f,e):new E(d,a,f,e)};E.prototype.resizeToCenter=E.prototype.Yb;E.prototype.kb="Polygon";
E.prototype.cc=function(){return[[this.g,this.l,0],[this.i,this.l,0],[this.i,this.j,0],[this.g,this.j,0],[this.g,this.l,0]]};E.prototype.ib=function(){return this.jb()};E.prototype.jb=function(){return[this.l,this.g,this.j,this.i]};function L(){0!=tc&&(uc[ua(this)]=this);this.na=this.na;this.G=this.G}var tc=0,uc={};L.prototype.na=!1;L.prototype.C=function(){if(!this.na&&(this.na=!0,this.K(),0!=tc)){var a=ua(this);if(0!=tc&&this.G&&0<this.G.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete uc[a]}};
L.prototype.aa=function(a,b){this.na?void 0!==b?a.call(b):a():(this.G||(this.G=[]),this.G.push(void 0!==b?Ca(a,b):a))};L.prototype.K=function(){if(this.G)for(;this.G.length;)this.G.shift()()};function vc(a,b){return-1!=a.indexOf(b)};var M;a:{var wc=p.navigator;if(wc){var xc=wc.userAgent;if(xc){M=xc;break a}}M=""};function yc(a){yc[" "](a);return a}yc[" "]=sa;var zc=vc(M,"Gecko")&&!(vc(M.toLowerCase(),"webkit")&&!vc(M,"Edge"))&&!(vc(M,"Trident")||vc(M,"MSIE"))&&!vc(M,"Edge"),Ac=vc(M.toLowerCase(),"webkit")&&!vc(M,"Edge");var Bc=function(){if(!p.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{p.addEventListener("test",sa,b),p.removeEventListener("test",sa,b)}catch(c){}return a}();function O(a,b){this.type=a;this.currentTarget=this.target=b;this.defaultPrevented=this.xa=!1}O.prototype.stopPropagation=function(){this.xa=!0};O.prototype.preventDefault=function(){this.defaultPrevented=!0};function Cc(a,b){O.call(this,a?a.type:"");this.relatedTarget=this.currentTarget=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0;this.key="";this.charCode=this.keyCode=0;this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.state=null;this.pointerId=0;this.pointerType="";this.oa=null;if(a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.currentTarget=
b;if(b=a.relatedTarget){if(zc){a:{try{yc(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.offsetX=Ac||void 0!==a.offsetX?a.offsetX:a.layerX,this.offsetY=Ac||void 0!==a.offsetY?a.offsetY:a.layerY,this.clientX=void 0!==a.clientX?a.clientX:a.pageX,
this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0);this.button=a.button;this.keyCode=a.keyCode||0;this.key=a.key||"";this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType="string"===typeof a.pointerType?a.pointerType:Dc[a.pointerType]||"";this.state=a.state;this.oa=a;a.defaultPrevented&&Cc.Z.preventDefault.call(this)}}
Fa(Cc,O);var Dc={2:"touch",3:"pen",4:"mouse"};Cc.prototype.stopPropagation=function(){Cc.Z.stopPropagation.call(this);this.oa.stopPropagation?this.oa.stopPropagation():this.oa.cancelBubble=!0};Cc.prototype.preventDefault=function(){Cc.Z.preventDefault.call(this);var a=this.oa;a.preventDefault?a.preventDefault():a.returnValue=!1};var Ec="closure_listenable_"+(1E6*Math.random()|0);var Fc=0;function Gc(a,b,c,d,e){this.listener=a;this.proxy=null;this.src=b;this.type=c;this.capture=!!d;this.La=e;this.key=++Fc;this.za=this.Ga=!1}function Hc(a){a.za=!0;a.listener=null;a.proxy=null;a.src=null;a.La=null};function Ic(a){this.src=a;this.m={};this.Ea=0}Ic.prototype.add=function(a,b,c,d,e){var f=a.toString();a=this.m[f];a||(a=this.m[f]=[],this.Ea++);var g=Jc(a,b,d,e);-1<g?(b=a[g],c||(b.Ga=!1)):(b=new Gc(b,this.src,f,!!d,e),b.Ga=c,a.push(b));return b};Ic.prototype.remove=function(a,b,c,d){a=a.toString();if(!(a in this.m))return!1;var e=this.m[a];b=Jc(e,b,c,d);return-1<b?(Hc(e[b]),Array.prototype.splice.call(e,b,1),0==e.length&&(delete this.m[a],this.Ea--),!0):!1};
function Kc(a,b){var c=b.type;if(c in a.m){var d=a.m[c],e=Ha(d,b),f;(f=0<=e)&&Array.prototype.splice.call(d,e,1);f&&(Hc(b),0==a.m[c].length&&(delete a.m[c],a.Ea--))}}Ic.prototype.ia=function(a){a=a&&a.toString();var b=0,c;for(c in this.m)if(!a||c==a){for(var d=this.m[c],e=0;e<d.length;e++)++b,Hc(d[e]);delete this.m[c];this.Ea--}return b};Ic.prototype.mb=function(a,b,c,d){a=this.m[a.toString()];var e=-1;a&&(e=Jc(a,b,c,d));return-1<e?a[e]:null};
function Jc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.za&&f.listener==b&&f.capture==!!c&&f.La==d)return e}return-1};var Lc="closure_lm_"+(1E6*Math.random()|0),Mc={},Nc=0;function Oc(a,b,c,d,e){if(d&&d.once)Pc(a,b,c,d,e);else if(Array.isArray(b))for(var f=0;f<b.length;f++)Oc(a,b[f],c,d,e);else c=Qc(c),a&&a[Ec]?a.D.add(String(b),c,!1,ra(d)?!!d.capture:!!d,e):Rc(a,b,c,!1,d,e)}
function Rc(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=ra(e)?!!e.capture:!!e,h=Sc(a);h||(a[Lc]=h=new Ic(a));c=h.add(b,c,d,g,f);if(!c.proxy){d=Tc();c.proxy=d;d.src=a;d.listener=c;if(a.addEventListener)Bc||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(Uc(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");Nc++}}
function Tc(){function a(c){return b.call(a.src,a.listener,c)}var b=Vc;return a}function Pc(a,b,c,d,e){if(Array.isArray(b))for(var f=0;f<b.length;f++)Pc(a,b[f],c,d,e);else c=Qc(c),a&&a[Ec]?a.D.add(String(b),c,!0,ra(d)?!!d.capture:!!d,e):Rc(a,b,c,!0,d,e)}function Wc(a,b,c,d,e){if(Array.isArray(b))for(var f=0;f<b.length;f++)Wc(a,b[f],c,d,e);else d=ra(d)?!!d.capture:!!d,c=Qc(c),a&&a[Ec]?a.D.remove(String(b),c,d,e):a&&(a=Sc(a))&&(b=a.mb(b,c,d,e))&&Xc(b)}
function Xc(a){if("number"!==typeof a&&a&&!a.za){var b=a.src;if(b&&b[Ec])Kc(b.D,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(Uc(c),d):b.addListener&&b.removeListener&&b.removeListener(d);Nc--;(c=Sc(b))?(Kc(c,a),0==c.Ea&&(c.src=null,b[Lc]=null)):Hc(a)}}}function Uc(a){return a in Mc?Mc[a]:Mc[a]="on"+a}function Vc(a,b){if(a.za)a=!0;else{b=new Cc(b,this);var c=a.listener,d=a.La||a.src;a.Ga&&Xc(a);a=c.call(d,b)}return a}
function Sc(a){a=a[Lc];return a instanceof Ic?a:null}var Yc="__closure_events_fn_"+(1E9*Math.random()>>>0);function Qc(a){if("function"===typeof a)return a;a[Yc]||(a[Yc]=function(b){return a.handleEvent(b)});return a[Yc]};r("H.util.Event",O);O.prototype.stopPropagation=O.prototype.stopPropagation;O.prototype.stopPropagation=O.prototype.stopPropagation;O.prototype.CAPTURING_PHASE=1;O.prototype.CAPTURING_PHASE=O.prototype.CAPTURING_PHASE;O.prototype.AT_TARGET=2;O.prototype.AT_TARGET=O.prototype.AT_TARGET;O.prototype.BUBBLING_PHASE=3;O.prototype.BUBBLING_PHASE=O.prototype.BUBBLING_PHASE;O.prototype.eventPhase=0;O.prototype.eventPhase=O.prototype.eventPhase;function Zc(a,b,c){Zc.Z.constructor.call(this,a,c);this.message=b}Fa(Zc,O);r("H.util.ErrorEvent",Zc);function Q(){L.call(this);this.D=new Ic(this);this.hc=this;this.wb=null}Fa(Q,L);Q.prototype[Ec]=!0;l=Q.prototype;l.M=function(){return this.wb};l.Sa=function(a){this.wb=a};l.addEventListener=function(a,b,c,d){Oc(this,a,b,c,d)};l.removeEventListener=function(a,b,c,d){Wc(this,a,b,c,d)};
l.dispatchEvent=function(a){var b,c=this.M();if(c)for(b=[];c;c=c.M())b.push(c);c=this.hc;var d=a.type||a;if("string"===typeof a)a=new O(a,c);else if(a instanceof O)a.target=a.target||c;else{var e=a;a=new O(d,c);Ma(a,e)}e=!0;if(b)for(var f=b.length-1;!a.xa&&0<=f;f--){var g=a.currentTarget=b[f];e=g.da(d,!0,a)&&e}a.xa||(g=a.currentTarget=c,e=g.da(d,!0,a)&&e,a.xa||(e=g.da(d,!1,a)&&e));if(b)for(f=0;!a.xa&&f<b.length;f++)g=a.currentTarget=b[f],e=g.da(d,!1,a)&&e;return e};
l.K=function(){Q.Z.K.call(this);this.D&&this.D.ia(void 0);this.wb=null};l.da=function(a,b,c){a=this.D.m[String(a)];if(!a)return!0;a=a.concat();for(var d=!0,e=0;e<a.length;++e){var f=a[e];if(f&&!f.za&&f.capture==b){var g=f.listener,h=f.La||f.src;f.Ga&&Kc(this.D,f);d=!1!==g.call(h,c)&&d}}return d&&!c.defaultPrevented};l.mb=function(a,b,c,d){return this.D.mb(String(a),b,c,d)};r("H.util.EventTarget",Q);Q.prototype.Sa=Q.prototype.Sa;Q.prototype.setParentEventTarget=Q.prototype.Sa;Q.prototype.M=Q.prototype.M;Q.prototype.getParentEventTarget=Q.prototype.M;Q.prototype.addEventListener=Q.prototype.addEventListener;Q.prototype.addEventListener=Q.prototype.addEventListener;Q.prototype.removeEventListener=Q.prototype.removeEventListener;Q.prototype.removeEventListener=Q.prototype.removeEventListener;Q.prototype.dispatchEvent=Q.prototype.dispatchEvent;
Q.prototype.dispatchEvent=Q.prototype.dispatchEvent;Q.prototype.C=Q.prototype.C;Q.prototype.dispose=Q.prototype.C;Q.prototype.aa=Q.prototype.aa;Q.prototype.addOnDisposeCallback=Q.prototype.aa;Q.prototype.yc=Q.prototype.da;
Q.prototype.da=function(a,b,c){var d,e,f=!0;var g=c[c.currentTarget===c.target?"AT_TARGET":b?"CAPTURING_PHASE":(d=!0,"BUBBLING_PHASE")];if(!d||"pointerenter"!==(e=c.type)&&"pointerleave"!==e)c.eventPhase=g,f=Q.prototype.yc.apply(this,arguments),d&&this.M&&null===this.M()&&delete c.eventPhase;return f};Q.prototype.qd=function(a){for(var b,c=this;c&&(b=c.M())&&b!==a;)c=b;b||c.Sa(a)};Q.prototype.setRootParentEventTarget=Q.prototype.qd;function S(a){a=a||{};var b=a.callback;this.rb=a.label;Va(b)&&(this.callback=b);this.cb=!!a.disabled;S.Z.constructor.call(this)}Fa(S,Q);r("H.util.ContextItem",S);S.prototype.Hc=function(){return this.rb};S.prototype.getLabel=S.prototype.Hc;S.prototype.pd=function(a){this.rb!==a&&(this.rb=a,this.dispatchEvent("update"));return this};S.prototype.setLabel=S.prototype.pd;S.prototype.Xc=function(){return this.cb};S.prototype.isDisabled=S.prototype.Xc;
S.prototype.od=function(a){a!==this.cb&&(this.cb=a,this.dispatchEvent("update"));return this};S.prototype.setDisabled=S.prototype.od;var $c=new S;S.SEPARATOR=$c;function ad(a,b){this.$c=100;this.rc=a;this.md=b;this.Qa=0;this.Ma=null}ad.prototype.get=function(){if(0<this.Qa){this.Qa--;var a=this.Ma;this.Ma=a.next;a.next=null}else a=this.rc();return a};ad.prototype.put=function(a){this.md(a);this.Qa<this.$c&&(this.Qa++,a.next=this.Ma,this.Ma=a)};function bd(){var a=document;var b="IFRAME";"application/xhtml+xml"===a.contentType&&(b=b.toLowerCase());return a.createElement(b)};var cd;
function dd(){var a=p.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!vc(M,"Presto")&&(a=function(){var e=bd();e.style.display="none";document.documentElement.appendChild(e);var f=e.contentWindow;e=f.document;e.open();e.close();var g="callImmediate"+Math.random(),h="file:"==f.location.protocol?"*":f.location.protocol+"//"+f.location.host;e=Ca(function(k){if(("*"==h||k.origin==h)&&k.data==g)this.port1.onmessage()},this);f.addEventListener("message",e,
!1);this.port1={};this.port2={postMessage:function(){f.postMessage(g,h)}}});if("undefined"!==typeof a&&!vc(M,"Trident")&&!vc(M,"MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var e=c.Jb;c.Jb=null;e()}};return function(e){d.next={Jb:e};d=d.next;b.port2.postMessage(0)}}return function(e){p.setTimeout(e,0)}};function ed(){this.Ya=this.ja=null}ed.prototype.add=function(a,b){var c=fd.get();c.set(a,b);this.Ya?this.Ya.next=c:this.ja=c;this.Ya=c};ed.prototype.remove=function(){var a=null;this.ja&&(a=this.ja,this.ja=this.ja.next,this.ja||(this.Ya=null),a.next=null);return a};var fd=new ad(function(){return new gd},function(a){return a.reset()});function gd(){this.next=this.scope=this.hb=null}gd.prototype.set=function(a,b){this.hb=a;this.scope=b;this.next=null};
gd.prototype.reset=function(){this.next=this.scope=this.hb=null};function hd(a){p.setTimeout(function(){throw a;},0)};function id(a,b){jd||kd();ld||(jd(),ld=!0);md.add(a,b)}var jd;function kd(){if(p.Promise&&p.Promise.resolve){var a=p.Promise.resolve(void 0);jd=function(){a.then(nd)}}else jd=function(){var b=nd;"function"!==typeof p.setImmediate||p.Window&&p.Window.prototype&&!vc(M,"Edge")&&p.Window.prototype.setImmediate==p.setImmediate?(cd||(cd=dd()),cd(b)):p.setImmediate(b)}}var ld=!1,md=new ed;function nd(){for(var a;a=md.remove();){try{a.hb.call(a.scope)}catch(b){hd(b)}fd.put(a)}ld=!1};function od(a){this.u=pd;this.Zb=void 0;this.ba=this.I=this.W=null;this.Ka=this.gb=!1;if(a!=sa)try{var b=this;a.call(void 0,function(c){qd(b,rd,c)},function(c){qd(b,sd,c)})}catch(c){qd(this,sd,c)}}var pd=0,rd=2,sd=3;function td(){this.next=this.context=this.ha=this.ua=this.R=null;this.Fa=!1}td.prototype.reset=function(){this.context=this.ha=this.ua=this.R=null;this.Fa=!1};var ud=new ad(function(){return new td},function(a){a.reset()});
function vd(a,b,c){var d=ud.get();d.ua=a;d.ha=b;d.context=c;return d}function wd(a,b,c){xd(a,b,c,null)||id(Da(b,a))}function yd(a){return new od(function(b,c){var d=a.length,e=[];if(d)for(var f=function(m,n){d--;e[m]=n;0==d&&b(e)},g=function(m){c(m)},h=0,k;h<a.length;h++)k=a[h],wd(k,Da(f,h),g);else b(e)})}function zd(){var a,b,c=new od(function(d,e){a=d;b=e});return new Ad(c,a,b)}od.prototype.then=function(a,b,c){return Bd(this,"function"===typeof a?a:null,"function"===typeof b?b:null,c)};
od.prototype.$goog_Thenable=!0;od.prototype.cancel=function(a){if(this.u==pd){var b=new Cd(a);id(function(){Dd(this,b)},this)}};function Dd(a,b){if(a.u==pd)if(a.W){var c=a.W;if(c.I){for(var d=0,e=null,f=null,g=c.I;g&&(g.Fa||(d++,g.R==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.u==pd&&1==d?Dd(c,b):(f?(d=f,d.next==c.ba&&(c.ba=d),d.next=d.next.next):Ed(c),Fd(c,e,sd,b)))}a.W=null}else qd(a,sd,b)}function Gd(a,b){a.I||a.u!=rd&&a.u!=sd||Hd(a);a.ba?a.ba.next=b:a.I=b;a.ba=b}
function Bd(a,b,c,d){var e=vd(null,null,null);e.R=new od(function(f,g){e.ua=b?function(h){try{var k=b.call(d,h);f(k)}catch(m){g(m)}}:f;e.ha=c?function(h){try{var k=c.call(d,h);void 0===k&&h instanceof Cd?g(h):f(k)}catch(m){g(m)}}:g});e.R.W=a;Gd(a,e);return e.R}od.prototype.td=function(a){this.u=pd;qd(this,rd,a)};od.prototype.ud=function(a){this.u=pd;qd(this,sd,a)};
function qd(a,b,c){a.u==pd&&(a===c&&(b=sd,c=new TypeError("Promise cannot resolve to itself")),a.u=1,xd(c,a.td,a.ud,a)||(a.Zb=c,a.u=b,a.W=null,Hd(a),b!=sd||c instanceof Cd||Id(a,c)))}function xd(a,b,c,d){if(a instanceof od)return Gd(a,vd(b||sa,c||null,d)),!0;if(a)try{var e=!!a.$goog_Thenable}catch(g){e=!1}else e=!1;if(e)return a.then(b,c,d),!0;if(ra(a))try{var f=a.then;if("function"===typeof f)return Jd(a,f,b,c,d),!0}catch(g){return c.call(d,g),!0}return!1}
function Jd(a,b,c,d,e){function f(k){h||(h=!0,d.call(e,k))}function g(k){h||(h=!0,c.call(e,k))}var h=!1;try{b.call(a,g,f)}catch(k){f(k)}}function Hd(a){a.gb||(a.gb=!0,id(a.uc,a))}function Ed(a){var b=null;a.I&&(b=a.I,a.I=b.next,b.next=null);a.I||(a.ba=null);return b}od.prototype.uc=function(){for(var a;a=Ed(this);)Fd(this,a,this.u,this.Zb);this.gb=!1};
function Fd(a,b,c,d){if(c==sd&&b.ha&&!b.Fa)for(;a&&a.Ka;a=a.W)a.Ka=!1;if(b.R)b.R.W=null,Kd(b,c,d);else try{b.Fa?b.ua.call(b.context):Kd(b,c,d)}catch(e){Ld.call(null,e)}ud.put(b)}function Kd(a,b,c){b==rd?a.ua.call(a.context,c):a.ha&&a.ha.call(a.context,c)}function Id(a,b){a.Ka=!0;id(function(){a.Ka&&Ld.call(null,b)})}var Ld=hd;function Cd(a){Ga.call(this,a)}Fa(Cd,Ga);Cd.prototype.name="cancel";function Ad(a,b,c){this.promise=a;this.resolve=b;this.reject=c};function Md(){}r("H.util.ICancelable",Md);Md.prototype.cancel=function(){};Md.prototype.cancel=Md.prototype.cancel;function Nd(a,b,c){this.type=a;this.data=b;this.O=zd();this.resolve=Oa(this.resolve,this);this.reject=Oa(this.reject,this);this.priority=Od;c!==t&&(this.priority=c);this.Gc().add(this)}var Od=1,Pd={zd:0,Ad:Od,yd:2};l=Nd.prototype;l.then=function(a,b,c){return this.O.promise.then(a,b,c)};l.resolve=function(a){this.state=3;this.O.resolve(a)};l.reject=function(a){this.state=5;this.O.reject(a)};l.state=0;l.cancel=function(){3>this.state&&(this.Dd(),this.Gc().remove(this),this.state=4)};
Nd.prototype.cancel=Nd.prototype.cancel;function Qd(a){var b;this.Y={};for(b in Pd)this.Y[Pd[b]]=[];this.Ba=a;this.Ba.addEventListener("allocatable",Oa(this.Lb,this))}r("H.util.JobManager",Qd);var Rd=Object.keys(Pd).map(function(a){return Pd[a]}).sort().reverse();Qd.prototype.add=function(a){Ua(a,Nd,this.add,0);this.Y[a.priority].push(a);this.Lb()};Qd.prototype.contains=function(a){return-1<this.Y[a.priority].indexOf(a)};
Qd.prototype.remove=function(a){var b=a.priority,c=this.Y[b].indexOf(a);if(-1<c)return this.Y[b].splice(c,1),!0;a.Fb&&this.Ba.sc(a.Fb);return!1};Qd.prototype.Lb=function(){Rd.forEach(function(a){this.Y[a]=this.Y[a].filter(function(b){var c;if((c=this.Ba.Bd(b))!==Ra){var d=Oa(this.Ba.sc,this.Ba,c,b);b.Fb=c;b.then(d,d);b.state=b.Ed(c)?1:5}else return!0},this)},this)};function Sd(a,b,c){Sd.Z.constructor.call(this,a,c);this.data=b}Fa(Sd,O);r("H.util.DataEvent",Sd);function Td(a,b,c){var d=[],e=arguments.length;a&&d.push(cb(a));1<e&&(e=2<e&&Wa(c,void 0,void 0,void 0)?" out of ["+c[0]+"..."+c[1]+"]":"",d.push("("+b+e+")"));d=Error(d.join(" "));Object.setPrototypeOf(d,Td.prototype);return d}Fa(Td,Error);r("H.lang.OutOfRangeError",Td);Td.prototype.name="OutOfRangeError";function Ud(a){if(Na.document){var b=document.createElement("canvas");b.width=b.height=1;b.getContext("2d",{Fd:a})}}r("H.util.getPixelRatio",function(){return window.devicePixelRatio||1});Object.create(Ra,void 0);r("H.util.eval",function(a){return eval(a)});r("H.util.provide",function(a){var b=p.$jscomp;if(b&&("function"!=typeof b.Dc?0:b.Dc()))throw Error("goog.provide cannot be used within a module.");qa(a,void 0,void 0)});function Vd(){this.v=0}
Vd.prototype.next=function(a){if(9007199254740992===this.v)throw new Td(a,this.v,[0,9007199254740991]);return this.v++};var Wd=new Vd;Oa(Wd.next,Wd);var Yd=Qa([]);Qa({});Ud(!0);Ud(!1);function Zd(a,b){b=180/(1<<b);var c=a.lat+90;a=(a.lng+180)%360;var d=0;180==c&&d--;d+=Math.floor(c/b);return[d,0+Math.floor(a/b)]}var $d=1/Math.pow(10,10);function ae(a,b){var c=[],d=a.Nb();a=a.Mb();var e;180==a.lng&&(a.lng-=$d);d=Zd(d,b);a=Zd(a,b);for(e=d[0];e>=a[0];e--)for(b=d[1];b<=a[1];b++)c.push(e,b);return c};r("H.util.Disposable",L);L.prototype.aa=L.prototype.aa;L.prototype.addOnDisposeCallback=L.prototype.aa;r("H.util.dispose",function(a){a&&"function"==typeof a.C&&a.C()});L.prototype.C=L.prototype.C;L.prototype.dispose=L.prototype.C;L.prototype.K=L.prototype.K;L.prototype.disposeInternal=L.prototype.K;function be(a,b,c,d,e,f){var g,h,k=a.length,m,n;if(k)for(g=[];k--;){var q=a[k];var u=q.length;var I=0;for(m=1;m<u;m++)if(n=ce(q[m-1],q[m],c,b,d,e)){var K=n[0];var w=n[1];I&&I.S(K)?h.push(w):g.push(h=n);I=w;f&&(m=u,k=0)}}else g=a;return g}r("H.math.clipping.clipStrips",be);
function ce(a,b,c,d,e,f){var g=a.x;a=-a.y;var h=b.x;b=-b.y;c=-c;f=-f;if(g>h){if(h>e||g<d)return;var k=g;var m=a;g=h;a=b;h=k;b=m;k=1}else if(g>e||h<d)return;if(a>b){if(b>c||a<f)return;var n=1;a=-a;b=-b;m=f;f=-c;c=-m}else if(a>c||b<f)return;if(g<d){if((a+=(d-g)*(b-a)/(h-g))>c)return;g=d}if(a<f){if((g+=(f-a)*(h-g)/(b-a))>e)return;a=f}h>e&&(b=a+(e-g)*(b-a)/(h-g),h=e);b>c&&(h=g+(c-a)*(h-g)/(b-a),b=c);n&&(a=-a,b=-b);return k?[new B(h,-b),new B(g,-a)]:[new B(g,-a),new B(h,-b)]}
function de(a,b,c){a=ee(a,!0);b=ee(b,!1);var d,e;var f={};var g=d=1;switch(~~(1*(c||0))){case 1:g=d=0;break;case 2:d=0;g=1;break;case 3:d=1,g=0}c=d;var h=g;if(b&&a){b.ma=new fe(b.x,b.y,null,ge(b));a.ma=new fe(a.x,a.y,null,ge(a));for(g=b;g.next;g=g.next)if(!g.F)for(d=a;d.next;d=d.next)if(!d.F){var k=he(g.next);var m=he(d.next);if(e=ie(g,k,d,m,f)){e=f.ic;var n=f.jc;var q=f.wd;var u=f.xd;e=new fe(q,u,null,null,null,null,!0,0,0,e);je(e,g,k);k=new fe(q,u,null,null,null,null,!0,0,0,n);je(k,d,m);e.vb=k;
k.vb=e}}f=Sb(b,ke(a));c&&(f=!f);for(g=b;g;g=g.next)g.F&&(g.qb=f,f=!f);f=Sb(a,ke(b));h&&(f=!f);for(d=a;d.next;d=d.next)d.F&&(d.qb=f,f=!f);le(b);for(le(a);(a=me(b))!=b;){for(c=null;!a.Wa;a=a.vb){for(f=a.qb;;){c=new fe(a.x,a.y,c);c.artificial=a.F||a.Rb;a.Wa=1;a=f?a.next:a.B;if(!a)break;if(a.F){a.Wa=1;break}}if(!a)break}c.Vb=I||null;var I=c}return I}}r("H.math.clipping.clipPolygon",de);
function fe(a,b,c,d,e,f,g,h,k,m){this.x=a;this.y=b;this.next=c||null;this.B=d||null;this.Vb=e||null;this.vb=f||null;this.F=!!g;this.qb=!!h;this.Wa=k||0;this.alpha=m||0;d&&(d.next=this);c&&(c.B=this);this.Rb=!1;this.ma=null}function he(a){for(;a&&a.F;)a=a.next;return a}function ge(a){if(a)for(;a.next;)a=a.next;return a}function me(a){var b=a;if(b){do b=b.next;while(b!=a&&(!b.F||b.F&&b.Wa))}return b}function le(a){var b=ge(a);b.B.next=a;a.B=b.B}
function ie(a,b,c,d,e){var f,g=b.x-a.x,h=b.y-a.y;var k=d.x-c.x;var m=d.y-c.y;var n=g*m-h*k;if(!n)return 0;k=((c.x-a.x)*m-(c.y-a.y)*k)/n;n=(h*(c.x-a.x)-g*(c.y-a.y))/n;if(0>k||1<k||0>n||1<n)return 0;0===k?f=a:1===k?f=b:0===n?f=c:1===n&&(f=d);if(f)return f.x+=2.480549651603763E-5,f.y+=7.321997314118067E-5,f.ma&&(f.ma.x=f.x,f.ma.y=f.y),ie(a,b,c,d,e);e.wd=a.x+k*g;e.xd=a.y+k*h;e.ic=k;e.jc=n;return 1}function ke(a){for(var b=[];a;)b.push(a.x,a.y),a=a.next;return b}
function je(a,b,c){for(b=b.next;b!==c&&b.alpha<=a.alpha;)b=b.next;a.next=b;a.B=b.B;a.next.B=a;a.B.next=a}function ee(a,b){for(var c,d=null,e=0,f=a.length;e<f;e++){c=new fe(a[e].x,a[e].y,d);c.Rb=b;if(c.next=d)d.B=c;d=c}return d};function T(){}r("H.util.ICache",T);T.prototype.add=function(){};T.prototype.add=T.prototype.add;T.prototype.get=function(){};T.prototype.get=T.prototype.get;T.prototype.fb=function(){};T.prototype.drop=T.prototype.fb;T.prototype.forEach=function(){};T.prototype.forEach=T.prototype.forEach;T.prototype.ia=function(){};T.prototype.removeAll=T.prototype.ia;T.prototype.ya=function(){};T.prototype.registerOnDrop=T.prototype.ya;T.prototype.bb=function(){};T.prototype.deRegisterOnDrop=T.prototype.bb;function U(a,b,c){this.ta=[];b&&this.ya(b);if(c&&!Va(c))throw new x(U,2,c);this.J=0;this.filter=c;this.s={};this.qa=this.ea=null;this.zb(a)}r("H.util.Cache",U);U.prototype.add=function(a,b,c){var d,e;c=+c;if(!ab(c)||0>c)throw new x(this.add,2,c);a=String(a);if(e=this.filter?this.filter(a,b,c):!0)(d=this.s[a])?(d.data!==b&&ne(this,d),this.J+=c-d.size,d.size=c,d.data=b,oe(this,d)):this.s[a]=pe(this,{id:a,data:b,size:c,v:null,N:null},this.ea),qe(this);return e};U.prototype.add=U.prototype.add;
U.prototype.ya=function(a){if(!Va(a))throw new x(this.ya,0,a);this.ta.push(a)};U.prototype.registerOnDrop=U.prototype.ya;U.prototype.bb=function(a){this.ta=this.ta.filter(function(b){return b!==a})};U.prototype.deRegisterOnDrop=U.prototype.bb;U.prototype.get=function(a,b){return(a=b?this.s[a]:oe(this,this.s[a]))&&a.data};U.prototype.get=U.prototype.get;U.prototype.fb=function(a){var b;(b=this.s[a])&&re(this,b,!0)};U.prototype.drop=U.prototype.fb;
U.prototype.forEach=function(a,b,c){var d;for(d in this.s){var e=this.s[d];(c?c(d,e.data,e.size):1)&&a.call(b,d,e.data,e.size)}};U.prototype.forEach=U.prototype.forEach;U.prototype.ia=function(a){var b;for(b in this.s){var c=this.s[b];(a?a(b,c.data,c.size):1)&&re(this,this.s[b],!0)}};U.prototype.removeAll=U.prototype.ia;U.prototype.zb=function(a){if(!(0<+a))throw new x(U.prototype.zb,0,a);this.Tb=+a;qe(this);return this};U.prototype.setMaxSize=U.prototype.zb;U.prototype.Jc=function(){return this.Tb};
U.prototype.getMaxSize=U.prototype.Jc;U.prototype.Ec=function(){return this.J};U.prototype.getCurrentSize=U.prototype.Ec;function oe(a,b){b&&(a.ea=pe(a,b,a.ea));return b}function qe(a){for(;a.J>a.Tb&&a.qa;)re(a,a.qa,!0)}function pe(a,b,c){if(c!==b){(b.v||b.N)&&re(a,b,!1);if(b.v=c)b.N=c.N,c.N=b;b.N||(a.ea=b);b.v||(a.qa=b);a.J+=b.size}return b}function re(a,b,c){var d=b.N,e=b.v;if(d||e||b==a.ea&&b==a.qa)d?d.v=e:a.ea=e,e?e.N=d:a.qa=d,a.J-=b.size,c&&(delete a.s[b.id],ne(a,b));b.v=b.N=null}
function ne(a,b){for(var c=a.ta.length;c--;)a.ta[c].call(a,b.id,b.data,b.size)};function se(a,b,c,d){this.key="";this.x=a;this.y=b;this.Sb=c;this.ra=d;this.O=zd()}se.prototype.then=function(a,b,c){return this.O.promise.then(a,b,c)};se.prototype.resolve=function(a){this.O.resolve(a)};se.prototype.reject=function(a){this.O.reject(a)};se.prototype.cancel=function(){this.O.promise.cancel()};se.prototype.cancel=se.prototype.cancel;function te(a,b,c,d){var e=!!c,f,g=0,h=0,k=0,m=0,n=0,q,u=-1;var I=Na.Float32Array;var K,w=[];if(b){b=Sa(b);a=Sa(a);e&&(f=Sa(c));c=b.length;d=d?1E-7:1E-5;for(K=new I(3*c);g<c;){I=b[g];var F=+I;var W=+a[g];e&&(q=+f[g]);ue.test(I)?0<=u&&(0<g-u&&w.push(u,g+1),u=-1):0>u&&(u=g);g++;m=K[h++]=m+W*d;k=K[h++]=k+F*d;e&&(n=K[h]=n+q);h++}0<=u&&1<c-u&&w.push(u,c)}else K=new I(0);return{path:K,outlineIndices:w}}var ue=/^-?0\\d/;
function ve(a,b){for(var c=0,d=a.length/3,e=new Na.Array(d),f=0;c<d;)e[c++]=b.sb(a[f],a[++f]),f+=2;return e};function X(){}r("H.service.extension.dataView.ITable",X);X.prototype.nb=function(){};X.prototype.getMeta=X.prototype.nb;X.prototype.ob=function(){};X.prototype.getRowCount=X.prototype.ob;X.prototype.Ja=function(){};X.prototype.getRow=X.prototype.Ja;X.prototype.L=function(){};X.prototype.getColumnNames=X.prototype.L;X.prototype.lb=function(){};X.prototype.getColumn=X.prototype.lb;X.prototype.o=function(){};X.prototype.getCell=X.prototype.o;X.prototype.concat=function(){};X.prototype.concat=X.prototype.concat;function we(){}r("H.service.extension.dataView.IRow",we);we.prototype.L=function(){};we.prototype.getColumnNames=we.prototype.L;we.prototype.o=function(){};we.prototype.getCell=we.prototype.o;we.prototype.pb=function(){};we.prototype.getTable=we.prototype.pb;function xe(a,b){this.Ca=a;this.nd=b}r("H.service.extension.dataView.ObjRow",xe);xe.prototype.L=function(){return this.Ca.L()};xe.prototype.getColumnNames=xe.prototype.L;xe.prototype.o=function(a){return this.Ca.o(this.nd,a)};xe.prototype.getCell=xe.prototype.o;xe.prototype.pb=function(){return this.Ca};xe.prototype.getTable=xe.prototype.pb;function ye(){}r("H.service.extension.dataView.IColumn",ye);ye.prototype.o=function(){};ye.prototype.getCell=ye.prototype.o;function ze(a,b){this.Ca=a;this.qc=b}r("H.service.extension.dataView.ObjColumn",ze);ze.prototype.o=function(a){return this.Ca.o(a,this.qc)};ze.prototype.getCell=ze.prototype.o;function Y(a,b,c){var d;b=b||(a&&a.length?Object.keys(a[0]):t);this.P=a;if(b)for(this.ca=b,this.ab=a=Object.create(Ra,void 0),d=b.length;d--;)a[b[d]]=!0;c!==t&&(this.ub=c)}r("H.service.extension.dataView.ObjTable",Y);l=Y.prototype;l.ub=t;l.P=t;l.ca=t;l.ab=t;l.nb=function(){return this.ub};Y.prototype.getMeta=Y.prototype.nb;Y.prototype.ob=function(){return this.P?this.P.length:0};Y.prototype.getRowCount=Y.prototype.ob;Y.prototype.Ja=function(a){var b=this.P;return b&&b[a]?new xe(this,a):t};
Y.prototype.getRow=Y.prototype.Ja;Y.prototype.L=function(){return this.ca||Yd};Y.prototype.getColumnNames=Y.prototype.L;Y.prototype.lb=function(a){return this.ab[a]?new ze(this,a):t};Y.prototype.getColumn=Y.prototype.lb;Y.prototype.o=function(a,b){var c=this.P;return(a=c&&this.ab[b]&&c[a])&&a[b]};Y.prototype.getCell=Y.prototype.o;
Y.prototype.concat=function(){var a=arguments.length,b,c=this.ca,d=""+this.ca,e=(this.P||[]).slice();for(b=0;b<a;b++){var f=arguments[b];if(!(f instanceof Y))throw new x(this.concat,b);if(f.P){if(c&&""+f.ca!==d)throw new x(this.concat,b,"Incompatible columns!");e=e.concat(f.P)}}return new Y(e,this.ca,this.ub)};Y.prototype.concat=Y.prototype.concat;function Ae(a,b,c,d){if(!a||!b||!c)throw new x(Ae,t,"Must specify name, version and revision parameter");this.name=a;this.version=b;this.revision=c;d&&Ma(this,d)}r("H.util.BuildInfo",Ae);Ae.prototype.toString=function(){var a,b=[];for(a in this)Ya(this[a])&&b.push(this[a]);return b.join(";")};var Be={};function Ce(a,b,c,d){if(!a)throw new x(Ce,1,"Must specify a name parameter");return Be[a]||(Be[a]=new Ae(a,b,c,d))}Ae.get=Ce;function Z(a,b,c,d,e,f){if(a&&b)this.Cb(a),this.Ra(b),this.Ab(c),this.Bb(e),this.ac(f),this.Ta(d);else throw new x(Z,t,'Parameters "scheme" and "host" must be specified');}r("H.service.Url",Z);
function De(a,b){var c=Na.document,d;var e="";if(c){e=c.createElement("a");if(b){var f=(d=c.getElementsByTagName("base")[0])&&d.href;var g=c.head;var h=d||g.appendChild(c.createElement("base"));h.href=b}e.href=a;e=e.href;b&&(d?d.href=f:g.removeChild(h))}else/[\\w]+:\\/\\//.test(a)&&(e=a);f=/(?:(\\w+):\\/\\/)?(?:([^:]+):([^@/]*)@)?([^/:]+)?(?:[:]{1}([0-9]+))?(\\/[^?#]*)?(\\?[^#]+)?(#.*)?/.exec(e);a=f[1];g=f[4];b=f[5];h=f[6];c=f[7];d=f[8];!f[2]&&g&&/@/.test(g)&&(g=g.split("@")[1]);f=Z;h=h&&0<h.length?h.substr(1):
"";e={};var k,m;if(c)for(k=/([?&]?([^=&+]+))(=([^&]+))?/g;m=k.exec(c);)e[decodeURIComponent(m[2])]=m[4]?decodeURIComponent(m[4]):void 0;return new f(a,g,h,e,isNaN(+b)?void 0:+b,d&&0<d.length?d.substr(1):"")}Z.parse=De;Z.prototype.clone=function(){var a={},b;for(b in this.A)a[b]=this.A[b];return new Z(this.yb,this.Na,this.X,a,this.wa,this.la)};Z.prototype.clone=Z.prototype.clone;
Z.prototype.Cb=function(a){if(!a||"string"!==typeof a)throw new x(this.Cb,0,'The "scheme" parameter must be a non-empty string.');this.yb=a;return this};Z.prototype.setScheme=Z.prototype.Cb;Z.prototype.Oc=function(){return this.yb};Z.prototype.getScheme=Z.prototype.Oc;Z.prototype.Ra=function(a){if(!a||"string"!==typeof a||"-"===a.charAt(0)||"."===a.charAt(0)||"."===a.charAt(a.length-1))throw new x(this.Ra,0,'The "host" parameter is not a valid host name.');this.Na=a;return this};
Z.prototype.setHost=Z.prototype.Ra;Z.prototype.Fc=function(){return this.Na};Z.prototype.getHost=Z.prototype.Fc;Z.prototype.Ab=function(a){this.X=a||void 0;return this};Z.prototype.setPath=Z.prototype.Ab;Z.prototype.Lc=function(){return this.X};Z.prototype.getPath=Z.prototype.Lc;Z.prototype.Ta=function(a){if(a)if("object"==typeof a)this.A=a;else throw new x(this.Ta,0,'Parameter "params" must be an object.');else this.A={};return this};Z.prototype.setQuery=Z.prototype.Ta;Z.prototype.Sc=function(){return!Ee(this)};
Z.prototype.hasQuery=Z.prototype.Sc;Z.prototype.getQuery=function(){return this.A};Z.prototype.getQuery=Z.prototype.getQuery;Z.prototype.Bb=function(a){if(void 0===a)this.wa=a;else{var b=Ob(+a<<0,0,65535);if(b!=a)throw new x(this.Bb,0,'Parameter "port" must be an integer in range [0...65535]');this.wa=b}return this};Z.prototype.setPort=Z.prototype.Bb;Z.prototype.Mc=function(){return this.wa};Z.prototype.getPort=Z.prototype.Mc;Z.prototype.ac=function(a){this.la=a||void 0;return this};
Z.prototype.setAnchor=Z.prototype.ac;Z.prototype.Bc=function(){return this.la};Z.prototype.getAnchor=Z.prototype.Bc;Z.prototype.ga=function(a){if("object"!==typeof a)throw new x(this.ga,0,'Parameter "other" must be an object.');var b=this.A,c;for(c in a)a.hasOwnProperty(c)&&"function"!==typeof a[c]&&(b[c]=a[c]);return this};Z.prototype.mergeQuery=Z.prototype.ga;
Z.prototype.Gb=function(a){if(!a||"string"!==typeof a)throw new x(this.Gb,0,'Parameter "subDomain" must be a non-empty string');"."===a.substr(a.length-1)&&(a=a.substr(0,a.length-1));return this.Ra(a+"."+this.Na)};Z.prototype.addSubDomain=Z.prototype.Gb;Z.prototype.Hb=function(a){if(!a||"string"!==typeof a)throw new x(this.Hb,0,'Parameter "subPath" must be a non-empty string');return this.Ab((this.X?this.X+"/":"")+a)};Z.prototype.addSubPath=Z.prototype.Hb;
Z.prototype.toString=function(){return[this.yb+"://",this.Na,this.wa?":"+this.wa:"",this.X||!Ee(this)||this.la?"/":"",this.X?encodeURI(this.X):"",Fe(this),this.la?"#"+encodeURIComponent(this.la):""].join("")};Z.prototype.toString=Z.prototype.toString;function Ge(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(b){return"%"+b.charCodeAt(0).toString(16)})}
function Fe(a){var b=[],c=a.A,d={},e;for(e in c){if(c.hasOwnProperty(e)&&"function"!==typeof c[e]){var f=a.A[e];d.$=Ge(e);Ua(f,He)?f.Va.forEach(function(g){return function(h){b.push(g.$+"="+Ge(h))}}(d)):Ua(f,Ie)?b.push(d.$+"="+f.Va.map(function(g){return Ge(g)}).join(f.tc)):b.push(void 0===f?d.$:d.$+"="+Ge(f))}d={$:d.$}}return 0<b.length?"?"+b.join("&"):""}function Ee(a){var b,c=0;for(b in a.A)if(a.A.hasOwnProperty(b)&&"function"!==typeof a.A[b]&&(c++,0<c))break;return!c}
function Je(a,b){if(Wa(a,void 0,void 0,void 0))for(var c=0;c<a.length;c++){var d=a[c];if(!Ya(d)&&!ab(d)){var e="The Array does not contain only strings and numbers";break}}else e="Not an Array";if(e)throw new x(b,0,a);return a}function He(a){this.Va=Je(a,He)}Z.MultiValueQueryParameter=He;He.prototype.Qc=function(){return this.Va};He.prototype.getValues=He.prototype.Qc;function Ie(a,b){this.Va=Je(a,Ie);if(!/^[!\\$\\(\\)\\*\\+,;]$/.test(b))throw new x(Ie,1,'Invalid delimiter "'+b+'"');this.tc=b}
Z.DelimitedQuerySubValues=Ie;function Ke(a,b,c){if(!Ya(a))throw new x(Ke,0,"InvalidArgument");if(!Va(b))throw new x(Ke,1,"InvalidArgument");var d=Le++;Me[d]={mimeType:c||Ne,nc:b};(new ob(["3",d,[]])).postMessage(a,[],2)}var Me={},Le=0;
function Oe(a,b){var c=a;if(Me[this.Ua]){var d=Me[this.Ua];var e=d.nc;delete Me[this.Ua];if(b)e(null,b);else{if(d.mimeType===Pe){a=new Uint8Array(a);b=a.byteLength;d="";c=0;for(var f,g,h,k;c<b;)f=a[c++],192>f||(g=a[c++],224>f?f=(f&31)<<6|g&63:(h=a[c++],240>f?f=(f&15)<<12|(g&63)<<6|h&63:(k=a[c++],f=(f&7)<<18|(g&63)<<12|(h&63)<<6|k&63))),65536>f?d+=String.fromCharCode(f):(f-=65536,d+=String.fromCharCode((f>>10)+55296,(f&1023)+56320));c=d}e(c)}}}var Ne=0,Pe=1;function Qe(a,b){var c=a.tileSize||256;this.va={};this.$b=De(a.serverUrl);this.Ib=b;this.Zc=a.layerConfigs||[];this.Xb=a.projected;this.bc=c;this.lc=!1!==a.batchTiles;this.Tc=a.horizontalMargin||0;this.ad=a.onlyOutline;this.jd=new G(t,c);this.tb=new G(t,c);this.tb.Aa(22-Math.log(c)/Math.LN2+8)}Fa(Qe,L);
Qe.prototype.ld=function(a,b,c){var d=this.bc,e=this.Tc,f={x:a*d-e,y:b*d};d={x:(a+1)*d-1+e,y:(b+1)*d-1};e=this.jd;e.Aa(c);f=e.xb(f);d=e.xb(d);return Re(this,new E(f.lat,f.lng,d.lat,d.lng),this.Zc,{x:a,y:b,z:c})};Qe.prototype.kd=function(a,b,c,d,e){return Re(this,new E(a,b,c,d),e)};
function Re(a,b,c,d){var e=Se(c),f=e.length,g={},h,k=a.va,m=[],n=[];for(c=0;c<f;c++){var q=e[c];var u=q.layerId;var I=q.level;g[u]=q.columns;q=ae(b,I);var K=q.length-1;for(h=0;h<K;h+=2){var w=[u,q[h+1],q[h],I].join("_");var F=k[w]||a.Ib.get(w);F||(F=new se(q[h+1],q[h],I,u),F.key=w,k[w]=F,n.push(F));m.push(F)}}n.length&&(a.lc?Te(a,n):Ue(a,n));return yd(m.map(function(W){var ia=Oa(this.xc,this,g[W.ra]),N=Oa(this.gd,this,W,d||Ve),Ea=W.then,va=this.wc,wa=W.ra,xa={},v,R=e.length;for(v=0;v<R;v++){var J=
e[v];if(J.rowFilter){var V=J.layerId;V=V!==t?V:J.layer;xa[V]=Oa(J.rowFilter,J.rowFilterContext)}}return Ea.call(W,Oa(va,this,wa,xa)).then(N).then(ia)},a))}var Ve={x:0,y:0,z:0};Qe.prototype.wc=function(a,b,c){var d=c.Rows,e=d.length,f,g;if(e&&(f=b[a])){b=new Y(c.Rows);var h=[];for(g=0;g<e;g++){var k=d[g];f(b.Ja(g),a)&&h.push(k)}a={Rows:h};if(c=c.Meta)a.Meta=c}else a=c;return a};
function Ue(a,b){function c(k,m,n){n?(delete a.va[k.key],k.reject(n)):We(a,k,m)}var d,e=b.length,f=a.$b;for(d=0;d<e;d++){var g=b[d];var h=f.clone().ga({tilex:g.x}).ga({tiley:g.y}).ga({level:g.Sb}).ga({layer:g.ra});new Ke(h.toString(),Oa(c,null,g),Pe)}}function Te(a,b){var c=b.length,d;for(d=0;d<c;d+=15){var e=b.slice(d,d+15);Xe(a,e)}}
function Xe(a,b){var c=a.$b.clone(),d=[],e=[],f=[],g=c.getQuery();b.length&&(b.forEach(function(h){d.push(h.x,h.y);e.push(h.Sb);f.push(h.ra)}),g.tilexy=d.join(","),g.layers=f.join(","),g.levels=e.join(","),c.Ta(g),new Ke(c.toString(),function(h,k){k?b.forEach(function(m){delete a.va[m.key];m.reject("error")}):We(a,b,h)},Pe))}
function We(a,b,c){var d=b.length,e;if(Wa(b,void 0,void 0,void 0)){var f=c.indexOf("[")+1;for(e=0;e<d;e++){var g=c.indexOf("]},{",f+3)+2;g<f&&(g=c.lastIndexOf("]}"));var h=c.substr(f,g-f);f=g+1;Ye(a,b[e],h)}}else Ye(a,b,c)}function Ye(a,b,c){try{var d=c.length;var e=b.key;delete a.va[e];a.Ib.add(e,b,2*d);b.resolve(JSON.parse(c))}catch(f){b.reject(f.message)}}function Ze(a,b,c,d,e){return e?[new B(a,b),new B(c,b),new B(c,d),new B(a,d),new B(a,b)]:[a,b,c,b,c,d,a,d]}
Qe.prototype.gd=function(a,b,c){var d=this.tb.Ob()-b.z,e=this.bc<<d,f=50<<d,g=b.x*e;b=b.y*e;var h=g+e;e=b+e;var k=g-f,m=b-f,n=h+f;f=e+f;var q,u,I=c.Rows,K=I.length,w,F=/^ADAS/.test(a.ra),W=this.tb,ia=this.ad,N,Ea=[],va=[],wa=[],xa=[];for(a=0;a<K;a++){var v=w=I[a];var R=(N=F)?"HPY":"LAT";var J=N?"HPX":"LON";var V=N?"HPZ":"ZLEVEL";if(v[R]){var P=te(v[R],v[J],v[V],N);v.geometry=P;delete v[R];delete v[J];delete v[V];if(v.INNER_LAT)for(R=v.INNER_LAT.split(";"),P=v.INNER_LON.split(";"),delete v.INNER_LAT,
delete v.INNER_LON,v.interiors=V=[],J=R.length,v=0;v<J;v++)V.push(te(R[v],P[v],"",N))}if(this.Xb){J=w;v=W;P=J.$$projected$$;R=0;if(!P){var aa=J.geometry;N=ve(aa.path,v);w=[N];J.$$projected$$=P={dd:w};J=(V=J.interiors)?V.length:0;w.length+=J;R|=+$e(w,N,aa.outlineIndices);if(J)for(P.Uc=1,q=0;q<J;q++)aa=V[q],N=ve(aa.path,v),w[1+q]=N,R|=+$e(w,N,aa.outlineIndices);R&&(P.bd=1+J)}v=P;N=v.dd;w=v.Uc;var mc=v.bd;P=[];R=J=Mb;var Za=V=t;v=N[0];if(1===v.length){var nc=nc||(nc=Ze(g,b,h,e,!1));w=v[0];Rb(w.x,w.y,
nc)&&P.push(af(v,g,b,d))}else{var Xd=N.length;for(aa=ia?mc:0;aa<Xd&&(ia||!aa||P.length);aa++)if(v=N[aa],aa>=mc){aa===mc&&(R=P.length);var ja=be([v],k,m,n,f,!1);bf(ja,g,b,d,P)}else{var Bb=Bb||(Bb=Ze(k,m,n,f,!0));if(aa>=w)if(aa===w&&(J=P.length),Za)for(q=Za.length;q--;){if(ja=cf(Za[q],v),u=ja.length){for(V=V||[];u--;)V.push(q);bf(ja,g,b,d,P)}}else ja=cf(Bb,v),bf(ja,g,b,d,P);else if(ja=cf(Bb,v),bf(ja,g,b,d,P),1<ja.length&&w<Xd)for(Za=[],q=ja.length;q--;)Za[q]=ja[q]}}P.length&&(Ea[a]=P,va[a]=J,wa[a]=
V,xa[a]=R)}}return{rd:c,pc:Ea,Vc:va,vc:wa,cd:xa}};function $e(a,b,c){for(var d=c.length,e=0,f,g,h=b.length;e<d;)f=c[e++],g=c[e++],a.push(g-f===h?b:b.slice(f,g));return 0<c.length}function cf(a,b){var c,d=[];if(c=de(a,b)){do{a=[];b=c;do a.push(b);while(b=b.next);d.push(a)}while(c=c.Vb)}else Sb(b[0],Tb(a))?d.push(b):Sb(a[0],Tb(b))&&d.push(a);return d}function bf(a,b,c,d,e){for(var f=0,g=a.length;f<g;f++)e.push(af(a[f],b,c,d))}
function af(a,b,c,d){var e,f=a.length,g=new Int32Array(2*f),h=0;for(e=0;e<f;e++){var k=a[e];g[h++]=k.x-b>>d;g[h++]=k.y-c>>d}return g}
Qe.prototype.xc=function(a,b){var c=b.rd,d=b.pc,e=b.Vc,f=b.cd;b=b.vc;for(var g=[],h,k={Rows:g},m,n=a?a.length:0,q=0,u,I=c.Rows,K=I.length,w;q<K;q+=1)if(d[q]||!this.Xb){h={};u=I[q];if(n)for(m=0;m<n;m++)u.hasOwnProperty(a[m])&&(h[a[m]]=u[a[m]]);else for(w in u)"$$projected$$"!==w&&(h[w]=u[w]);u.geometry&&(h.geometry=u.geometry);m=void 0;var F,W=h,ia=d[q],N=e[q],Ea=b[q],va=f[q],wa=g;if(ia){var xa=ia.length;if(Ea)for(F=N;F--;){if(F){var v={};for(m in W)v[m]=W[m]}else v=W;u=[ia[F]];var R=pb(xa,va)-N;for(h=
0;h<R;h++)Ea[h]===F&&u.push(ia[N+h]);R=u.length;if(!F)for(h=va;h<xa;h++)u.push(ia[h]);v.$HProjGeometry={paths:u,interiorsIndex:1,outlinesIndex:R};wa.push(v)}else W.$HProjGeometry={paths:ia,interiorsIndex:N,outlinesIndex:va},wa.push(W)}else wa.push(W)}c.Meta&&(k.Meta=c.Meta);return k};Qe.prototype.K=function(){var a,b=this.va;for(a in b)b.hasOwnProperty(a)&&(b[a].reject("disposed"),delete b[a])};Qe.prototype.disposeInternal=Qe.prototype.K;
function Se(a){for(var b=[],c,d=a.length,e=0;e<d;e++){c=Ka(a[e]);if(c.rowFilter&&(c.rowFilter=eval("("+c.rowFilter+")"),!Va(c.rowFilter)))throw Error("Invalid row filter for layer "+c.layerId);b.push(c)}return b};r("H.service.extension.worker.processor",function(a,b,c){function d(h){e.postMessage(h)}var e=this,f=Ja[a];var g=function(h){e.postError(h.toString())};if(0===b)f||(Ja[a]=new Qe(c,df)),this.postMessage(void 0);else if(f)switch(b){case 1:try{f.ld.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 2:try{f.kd.apply(f,c).then(d,g)}catch(h){this.postError(h.message)}break;case 3:f.C();delete Ja[a];Ia()&&df.ia();break;default:e.postError("Unsupported command")}});
var df=new U(26214400),Ja=Object.create(Ra,void 0);self.addEventListener("message",function(a){a=new ob(a.data);var b=kb[a.Wb];if(b)try{b.apply(a,a.kc)}catch(c){a.postError(c.message)}else a.postError("processor_not_found")});(function(){var a=new ob;var b=function(c,d){nb.apply(a,[c,d,!0])};b("0",lb);b("1",nb);b("2",mb);b("3",Oe)})();
`,function(){var f=function(){var target=(typeof self>"u"||!(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope))&&(typeof module<"u"&&module.exports||typeof window<"u");if(target)var __worker_src__=f.toString(),__worker_src_map__="",__worker_src_origin__=typeof document<"u"&&document.currentScript instanceof HTMLScriptElement?document.currentScript.src:"";(function(){var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(e.__esModule)return e;var o=e.default;if(typeof o=="function"){var s=function h(){return this instanceof h?Reflect.construct(o,arguments,this.constructor):o.apply(this,arguments)};s.prototype=o.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(e).forEach(function(h){var d=Object.getOwnPropertyDescriptor(e,h);Object.defineProperty(s,h,d.get?d:{enumerable:!0,get:function(){return e[h]}})}),s}var toString$2={}.toString,classofRaw$1=function(e){return toString$2.call(e).slice(8,-1)},shared$1={exports:{}},O="object",check=function(e){return e&&e.Math==Math&&e},global$c=check(typeof globalThis==O&&globalThis)||check(typeof window==O&&window)||check(typeof self==O&&self)||check(typeof commonjsGlobal==O&&commonjsGlobal)||Function("return this")(),objectDefineProperty={},fails$3=function(e){try{return!!e()}catch{return!0}},descriptors=!fails$3(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),isObject$9=function(e){return typeof e=="object"?e!==null:typeof e=="function"},isObject$8=isObject$9,document$3=global$c.document,exist=isObject$8(document$3)&&isObject$8(document$3.createElement),documentCreateElement$1=function(e){return exist?document$3.createElement(e):{}},ie8DomDefine=!descriptors&&!fails$3(function(){return Object.defineProperty(documentCreateElement$1("div"),"a",{get:function(){return 7}}).a!=7}),isObject$7=isObject$9,anObject$9=function(e){if(!isObject$7(e))throw TypeError(String(e)+" is not an object");return e},isObject$6=isObject$9,toPrimitive$2=function(e,o){if(!isObject$6(e))return e;var s,h;if(o&&typeof(s=e.toString)=="function"&&!isObject$6(h=s.call(e))||typeof(s=e.valueOf)=="function"&&!isObject$6(h=s.call(e))||!o&&typeof(s=e.toString)=="function"&&!isObject$6(h=s.call(e)))return h;throw TypeError("Can't convert object to primitive value")},DESCRIPTORS$2=descriptors,IE8_DOM_DEFINE$1=ie8DomDefine,anObject$8=anObject$9,toPrimitive$1=toPrimitive$2,nativeDefineProperty=Object.defineProperty;objectDefineProperty.f=DESCRIPTORS$2?nativeDefineProperty:function(e,o,s){if(anObject$8(e),o=toPrimitive$1(o,!0),anObject$8(s),IE8_DOM_DEFINE$1)try{return nativeDefineProperty(e,o,s)}catch{}if("get"in s||"set"in s)throw TypeError("Accessors not supported");return"value"in s&&(e[o]=s.value),e};var createPropertyDescriptor$3=function(e,o){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:o}},definePropertyModule$2=objectDefineProperty,createPropertyDescriptor$2=createPropertyDescriptor$3,hide$7=descriptors?function(e,o,s){return definePropertyModule$2.f(e,o,createPropertyDescriptor$2(1,s))}:function(e,o,s){return e[o]=s,e},global$b=global$c,hide$6=hide$7,setGlobal$2=function(e,o){try{hide$6(global$b,e,o)}catch{global$b[e]=o}return o},isPure=!1,global$a=global$c,setGlobal$1=setGlobal$2,SHARED="__core-js_shared__",store$2=global$a[SHARED]||setGlobal$1(SHARED,{});(shared$1.exports=function(e,o){return store$2[e]||(store$2[e]=o!==void 0?o:{})})("versions",[]).push({version:"3.1.0",mode:"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"});var sharedExports=shared$1.exports,id$2=0,postfix=Math.random(),uid$2=function(e){return"Symbol(".concat(e===void 0?"":e,")_",(++id$2+postfix).toString(36))},nativeSymbol=!fails$3(function(){return!String(Symbol())}),store$1=sharedExports("wks"),uid$1=uid$2,Symbol$1=global$c.Symbol,NATIVE_SYMBOL=nativeSymbol,wellKnownSymbol$1=function(e){return store$1[e]||(store$1[e]=NATIVE_SYMBOL&&Symbol$1[e]||(NATIVE_SYMBOL?Symbol$1:uid$1)("Symbol."+e))},classofRaw=classofRaw$1,TO_STRING_TAG$2=wellKnownSymbol$1("toStringTag"),CORRECT_ARGUMENTS=classofRaw(function(){return arguments}())=="Arguments",tryGet=function(e,o){try{return e[o]}catch{}},classof$6=function(e){var o,s,h;return e===void 0?"Undefined":e===null?"Null":typeof(s=tryGet(o=Object(e),TO_STRING_TAG$2))=="string"?s:CORRECT_ARGUMENTS?classofRaw(o):(h=classofRaw(o))=="Object"&&typeof o.callee=="function"?"Arguments":h},classof$5=classof$6,TO_STRING_TAG$1=wellKnownSymbol$1("toStringTag"),test={};test[TO_STRING_TAG$1]="z";var objectToString$1=String(test)!=="[object z]"?function(){return"[object "+classof$5(this)+"]"}:test.toString,redefine$2={exports:{}},hasOwnProperty$1={}.hasOwnProperty,has$6=function(e,o){return hasOwnProperty$1.call(e,o)},functionToString,hasRequiredFunctionToString;function requireFunctionToString(){return hasRequiredFunctionToString?functionToString:(hasRequiredFunctionToString=1,functionToString=sharedExports("native-function-to-string",Function.toString))}var nativeFunctionToString=requireFunctionToString(),WeakMap$1=global$c.WeakMap,nativeWeakMap=typeof WeakMap$1=="function"&&/native code/.test(nativeFunctionToString.call(WeakMap$1)),shared=sharedExports("keys"),uid=uid$2,sharedKey$1=function(e){return shared[e]||(shared[e]=uid(e))},hiddenKeys$3={},NATIVE_WEAK_MAP=nativeWeakMap,isObject$5=isObject$9,hide$5=hide$7,objectHas=has$6,sharedKey=sharedKey$1,hiddenKeys$2=hiddenKeys$3,WeakMap=global$c.WeakMap,set$2,get,has$5,enforce=function(e){return has$5(e)?get(e):set$2(e,{})},getterFor=function(e){return function(o){var s;if(!isObject$5(o)||(s=get(o)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return s}};if(NATIVE_WEAK_MAP){var store=new WeakMap,wmget=store.get,wmhas=store.has,wmset=store.set;set$2=function(e,o){return wmset.call(store,e,o),o},get=function(e){return wmget.call(store,e)||{}},has$5=function(e){return wmhas.call(store,e)}}else{var STATE=sharedKey("state");hiddenKeys$2[STATE]=!0,set$2=function(e,o){return hide$5(e,STATE,o),o},get=function(e){return objectHas(e,STATE)?e[STATE]:{}},has$5=function(e){return objectHas(e,STATE)}}var internalState={set:set$2,get,has:has$5,enforce,getterFor},hasRequiredRedefine;function requireRedefine(){if(hasRequiredRedefine)return redefine$2.exports;hasRequiredRedefine=1;var e=global$c,o=hide$7,s=has$6,h=setGlobal$2,d=requireFunctionToString(),g=internalState,_=g.get,j=g.enforce,$=String(d).split("toString");return sharedExports("inspectSource",function(_t){return d.call(_t)}),(redefine$2.exports=function(_t,_e,_r,_i){var _n=!!_i&&!!_i.unsafe,_s=!!_i&&!!_i.enumerable,_l=!!_i&&!!_i.noTargetGet;typeof _r=="function"&&(typeof _e!="string"||s(_r,"name")||o(_r,"name",_e),j(_r).source=$.join(typeof _e=="string"?_e:"")),_t!==e?(_n?!_l&&_t[_e]&&(_s=!0):delete _t[_e],_s?_t[_e]=_r:o(_t,_e,_r)):_s?_t[_e]=_r:h(_e,_r)})(Function.prototype,"toString",function(){return typeof this=="function"&&_(this).source||d.call(this)}),redefine$2.exports}var toString$1=objectToString$1,ObjectPrototype$1=Object.prototype;toString$1!==ObjectPrototype$1.toString&&requireRedefine()(ObjectPrototype$1,"toString",toString$1,{unsafe:!0});var ceil=Math.ceil,floor=Math.floor,toInteger$3=function(e){return isNaN(e=+e)?0:(e>0?floor:ceil)(e)},requireObjectCoercible$3=function(e){if(e==null)throw TypeError("Can't call method on "+e);return e},toInteger$2=toInteger$3,requireObjectCoercible$2=requireObjectCoercible$3,stringAt=function(e,o,s){var h,d,g=String(requireObjectCoercible$2(e)),_=toInteger$2(o),j=g.length;return _<0||_>=j?s?"":void 0:(h=g.charCodeAt(_))<55296||h>56319||_+1===j||(d=g.charCodeAt(_+1))<56320||d>57343?s?g.charAt(_):h:s?g.slice(_,_+2):d-56320+(h-55296<<10)+65536},objectGetOwnPropertyDescriptor={},objectPropertyIsEnumerable={},nativePropertyIsEnumerable={}.propertyIsEnumerable,nativeGetOwnPropertyDescriptor$1=Object.getOwnPropertyDescriptor,NASHORN_BUG=nativeGetOwnPropertyDescriptor$1&&!nativePropertyIsEnumerable.call({1:2},1);objectPropertyIsEnumerable.f=NASHORN_BUG?function(e){var o=nativeGetOwnPropertyDescriptor$1(this,e);return!!o&&o.enumerable}:nativePropertyIsEnumerable;var fails$2=fails$3,classof$4=classofRaw$1,split="".split,indexedObject=fails$2(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return classof$4(e)=="String"?split.call(e,""):Object(e)}:Object,IndexedObject=indexedObject,requireObjectCoercible$1=requireObjectCoercible$3,toIndexedObject$4=function(e){return IndexedObject(requireObjectCoercible$1(e))},DESCRIPTORS$1=descriptors,propertyIsEnumerableModule=objectPropertyIsEnumerable,createPropertyDescriptor$1=createPropertyDescriptor$3,toIndexedObject$3=toIndexedObject$4,toPrimitive=toPrimitive$2,has$4=has$6,IE8_DOM_DEFINE=ie8DomDefine,nativeGetOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;objectGetOwnPropertyDescriptor.f=DESCRIPTORS$1?nativeGetOwnPropertyDescriptor:function(e,o){if(e=toIndexedObject$3(e),o=toPrimitive(o,!0),IE8_DOM_DEFINE)try{return nativeGetOwnPropertyDescriptor(e,o)}catch{}if(has$4(e,o))return createPropertyDescriptor$1(!propertyIsEnumerableModule.f.call(e,o),e[o])};var objectGetOwnPropertyNames={},toInteger$1=toInteger$3,min$1=Math.min,toLength$2=function(e){return e>0?min$1(toInteger$1(e),9007199254740991):0},toInteger=toInteger$3,max=Math.max,min=Math.min,toAbsoluteIndex$1=function(e,o){var s=toInteger(e);return s<0?max(s+o,0):min(s,o)},toIndexedObject$2=toIndexedObject$4,toLength$1=toLength$2,toAbsoluteIndex=toAbsoluteIndex$1,arrayIncludes=function(e){return function(o,s,h){for(var d=toIndexedObject$2(o),g=toLength$1(d.length),_=toAbsoluteIndex(h,g);g>_;_++)if(_ in d&&d[_]===s)return _||0;return-1}},has$3=has$6,toIndexedObject$1=toIndexedObject$4,arrayIndexOf$1=arrayIncludes(),hiddenKeys$1=hiddenKeys$3,objectKeysInternal=function(e,o){var s,h=toIndexedObject$1(e),d=0,g=[];for(s in h)!has$3(hiddenKeys$1,s)&&has$3(h,s)&&g.push(s);for(;o.length>d;)has$3(h,s=o[d++])&&(~arrayIndexOf$1(g,s)||g.push(s));return g},enumBugKeys$2=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],internalObjectKeys$1=objectKeysInternal,hiddenKeys=enumBugKeys$2.concat("length","prototype");objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(e){return internalObjectKeys$1(e,hiddenKeys)};var objectGetOwnPropertySymbols={};objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols;var getOwnPropertyNamesModule=objectGetOwnPropertyNames,getOwnPropertySymbolsModule=objectGetOwnPropertySymbols,anObject$7=anObject$9,Reflect$1=global$c.Reflect,ownKeys$1=Reflect$1&&Reflect$1.ownKeys||function(e){var o=getOwnPropertyNamesModule.f(anObject$7(e)),s=getOwnPropertySymbolsModule.f;return s?o.concat(s(e)):o},has$2=has$6,ownKeys=ownKeys$1,getOwnPropertyDescriptorModule=objectGetOwnPropertyDescriptor,definePropertyModule$1=objectDefineProperty,copyConstructorProperties$1=function(e,o){for(var s=ownKeys(o),h=definePropertyModule$1.f,d=getOwnPropertyDescriptorModule.f,g=0;g<s.length;g++){var _=s[g];has$2(e,_)||h(e,_,d(o,_))}},fails$1=fails$3,replacement=/#|\.prototype\./,isForced$2=function(e,o){var s=data[normalize$1(e)];return s==POLYFILL||s!=NATIVE&&(typeof o=="function"?fails$1(o):!!o)},normalize$1=isForced$2.normalize=function(e){return String(e).replace(replacement,".").toLowerCase()},data=isForced$2.data={},NATIVE=isForced$2.NATIVE="N",POLYFILL=isForced$2.POLYFILL="P",isForced_1=isForced$2,global$9=global$c,getOwnPropertyDescriptor$1=objectGetOwnPropertyDescriptor.f,hide$4=hide$7,redefine$1=requireRedefine(),setGlobal=setGlobal$2,copyConstructorProperties=copyConstructorProperties$1,isForced$1=isForced_1,_export=function(e,o){var s,h,d,g,_,j=e.target,$=e.global,_t=e.stat;if(s=$?global$9:_t?global$9[j]||setGlobal(j,{}):(global$9[j]||{}).prototype)for(h in o){if(g=o[h],d=e.noTargetGet?(_=getOwnPropertyDescriptor$1(s,h))&&_.value:s[h],!isForced$1($?h:j+(_t?".":"#")+h,e.forced)&&d!==void 0){if(typeof g==typeof d)continue;copyConstructorProperties(g,d)}(e.sham||d&&d.sham)&&hide$4(g,"sham",!0),redefine$1(s,h,g,e)}},requireObjectCoercible=requireObjectCoercible$3,toObject$1=function(e){return Object(requireObjectCoercible(e))},correctPrototypeGetter=!fails$3(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),has$1=has$6,toObject=toObject$1,IE_PROTO$1=sharedKey$1("IE_PROTO"),CORRECT_PROTOTYPE_GETTER=correctPrototypeGetter,ObjectPrototype=Object.prototype,objectGetPrototypeOf=CORRECT_PROTOTYPE_GETTER?Object.getPrototypeOf:function(e){return e=toObject(e),has$1(e,IE_PROTO$1)?e[IE_PROTO$1]:typeof e.constructor=="function"&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?ObjectPrototype:null},getPrototypeOf$1=objectGetPrototypeOf,hide$3=hide$7,has=has$6,ITERATOR$5=wellKnownSymbol$1("iterator"),BUGGY_SAFARI_ITERATORS$1=!1,returnThis$2=function(){return this},IteratorPrototype$2,PrototypeOfArrayIteratorPrototype,arrayIterator;[].keys&&(arrayIterator=[].keys(),"next"in arrayIterator?(PrototypeOfArrayIteratorPrototype=getPrototypeOf$1(getPrototypeOf$1(arrayIterator)),PrototypeOfArrayIteratorPrototype!==Object.prototype&&(IteratorPrototype$2=PrototypeOfArrayIteratorPrototype)):BUGGY_SAFARI_ITERATORS$1=!0),IteratorPrototype$2==null&&(IteratorPrototype$2={}),has(IteratorPrototype$2,ITERATOR$5)||hide$3(IteratorPrototype$2,ITERATOR$5,returnThis$2);var iteratorsCore={IteratorPrototype:IteratorPrototype$2,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS$1},internalObjectKeys=objectKeysInternal,enumBugKeys$1=enumBugKeys$2,objectKeys$2=Object.keys||function(e){return internalObjectKeys(e,enumBugKeys$1)},DESCRIPTORS=descriptors,definePropertyModule=objectDefineProperty,anObject$6=anObject$9,objectKeys$1=objectKeys$2,objectDefineProperties=DESCRIPTORS?Object.defineProperties:function(e,o){anObject$6(e);for(var s,h=objectKeys$1(o),d=h.length,g=0;d>g;)definePropertyModule.f(e,s=h[g++],o[s]);return e},document$2=global$c.document,html$2=document$2&&document$2.documentElement,anObject$5=anObject$9,defineProperties=objectDefineProperties,enumBugKeys=enumBugKeys$2,html$1=html$2,documentCreateElement=documentCreateElement$1,IE_PROTO=sharedKey$1("IE_PROTO"),PROTOTYPE="prototype",Empty=function(){},createDict=function(){var e,o=documentCreateElement("iframe"),s=enumBugKeys.length,h="script",d="java"+h+":";for(o.style.display="none",html$1.appendChild(o),o.src=String(d),(e=o.contentWindow.document).open(),e.write("<"+h+">document.F=Object</"+h+">"),e.close(),createDict=e.F;s--;)delete createDict[PROTOTYPE][enumBugKeys[s]];return createDict()},objectCreate=Object.create||function(e,o){var s;return e!==null?(Empty[PROTOTYPE]=anObject$5(e),s=new Empty,Empty[PROTOTYPE]=null,s[IE_PROTO]=e):s=createDict(),o===void 0?s:defineProperties(s,o)},setToStringTag$2,hasRequiredSetToStringTag;function requireSetToStringTag(){if(hasRequiredSetToStringTag)return setToStringTag$2;hasRequiredSetToStringTag=1;var e=objectDefineProperty.f,o=has$6,s=wellKnownSymbol$1("toStringTag");return setToStringTag$2=function(h,d,g){h&&!o(h=g?h:h.prototype,s)&&e(h,s,{configurable:!0,value:d})}}hiddenKeys$3[IE_PROTO]=!0;var iterators={},IteratorPrototype$1=iteratorsCore.IteratorPrototype,create$3=objectCreate,createPropertyDescriptor=createPropertyDescriptor$3,setToStringTag$1=requireSetToStringTag(),Iterators$4=iterators,returnThis$1=function(){return this},createIteratorConstructor$1=function(e,o,s){var h=o+" Iterator";return e.prototype=create$3(IteratorPrototype$1,{next:createPropertyDescriptor(1,s)}),setToStringTag$1(e,h,!1,!0),Iterators$4[h]=returnThis$1,e},isObject$4=isObject$9,anObject$4=anObject$9,validateSetPrototypeOfArguments$1=function(e,o){if(anObject$4(e),!isObject$4(o)&&o!==null)throw TypeError("Can't set "+String(o)+" as a prototype")},validateSetPrototypeOfArguments=validateSetPrototypeOfArguments$1,objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?function(){var e,o=!1,s={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(s,[]),o=s instanceof Array}catch{}return function(h,d){return validateSetPrototypeOfArguments(h,d),o?e.call(h,d):h.__proto__=d,h}}():void 0),$export$1=_export,createIteratorConstructor=createIteratorConstructor$1,getPrototypeOf=objectGetPrototypeOf,setPrototypeOf=objectSetPrototypeOf,setToStringTag=requireSetToStringTag(),hide$2=hide$7,redefine=requireRedefine(),ITERATOR$4=wellKnownSymbol$1("iterator"),Iterators$3=iterators,IteratorsCore=iteratorsCore,IteratorPrototype=IteratorsCore.IteratorPrototype,BUGGY_SAFARI_ITERATORS=IteratorsCore.BUGGY_SAFARI_ITERATORS,KEYS="keys",VALUES="values",ENTRIES="entries",returnThis=function(){return this},defineIterator$2=function(e,o,s,h,d,g,_){createIteratorConstructor(s,o,h);var j,$,_t,_e=function(_h){if(_h===d&&_l)return _l;if(!BUGGY_SAFARI_ITERATORS&&_h in _n)return _n[_h];switch(_h){case KEYS:case VALUES:case ENTRIES:return function(){return new s(this,_h)}}return function(){return new s(this)}},_r=o+" Iterator",_i=!1,_n=e.prototype,_s=_n[ITERATOR$4]||_n["@@iterator"]||d&&_n[d],_l=!BUGGY_SAFARI_ITERATORS&&_s||_e(d),Ap=o=="Array"&&_n.entries||_s;if(Ap&&(j=getPrototypeOf(Ap.call(new e)),IteratorPrototype!==Object.prototype&&j.next&&(getPrototypeOf(j)!==IteratorPrototype&&(setPrototypeOf?setPrototypeOf(j,IteratorPrototype):typeof j[ITERATOR$4]!="function"&&hide$2(j,ITERATOR$4,returnThis)),setToStringTag(j,_r,!0,!0))),d==VALUES&&_s&&_s.name!==VALUES&&(_i=!0,_l=function(){return _s.call(this)}),_n[ITERATOR$4]!==_l&&hide$2(_n,ITERATOR$4,_l),Iterators$3[o]=_l,d)if($={values:_e(VALUES),keys:g?_l:_e(KEYS),entries:_e(ENTRIES)},_)for(_t in $)(BUGGY_SAFARI_ITERATORS||_i||!(_t in _n))&&redefine(_n,_t,$[_t]);else $export$1({target:o,proto:!0,forced:BUGGY_SAFARI_ITERATORS||_i},$);return $},codePointAt$1=stringAt,InternalStateModule$2=internalState,defineIterator$1=defineIterator$2,STRING_ITERATOR="String Iterator",setInternalState$2=InternalStateModule$2.set,getInternalState$2=InternalStateModule$2.getterFor(STRING_ITERATOR);defineIterator$1(String,"String",function(e){setInternalState$2(this,{type:STRING_ITERATOR,string:String(e),index:0})},function(){var e,o=getInternalState$2(this),s=o.string,h=o.index;return h>=s.length?{value:void 0,done:!0}:(e=codePointAt$1(s,h,!0),o.index+=e.length,{value:e,done:!1})});var domIterables={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},UNSCOPABLES=wellKnownSymbol$1("unscopables"),create$2=objectCreate,hide$1=hide$7,ArrayPrototype$1=Array.prototype;ArrayPrototype$1[UNSCOPABLES]==null&&hide$1(ArrayPrototype$1,UNSCOPABLES,create$2(null));var addToUnscopables$1=function(e){ArrayPrototype$1[UNSCOPABLES][e]=!0},toIndexedObject=toIndexedObject$4,addToUnscopables=addToUnscopables$1,Iterators$2=iterators,InternalStateModule$1=internalState,defineIterator=defineIterator$2,ARRAY_ITERATOR="Array Iterator",setInternalState$1=InternalStateModule$1.set,getInternalState$1=InternalStateModule$1.getterFor(ARRAY_ITERATOR),es_array_iterator=defineIterator(Array,"Array",function(e,o){setInternalState$1(this,{type:ARRAY_ITERATOR,target:toIndexedObject(e),index:0,kind:o})},function(){var e=getInternalState$1(this),o=e.target,s=e.kind,h=e.index++;return!o||h>=o.length?(e.target=void 0,{value:void 0,done:!0}):s=="keys"?{value:h,done:!1}:s=="values"?{value:o[h],done:!1}:{value:[h,o[h]],done:!1}},"values");Iterators$2.Arguments=Iterators$2.Array,addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries");var DOMIterables=domIterables,ArrayIteratorMethods=es_array_iterator,global$8=global$c,hide=hide$7,wellKnownSymbol=wellKnownSymbol$1,ITERATOR$3=wellKnownSymbol("iterator"),TO_STRING_TAG=wellKnownSymbol("toStringTag"),ArrayValues=ArrayIteratorMethods.values;for(var COLLECTION_NAME in DOMIterables){var Collection=global$8[COLLECTION_NAME],CollectionPrototype=Collection&&Collection.prototype;if(CollectionPrototype){if(CollectionPrototype[ITERATOR$3]!==ArrayValues)try{hide(CollectionPrototype,ITERATOR$3,ArrayValues)}catch{CollectionPrototype[ITERATOR$3]=ArrayValues}if(CollectionPrototype[TO_STRING_TAG]||hide(CollectionPrototype,TO_STRING_TAG,COLLECTION_NAME),DOMIterables[COLLECTION_NAME]){for(var METHOD_NAME in ArrayIteratorMethods)if(CollectionPrototype[METHOD_NAME]!==ArrayIteratorMethods[METHOD_NAME])try{hide(CollectionPrototype,METHOD_NAME,ArrayIteratorMethods[METHOD_NAME])}catch{CollectionPrototype[METHOD_NAME]=ArrayIteratorMethods[METHOD_NAME]}}}}var aFunction$5=function(e){if(typeof e!="function")throw TypeError(String(e)+" is not a function");return e},anInstance$1=function(e,o,s){if(!(e instanceof o))throw TypeError("Incorrect "+(s?s+" ":"")+"invocation");return e},iterate$1={exports:{}},Iterators$1=iterators,ITERATOR$2=wellKnownSymbol$1("iterator"),ArrayPrototype=Array.prototype,isArrayIteratorMethod$1=function(e){return e!==void 0&&(Iterators$1.Array===e||ArrayPrototype[ITERATOR$2]===e)},aFunction$4=aFunction$5,bindContext=function(e,o,s){if(aFunction$4(e),o===void 0)return e;switch(s){case 0:return function(){return e.call(o)};case 1:return function(h){return e.call(o,h)};case 2:return function(h,d){return e.call(o,h,d)};case 3:return function(h,d,g){return e.call(o,h,d,g)}}return function(){return e.apply(o,arguments)}},classof$3=classof$6,ITERATOR$1=wellKnownSymbol$1("iterator"),Iterators=iterators,getIteratorMethod$1=function(e){if(e!=null)return e[ITERATOR$1]||e["@@iterator"]||Iterators[classof$3(e)]},anObject$3=anObject$9,callWithSafeIterationClosing$1=function(e,o,s,h){try{return h?o(anObject$3(s)[0],s[1]):o(s)}catch(g){var d=e.return;throw d!==void 0&&anObject$3(d.call(e)),g}},anObject$2=anObject$9,isArrayIteratorMethod=isArrayIteratorMethod$1,toLength=toLength$2,bind$2=bindContext,getIteratorMethod=getIteratorMethod$1,callWithSafeIterationClosing=callWithSafeIterationClosing$1,BREAK={},exports$1=iterate$1.exports=function(e,o,s,h,d){var g,_,j,$,_t,_e=bind$2(o,s,h?2:1);if(d)g=e;else{if(typeof(_=getIteratorMethod(e))!="function")throw TypeError("Target is not iterable");if(isArrayIteratorMethod(_)){for(j=0,$=toLength(e.length);$>j;j++)if((h?_e(anObject$2(_t=e[j])[0],_t[1]):_e(e[j]))===BREAK)return BREAK;return}g=_.call(e)}for(;!(_t=g.next()).done;)if(callWithSafeIterationClosing(g,_e,_t.value,h)===BREAK)return BREAK};exports$1.BREAK=BREAK;var iterateExports=iterate$1.exports,ITERATOR=wellKnownSymbol$1("iterator"),SAFE_CLOSING=!1;try{var called=0,iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=!0}};iteratorWithReturn[ITERATOR]=function(){return this},Array.from(iteratorWithReturn,function(){throw 2})}catch(e){}var checkCorrectnessOfIteration$1=function(e,o){if(!o&&!SAFE_CLOSING)return!1;var s=!1;try{var h={};h[ITERATOR]=function(){return{next:function(){return{done:s=!0}}}},e(h)}catch{}return s},anObject$1=anObject$9,aFunction$3=aFunction$5,SPECIES$1=wellKnownSymbol$1("species"),speciesConstructor$2=function(e,o){var s,h=anObject$1(e).constructor;return h===void 0||(s=anObject$1(h)[SPECIES$1])==null?o:aFunction$3(s)},global$7=global$c,fails=fails$3,classof$2=classofRaw$1,bind$1=bindContext,html=html$2,createElement=documentCreateElement$1,location=global$7.location,set$1=global$7.setImmediate,clear=global$7.clearImmediate,process$2=global$7.process,MessageChannel=global$7.MessageChannel,Dispatch=global$7.Dispatch,counter=0,queue={},ONREADYSTATECHANGE="onreadystatechange",defer,channel,port,run=function(e){if(queue.hasOwnProperty(e)){var o=queue[e];delete queue[e],o()}},runner=function(e){return function(){run(e)}},listener=function(e){run(e.data)},post=function(e){global$7.postMessage(e+"",location.protocol+"//"+location.host)};set$1&&clear||(set$1=function(e){for(var o=[],s=1;arguments.length>s;)o.push(arguments[s++]);return queue[++counter]=function(){(typeof e=="function"?e:Function(e)).apply(void 0,o)},defer(counter),counter},clear=function(e){delete queue[e]},classof$2(process$2)=="process"?defer=function(e){process$2.nextTick(runner(e))}:Dispatch&&Dispatch.now?defer=function(e){Dispatch.now(runner(e))}:MessageChannel?(channel=new MessageChannel,port=channel.port2,channel.port1.onmessage=listener,defer=bind$1(port.postMessage,port,1)):!global$7.addEventListener||typeof postMessage!="function"||global$7.importScripts||fails(post)?defer=ONREADYSTATECHANGE in createElement("script")?function(e){html.appendChild(createElement("script"))[ONREADYSTATECHANGE]=function(){html.removeChild(this),run(e)}}:function(e){setTimeout(runner(e),0)}:(defer=post,global$7.addEventListener("message",listener,!1)));var task$1={set:set$1,clear},global$6=global$c,navigator$1=global$6.navigator,userAgent$2=navigator$1&&navigator$1.userAgent||"",global$5=global$c,getOwnPropertyDescriptor=objectGetOwnPropertyDescriptor.f,classof$1=classofRaw$1,macrotask=task$1.set,userAgent$1=userAgent$2,MutationObserver=global$5.MutationObserver||global$5.WebKitMutationObserver,process$1=global$5.process,Promise$1=global$5.Promise,IS_NODE$1=classof$1(process$1)=="process",queueMicrotaskDescriptor=getOwnPropertyDescriptor(global$5,"queueMicrotask"),queueMicrotask=queueMicrotaskDescriptor&&queueMicrotaskDescriptor.value,flush,head,last,notify$1,toggle,node,promise;queueMicrotask||(flush=function(){var e,o;for(IS_NODE$1&&(e=process$1.domain)&&e.exit();head;){o=head.fn,head=head.next;try{o()}catch(s){throw head?notify$1():last=void 0,s}}last=void 0,e&&e.enter()},IS_NODE$1?notify$1=function(){process$1.nextTick(flush)}:MutationObserver&&!/(iphone|ipod|ipad).*applewebkit/i.test(userAgent$1)?(toggle=!0,node=document.createTextNode(""),new MutationObserver(flush).observe(node,{characterData:!0}),notify$1=function(){node.data=toggle=!toggle}):Promise$1&&Promise$1.resolve?(promise=Promise$1.resolve(void 0),notify$1=function(){promise.then(flush)}):notify$1=function(){macrotask.call(global$5,flush)});var microtask$1=queueMicrotask||function(e){var o={fn:e,next:void 0};last&&(last.next=o),head||(head=o,notify$1()),last=o},newPromiseCapability$2={},aFunction$2=aFunction$5,PromiseCapability=function(e){var o,s;this.promise=new e(function(h,d){if(o!==void 0||s!==void 0)throw TypeError("Bad Promise constructor");o=h,s=d}),this.resolve=aFunction$2(o),this.reject=aFunction$2(s)};newPromiseCapability$2.f=function(e){return new PromiseCapability(e)};var anObject=anObject$9,isObject$3=isObject$9,newPromiseCapability$1=newPromiseCapability$2,promiseResolve$2=function(e,o){if(anObject(e),isObject$3(o)&&o.constructor===e)return o;var s=newPromiseCapability$1.f(e);return(0,s.resolve)(o),s.promise},global$4=global$c,hostReportErrors$1=function(e,o){var s=global$4.console;s&&s.error&&(arguments.length===1?s.error(e):s.error(e,o))},perform$1=function(e){try{return{error:!1,value:e()}}catch(o){return{error:!0,value:o}}},redefineAll,hasRequiredRedefineAll;function requireRedefineAll(){if(hasRequiredRedefineAll)return redefineAll;hasRequiredRedefineAll=1;var e=requireRedefine();return redefineAll=function(o,s,h){for(var d in s)e(o,d,s[d],h);return o},redefineAll}var path$1=global$c,path=path$1,global$3=global$c,aFunction$1=function(e){return typeof e=="function"?e:void 0},getBuiltIn$1=function(e,o){return arguments.length<2?aFunction$1(path[e])||aFunction$1(global$3[e]):path[e]&&path[e][o]||global$3[e]&&global$3[e][o]},setSpecies,hasRequiredSetSpecies;function requireSetSpecies(){if(hasRequiredSetSpecies)return setSpecies;hasRequiredSetSpecies=1;var e=getBuiltIn$1,o=objectDefineProperty,s=descriptors,h=wellKnownSymbol$1("species");return setSpecies=function(d){var g=e(d),_=o.f;s&&g&&!g[h]&&_(g,h,{configurable:!0,get:function(){return this}})}}var PROMISE="Promise",IS_PURE=isPure,global$2=global$c,$export=_export,isObject$2=isObject$9,aFunction=aFunction$5,anInstance=anInstance$1,classof=classofRaw$1,iterate=iterateExports,checkCorrectnessOfIteration=checkCorrectnessOfIteration$1,speciesConstructor$1=speciesConstructor$2,task=task$1.set,microtask=microtask$1,promiseResolve$1=promiseResolve$2,hostReportErrors=hostReportErrors$1,newPromiseCapabilityModule=newPromiseCapability$2,perform=perform$1,userAgent=userAgent$2,SPECIES=wellKnownSymbol$1("species"),InternalStateModule=internalState,isForced=isForced_1,getInternalState=InternalStateModule.get,setInternalState=InternalStateModule.set,getInternalPromiseState=InternalStateModule.getterFor(PROMISE),PromiseConstructor=global$2[PROMISE],TypeError$1=global$2.TypeError,document$1=global$2.document,process=global$2.process,$fetch=global$2.fetch,versions=process&&process.versions,v8=versions&&versions.v8||"",newPromiseCapability=newPromiseCapabilityModule.f,newGenericPromiseCapability=newPromiseCapability,IS_NODE=classof(process)=="process",DISPATCH_EVENT=!!(document$1&&document$1.createEvent&&global$2.dispatchEvent),UNHANDLED_REJECTION="unhandledrejection",REJECTION_HANDLED="rejectionhandled",PENDING=0,FULFILLED=1,REJECTED=2,HANDLED=1,UNHANDLED=2,Internal,OwnPromiseCapability,PromiseWrapper,FORCED=isForced(PROMISE,function(){var e=PromiseConstructor.resolve(1),o=function(){},s=(e.constructor={})[SPECIES]=function(h){h(o,o)};return!((IS_NODE||typeof PromiseRejectionEvent=="function")&&!IS_PURE&&e.then(o)instanceof s&&v8.indexOf("6.6")!==0&&userAgent.indexOf("Chrome/66")===-1)}),INCORRECT_ITERATION=FORCED||!checkCorrectnessOfIteration(function(e){PromiseConstructor.all(e).catch(function(){})}),isThenable=function(e){var o;return!(!isObject$2(e)||typeof(o=e.then)!="function")&&o},notify=function(e,o,s){if(!o.notified){o.notified=!0;var h=o.reactions;microtask(function(){for(var d=o.value,g=o.state==FULFILLED,_=0,j=function($){var _t,_e,_r,_i=g?$.ok:$.fail,_n=$.resolve,_s=$.reject,_l=$.domain;try{_i?(g||(o.rejection===UNHANDLED&&onHandleUnhandled(e,o),o.rejection=HANDLED),_i===!0?_t=d:(_l&&_l.enter(),_t=_i(d),_l&&(_l.exit(),_r=!0)),_t===$.promise?_s(TypeError$1("Promise-chain cycle")):(_e=isThenable(_t))?_e.call(_t,_n,_s):_n(_t)):_s(d)}catch(Ap){_l&&!_r&&_l.exit(),_s(Ap)}};h.length>_;)j(h[_++]);o.reactions=[],o.notified=!1,s&&!o.rejection&&onUnhandled(e,o)})}},dispatchEvent=function(e,o,s){var h,d;DISPATCH_EVENT?((h=document$1.createEvent("Event")).promise=o,h.reason=s,h.initEvent(e,!1,!0),global$2.dispatchEvent(h)):h={promise:o,reason:s},(d=global$2["on"+e])?d(h):e===UNHANDLED_REJECTION&&hostReportErrors("Unhandled promise rejection",s)},onUnhandled=function(e,o){task.call(global$2,function(){var s,h=o.value;if(isUnhandled(o)&&(s=perform(function(){IS_NODE?process.emit("unhandledRejection",h,e):dispatchEvent(UNHANDLED_REJECTION,e,h)}),o.rejection=IS_NODE||isUnhandled(o)?UNHANDLED:HANDLED,s.error))throw s.value})},isUnhandled=function(e){return e.rejection!==HANDLED&&!e.parent},onHandleUnhandled=function(e,o){task.call(global$2,function(){IS_NODE?process.emit("rejectionHandled",e):dispatchEvent(REJECTION_HANDLED,e,o.value)})},bind=function(e,o,s,h){return function(d){e(o,s,d,h)}},internalReject=function(e,o,s,h){o.done||(o.done=!0,h&&(o=h),o.value=s,o.state=REJECTED,notify(e,o,!0))},internalResolve=function(e,o,s,h){if(!o.done){o.done=!0,h&&(o=h);try{if(e===s)throw TypeError$1("Promise can't be resolved itself");var d=isThenable(s);d?microtask(function(){var g={done:!1};try{d.call(s,bind(internalResolve,e,g,o),bind(internalReject,e,g,o))}catch(_){internalReject(e,g,_,o)}}):(o.value=s,o.state=FULFILLED,notify(e,o,!1))}catch(g){internalReject(e,{done:!1},g,o)}}};FORCED&&(PromiseConstructor=function(e){anInstance(this,PromiseConstructor,PROMISE),aFunction(e),Internal.call(this);var o=getInternalState(this);try{e(bind(internalResolve,this,o),bind(internalReject,this,o))}catch(s){internalReject(this,o,s)}},Internal=function(e){setInternalState(this,{type:PROMISE,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:PENDING,value:void 0})},Internal.prototype=requireRedefineAll()(PromiseConstructor.prototype,{then:function(e,o){var s=getInternalPromiseState(this),h=newPromiseCapability(speciesConstructor$1(this,PromiseConstructor));return h.ok=typeof e!="function"||e,h.fail=typeof o=="function"&&o,h.domain=IS_NODE?process.domain:void 0,s.parent=!0,s.reactions.push(h),s.state!=PENDING&&notify(this,s,!1),h.promise},catch:function(e){return this.then(void 0,e)}}),OwnPromiseCapability=function(){var e=new Internal,o=getInternalState(e);this.promise=e,this.resolve=bind(internalResolve,e,o),this.reject=bind(internalReject,e,o)},newPromiseCapabilityModule.f=newPromiseCapability=function(e){return e===PromiseConstructor||e===PromiseWrapper?new OwnPromiseCapability(e):newGenericPromiseCapability(e)},typeof $fetch=="function"&&$export({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return promiseResolve$1(PromiseConstructor,$fetch.apply(global$2,arguments))}})),$export({global:!0,wrap:!0,forced:FORCED},{Promise:PromiseConstructor}),requireSetToStringTag()(PromiseConstructor,PROMISE,!1,!0),requireSetSpecies()(PROMISE),PromiseWrapper=path$1[PROMISE],$export({target:PROMISE,stat:!0,forced:FORCED},{reject:function(e){var o=newPromiseCapability(this);return o.reject.call(void 0,e),o.promise}}),$export({target:PROMISE,stat:!0,forced:FORCED},{resolve:function(e){return promiseResolve$1(this,e)}}),$export({target:PROMISE,stat:!0,forced:INCORRECT_ITERATION},{all:function(e){var o=this,s=newPromiseCapability(o),h=s.resolve,d=s.reject,g=perform(function(){var _=aFunction(o.resolve),j=[],$=0,_t=1;iterate(e,function(_e){var _r=$++,_i=!1;j.push(void 0),_t++,_.call(o,_e).then(function(_n){_i||(_i=!0,j[_r]=_n,--_t||h(j))},d)}),--_t||h(j)});return g.error&&d(g.value),s.promise},race:function(e){var o=this,s=newPromiseCapability(o),h=s.reject,d=perform(function(){var g=aFunction(o.resolve);iterate(e,function(_){g.call(o,_).then(s.resolve,h)})});return d.error&&h(d.value),s.promise}});var getBuiltIn=getBuiltIn$1,speciesConstructor=speciesConstructor$2,promiseResolve=promiseResolve$2,perf;if(_export({target:"Promise",proto:!0,real:!0},{finally:function(e){var o=speciesConstructor(this,getBuiltIn("Promise")),s=typeof e=="function";return this.then(s?function(h){return promiseResolve(o,e()).then(function(){return h})}:e,s?function(h){return promiseResolve(o,e()).then(function(){throw h})}:e)}}),path$1.Promise,typeof Object.assign!="function"&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),s=1;s<arguments.length;s++){var h=arguments[s];if(h!=null)for(var d in h)h.hasOwnProperty(d)&&(o[d]=h[d])}return o}),typeof Object.values!="function"&&(Object.values=function(e){return Object.keys(e).map(function(o){return e[o]})}),Math.hypot=Math.hypot||function(){for(var e=0,o=arguments.length,s=0;s<o;s++){if(arguments[s]===1/0||arguments[s]===-1/0)return 1/0;e+=arguments[s]*arguments[s]}return Math.sqrt(e)},Math.log2=Math.log2||function(e){return Math.log(e)*Math.LOG2E},typeof window<"u"?(!("performance"in window)&&(window.performance={}),perf=window.performance):typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&(!("performance"in self)&&(self.performance={}),perf=self.performance),perf&&typeof perf.now!="function"){var start=+new Date;perf.now=function(){return+new Date-start}}function _callSuper(e,o,s){return o=_getPrototypeOf(o),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(o,s||[],_getPrototypeOf(e).constructor):o.apply(e,s))}function _construct(e,o,s){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var h=[null];h.push.apply(h,o);var d=new(e.bind.apply(e,h));return s&&_setPrototypeOf(d,s.prototype),d}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct=function(){return!!e})()}function _iterableToArrayLimit(e,o){var s=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(s!=null){var h,d,g,_,j=[],$=!0,_t=!1;try{if(g=(s=s.call(e)).next,o===0){if(Object(s)!==s)return;$=!1}else for(;!($=(h=g.call(s)).done)&&(j.push(h.value),j.length!==o);$=!0);}catch(_e){_t=!0,d=_e}finally{try{if(!$&&s.return!=null&&(_=s.return(),Object(_)!==_))return}finally{if(_t)throw d}}return j}}function _toPrimitive(e,o){if(typeof e!="object"||!e)return e;var s=e[Symbol.toPrimitive];if(s!==void 0){var h=s.call(e,o||"default");if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(e)}function _toPropertyKey(e){var o=_toPrimitive(e,"string");return typeof o=="symbol"?o:o+""}function _typeof(e){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(e)}function _classCallCheck(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,o){for(var s=0;s<o.length;s++){var h=o[s];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(e,_toPropertyKey(h.key),h)}}function _createClass(e,o,s){return o&&_defineProperties(e.prototype,o),s&&_defineProperties(e,s),Object.defineProperty(e,"prototype",{writable:!1}),e}function _defineProperty(e,o,s){return(o=_toPropertyKey(o))in e?Object.defineProperty(e,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[o]=s,e}function _inherits(e,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),o&&_setPrototypeOf(e,o)}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(e)}function _setPrototypeOf(e,o){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,h){return s.__proto__=h,s},_setPrototypeOf(e,o)}function _isNativeFunction(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function _wrapNativeSuper(e){var o=typeof Map=="function"?new Map:void 0;return _wrapNativeSuper=function(s){if(s===null||!_isNativeFunction(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(o!==void 0){if(o.has(s))return o.get(s);o.set(s,h)}function h(){return _construct(s,arguments,_getPrototypeOf(this).constructor)}return h.prototype=Object.create(s.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(h,s)},_wrapNativeSuper(e)}function _assertThisInitialized(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,o){if(o&&(typeof o=="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _superPropBase(e,o){for(;!Object.prototype.hasOwnProperty.call(e,o)&&(e=_getPrototypeOf(e))!==null;);return e}function _get(){return _get=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(e,o,s){var h=_superPropBase(e,o);if(h){var d=Object.getOwnPropertyDescriptor(h,o);return d.get?d.get.call(arguments.length<3?e:s):d.value}},_get.apply(this,arguments)}function _slicedToArray(e,o){return _arrayWithHoles(e)||_iterableToArrayLimit(e,o)||_unsupportedIterableToArray(e,o)||_nonIterableRest()}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArray(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _unsupportedIterableToArray(e,o){if(e){if(typeof e=="string")return _arrayLikeToArray(e,o);var s=Object.prototype.toString.call(e).slice(8,-1);return s==="Object"&&e.constructor&&(s=e.constructor.name),s==="Map"||s==="Set"?Array.from(e):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?_arrayLikeToArray(e,o):void 0}}function _arrayLikeToArray(e,o){(o==null||o>e.length)&&(o=e.length);for(var s=0,h=new Array(o);s<o;s++)h[s]=e[s];return h}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _createForOfIteratorHelper(e,o){var s=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!s){if(Array.isArray(e)||(s=_unsupportedIterableToArray(e))||o){s&&(e=s);var h=0,d=function(){};return{s:d,n:function(){return h>=e.length?{done:!0}:{done:!1,value:e[h++]}},e:function($){throw $},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g,_=!0,j=!1;return{s:function(){s=s.call(e)},n:function(){var $=s.next();return _=$.done,$},e:function($){j=!0,g=$},f:function(){try{_||s.return==null||s.return()}finally{if(j)throw g}}}}var global$1=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},ns={},MathUtils;(function(){var e,o=typeof Object.defineProperties=="function"?Object.defineProperty:function(_u,_f,iy){_u!=Array.prototype&&_u!=Object.prototype&&(_u[_f]=iy.value)},s=typeof window<"u"&&window===this?this:global$1!==void 0&&global$1!=null?global$1:this;if(typeof Object.setPrototypeOf=="function")e=Object.setPrototypeOf;else{var h;t:{var d={};try{d.__proto__={ea:!0},h=d.ea;break t}catch{}h=!1}e=h?function(_u,_f){if(_u.__proto__=_f,_u.__proto__!==_f)throw new TypeError(_u+" is not extensible");return _u}:null}var g=e;(function(_u,_f){if(_f){var iy=s;_u=_u.split(".");for(var sy=0;sy<_u.length-1;sy++){var cy=_u[sy];cy in iy||(iy[cy]={}),iy=iy[cy]}(_f=_f(sy=iy[_u=_u[_u.length-1]]))!=sy&&_f!=null&&o(iy,_u,{configurable:!0,writable:!0,value:_f})}})("Object.setPrototypeOf",function(_u){return _u||g});var _=this||self;function j(_u){var _f=_typeof(_u);if(_f=="object"){if(!_u)return"null";if(_u instanceof Array)return"array";if(_u instanceof Object)return _f;var iy=Object.prototype.toString.call(_u);if(iy=="[object Window]")return"object";if(iy=="[object Array]"||typeof _u.length=="number"&&_u.splice!==void 0&&_u.propertyIsEnumerable!==void 0&&!_u.propertyIsEnumerable("splice"))return"array";if(iy=="[object Function]"||_u.call!==void 0&&_u.propertyIsEnumerable!==void 0&&!_u.propertyIsEnumerable("call"))return"function"}else if(_f=="function"&&_u.call===void 0)return"object";return _f}function $(_u){return j(_u)=="function"}function _t(_u){var _f=_typeof(_u);return _f=="object"&&_u!=null||_f=="function"}function _e(_u,_f){_u=_u.split(".");var iy,sy=_;for((_u[0]in sy)||sy.execScript===void 0||sy.execScript("var "+_u[0]);_u.length&&(iy=_u.shift());)_u.length||_f===void 0?sy=sy[iy]&&sy[iy]!==Object.prototype[iy]?sy[iy]:sy[iy]={}:sy[iy]=_f}function _r(_u,_f){function iy(){}iy.prototype=_f.prototype,_u.ua=_f.prototype,_u.prototype=new iy,_u.prototype.constructor=_u}var _i=Math,_n=_i.min,_s=_i.max,_l=_i.round,Ap=_i.floor,_h=_i.ceil,_p=_i.abs,ty=_i.log,ry=_i.sqrt,ly=_i.pow,uy=_i.sin,py=_i.asin,fy=_i.cos,my=_i.tan,xy=_i.atan2,Ly=_i.PI,My=Ly/2,Ry=Ly/4,Sy=2*Ly,Zy=3*Ly,qy=Ly/180,_m=180/Ly;function ky(_u,_f,iy){return _u>iy?iy:_u<_f?_f:_u}function Dy(_u,_f,iy){return _f<iy?_u>=_f&&_u<=iy:_u>=iy&&_u<=_f}function Gy(_u,_f,iy,sy,cy,hy){return ry(ly((_u-cy)*(sy-hy)-(_f-hy)*(iy-cy),2)/(ly(iy-cy,2)+ly(sy-hy,2)))}_e("H.math.normalize",function(_u,_f,iy){return _f-=iy=iy||0,(_u-=iy)-Ap(_u/_f)*_f+iy}),_e("H.math.clamp",ky);var Ky={NONE:0,VERTEX:1,EDGE:2,SURFACE:3};function sv(_u,_f){var iy=_u.x;_u=_u.y;for(var sy,cy,hy,vy,Ey=_f.length,Ay=Ey,Iy=_f[0],Fy=0,_g=0,pv=0;Fy!=1&&1<Ay;)cy=_f[--Ay],sy=_f[--Ay],vy=_f[Ay?Ay-1:(Ey+(Ay-1))%Ey],hy=_f[Ay?Ay-2:(Ey+(Ay-2))%Ey],sy>=iy&&sy<=iy&&cy>=_u&&cy<=_u||hy>=iy&&hy<=iy&&vy>=_u&&vy<=_u?Fy=1:Fy||sy!==iy?!Fy&&Dy(iy,sy,hy)&&((sy<iy&&hy>iy||sy>iy&&hy<iy)&&(_g+=(Iy=cy+(iy-sy)/(hy-sy)*(vy-cy))>_u,pv+=Iy<_u),Fy=Dy(_u,cy,vy)&&0>=Gy(iy,_u,sy,cy,hy,vy)?2:0):(hy===iy&&(cy<_u&&vy>_u||cy>_u&&vy<_u)||(Iy<=iy&&hy>iy||Iy>=iy&&hy<iy)&&(cy>=_u?++_g:++pv),Fy=Dy(_u,cy,vy)&&0>=Gy(iy,_u,sy,cy,hy,vy)?2:0),Iy=sy;return!Fy&&pv!==0&&_g%2!=0&&(Fy=3),Fy!==Ky.NONE}function Hy(_u,_f){this.x=+_u,this.y=+_f}function vv(_u,_f,iy,sy,cy,hy){var vy=_u.x;_u=-_u.y;var Ey=_f.x;if(_f=-_f.y,iy=-iy,hy=-hy,vy>Ey){if(Ey>cy||vy<sy)return;var Ay=vy,Iy=_u;vy=Ey,_u=_f,Ey=Ay,_f=Iy,Ay=1}else if(vy>cy||Ey<sy)return;if(_u>_f){if(_f>iy||_u<hy)return;var Fy=1;_u=-_u,_f=-_f,Iy=hy,hy=-iy,iy=-Iy}else if(_u>iy||_f<hy)return;if(vy<sy){if((_u+=(sy-vy)*(_f-_u)/(Ey-vy))>iy)return;vy=sy}if(_u<hy){if((vy+=(hy-_u)*(Ey-vy)/(_f-_u))>cy)return;_u=hy}return Ey>cy&&(_f=_u+(cy-vy)*(_f-_u)/(Ey-vy),Ey=cy),_f>iy&&(Ey=vy+(iy-_u)*(Ey-vy)/(_f-_u),_f=iy),Fy&&(_u=-_u,_f=-_f),Ay?[new Hy(Ey,-_f),new Hy(vy,-_u)]:[new Hy(vy,-_u),new Hy(Ey,-_f)]}function _v(_u,_f,iy,sy,cy,hy,vy,Ey,Ay,Iy){return _u={x:_u,y:_f,next:iy||null,s:sy||null,ta:cy||null,X:hy||null,o:!!vy,T:Ey||0,O:Ay||0,alpha:Iy||0},sy&&(_u.s.next=_u),iy&&(_u.next.s=_u),_u}function Av(_u){for(;_u&&_u.o;)_u=_u.next;return _u}function Mv(_u){if(_u)for(;_u.next;)_u=_u.next;return _u}function Nv(_u){var _f=_u;if(_f)do _f=_f.next;while(_f!=_u&&(!_f.o||_f.o&&_f.O));return _f}function iv(_u){var _f=Mv(_u);_f.s.next=_u,_u.s=_f.s}function Ov(_u,_f,iy,sy,cy){var hy,vy=_f.x-_u.x,Ey=_f.y-_u.y,Ay=sy.x-iy.x,Iy=sy.y-iy.y,Fy=vy*Iy-Ey*Ay;return Fy?(Ay=((iy.x-_u.x)*Iy-(iy.y-_u.y)*Ay)/Fy,Fy=(Ey*(iy.x-_u.x)-vy*(iy.y-_u.y))/Fy,0>Ay||1<Ay||0>Fy||1<Fy?0:(Ay===0?hy=_u:Ay===1?hy=_f:Fy===0?hy=iy:Fy===1&&(hy=sy),hy?(hy.x+=2480549651603763e-20,hy.y+=7321997314118067e-20,hy.M&&(hy.M.x=hy.x,hy.M.y=hy.y),Ov(_u,_f,iy,sy,cy)):(cy.xa=_u.x+Ay*vy,cy.ya=_u.y+Ay*Ey,cy.fa=Ay,cy.ga=Fy,1))):0}function Qv(_u){for(var _f=[];_u;)_f.push(_u.x,_u.y),_u=_u.next;return _f}function t0(_u,_f,iy){for(_f=_f.next;_f!==iy&&_f.alpha<=_u.alpha;)_f=_f.next;_u.next=_f,_u.s=_f.s,_u.next.s=_u,_u.s.next=_u}function s0(_u,_f){for(var iy,sy=null,cy=0,hy=_u.length;cy<hy;cy++)(iy=_v(_u[cy].x,_u[cy].y,sy)).qa=_f,(iy.next=sy)&&(sy.s=iy),sy=iy;return sy}function Gv(_u,_f,iy,sy){return(_u-=iy)*_u+(_f-=sy)*_f}function Zv(_u,_f,iy,sy,cy){var hy=0,vy=sy,Ey=_u[sy].x,Ay=_u[sy].y,Iy=_u[cy].x,Fy=_u[cy].y,_g=sy+1,pv=Gv(Ey,Ay,Iy,Fy);if(pv)for(;_g<cy;){var lv=_u[_g++],wv=lv.x,Cv=((wv-Ey)*(Iy-Ey)+((lv=lv.y)-Ay)*(Fy-Ay))/pv;(wv=0>Cv?Gv(wv,lv,Ey,Ay):1<Cv?Gv(wv,lv,Iy,Fy):Gv(wv,lv,Ey+Cv*(Iy-Ey),Ay+Cv*(Fy-Ay)))>hy&&(hy=wv,vy=_g-1)}else for(;_g<cy;)(wv=Gv(wv=(lv=_u[_g++]).x,lv=lv.y,Ey,Ay))>hy&&(hy=wv,vy=_g-1);return hy>=_f||0<iy&&vy-sy?(--iy,1<vy-sy?(sy=Zv(_u,_f,iy,sy,vy)).splice(sy.length-1,1):sy=[_u[sy]],sy=1<cy-vy?sy.concat(Zv(_u,_f,iy,vy,cy)):sy.concat(_u.slice(vy,cy+1))):sy=[_u[sy],_u[cy]],sy}_e("H.math.CoverType",Ky),_e("H.math.isPointInsidePolygon",sv),_e("H.math.flatten",function(_u){for(var _f=_u.length,iy=new Float64Array(2*_f),sy=_f&&_u[0].x!==Pv;_f--;){var cy=_u[_f],hy=_f<<1;iy[hy]=sy?cy.x:cy[0],iy[hy+1]=sy?cy.y:cy[1]}return iy}),_e("H.math.Point",Hy),Hy.prototype.set=Hy,Hy.prototype.set=Hy.prototype.set,Hy.prototype.clone=function(_u){return _u?(_u.x=this.x,_u.y=this.y):_u=new Hy(this.x,this.y),_u},Hy.prototype.clone=Hy.prototype.clone,Hy.prototype.add=function(_u){return this.x+=_u.x,this.y+=_u.y,this},Hy.prototype.add=Hy.prototype.add,Hy.prototype.sub=function(_u){return this.x-=_u.x,this.y-=_u.y,this},Hy.prototype.sub=Hy.prototype.sub,Hy.prototype.scale=function(_u,_f){return this.x*=_u,this.y*=_f===void 0?_u:_f,this},Hy.prototype.scale=Hy.prototype.scale,Hy.prototype.round=function(){return this.x=_l(this.x),this.y=_l(this.y),this},Hy.prototype.round=Hy.prototype.round,Hy.prototype.floor=function(){return this.x=Ap(this.x),this.y=Ap(this.y),this},Hy.prototype.floor=Hy.prototype.floor,Hy.prototype.ceil=function(){return this.x=_h(this.x),this.y=_h(this.y),this},Hy.prototype.ceil=Hy.prototype.ceil,Hy.prototype.w=function(_u){return!(!_u||this.x!==_u.x||this.y!==_u.y)},Hy.prototype.equals=Hy.prototype.w,Hy.prototype.la=function(_u,_f){var iy=_f.x-_u.x,sy=_f.y-_u.y,cy=_u;if(iy||sy){var hy=((this.x-_u.x)*iy+(this.y-_u.y)*sy)/(iy*iy+sy*sy);cy=0>=hy?_u:1<=hy?_f:new Hy(_u.x+hy*iy,_u.y+hy*sy)}return cy},Hy.prototype.getNearest=Hy.prototype.la,Hy.prototype.R=function(_u){return ry(ly(this.x-_u.x,2)+ly(this.y-_u.y,2))},Hy.prototype.distance=Hy.prototype.R,Hy.fromIPoint=function(_u){if(!_u)throw Error("invalid argument");return _u instanceof Hy?_u:new Hy(_u.x,_u.y)},_e("H.math.clipping.clipStrips",function(_u,_f,iy,sy,cy,hy){var vy,Ey,Ay,Iy,Fy=_u.length;if(Fy)for(vy=[];Fy--;){var _g=_u[Fy],pv=_g.length,lv=0;for(Ay=1;Ay<pv;Ay++)if(Iy=vv(_g[Ay-1],_g[Ay],iy,_f,sy,cy)){var wv=Iy[0],Cv=Iy[1];lv&&lv.w(wv)?Ey.push(Cv):vy.push(Ey=Iy),lv=Cv,hy&&(Ay=pv,Fy=0)}}else vy=_u;return vy}),_e("H.math.clipping.clipPolygon",function(_u,_f,iy){var sy,cy;_u=s0(_u,!0),_f=s0(_f,!1);var hy={},vy=sy=1;switch(~~(iy||0)){case 1:vy=sy=0;break;case 2:sy=0,vy=1;break;case 3:sy=1,vy=0}iy=sy;var Ey=vy;if(_f&&_u){for(_f.M=_v(_f.x,_f.y,null,Mv(_f)),_u.M=_v(_u.x,_u.y,null,Mv(_u)),vy=_f;vy.next;vy=vy.next)if(!vy.o){for(sy=_u;sy.next;sy=sy.next)if(!sy.o){var Ay=Av(vy.next),Iy=Av(sy.next);if(cy=Ov(vy,Ay,sy,Iy,hy)){cy=hy.fa;var Fy=hy.ga,_g=hy.xa,pv=hy.ya;t0(cy=_v(_g,pv,null,null,null,null,!0,0,0,cy),vy,Ay),t0(Ay=_v(_g,pv,null,null,null,null,!0,0,0,Fy),sy,Iy),cy.X=Ay,Ay.X=cy}}}for(hy=sv(_f,Qv(_u)),iy&&(hy=!hy),vy=_f;vy;vy=vy.next)vy.o&&(vy.T=hy,hy=!hy);for(hy=sv(_u,Qv(_f)),Ey&&(hy=!hy),sy=_u;sy.next;sy=sy.next)sy.o&&(sy.T=hy,hy=!hy);for(iv(_f),iv(_u);(_u=Nv(_f))!=_f;){for(iy=null;!_u.O;_u=_u.X){for(hy=_u.T;(iy=_v(_u.x,_u.y,iy)).artificial=_u.o||_u.qa,_u.O=1,_u=hy?_u.next:_u.s;)if(_u.o){_u.O=1;break}if(!_u)break}iy.ta=lv;var lv=iy}return lv}}),_e("H.math.simplifyDP",function(_u,_f,iy){return Zv(_u,_f*_f,iy||0,0,_u.length-1)});var Wv=this,Dv=String,Pv=[].pop(),a0=/x/.exec(""),Fv="prototype constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $v(_u,_f){if(_u instanceof _f&&_u.constructor===_f)throw new TypeError("Illegal constructor "+g0(_f))}_e("H.lang.isArray",function(_u,_f,iy,sy){var cy;if(!(cy=k0(_u)==="Array")&&_f)throw new dv(_f,iy,sy!==Pv?sy:_u);return cy}),_e("H.lang.isString",function(_u){return typeof _u=="string"});var kv=isNaN;function z0(_u){return _u===+_u}function k0(_u){var _f=Object[Fv[0]][Fv[6]].call(_u).match(/^\[object (\w+)\]$/);return _f?_f[1]:_typeof(_u)}_e("H.lang.isNumber",z0),_e("H.lang.isInteger",Number.isInteger?Number.isInteger:function(_u){return typeof _u=="number"&&_u%1==0});var l0=[];function g0(_u,_f,iy,sy){var cy,hy="",vy=2>arguments.length;return vy&&(_f={H:Wv.H},iy="",sy=l0.slice()),fv(_f,!0,function(Ey,Ay){try{if(Ay=function(Iy,Fy){var _g=[];return fv(Iy,!1,function(pv,lv){pv[lv]===Fy&&_g.push(lv)}),_g.sort(Z0)[0]}(Ey,cy=Ey[Ay]),!(_t(cy)&&cy.window===cy&&cy.self===cy||_t(cy)&&0<cy.nodeType&&$(cy.cloneNode))&&_t(cy)){if(cy===_u)return hy=iy+"."+Ay,!0;if(0>sy.indexOf(cy)&&(sy.push(cy),hy=g0(_u,cy,iy+"."+Ay,sy)))return!0}}catch{}}),vy&&(hy=hy?hy.substr(1).replace("."+Fv[0]+".","#"):"~"+($(_u)?function(Ey){return(Ey=/^\s*function ([^\( ]+)/.exec(Ey))?Ey[1]:"anonymous"}(_u)+"()":k0(_u))),hy}function Z0(_u,_f){return _f.length-_u.length}0>l0.indexOf(l0)&&l0.push(l0);var B0=Object[Fv[0]][Fv[2]];function fv(_u,_f,iy){var sy;if(_u){for(cy in _u)if((!_f||B0.call(_u,cy))&&iy(_u,cy,!0))return;for(sy=Fv.length;sy--;){var cy=Fv[sy];if((!_f||B0.call(_u,cy))&&iy(_u,cy,!1))break}}}function X0(_u,_f,iy){iy[_f]="#"+_f}function dv(_u,_f,iy){var sy=arguments.length;if((_f=_f!==Pv?+_f:_f)!==Pv){var cy,hy=/^.*?\(([^\)]+)/.exec((""+_u).replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,""));cy=hy?Dv(hy[1].replace(/\s+/g,"")).split(Pv!==","?",":" "):[],(hy=cy).forEach(X0),hy=hy[_f]||"#"+_f}return cy=_u?g0(_u):"",sy=2<sy?Dv(iy):"",(hy||sy)&&(cy+=" (Argument "+(hy||"")+(sy?" "+sy:"")+")"),sy=Error(cy),Object.setPrototypeOf(sy,dv.prototype),sy}function Kv(_u,_f,iy){var sy=ky(+_u,-90,90);if(_f&&kv(sy))throw new dv(_f,iy,_u);return sy}function Hv(_u,_f,iy){var sy,cy=+_u;if((-180>cy||180<cy)&&(cy=(0>(sy=(cy+180)%360)?sy+360:sy)-180),_f&&kv(cy))throw new dv(_f,iy,_u);return cy}function F0(_u,_f,iy){var sy;if(_u!==Pv&&kv(sy=+_u)&&_f)throw new dv(_f,iy,_u);return sy}function xv(){$v(this,xv)}function nv(_u,_f,iy){this.lat=Kv(_u,nv,0),this.lng=Hv(_f,nv,1),iy!==Pv&&(this.alt=F0(iy,nv,2))}function e0(_u,_f,iy){var sy=_t(_u)&&!(kv(_u.lat=Kv(_u.lat))||kv(_u.lng=Hv(_u.lng))||_u.alt!==Pv&&kv(_u.alt=F0(_u.alt)));if(!sy&&_f)throw new dv(_f,iy,_u);return sy}function Cy(_u,_f,iy,sy){m0(this,Kv(_u,Cy,0),Hv(_f,Cy,1),Kv(iy,Cy,2),Hv(sy,Cy,3))}function m0(_u,_f,iy,sy,cy){return _u.f=iy,_u.g=cy,_f<sy&&(iy=_f,_f=sy,sy=iy),_u.i=_f,_u.h=sy,_u.m=_u.b=_u.c=null,_u}function u0(_u,_f){return(_u=_f-_u)+(0>_u?360:0)}function Xv(_u,_f){return(_u+=_f/2)-(180<_u?360:0)}function c0(_u,_f,iy,sy,cy,hy,vy,Ey,Ay){iy=_n(iy,vy),_u=_s(_u,cy);var Iy=Xv(_f,cy=u0(_f,sy)),Fy=Xv(hy,vy=u0(hy,Ey))-Iy;if(180>(Fy+=0>Fy-1e-6?360:0)-1e-6){Iy=_f;var _g=Ey}else Fy=360-Fy,Iy=hy,_g=sy;return 360<=(Fy=Fy+cy/2+vy/2)+5e-7?(Iy=-180,_g=180):Fy-5e-7<cy?(Iy=_f,_g=sy):Fy-5e-7<vy&&(Iy=hy,_g=Ey),Ay?m0(Ay,_u,Iy,iy,_g):new Cy(_u,Iy,iy,_g)}function v0(_u,_f,iy){return iy||(e0(_u,v0,0),e0(_f,v0,1)),new Cy(_u.lat,_u.lng,_f.lat,_f.lng)}function r0(_u,_f,iy,sy,cy,hy){$v(this,r0),this.sa=_u||10,this.c=this.b=null,this.j=sy||0,this.l=cy||0,this.m=_f||1,this.u=iy||1,this.I=!!hy,this.flush()}function O0(_u,_f){var iy,sy,cy,hy,vy=0;for(iy=3;0<=iy;iy--){var Ey=iy+4,Ay=0<iy%3,Iy=[],Fy=_f[iy],_g=_u[iy];for(sy=_g.length;sy--;){var pv=_g[sy];if(cy=pv.entries)for(hy=cy.length;hy--;){var lv=cy[hy][iy];(Ay?lv>Fy:lv<Fy)&&(Fy=lv)}for(hy=4;hy--;)(cy=pv[hy])&&(Ay?cy[Ey]>Fy:cy[Ey]<Fy)&&Iy.push(cy)}vy+=Iy.length,_f[iy]=Fy,_u[iy]=Iy}return vy&&(_f=O0(_u,_f)),_f}function $0(_u,_f,iy){var sy,cy;if(_u.I&&(sy=_u.c))for(cy=3;0<=cy;cy--){var hy=_f[cy];if(cy%3?hy>=sy[cy]:hy<=sy[cy]){if(!iy){_u.c=null;break}sy[cy]=hy}}}function U0(_u,_f){var iy,sy=_u.a;if(_f){var cy=_f;if(cy!==sy)for(sy=cy;cy=cy.c;)(cy.entries||1<cy.a)&&(sy=cy)}else for(;!sy.entries&&2>(iy=sy.a)&&iy;)sy=cy;_u.a=sy}function zv(_u,_f,iy,sy,cy,hy,vy,Ey,Ay){var Iy,Fy=_f.entries,_g=_f[7],pv=_f[4],lv=_f[5],wv=_f[6],Cv=_f[8],Uv=_f[9];if(Fy){var f0=Fy.length;if(cy>pv||sy>_g||vy<wv||hy<lv)for(;f0--;)pv=(_g=Fy[f0])[3],lv=_g[0],wv=_g[1],_g[2]>=cy&&wv>=sy&&(lv<vy||Ey&&lv==vy)&&(pv<hy||Ay&&pv==hy)&&iy.push(_g);else for(;f0--;)iy.push(Fy[f0])}(hy>Cv||Ay&&hy==Cv)&&(cy<Uv&&(Iy=_f[1])&&zv(_u,Iy,iy,sy,cy,hy,vy,Ey,Ay),(vy>Uv||Ey&&vy==Uv)&&(Iy=_f[3])&&zv(_u,Iy,iy,sy,cy,hy,vy,Ey,Ay)),sy<Cv&&(cy<Uv&&(Iy=_f[0])&&zv(_u,Iy,iy,sy,cy,hy,vy,Ey,Ay),(vy>Uv||Ey&&vy==Uv)&&(Iy=_f[2])&&zv(_u,Iy,iy,sy,cy,hy,vy,Ey,Ay))}_r(dv,Error),_e("H.lang.InvalidArgumentError",dv),dv.prototype.name="InvalidArgumentError",_e("H.geo.isDBC",function(_u,_f){return!!(0>_u^0>_f)&&180<_p(_f-_u)}),_e("H.geo.AbstractGeometry",xv),xv.prototype.getBoundingBox=xv.prototype.D,xv.prototype.equals=xv.prototype.w,xv.prototype.a="",xv.prototype.l="",xv.prototype.toString=function(){return this.I([this.a.toUpperCase()," "]).join("")},xv.prototype.toString=xv.prototype.toString,xv.prototype.va=function(){return{type:this.l,coordinates:this.u()}},xv.prototype.toGeoJSON=xv.prototype.va,xv.prototype.U=function(){return{type:this.a,coordinates:this.j(),boundingBox:this.D().U()}},xv.prototype.forWorkerMessage=xv.prototype.U,_r(nv,xv),_e("H.geo.Point",nv),nv.prototype.w=function(_u){return this===_u||!!_u&&this.lat===_u.lat&&this.lng===_u.lng&&(this.alt||0)===(_u.alt||0)},nv.prototype.equals=nv.prototype.w,nv.prototype.R=function(_u){if(this===_u||this.lat===_u.lat&&this.lng===_u.lng)_u=0;else{var _f=this.lat*qy,iy=_u.lat*qy;_u=1274200158e-2*py(_n(1,ry(ly(uy((_f-iy)/2),2)+fy(_f)*fy(iy)*ly(uy((this.lng*qy-_u.lng*qy)/2),2))))}return _u},nv.prototype.distance=nv.prototype.R,nv.prototype.wa=function(_u,_f,iy){if(iy){if(_f/=637100079e-2){_u*=qy;var sy=qy*this.lat,cy=uy(sy),hy=uy(_f),vy=fy(_f),Ey=qy*this.lng,Ay=fy(sy);sy=py(Ay*fy(_u)*hy+cy*vy),Ay=(_u=(Ey+(_u=xy(uy(_u)*Ay*hy,vy-cy*uy(sy)))+Ly)%(2*Ly)-Ly)*_m}return _f?new nv(sy*_m,(Ay+540)%360-180):this}if(((_u=(_u%360+360)%360)+90)%180==0)return sy=this.lng+_f/(637100079e-2*Sy*fy(this.lat*qy))*(_u===270?-360:360),new nv(this.lat,(sy+540)%360-180);if(_f/=637100079e-2){_u*=qy,Ey=this.lat*qy,cy=this.lng*qy,vy=(hy=Ey+_f*fy(_u))-Ey,sy=ty(my(hy/2+Ry)/my(Ey/2+Ry)),sy=kv(vy/sy)?fy(Ey):vy/sy;var Iy=_f*uy(_u)/sy;_p(hy)>My&&(hy=0<hy?Ly-hy:-(Ly+hy))}return _f?new nv(hy*_m,((cy+Iy+Zy+(_p(Ey+vy)>My?Ly:0))%Sy-Ly)*_m):this},nv.prototype.walk=nv.prototype.wa,nv.prototype.D=function(){return new Cy(this.lat,this.lng,this.lat,this.lng)},nv.prototype.getBoundingBox=nv.prototype.D,nv.validate=e0,nv.fromIPoint=function _u(_f){if(!_f)throw new dv(_u,0,_f);return new nv(_f.lat,_f.lng,_f.alt)},nv.prototype.a="Point",nv.prototype.I=function(_u){return _u.push("(",this.lng," ",this.lat,")"),_u},nv.prototype.l="Point",nv.prototype.u=function(){return[this.lng,this.lat,this.alt||0]},nv.prototype.j=function(){return[this.lat,this.lng,this.alt||0]},_r(Cy,xv),_e("H.geo.Rect",Cy),Cy.prototype.a="Polygon",Cy.prototype.I=function(_u){var _f=this.i,iy=this.f,sy=this.h,cy=this.g;return _u.push("(","(",iy," ",_f,",",cy," ",_f,",",cy," ",sy,",",iy," ",sy,",",iy," ",_f,")",")"),_u},Cy.prototype.w=function(_u){return this===_u||!!_u&&this.i===_u.i&&this.f===_u.f&&this.h===_u.h&&this.g===_u.g},Cy.prototype.equals=Cy.prototype.w,Cy.prototype.clone=function(){return new Cy(this.i,this.f,this.h,this.g)},Cy.prototype.clone=Cy.prototype.clone,Cy.prototype.W=function(){return this.m||(this.m=new nv(this.i,this.f)),this.m},Cy.prototype.getTopLeft=Cy.prototype.W,Cy.prototype.V=function(){return this.b||(this.b=new nv(this.h,this.g)),this.b},Cy.prototype.getBottomRight=Cy.prototype.V,Cy.prototype.na=function(){return this.i},Cy.prototype.getTop=Cy.prototype.na,Cy.prototype.ha=function(){return this.h},Cy.prototype.getBottom=Cy.prototype.ha,Cy.prototype.ja=function(){return this.f},Cy.prototype.getLeft=Cy.prototype.ja,Cy.prototype.ma=function(){return this.g},Cy.prototype.getRight=Cy.prototype.ma,Cy.prototype.F=function(){return this.c||(this.c=new nv(this.h+(this.i-this.h)/2,Xv(this.f,this.A()))),this.c},Cy.prototype.getCenter=Cy.prototype.F,Cy.prototype.A=function(){return u0(this.f,this.g)},Cy.prototype.getWidth=Cy.prototype.A,Cy.prototype.G=function(){return this.i-this.h},Cy.prototype.getHeight=Cy.prototype.G,Cy.prototype.N=function(){return this.f>this.g},Cy.prototype.isCDB=Cy.prototype.N,Cy.prototype.ra=function(){return!this.A()&&!this.G()},Cy.prototype.isEmpty=Cy.prototype.ra,Cy.prototype.D=function(){return new Cy(this.i,this.f,this.h,this.g)},Cy.prototype.getBoundingBox=Cy.prototype.D,Cy.prototype.L=function(_u,_f,iy){var sy=this.F();return iy||(_u=Kv(_u,this.L,0),_f=Hv(_f,this.L,1)),(_u=(_f=this.B(_u,_f,iy)).F()).lat===sy.lat&&_u.lng===sy.lng&&this.G()===_f.G()&&this.A()===_f.A()},Cy.prototype.containsLatLng=Cy.prototype.L,Cy.prototype.$=function(_u,_f){return _f||e0(_u,this.$,0),this.L(_u.lat,_u.lng,_f)},Cy.prototype.containsPoint=Cy.prototype.$,Cy.prototype.aa=function(_u,_f){var iy=this.F();if(!(_f||_u instanceof Cy))throw new dv(this.aa,0,_u);return(_u=(_f=this.J(_u,_f)).F()).lat===iy.lat&&_u.lng===iy.lng&&this.G()===_f.G()&&this.A()===_f.A()},Cy.prototype.containsRect=Cy.prototype.aa,Cy.prototype.B=function(_u,_f,iy,sy){if(!iy){if(kv(_u=Kv(_u)))throw new dv(this.B,0,_u);if(kv(_f=Hv(_f)))throw new dv(this.B,1,_f)}return c0(this.i,this.f,this.h,this.g,_u,_f,_u,_f,sy)},Cy.prototype.mergeLatLng=Cy.prototype.B,Cy.prototype.ca=function(_u,_f,iy){return _f||e0(_u,this.ca,0),this.B(_u.lat,_u.lng,_f,iy)},Cy.prototype.mergePoint=Cy.prototype.ca,Cy.prototype.J=function(_u,_f,iy){if(!(_f||_u instanceof Cy))throw new dv(this.J,0,_u);return c0(this.i,this.f,this.h,this.g,_u.i,_u.f,_u.h,_u.g,iy)},Cy.prototype.mergeRect=Cy.prototype.J,Cy.prototype.C=function(_u,_f,iy,sy,cy,hy){return cy||(_u=Kv(_u,this.C,0),_f=Hv(_f,this.C,1),iy=Kv(iy,this.C,2),sy=Hv(sy,this.C,3)),c0(this.i,this.f,this.h,this.g,_u,_f,iy,sy,hy)},Cy.prototype.mergeTopLeftBottomRight=Cy.prototype.C,Cy.prototype.ba=function(_u,_f){var iy=this.f<=this.g,sy=_u.f<=_u.g,cy=this.f<_u.g,hy=_u.f<this.g;if(!(_f||_u instanceof Cy))throw new dv(this.ba,0,_u);return this.h<=_u.i&&_u.h<=this.i&&(!iy&&(!sy||cy||hy)||!sy&&(cy||hy)||cy&&hy)},Cy.prototype.intersects=Cy.prototype.ba,Cy.merge=c0,Cy.fromPoints=v0,Cy.coverPoints=function _u(_f,iy){var sy=1,cy=_f.length,hy=null,vy=j(_f);if(vy!="array"&&(vy!="object"||typeof _f.length!="number"))throw new dv(_u,0,_f);if(0<cy)for(hy=v0(vy=_f[0],vy,iy);sy<cy;sy++)vy=_f[sy],hy.B(vy.lat,vy.lng,iy,hy);return hy},Cy.coverLatLngAlts=function _u(_f,iy){var sy,cy=3,hy=_f.length;if(!(iy||_f&&_f.length!=null))throw new dv(_u,0,_f);if(0<hy)for(sy=new Cy(_f[0],_f[1],_f[0],_f[1]);cy<hy;cy+=3)sy.B(_f[cy],_f[cy+1],iy,sy);return sy},Cy.coverRects=function _u(_f,iy){var sy,cy=1,hy=_f.length;if(iy&&(!_f||_f.length==null))throw new dv(_u,0,_f);if(0<hy)for(sy=new Cy(_f[0].i,_f[0].f,_f[0].h,_f[0].g);cy<hy;cy++)sy.J(_f[cy],iy,sy);return sy},Cy.prototype.da=function(_u,_f){var iy=this.f,sy=this.i,cy=this.g,hy=this.h,vy=this.F().lng;e0(_u,this.da,0);var Ey=_u.lat-hy-(sy-hy)/2,Ay=_u.lng-vy;return _u=-180>(_u=iy+(0>(Ay=180<Ay||-180>Ay?-(vy+_u.lng):Ay)?2*Ay:0))?360+_u:_u,cy=180<(cy+=0<Ay?2*Ay:0)?cy-360:cy,90<=(sy=0<Ey?sy+2*Ey:sy)&&(sy=90),-90>=(hy=0>Ey?hy+2*Ey:hy)&&(hy=-90),_f?m0(_f,sy,_u,hy,cy):new Cy(sy,_u,hy,cy)},Cy.prototype.resizeToCenter=Cy.prototype.da,Cy.prototype.l="Polygon",Cy.prototype.u=function(){return[[this.f,this.i,0],[this.g,this.i,0],[this.g,this.h,0],[this.f,this.h,0],[this.f,this.i,0]]},Cy.prototype.U=function(){return this.j()},Cy.prototype.j=function(){return[this.i,this.f,this.h,this.g]},r0.prototype.remove=function(_u){var _f,iy,sy,cy=!1;if(_u&&(_f=_u.a)&&_f.b===this&&(iy=_f.entries)&&0<=(sy=iy.indexOf(_u))){var hy,vy;for(iy.splice(sy,1),iy=this.a;_f;)if((hy=_f.entries)&&hy.length||(hy&&delete _f.entries,_f.a||!(vy=_f.c)))_f=a0;else{sy=vy;var Ey=(cy=_f).j;sy[Ey]===cy&&(delete sy[Ey],delete cy.c,--sy.a),iy===_f&&(iy=vy),_f=vy}this.a!==iy&&(this.a=iy,U0(this)),$0(this,_u,!1),cy=!0}return cy},r0.prototype.flush=function(){var _u=new P0(null,NaN,this.j-this.m,this.l-this.u,this.j+this.m,this.l+this.u);_u.b=this,this.a=this.b=_u,this.c=null},r0.prototype.o=function(_u,_f,iy,sy,cy,hy){var vy=[],Ey=this.a,Ay=this.b;return _u<=Ey[5]&&_f<=Ey[6]&&(cy?iy>=Ey[7]:iy>Ey[7])&&(hy?sy>=Ey[4]:sy>Ey[4])&&zv(this,Ey,vy,_u,_f,iy,sy,hy||sy>=Ay[6],cy||iy>=Ay[5]),vy};var Sv=0;function P0(_u,_f,iy,sy,cy,hy){this.j=_f,_u&&(this.c=_u,this.b=_u.b,1&_f?(iy=_u[8],cy=_u[5]):(iy=_u[7],cy=_u[8]),2&_f?(sy=_u[9],hy=_u[6]):(sy=_u[4],hy=_u[9])),this[7]=iy,this[5]=cy,this[8]=(iy+cy)/2,this[4]=sy,this[6]=hy,this[9]=(sy+hy)/2}function L0(_u,_f,iy,sy,cy,hy){L0.ua.constructor.apply(this,arguments)}function G0(_u,_f,iy,sy,cy,hy,vy){var Ey,Ay,Iy=_f[8],Fy=_f[9];return vy&&(cy<Iy||(Ey=iy>=Iy))&&(hy<Fy||(Ay=sy>=Fy))?iy=(Iy=G0)(_u,_f=_f[Ey|=Ay<<1]||(++_f.a,_f[Ey]=new P0(_f,Ey)),iy,sy,cy,hy,vy-1):(sy=iy=new H0(iy,sy,cy,hy),(_f.entries||(_f.entries=[])).push(sy),sy.a=_f,$0(_u,iy,!0),U0(_u,_f)),iy}function H0(_u,_f,iy,sy){this.id=Sv++,this[0]=_f,this[1]=iy,this[2]=sy,this[3]=_u}function jv(_u){this.l=new L0(+_u||10,180,90,0,0,!0),this.j=[],this.m=!1,this.a=this.b=this.c=null}function _0(_u,_f,iy,sy,cy,hy){if(hy)hy=new H0(cy,-_f,iy+360,-sy),_u.j.push(hy),_u.m=!0,_u.a&&_u.a.C(_f,iy,sy,cy,!0,_u.a);else{var vy=-_f,Ey=-sy,Ay=(hy=_u.l).b,Iy=Ay[5],Fy=Ay[6];if(!(Ay[7]<=iy&&Ay[4]<=vy&&(Iy>cy||Iy===cy&&Iy===Ay.b.b[5])&&(Fy>Ey||Fy===Ey&&Fy===Ay.b.b[6])))throw Error("Coordinates out of bounds");hy=G0(hy,hy.b,iy,vy,cy,Ey,hy.sa),_u.b&&_u.b.C(_f,iy,sy,cy,!0,_u.b)}return _u.c=null,hy}function C0(_u,_f,iy,sy,cy,hy,vy){var Ey,Ay=(_u=_u.j).length,Iy=[];if(Ay){var Fy=iy+360;for(Ey=cy+360;Ay--;){var _g=_u[Ay];(b0(_g,_f,iy,sy,cy,hy,vy)||b0(_g,_f,Fy,sy,Ey,hy,vy))&&Iy.push(_g)}}return Iy}function b0(_u,_f,iy,sy,cy,hy,vy){var Ey=_u[3],Ay=_u[0],Iy=_u[1];return _u=_u[2],(hy?Ay<=sy:Ay<sy)&&(vy?Ey<=cy:Ey<cy)&&_u>=_f&&Iy>=iy}function h0(_u,_f){var iy,sy,cy;if(iy=_f.length){var hy=_u.length;for(sy={};hy--;)sy[_u[hy].id]=1;for(;iy--;)(cy=_f[iy]).id in sy||_u.push(cy)}}function cv(){}function ev(_u,_f,iy){if(this.l=[],_f&&this.K(_f),iy&&!$(iy))throw new dv(ev,2,iy);this.b=0,this.m=iy,this.a={},this.j=this.c=null,this.Z(_u)}function x0(_u,_f){return _f&&(_u.c=i0(_u,_f,_u.c)),_f}function w0(_u){for(;_u.b>_u.u&&_u.j;)p0(_u,_u.j,!0)}function i0(_u,_f,iy){return iy!==_f&&((_f.H||_f.v)&&p0(_u,_f,!1),(_f.H=iy)&&(_f.v=iy.v,iy.v=_f),_f.v||(_u.c=_f),_f.H||(_u.j=_f),_u.b+=_f.size),_f}function p0(_u,_f,iy){var sy=_f.v,cy=_f.H;(sy||cy||_f==_u.c&&_f==_u.j)&&(sy?sy.H=cy:_u.c=cy,cy?cy.v=sy:_u.j=sy,_u.b-=_f.size,iy&&(delete _u.a[_f.id],V0(_u,_f))),_f.H=_f.v=null}function V0(_u,_f){for(var iy=_u.l.length;iy--;)_u.l[iy].call(_u,_f.id,_f.data,_f.size)}P0.prototype.a=0,_r(L0,r0),_e("H.geo.QuadTree",jv),jv.prototype.N=function(){return this.m},jv.prototype.D=function(){var _u;if(!this.c){var _f,iy,sy,cy,hy=[];if(_f=!this.b){var vy=this.l,Ey=vy.c;vy.I&&!Ey&&((_f=vy.a).entries||_f[0]||_f[1]||_f[2]||_f[3])&&(Ey=O0([Ey=[_f],Ey,Ey,Ey],[_f[6],_f[7],_f[4],_f[5]]),vy.c=Ey),_f=vy=Ey}if(_f&&(this.b=new Cy(-vy[0],vy[3],-vy[2],vy[1])),(_u=this.b)&&hy.push(_u),!this.a&&(cy=(sy=this.j).length)){for(vy=90,_f=360,Ey=-90,iy=0;cy--;){var Ay=sy[cy];vy=_n(vy,Ay[0]),_f=_n(_f,Ay[3]),Ey=_s(Ey,Ay[2]),iy=_s(iy,Ay[1])}this.a=new Cy(-vy,_f,-Ey,iy-360)}(_u=this.a)&&hy.push(_u),(_u=hy[0])&&(hy[1]&&(_u=_u.J(hy[1],!0)),this.c=_u)}return this.c},jv.prototype.oa=function(_u){var _f=_u.W(),iy=_u.V();return(_u=_u.N())?_0(this,_f.lat,iy.lng,iy.lat,_f.lng,_u):_0(this,_f.lat,_f.lng,iy.lat,iy.lng,_u)},jv.prototype.insertBoundingBox=jv.prototype.oa,jv.prototype.remove=function(_u){var _f;if(_u.a){var iy=this.l.remove(_u);this.b=null}else(iy=0<=(_u=(_f=this.j).indexOf(_u)))&&(_f.splice(_u,1),this.m=0<_f.length,this.a=null);return iy&&(this.c=null),iy},jv.prototype.remove=jv.prototype.remove,jv.prototype.pa=function(_u,_f,iy){var sy=this.l,cy=_u.W(),hy=_u.V(),vy=-cy.lat;cy=cy.lng;var Ey=-hy.lat;return hy=hy.lng,!_f&&vy===Ey||!iy&&cy===hy?_u=[]:_u.N()?(h0(_u=sy.o(-180,vy,hy,Ey,iy,_f),sy.o(cy,vy,180,Ey,!1,_f)),h0(_u,C0(this,vy,hy,Ey,cy+360,_f,iy))):h0(_u=sy.o(cy,vy,hy,Ey,iy,_f),C0(this,vy,cy,Ey,hy,_f,iy)),_u},jv.prototype.intersectBoundingBox=jv.prototype.pa,_e("H.util.ICache",cv),cv.prototype.add=function(){},cv.prototype.add=cv.prototype.add,cv.prototype.get=function(){},cv.prototype.get=cv.prototype.get,cv.prototype.S=function(){},cv.prototype.drop=cv.prototype.S,cv.prototype.forEach=function(){},cv.prototype.forEach=cv.prototype.forEach,cv.prototype.Y=function(){},cv.prototype.removeAll=cv.prototype.Y,cv.prototype.K=function(){},cv.prototype.registerOnDrop=cv.prototype.K,cv.prototype.P=function(){},cv.prototype.deRegisterOnDrop=cv.prototype.P,_e("H.util.Cache",ev),ev.prototype.add=function(_u,_f,iy){var sy,cy;if(!z0(iy=+iy)||0>iy)throw new dv(this.add,2,iy);return _u=String(_u),(cy=!this.m||this.m(_u,_f,iy))&&((sy=this.a[_u])?(sy.data!==_f&&V0(this,sy),this.b+=iy-sy.size,sy.size=iy,sy.data=_f,x0(this,sy)):this.a[_u]=i0(this,{id:_u,data:_f,size:iy,H:null,v:null},this.c),w0(this)),cy},ev.prototype.add=ev.prototype.add,ev.prototype.K=function(_u){if(!$(_u))throw new dv(this.K,0,_u);this.l.push(_u)},ev.prototype.registerOnDrop=ev.prototype.K,ev.prototype.P=function(_u){this.l=this.l.filter(function(_f){return _f!==_u})},ev.prototype.deRegisterOnDrop=ev.prototype.P,ev.prototype.get=function(_u,_f){return(_u=_f?this.a[_u]:x0(this,this.a[_u]))&&_u.data},ev.prototype.get=ev.prototype.get,ev.prototype.S=function(_u){var _f;(_f=this.a[_u])&&p0(this,_f,!0)},ev.prototype.drop=ev.prototype.S,ev.prototype.forEach=function(_u,_f,iy){var sy;for(sy in this.a){var cy=this.a[sy];(!iy||iy(sy,cy.data,cy.size))&&_u.call(_f,sy,cy.data,cy.size)}},ev.prototype.forEach=ev.prototype.forEach,ev.prototype.Y=function(_u){var _f;for(_f in this.a){var iy=this.a[_f];(!_u||_u(_f,iy.data,iy.size))&&p0(this,this.a[_f],!0)}},ev.prototype.removeAll=ev.prototype.Y,ev.prototype.Z=function(_u){if(!(0<+_u))throw new dv(ev.prototype.Z,0,_u);return this.u=+_u,w0(this),this},ev.prototype.setMaxSize=ev.prototype.Z,ev.prototype.ka=function(){return this.u},ev.prototype.getMaxSize=ev.prototype.ka,ev.prototype.ia=function(){return this.b},ev.prototype.getCurrentSize=ev.prototype.ia}).call(ns);var MathUtils$1=MathUtils={},Geo;function _xyToArr(e){return[e.x,e.y]}function _arrToXy(e){return _construct(ns.H.math.Point,_toConsumableArray(e))}MathUtils.clipPolygon=function(e,o){var s,h,d,g=[];if(s=ns.H.math.clipping.clipPolygon(e.map(_arrToXy),o.map(_arrToXy)))do{h=[],d=s;do h.push(_xyToArr(d));while(d=d.next);g.push(h)}while(s=s.nextPoly);else MathUtils.isPointInsidePolygon(o[0],e)?g.push(o):MathUtils.isPointInsidePolygon(e[0],o)&&g.push(e);return g},MathUtils.isPointInsidePolygon=function(e,o){return ns.H.math.isPointInsidePolygon({x:e[0],y:e[1]},ns.H.math.flatten(o))},MathUtils.clamp=function(e,o,s){return(e-=0)>s?s:e<o?o:e},MathUtils.splitLegs=function(e,o){var s=[];e.push(e[0]);for(var h=0;h<e.length-1;h++){var d=e[h],g=e[h+1];if(s.push(d),Math.abs(g[0]-d[0])>=o){var _=[(d[0]+g[0])/2,(d[1]+g[1])/2];s.push(_)}}return s.length!==e.length-1?MathUtils.splitLegs(s,o):s},MathUtils.getBBox=function(e){var o=1/0,s=1/0,h=-1/0,d=-1/0;return e.forEach(function(g){g[0]<o&&(o=g[0]),g[1]<s&&(s=g[1]),g[0]>h&&(h=g[0]),g[1]>d&&(d=g[1])}),[o,s,h,d]},MathUtils.getBBoxCenter=function(e){var o=_slicedToArray(e,4),s=o[0],h=o[1];return[s+(o[2]-s)/2,h+(o[3]-h)/2]},MathUtils.getLineLength=function(e,o,s,h){return Math.sqrt(Math.pow(e-s,2)+Math.pow(o-h,2))},MathUtils.modulo=function(e,o){var s;return(s=e%o)<0==o<0?s:s+o};var Geo$1=Geo={};Geo.default_source_max_zoom=18,Geo.default_view_max_zoom=20,Geo.tile_size=256,Geo.half_circumference_meters=20037508342789244e-9,Geo.circumference_meters=2*Geo.half_circumference_meters,Geo.min_zoom_meters_per_pixel=Geo.circumference_meters/Geo.tile_size;var meters_per_pixel=[];Geo.metersPerPixel=function(e){return meters_per_pixel[e]=meters_per_pixel[e]||Geo.min_zoom_meters_per_pixel/Math.pow(2,e),meters_per_pixel[e]};var meters_per_tile=[];Geo.metersPerTile=function(e){return meters_per_tile[e]=meters_per_tile[e]||Geo.circumference_meters/Math.pow(2,e),meters_per_tile[e]},Geo.tile_scale=4096,Geo.units_per_pixel=Geo.tile_scale/Geo.tile_size,Geo.height_scale=16;var units_per_meter=[];Geo.unitsPerMeter=function(e){return units_per_meter[e]=units_per_meter[e]||Geo.tile_scale/(Geo.tile_size*Geo.metersPerPixel(e)),units_per_meter[e]},Geo.metersForTile=function(e){return{x:e.x*Geo.circumference_meters/Math.pow(2,e.z)-Geo.half_circumference_meters,y:-(e.y*Geo.circumference_meters/Math.pow(2,e.z)-Geo.half_circumference_meters)}},Geo.tileForMeters=function(e,o){var s=_slicedToArray(e,2),h=s[0],d=s[1];return{x:Math.floor((h+Geo.half_circumference_meters)/(Geo.circumference_meters/Math.pow(2,o))),y:Math.floor((-d+Geo.half_circumference_meters)/(Geo.circumference_meters/Math.pow(2,o))),z:o}},Geo.metersToExactTileCoords=function(e,o){var s=_slicedToArray(e,2),h=s[0],d=s[1];return{x:Math.pow(2,o-1)*(1+h/Geo.half_circumference_meters),y:Math.pow(2,o-1)*(1-d/Geo.half_circumference_meters),z:o}},Geo.wrapTile=function(e){var o=e.x,s=e.y,h=e.z,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{x:!0,y:!1},g=(1<<h)-1;return d.x&&(o&=g),d.y&&(s&=g),{x:o,y:s,z:h}},Geo.wrapMeters=function(e){var o=e.x,s=e.y;return{x:MathUtils$1.modulo(o+Geo.half_circumference_meters,Geo.circumference_meters)-Geo.half_circumference_meters,y:s}},Geo.metersToLatLng=function(e){var o=_slicedToArray(e,2),s=o[0],h=o[1];return s/=Geo.half_circumference_meters,h/=Geo.half_circumference_meters,h=(2*Math.atan(Math.exp(h*Math.PI))-Math.PI/2)/Math.PI,[s*=180,h*=180]},Geo.latLngToMeters=function(e){var o=_slicedToArray(e,2),s=o[0],h=o[1];return h=Math.log(Math.tan(h*Math.PI/360+Math.PI/4))/Math.PI,h*=Geo.half_circumference_meters,h=Math.min(Math.max(h,-Geo.half_circumference_meters),Geo.half_circumference_meters),[s*=Geo.half_circumference_meters/180,h]},Geo.tileSpaceToMeters=function(e,o,s){var h=_slicedToArray(e,2),d=h[0],g=h[1],_=Geo.unitsPerMeter(o);return[d/_+s.x,g/_+s.y]},Geo.tileSpaceToLatlng=function(e,o,s){var h=Geo.unitsPerMeter(o);return Geo.transformGeometry(e,function(d){d[0]=d[0]/h+s.x,d[1]=d[1]/h+s.y;var g=_slicedToArray(Geo.metersToLatLng(d),2),_=g[0],j=g[1];d[0]=_,d[1]=j}),e},Geo.copyGeometry=function(e){if(e!=null){var o={type:e.type};return e.type==="Point"?o.coordinates=[e.coordinates[0],e.coordinates[1]]:e.type==="LineString"||e.type==="MultiPoint"?o.coordinates=e.coordinates.map(function(s){return[s[0],s[1]]}):e.type==="Polygon"||e.type==="MultiLineString"?o.coordinates=e.coordinates.map(function(s){return s.map(function(h){return[h[0],h[1]]})}):e.type==="MultiPolygon"&&(o.coordinates=e.coordinates.map(function(s){return s.map(function(h){return h.map(function(d){return[d[0],d[1]]})})})),o}},Geo.transformGeometry=function(e,o){e!=null&&(e.type==="Point"?o(e.coordinates):e.type==="LineString"||e.type==="MultiPoint"?e.coordinates.forEach(o):e.type==="Polygon"||e.type==="MultiLineString"?e.coordinates.forEach(function(s){return s.forEach(o)}):e.type==="MultiPolygon"&&e.coordinates.forEach(function(s){s.forEach(function(h){return h.forEach(o)})}))},Geo.boxIntersect=function(e,o){return!(o.sw.x>e.ne.x||o.ne.x<e.sw.x||o.sw.y>e.ne.y||o.ne.y<e.sw.y)},Geo.findBoundingBox=function(e){for(var o=1/0,s=-1/0,h=1/0,d=-1/0,g=e[0].length,_=0;_<g;_++){var j=e[0][_];j[0]<o&&(o=j[0]),j[1]<h&&(h=j[1]),j[0]>s&&(s=j[0]),j[1]>d&&(d=j[1])}return[o,h,s,d]},Geo.geometryType=function(e){return e==="Polygon"||e==="MultiPolygon"?"polygon":e==="LineString"||e==="MultiLineString"?"line":e==="Point"||e==="MultiPoint"?"point":void 0},Geo.centroid=function(e){var o=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(e&&e.length!==0){var s,h=0,d=0,g=0,_=e[0],j=_.length;o&&(s=_[0],_=_.map(function(_s){return[_s[0]-s[0],_s[1]-s[1]]}));for(var $=0,_t=j-1;$<j;_t=$,$++){var _e=_[$],_r=_[_t],_i=_e[1]*_r[0]-_r[1]*_e[0];h+=(_e[0]+_r[0])*_i,d+=(_e[1]+_r[1])*_i,g+=3*_i}var _n=[h/g,d/g];return o&&(_n[0]+=s[0],_n[1]+=s[1]),_n}},Geo.multiCentroid=function(e){for(var o=e.length,s=[0,0],h=0;h<e.length;h++){var d=Geo.centroid(e[h]);s[0]+=d[0],s[1]+=d[1]}return s[0]/=o,s[1]/=o,s},Geo.signedPolygonRingAreaSum=function(e){for(var o=0,s=e.length,h=0;h<s-1;h++){var d=e[h],g=e[h+1];o+=d[0]*g[1]-g[0]*d[1]}return o+=e[s-1][0]*e[0][1]-e[0][0]*e[s-1][1]},Geo.polygonRingArea=function(e){return Math.abs(Geo.signedPolygonRingAreaSum(e))/2},Geo.polygonArea=function(e){if(e)return Geo.polygonRingArea(e[0])},Geo.multiPolygonArea=function(e){for(var o=0,s=0;s<e.length;s++)o+=Geo.polygonArea(e[s]);return o},Geo.ringWinding=function(e){var o=Geo.signedPolygonRingAreaSum(e);return o>0?"CW":o<0?"CCW":void 0},Geo.getTileBoundingBox=function(e,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,h=Geo.wrapTile(e,{x:!0}),d=Geo.metersForTile(h),g=Geo.metersPerPixel(h.z),_=Geo.metersToLatLng([d.x-s*g,d.y+s*g]),j=Geo.metersToLatLng([d.x+(o+s)*g,d.y-(o+s)*g]),$=Geo.isLastTile(h);return new ns.H.geo.Rect(e.y===0?90:MathUtils$1.clamp(_[1],-90,90),MathUtils$1.clamp(_[0],-180,180),$.row?-90:MathUtils$1.clamp(j[1],-90,90),$.column?180:MathUtils$1.clamp(j[0],-180,180))},Geo.isLastTile=function(e){var o=e.x,s=e.y,h=e.z;return{row:s===Math.pow(2,h)-1,column:o===Math.pow(2,h)-1}};var MethodNotImplemented=function(e){function o(s){var h;return _classCallCheck(this,o),(h=_callSuper(this,o)).name="MethodNotImplemented",h.message="Method "+s+" must be implemented in subclass",h}return _inherits(o,e),_createClass(o)}(_wrapNativeSuper(Error)),is_worker=!1,is_main=!1,force_main,force_worker;try{window.document!==HTMLDocument&&(is_main=!0)}catch(e){self!==void 0&&(is_worker=!0,self.window={document:{}},self.document=self.window.document)}var Thread={get is_fake_worker(){return self.is_fake_worker},get is_worker(){return force_worker!==void 0?force_worker:is_worker||self.is_fake_worker},set is_worker(e){force_worker=e},get is_main(){return force_main!==void 0?force_main:is_main&&!self.is_fake_worker},set is_main(e){force_main=e},is_native_worker:is_worker},WorkerBroker={},message_id=0,messages={},targets={},main_worker_targets={};function findTarget(e,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:targets,h=[];if(typeof e=="string"&&(h=e.split("."),e=h.pop()),Thread.is_main&&o&&h.length===1&&h[0]==="self")s=o;else for(var d=0;d<h.length;d++){if(!s[h[d]])return[];s=s[h[d]]}return[e,s]}WorkerBroker.addTarget=function(e,o){Thread.is_fake_worker?main_worker_targets[e]=o:targets[e]=o},WorkerBroker.removeTarget=function(e){delete targets[e],delete main_worker_targets[e]};var ERROR_NO_TARGET=" No object with that name is registered on main thread.",ERROR_NO_METHOD=" Object has no method with that name.",ERROR_NOT_SET="_worker_broker_error_not_set_";function setupMainThread(){WorkerBroker.postMessage=function(e,o){for(var s=arguments.length,h=new Array(s>2?s-2:0),d=2;d<s;d++)h[d-2]=arguments[d];if(Array.isArray(e))return Promise.all(e.map(function(_r){return WorkerBroker.postMessage.apply(WorkerBroker,[_r,o].concat(_toConsumableArray(h)))}));var g,_={};_typeof(o)==="object"&&(_=o,o=o.method);var j="main_send";typeof e=="string"?(o=e,h=Array.prototype.slice.call(arguments,1),g=!0,j="worker_send"):e.init&&(g=!0);var $,_t=[];if(h&&h.length===1&&h[0]instanceof WorkerBroker.withTransferables&&(_t=h[0].transferables,h=h[0].value),$={type:j,message_id:++message_id,method:o,message:h},g)return function(_r,_i){var _n=_r.type,_s=_slicedToArray(findTarget(_r.method,_i,_n==="main_send"?main_worker_targets:targets),2),_l=_s[0],Ap=_s[1],_h="Worker broker could not dispatch message type ".concat(_r.method," on target ").concat(_r.target,".");if(!Ap)throw Error(_h+ERROR_NO_TARGET);var _p=typeof Ap[_l]=="function"&&Ap[_l];if(!_p)throw Error(_h+ERROR_NO_METHOD);return new Promise(function(ty,ry){var ly;try{ly=_p.apply(Ap,_r.message)}catch(uy){return void ry(uy)}ly instanceof Promise?ly.then(function(uy){uy instanceof WorkerBroker.withTransferables&&(uy=uy.value[0]),ty(uy)},function(uy){ry(uy instanceof Error?"".concat(uy.message,": ").concat(uy.stack):uy)}):(ly instanceof WorkerBroker.withTransferables&&(ly=ly.value[0]),ty(ly))})}($,e&&e.init?e:void 0);var _e=new Promise(function(_r,_i){messages[message_id]={method:o,message:h,resolve:_r,reject:_i}});return _.stringify&&($=JSON.stringify($)),e.postMessage($,_t.map(function(_r){return _r.object})),freeTransferables(_t),_e},WorkerBroker.addWorker=function(e){if(!(e instanceof Worker))throw Error("Worker broker could not add non-Worker object",e);e.addEventListener("message",function(o){var s=typeof o.data=="string"?JSON.parse(o.data):o.data,h=s.message_id;if(s.type==="worker_reply")messages[h]&&(s.error?messages[h].reject(s.error):messages[h].resolve(s.message),delete messages[h]);else if(s.type==="worker_send"&&h!=null){var d=_slicedToArray(findTarget(s.method),2),g=d[0],_=d[1],j="Worker broker could not dispatch message type ".concat(s.method," on target ").concat(s.target,".");if(!_)throw Error(j+ERROR_NO_TARGET);var $=typeof _[g]=="function"&&_[g];if(!$)throw Error(j+ERROR_NO_METHOD);var _t,_e=ERROR_NOT_SET;try{_t=$.apply(_,s.message)}catch(_n){_e=_n}var _r,_i=[];_t&&typeof _t.then=="function"?_t.then(function(_n){_n instanceof WorkerBroker.withTransferables&&(_i=_n.transferables,_n=_n.value[0]),_r={type:"main_reply",message_id:h,message:_n},e.postMessage(_r,_i.map(function(_s){return _s.object})),freeTransferables(_i)},function(_n){e.postMessage({type:"main_reply",message_id:h,error:_n instanceof Error?"".concat(_n.message,": ").concat(_n.stack):_n})}):(_t instanceof WorkerBroker.withTransferables&&(_i=_t.transferables,_t=_t.value[0]),_r={type:"main_reply",message_id:h,message:_t,error:_e instanceof Error?"".concat(_e.message,": ").concat(_e.stack):_e},e.postMessage(_r,_i.map(function(_n){return _n.object})),freeTransferables(_i))}})},WorkerBroker.getMessages=function(){return messages},WorkerBroker.getMessageId=function(){return message_id}}function setupWorkerThread(){WorkerBroker.postMessage=function(e){for(var o=arguments.length,s=new Array(o>1?o-1:0),h=1;h<o;h++)s[h-1]=arguments[h];var d={};_typeof(e)==="object"&&(d=e,e=e.method);var g,_=new Promise(function($,_t){messages[message_id]={method:e,message:s,resolve:$,reject:_t}}),j=[];return s&&s.length===1&&s[0]instanceof WorkerBroker.withTransferables&&(j=s[0].transferables,s=s[0].value),g={type:"worker_send",message_id,method:e,message:s},d.stringify&&(g=JSON.stringify(g)),self.postMessage(g,j.map(function($){return $.object})),freeTransferables(j),message_id++,_},self.addEventListener("message",function(e){var o=typeof e.data=="string"?JSON.parse(e.data):e.data,s=o.message_id;if(o.type==="main_reply")messages[s]&&(o.hasOwnProperty("error")&&o.error!==ERROR_NOT_SET?messages[s].reject(o.error):messages[s].resolve(o.message),delete messages[s]);else if(o.type==="main_send"&&s!=null){var h=_slicedToArray(findTarget(o.method),2),d=h[0],g=h[1],_="Worker broker could not dispatch message type ".concat(o.method," on target ").concat(o.target,".");if(!g)throw Error(_+ERROR_NO_TARGET);var j,$,_t=typeof g[d]=="function"&&g[d];if(!_t)throw Error(_+ERROR_NO_METHOD);try{j=_t.apply(g,o.message)}catch(_i){$=_i}var _e,_r=[];j instanceof Promise?j.then(function(_i){_i instanceof WorkerBroker.withTransferables&&(_r=_i.transferables,_i=_i.value[0]),_e={type:"worker_reply",message_id:s,message:_i},self.postMessage(_e,_r.map(function(_n){return _n.object})),freeTransferables(_r)},function(_i){self.postMessage({type:"worker_reply",message_id:s,error:_i instanceof Error?"".concat(_i.message,": ").concat(_i.stack):_i})}):(j instanceof WorkerBroker.withTransferables&&(_r=j.transferables,j=j.value[0]),_e={type:"worker_reply",message_id:s,message:j,error:$ instanceof Error?"".concat($.message,": ").concat($.stack):$},self.postMessage(_e,_r.map(function(_i){return _i.object})),freeTransferables(_r))}})}function findTransferables(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];if(!e)return h;if(Array.isArray(e))e.forEach(function(g,_){return findTransferables(g,e,_,h)});else if(_typeof(e)==="object")if(e instanceof ArrayBuffer)h.push({object:e,parent:o,property:s});else if(e.buffer instanceof ArrayBuffer)h.push({object:e.buffer,parent:o,property:s});else for(var d in e)findTransferables(e[d],e,d,h);return h}function freeTransferables(e){Array.isArray(e)&&e.filter(function(o){return o.parent&&o.property}).forEach(function(o){return delete o.parent[o.property]})}WorkerBroker.withTransferables=function(){for(var e=arguments.length,o=new Array(e),s=0;s<e;s++)o[s]=arguments[s];if(!(this instanceof WorkerBroker.withTransferables))return _construct(WorkerBroker.withTransferables,o);this.value=o,this.transferables=findTransferables(this.value)},Thread.is_main&&setupMainThread(),Thread.is_worker&&setupWorkerThread();var LEVELS={silent:-1,error:0,warn:1,info:2,debug:3,trace:4},methods={},logged_once={},Utils;function methodForLevel(e){return methods[e]=methods[e]||(console[e]?console[e]:console.log).bind(console),methods[e]}function log(e){var o=_typeof(e)==="object"?e.level:e;if(LEVELS[o]<=LEVELS[log.level]){for(var s=arguments.length,h=new Array(s>1?s-1:0),d=1;d<s;d++)h[d-1]=arguments[d];if(Thread.is_native_worker)WorkerBroker.postMessage.apply(WorkerBroker,[{method:"_logProxy",stringify:!0},e].concat(h));else{if(_typeof(e)==="object"&&e.once===!0){if(logged_once[JSON.stringify(h)])return;logged_once[JSON.stringify(h)]=!0}var g=methodForLevel(o);h.length>1?g.apply(void 0,["Tangram [".concat(o,"]: ").concat(h[0])].concat(_toConsumableArray(h.slice(1)))):g("Tangram [".concat(o,"]: ").concat(h[0]))}}}function debounce(e,o,s){var h,d;return s=s||0,function(){var g=this,_=arguments;function j(){d=0,e.apply(g,_)}clearTimeout(h),d&&s&&Date.now()-d>=s?j():(d||(d=Date.now()),h=setTimeout(function(){j()},o))}}log.level="info",log.workers=null,log.setLevel=function(e){log.level=e,Thread.is_main&&Array.isArray(log.workers)&&WorkerBroker.postMessage(log.workers,"_logSetLevelProxy",e)},Thread.is_main&&(log.setWorkers=function(e){log.workers=e},log.reset=function(){logged_once={}}),WorkerBroker.addTarget("_logProxy",log),WorkerBroker.addTarget("_logSetLevelProxy",log.setLevel);var Utils$1=Utils={};WorkerBroker.addTarget("Utils",Utils),Utils.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},Utils.isMicrosoft=function(){return/(Trident\/7.0|Edge[ /](\d+[\.\d]+))/i.test(navigator.userAgent)},Utils._requests={},Utils._proxy_requests={},Utils.io=function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6e4,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"text",h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"GET",d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{},g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,_=arguments.length>6&&arguments[6]!==void 0&&arguments[6];if(Thread.is_worker&&Utils.isMicrosoft())return log("debug","Proxying request for URL to worker",e),g&&(Utils._proxy_requests[g]=!0),WorkerBroker.postMessage("Utils.io",e,o,s,h,d,g,!0);var j=new XMLHttpRequest,$=new Promise(function(_t,_e){j.open(h,e,!0),j.timeout=o,j.responseType=s,j.onload=function(){j.status===200?["text","json"].indexOf(j.responseType)>-1?_t(j.responseText):_t(j.response):_e(Error("Request error with a status of "+j.statusText))},j.onerror=function(_r){_e(Error("There was a network error"+_r.toString()))},j.ontimeout=function(_r){_e(Error("timeout "+_r.toString()))},j.send()});return $=$.then(function(_t){return g&&delete Utils._requests[g],_?WorkerBroker.withTransferables(_t):_t}),g&&(Utils._requests[g]=j),$},Utils.cancelRequest=function(e){if(Thread.is_worker&&Utils._proxy_requests[e])return WorkerBroker.postMessage("Utils.cancelRequest",e);Utils._requests[e]?(log("trace","Cancelling network request key '".concat(e,"'")),Utils._requests[e].abort(),delete Utils._requests[e]):log("trace","Could not find network request key '".concat(e,"'"))},Utils.requestAnimationFramePolyfill=function(){typeof window.requestAnimationFrame!="function"&&(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,16.666666666666668)})},Utils.serializeWithFunctions=function(e){return typeof e=="function"?e.toString():JSON.stringify(e,function(o,s){return typeof s=="function"?s.toString():s})},Utils.stringsToFunctions=function(e,o){if(typeof e=="string")e=Utils.stringToFunction(e,o);else if(e!=null&&_typeof(e)==="object")for(var s in e)e[s]=Utils.stringsToFunctions(e[s],o);return e},Utils._use_count=0,Utils._function_cache={};var _clear_function_cache=debounce(function(){log("trace","Cleared cached ".concat(Object.keys(Utils._function_cache).length," functions (reused ").concat(Utils._use_count," times)")),Utils._use_count=0,Utils._function_cache={}},1e4),FUNCTION_MATCH_RGX=/^\s*function[^(]*\(([^)]*)\)\s*?\{([\s\S]*)\}$/m,_createObjectURL,_revokeObjectURL;function addBaseURL(e,o){if(!e||!isRelativeURL(e))return e;var s,h=e[0]!=="/";if(o?(s=document.createElement("a")).href=o:s=window.location,h)e=pathForURL(s.href)+e;else{var d=s.origin;d||(d=s.protocol+"//"+s.host),e=d+e}return e}function pathForURL(e){if(typeof e=="string"&&e.search(/^(data|blob):/)===-1){var o=e.indexOf("?");o>-1&&(e=e.substr(0,o));var s=e.indexOf("#");return s>-1&&(e=e.substr(0,s)),e.substr(0,e.lastIndexOf("/")+1)||""}return""}function extensionForURL(e){var o=(e=e.split("/").pop()).lastIndexOf(".");if(o>-1)return e.substring(o+1)}function isRelativeURL(e){if(typeof e=="string")return!(e.search(/^(http|https|data|blob):/)>-1||e.substr(0,2)==="//")}function addParamsToURL(e,o){if(!o||Object.keys(o).length===0)return[e,[]];var s=e.indexOf("?"),h=e.indexOf("#"),d="";h>-1&&(d=e.slice(h),e=e.slice(0,h)),s===-1&&(s=e.length,e+="?"),s++;var g="",_=[];for(var j in o)getURLParameter(j,e)===""?g+="".concat(j,"=").concat(o[j],"&"):_.push([j,o[j]]);return[e=e.slice(0,s)+g+e.slice(s)+d,_]}function createObjectURL(e){return _createObjectURL===void 0&&typeof(_createObjectURL=window.URL&&window.URL.createObjectURL||window.webkitURL&&window.webkitURL.createObjectURL)!="function"&&(_createObjectURL=null,log("warn","window.URL.createObjectURL (or vendor prefix) not found, unable to create local blob URLs")),_createObjectURL?_createObjectURL(e):e}function revokeObjectURL(e){return _revokeObjectURL===void 0&&typeof(_revokeObjectURL=window.URL&&window.URL.revokeObjectURL||window.webkitURL&&window.webkitURL.revokeObjectURL)!="function"&&(_revokeObjectURL=null,log("warn","window.URL.revokeObjectURL (or vendor prefix) not found, unable to create local blob URLs")),_revokeObjectURL?_revokeObjectURL(e):e}function getURLParameter(e,o){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var s=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(o);return s===null?"":decodeURIComponent(s[1].replace(/\+/g," "))}Utils.stringToFunction=function(e,o){var s=e;o&&(s+=o.toString());var h=Utils._function_cache[s];if(_clear_function_cache(),h)return Utils._use_count++,h;var d=typeof e=="string"&&e.match(FUNCTION_MATCH_RGX);if(d&&d.length>2)try{var g=d[2],_=d[1].length>0&&d[1].split(",").map(function($){return $.trim()}).filter(function($){return $});_=_.length>0?_:["context"];var j=new Function(_.toString(),typeof o=="function"?o(g):g);return Utils._function_cache[s]=j,j}catch{return e}return e},Utils.device_pixel_ratio=1,Utils.isPowerOf2=function(e){return!(e&e-1)},Utils.interpolate=function(e,o,s){if(!Array.isArray(o)||!Array.isArray(o[0])||o.length<1)return o;var h,d,g,_,j;if(e<=o[0][0])_=o[0][1],typeof s=="function"&&(_=s(_));else if(e>=o[o.length-1][0])_=o[o.length-1][1],typeof s=="function"&&(_=s(_));else for(var $=0;$<o.length-1;$++)if(e>=o[$][0]&&e<o[$+1][0]){if(h=o[$][0],d=o[$+1][0],Array.isArray(o[$][1])){_=[];for(var _t=0;_t<o[$][1].length;_t++)typeof s=="function"?(j=s(o[$][1][_t]),g=s(o[$+1][1][_t])-j,_[_t]=g*(e-h)/(d-h)+j):(g=o[$+1][1][_t]-o[$][1][_t],_[_t]=g*(e-h)/(d-h)+o[$][1][_t])}else typeof s=="function"?(j=s(o[$][1]),_=(g=s(o[$+1][1])-j)*(e-h)/(d-h)+j):_=(g=o[$+1][1]-o[$][1])*(e-h)/(d-h)+o[$][1];break}return _},Utils.toCSSColor=function(e){return e[3]===1?"rgb(".concat(e.slice(0,3).map(function(o){return Math.round(255*o)}).join(", "),")"):"rgba(".concat(e.map(function(o,s){return s<3&&Math.round(255*o)||o}).join(", "),")")},Utils.pointInTile=function(e){return e[0]>=0&&e[1]>-Geo$1.tile_scale&&e[0]<Geo$1.tile_scale&&e[1]<=0},Utils.zoomToTileLevel=function(e){return Math.floor(e)};var DataSource=function(){function e(o,s){var h=this;if(_classCallCheck(this,e),this.config=o,this.sources=s,this.id=o.id,this.name=o.name,this.pad_scale=o.pad_scale||1e-4,this.default_winding=null,this.rasters=[],Array.isArray(o.rasters)&&o.rasters.forEach(function(g){h.rasters.indexOf(g)===-1&&h.rasters.push(g)}),this.preprocess=o.preprocess,typeof this.preprocess=="function"&&this.preprocess.bind(this),this.transform=o.transform,typeof this.transform=="function")this.transform=this.transform.bind(this);else if(_typeof(this.transform)==="object")for(var d in this.transform)typeof this.transform[d]=="function"&&(this.transform[d]=this.transform[d].bind(this));this.extra_data=o.extra_data,this.scripts=o.scripts,this.max_zoom=o.max_zoom!=null?o.max_zoom:Geo$1.default_source_max_zoom,this.setTileSize(o.tile_size),this.max_coord_zoom=this.max_zoom+this.zoom_bias,this.min_display_zoom=o.min_display_zoom!=null?o.min_display_zoom:0,this.max_display_zoom=o.max_display_zoom!=null?o.max_display_zoom:null,this._has_volatile_data=!!o.has_volatile_data}return _createClass(e,[{key:"has_volatile_data",get:function(){return this._has_volatile_data},set:function(){var o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this._has_volatile_data=o}},{key:"hasLabeledData",value:function(){return!0}},{key:"_transformTile",value:function(o){if(o.source_data.layers){var s={coords:o.coords},h=[];if(typeof this.transform=="function")h.push(this.transform);else if(_typeof(this.transform)==="object")for(var d=Object.keys(this.transform).sort(),g=0;g<d.length;g++)h.push(this.transform[d[g]]);for(var _=Object.keys(o.source_data.layers).length===1&&o.source_data.layers._default,j=0;j<h.length;j++)_?o.source_data.layers._default=h[j](o.source_data.layers._default,this.extra_data,s):o.source_data.layers=h[j](o.source_data.layers,this.extra_data,s)}}},{key:"_postProcessTile",value:function(o){var s=this;for(var h in this._transformTile(o),o.source_data.layers){var d=o.source_data.layers[h];d&&d.features&&d.features.forEach(function(g){Geo$1.transformGeometry(g.geometry,function(_){_[1]=-_[1],s.pad_scale&&(_[0]=Math.round(_[0]*(1+s.pad_scale)-Geo$1.tile_scale*s.pad_scale/2),_[1]=Math.round(_[1]*(1+s.pad_scale)-Geo$1.tile_scale*s.pad_scale/2))}),s.updateDefaultWinding(g.geometry)})}o.default_winding=this.default_winding||"CCW"}},{key:"load",value:function(o){return o.source_data={},o.source_data.layers={},o.pad_scale=this.pad_scale,o.rasters=_toConsumableArray(this.rasters),this._load(o)}},{key:"_load",value:function(o){throw new MethodNotImplemented("_load")}},{key:"setTileSize",value:function(o){this.tile_size=o||256,(typeof this.tile_size!="number"||this.tile_size<256||!Utils$1.isPowerOf2(this.tile_size))&&(log({level:"warn",once:!0},"Data source '".concat(this.name,"': 'tile_size' parameter must be a number that is a power of 2 greater than or equal to 256, but was '").concat(o,"'")),this.tile_size=256),this.zoom_bias=Math.log2(this.tile_size)-8}},{key:"updateDefaultWinding",value:function(o){return this.default_winding==null&&(o.type==="Polygon"?this.default_winding=Geo$1.ringWinding(o.coordinates[0]):o.type==="MultiPolygon"&&(this.default_winding=Geo$1.ringWinding(o.coordinates[0][0]))),this.default_winding}},{key:"includesTile",value:function(o,s){if(o.z<this.min_display_zoom||this.max_display_zoom!=null&&s>this.max_display_zoom)return!1;for(var h=0;h<this.rasters.length;h++){var d=this.rasters[h];if(this.sources[d]&&this.sources[d]!==this&&!this.sources[d].includesTile(o,o.z))return!1}return!0}}],[{key:"create",value:function(o,s){for(var h in s)if(s[h].config.name===o.name&&e.sameConfig(s[h],{config:o}))return s[h];if(e.types[o.type])return new e.types[o.type](o,s)}},{key:"sameConfig",value:function(o,s){if(!o||!s)return!1;var h=Object.assign({},o.config,{id:null,tiled:null,url:null}),d=Object.assign({},s.config,{id:null,tiled:null,url:null});return JSON.stringify(h)===JSON.stringify(d)}},{key:"coordsToMeters",value:function(o){var s=_slicedToArray(Geo$1.latLngToMeters(o),2),h=s[0],d=s[1];o[0]=h,o[1]=d}},{key:"projectData",value:function(o){for(var s in o.layers)for(var h=o.layers[s].features.length,d=0;d<h;d++){var g=o.layers[s].features[d];Geo$1.transformGeometry(g.geometry,e.coordsToMeters)}}},{key:"metersToTileUnits",value:function(o,s,h){h[0]=Math.round((h[0]-s.x)*o),h[1]=-1*Math.round((h[1]-s.y)*o)}},{key:"scaleData",value:function(o,s){var h=s.coords.z,d=s.min;s.max;var g=e.metersToTileUnits.bind(this,Geo$1.unitsPerMeter(h),d);for(var _ in o.layers)for(var j=o.layers[_].features.length,$=0;$<j;$++){var _t=o.layers[_].features[$];Geo$1.transformGeometry(_t.geometry,g)}}},{key:"register",value:function(o,s){o&&s&&(e.types[s]=o)}}])}();DataSource.types={};var network_request_id=0,NetworkSource=function(e){function o(s,h){var d;_classCallCheck(this,o),(d=_callSuper(this,o,[s,h])).response_type="";var g=_slicedToArray(addParamsToURL(s.url,s.url_params),2),_=g[0],j=g[1];if(d.url=_,j.forEach(function($){var _t=_slicedToArray($,2),_e=_t[0],_r=_t[1];log({level:"warn",once:!0},"Data source '".concat(d.name,"': parameter '").concat(_e,"' already present in URL '").concat(s.url,"', ")+"skipping value '".concat(_e,"=").concat(_r,"' specified in 'url_params'"))}),typeof d.url!="string")throw Error("Network data source must provide a string `url` property");return d}return _inherits(o,e),_createClass(o,[{key:"_load",value:function(s){var h=this,d=this.formatUrl(this.url,s),g=s.source_data;return g.url=d,new Promise(function(_,j){g.error=null;var $=network_request_id+++"-"+d,_t=Utils$1.io(d,6e4,h.response_type,"GET",{},$);g.request_id=$,_t.then(function(_e){typeof h.preprocess=="function"&&(_e=h.preprocess(_e)),(_e=_e instanceof Promise?_e:Promise.resolve(_e)).then(function(_r){h.parseSourceData(s,g,_r),h._postProcessTile(s),_(s)})},function(_e){g.error=_e.stack,h._postProcessTile(s),_(s)})})}},{key:"formatUrl",value:function(s,h){throw new MethodNotImplemented("formatUrl")}},{key:"parseSourceData",value:function(s,h,d){throw new MethodNotImplemented("parseSourceData")}}])}(DataSource),NetworkTileSource=function(e){function o(s,h){var d;return _classCallCheck(this,o),(d=_callSuper(this,o,[s,h])).tiled=!0,d.parseBounds(s),d.builds_geometry_tiles=!1,d.tms=s.tms===!0,d.url.search("{s}")>-1&&(Array.isArray(s.url_subdomains)&&s.url_subdomains.length>0?(d.url_subdomains=s.url_subdomains,d.next_url_subdomain=0):log({level:"warn",once:!0},"Data source '".concat(d.name,"': source URL includes '{s}' subdomain marker ('").concat(d.url,"'), but no subdomains ")+"were specified in 'url_subdomains' parameter")),d}return _inherits(o,e),_createClass(o,[{key:"parseBounds",value:function(s){if(Array.isArray(s.bounds)&&s.bounds.length===4){this.bounds=s.bounds;var h=_slicedToArray(this.bounds,4),d=h[0],g=h[1],_=h[2],j=h[3];this.bounds_meters={min:Geo$1.latLngToMeters([d,j]),max:Geo$1.latLngToMeters([_,g])},this.bounds_tiles={min:{},max:{}}}}},{key:"checkBounds",value:function(s){if(this.bounds){s=Geo$1.wrapTile(s,{x:!0});var h=this.bounds_tiles.min[s.z];h||(h=this.bounds_tiles.min[s.z]=Geo$1.tileForMeters(this.bounds_meters.min,s.z));var d=this.bounds_tiles.max[s.z];if(d||(d=this.bounds_tiles.max[s.z]=Geo$1.tileForMeters(this.bounds_meters.max,s.z)),s.x<h.x||s.x>d.x||s.y<h.y||s.y>d.y)return!1}return!0}},{key:"includesTile",value:function(s,h){return!!_get(_getPrototypeOf(o.prototype),"includesTile",this).call(this,s,h)&&!!this.checkBounds(s)}},{key:"formatUrl",value:function(s,h){var d=Geo$1.wrapTile(h.coords,{x:!0});this.tms&&(d.y=Math.pow(2,d.z)-1-d.y);var g=s.replace("{x}",d.x).replace("{y}",d.y).replace("{z}",d.z);return this.url_subdomains!=null&&(g=g.replace("{s}",this.url_subdomains[this.next_url_subdomain]),this.next_url_subdomain=(this.next_url_subdomain+1)%this.url_subdomains.length),g}},{key:"urlHasTilePattern",value:function(s){return s&&s.search("{x}")>-1&&s.search("{y}")>-1&&s.search("{z}")>-1}}])}(NetworkSource),MapsJsSource=function(e){function o(s,h){var d;return _classCallCheck(this,o),(d=_callSuper(this,o,[s,h])).target_name="MapsJsSource"+s.uid,d.tiled=!!s.tiled,WorkerBroker.addTarget(d.target_name,d),Thread.is_worker&&WorkerBroker.postMessage(d.target_name+".onWorkerInitialized"),Thread.is_main&&(d._workers_left=0),d}return _inherits(o,e),_createClass(o,[{key:"initialize",value:function(s,h,d,g){this._main_initialized||(this.provider=s,this.worker=g,this._workers_left+=d,this._on_update=h,this._main_initialized=!0,this._onProviderUpdate=this._onProviderUpdate.bind(this),s.addEventListener("update",this._onProviderUpdate),this._isReady()&&this.onReady())}},{key:"onWorkerInitialized",value:function(){--this._workers_left,this._isReady()&&this.onReady()}},{key:"onReady",value:function(){}},{key:"_isReady",value:function(){return this._main_initialized&&!this._workers_left}},{key:"_onProviderUpdate",value:function(s){this._isReady()&&this.onProviderUpdate(s)}},{key:"onProviderUpdate",value:function(s){this.dispatchUpdate(void 0,s.data)}},{key:"dispatchUpdate",value:function(s,h){this._on_update(this.name,s,h)}},{key:"dispose",value:function(){WorkerBroker.removeTarget(this.target_name),this.provider.removeEventListener("update",this._onProviderUpdate)}}])}(DataSource),ieee754$1={read:function(e,o,s,h,d){var g,_,j=8*d-h-1,$=(1<<j)-1,_t=$>>1,_e=-7,_r=s?d-1:0,_i=s?-1:1,_n=e[o+_r];for(_r+=_i,g=_n&(1<<-_e)-1,_n>>=-_e,_e+=j;_e>0;g=256*g+e[o+_r],_r+=_i,_e-=8);for(_=g&(1<<-_e)-1,g>>=-_e,_e+=h;_e>0;_=256*_+e[o+_r],_r+=_i,_e-=8);if(g===0)g=1-_t;else{if(g===$)return _?NaN:1/0*(_n?-1:1);_+=Math.pow(2,h),g-=_t}return(_n?-1:1)*_*Math.pow(2,g-h)},write:function(e,o,s,h,d,g){var _,j,$,_t=8*g-d-1,_e=(1<<_t)-1,_r=_e>>1,_i=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,_n=h?0:g-1,_s=h?1:-1,_l=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(j=isNaN(o)?1:0,_=_e):(_=Math.floor(Math.log(o)/Math.LN2),o*($=Math.pow(2,-_))<1&&(_--,$*=2),(o+=_+_r>=1?_i/$:_i*Math.pow(2,1-_r))*$>=2&&(_++,$/=2),_+_r>=_e?(j=0,_=_e):_+_r>=1?(j=(o*$-1)*Math.pow(2,d),_+=_r):(j=o*Math.pow(2,_r-1)*Math.pow(2,d),_=0));d>=8;e[s+_n]=255&j,_n+=_s,j/=256,d-=8);for(_=_<<d|j,_t+=d;_t>0;e[s+_n]=255&_,_n+=_s,_/=256,_t-=8);e[s+_n-_s]|=128*_l}},pbf=Pbf,ieee754=ieee754$1;function Pbf(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Pbf.Varint=0,Pbf.Fixed64=1,Pbf.Bytes=2,Pbf.Fixed32=5;var SHIFT_LEFT_32=4294967296,SHIFT_RIGHT_32=1/SHIFT_LEFT_32;function readVarintRemainder(e,o,s){var h,d,g=s.buf;if(h=(112&(d=g[s.pos++]))>>4,d<128||(h|=(127&(d=g[s.pos++]))<<3,d<128)||(h|=(127&(d=g[s.pos++]))<<10,d<128)||(h|=(127&(d=g[s.pos++]))<<17,d<128)||(h|=(127&(d=g[s.pos++]))<<24,d<128)||(h|=(1&(d=g[s.pos++]))<<31,d<128))return toNum(e,h,o);throw new Error("Expected varint not more than 10 bytes")}function readPackedEnd(e){return e.type===Pbf.Bytes?e.readVarint()+e.pos:e.pos+1}function toNum(e,o,s){return s?4294967296*o+(e>>>0):4294967296*(o>>>0)+(e>>>0)}function writeBigVarint(e,o){var s,h;if(e>=0?(s=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),writeBigVarintLow(s,h,o),writeBigVarintHigh(h,o)}function writeBigVarintLow(e,o,s){s.buf[s.pos++]=127&e|128,e>>>=7,s.buf[s.pos++]=127&e|128,e>>>=7,s.buf[s.pos++]=127&e|128,e>>>=7,s.buf[s.pos++]=127&e|128,e>>>=7,s.buf[s.pos]=127&e}function writeBigVarintHigh(e,o){var s=(7&e)<<4;o.buf[o.pos++]|=s|((e>>>=3)?128:0),e&&(o.buf[o.pos++]=127&e|((e>>>=7)?128:0),e&&(o.buf[o.pos++]=127&e|((e>>>=7)?128:0),e&&(o.buf[o.pos++]=127&e|((e>>>=7)?128:0),e&&(o.buf[o.pos++]=127&e|((e>>>=7)?128:0),e&&(o.buf[o.pos++]=127&e)))))}function makeRoomForExtraLength(e,o,s){var h=o<=16383?1:o<=2097151?2:o<=268435455?3:Math.ceil(Math.log(o)/(7*Math.LN2));s.realloc(h);for(var d=s.pos-1;d>=e;d--)s.buf[d+h]=s.buf[d]}function writePackedVarint(e,o){for(var s=0;s<e.length;s++)o.writeVarint(e[s])}function writePackedSVarint(e,o){for(var s=0;s<e.length;s++)o.writeSVarint(e[s])}function writePackedFloat(e,o){for(var s=0;s<e.length;s++)o.writeFloat(e[s])}function writePackedDouble(e,o){for(var s=0;s<e.length;s++)o.writeDouble(e[s])}function writePackedBoolean(e,o){for(var s=0;s<e.length;s++)o.writeBoolean(e[s])}function writePackedFixed32(e,o){for(var s=0;s<e.length;s++)o.writeFixed32(e[s])}function writePackedSFixed32(e,o){for(var s=0;s<e.length;s++)o.writeSFixed32(e[s])}function writePackedFixed64(e,o){for(var s=0;s<e.length;s++)o.writeFixed64(e[s])}function writePackedSFixed64(e,o){for(var s=0;s<e.length;s++)o.writeSFixed64(e[s])}function readUInt32(e,o){return(e[o]|e[o+1]<<8|e[o+2]<<16)+16777216*e[o+3]}function writeInt32(e,o,s){e[s]=o,e[s+1]=o>>>8,e[s+2]=o>>>16,e[s+3]=o>>>24}function readInt32(e,o){return(e[o]|e[o+1]<<8|e[o+2]<<16)+(e[o+3]<<24)}function readUtf8(e,o,s){for(var h="",d=o;d<s;){var g,_,j,$=e[d],_t=null,_e=$>239?4:$>223?3:$>191?2:1;if(d+_e>s)break;_e===1?$<128&&(_t=$):_e===2?(192&(g=e[d+1]))==128&&(_t=(31&$)<<6|63&g)<=127&&(_t=null):_e===3?(g=e[d+1],_=e[d+2],(192&g)==128&&(192&_)==128&&((_t=(15&$)<<12|(63&g)<<6|63&_)<=2047||_t>=55296&&_t<=57343)&&(_t=null)):_e===4&&(g=e[d+1],_=e[d+2],j=e[d+3],(192&g)==128&&(192&_)==128&&(192&j)==128&&((_t=(15&$)<<18|(63&g)<<12|(63&_)<<6|63&j)<=65535||_t>=1114112)&&(_t=null)),_t===null?(_t=65533,_e=1):_t>65535&&(_t-=65536,h+=String.fromCharCode(_t>>>10&1023|55296),_t=56320|1023&_t),h+=String.fromCharCode(_t),d+=_e}return h}function writeUtf8(e,o,s){for(var h,d,g=0;g<o.length;g++){if((h=o.charCodeAt(g))>55295&&h<57344){if(!d){h>56319||g+1===o.length?(e[s++]=239,e[s++]=191,e[s++]=189):d=h;continue}if(h<56320){e[s++]=239,e[s++]=191,e[s++]=189,d=h;continue}h=d-55296<<10|h-56320|65536,d=null}else d&&(e[s++]=239,e[s++]=191,e[s++]=189,d=null);h<128?e[s++]=h:(h<2048?e[s++]=h>>6|192:(h<65536?e[s++]=h>>12|224:(e[s++]=h>>18|240,e[s++]=h>>12&63|128),e[s++]=h>>6&63|128),e[s++]=63&h|128)}return s}Pbf.prototype={destroy:function(){this.buf=null},readFields:function(e,o,s){for(s=s||this.length;this.pos<s;){var h=this.readVarint(),d=h>>3,g=this.pos;this.type=7&h,e(d,o,this),this.pos===g&&this.skip(h)}return o},readMessage:function(e,o){return this.readFields(e,o,this.readVarint()+this.pos)},readFixed32:function(){var e=readUInt32(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=readInt32(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=readUInt32(this.buf,this.pos)+readUInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;return this.pos+=8,e},readSFixed64:function(){var e=readUInt32(this.buf,this.pos)+readInt32(this.buf,this.pos+4)*SHIFT_LEFT_32;return this.pos+=8,e},readFloat:function(){var e=ieee754.read(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=ieee754.read(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var o,s,h=this.buf;return o=127&(s=h[this.pos++]),s<128?o:(o|=(127&(s=h[this.pos++]))<<7,s<128?o:(o|=(127&(s=h[this.pos++]))<<14,s<128?o:(o|=(127&(s=h[this.pos++]))<<21,s<128?o:readVarintRemainder(o|=(15&(s=h[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var e=this.readVarint()+this.pos,o=readUtf8(this.buf,this.pos,e);return this.pos=e,o},readBytes:function(){var e=this.readVarint()+this.pos,o=this.buf.subarray(this.pos,e);return this.pos=e,o},readPackedVarint:function(e,o){var s=readPackedEnd(this);for(e=e||[];this.pos<s;)e.push(this.readVarint(o));return e},readPackedSVarint:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readBoolean());return e},readPackedFloat:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readFloat());return e},readPackedDouble:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readDouble());return e},readPackedFixed32:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){var o=readPackedEnd(this);for(e=e||[];this.pos<o;)e.push(this.readSFixed64());return e},skip:function(e){var o=7&e;if(o===Pbf.Varint)for(;this.buf[this.pos++]>127;);else if(o===Pbf.Bytes)this.pos=this.readVarint()+this.pos;else if(o===Pbf.Fixed32)this.pos+=4;else{if(o!==Pbf.Fixed64)throw new Error("Unimplemented type: "+o);this.pos+=8}},writeTag:function(e,o){this.writeVarint(e<<3|o)},realloc:function(e){for(var o=this.length||16;o<this.pos+e;)o*=2;if(o!==this.length){var s=new Uint8Array(o);s.set(this.buf),this.buf=s,this.length=o}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),writeInt32(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*SHIFT_RIGHT_32),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),writeInt32(this.buf,-1&e,this.pos),writeInt32(this.buf,Math.floor(e*SHIFT_RIGHT_32),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?writeBigVarint(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(!!e)},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var o=this.pos;this.pos=writeUtf8(this.buf,e,this.pos);var s=this.pos-o;s>=128&&makeRoomForExtraLength(o,s,this),this.pos=o-1,this.writeVarint(s),this.pos+=s},writeFloat:function(e){this.realloc(4),ieee754.write(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),ieee754.write(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var o=e.length;this.writeVarint(o),this.realloc(o);for(var s=0;s<o;s++)this.buf[this.pos++]=e[s]},writeRawMessage:function(e,o){this.pos++;var s=this.pos;e(o,this);var h=this.pos-s;h>=128&&makeRoomForExtraLength(s,h,this),this.pos=s-1,this.writeVarint(h),this.pos+=h},writeMessage:function(e,o,s){this.writeTag(e,Pbf.Bytes),this.writeRawMessage(o,s)},writePackedVarint:function(e,o){this.writeMessage(e,writePackedVarint,o)},writePackedSVarint:function(e,o){this.writeMessage(e,writePackedSVarint,o)},writePackedBoolean:function(e,o){this.writeMessage(e,writePackedBoolean,o)},writePackedFloat:function(e,o){this.writeMessage(e,writePackedFloat,o)},writePackedDouble:function(e,o){this.writeMessage(e,writePackedDouble,o)},writePackedFixed32:function(e,o){this.writeMessage(e,writePackedFixed32,o)},writePackedSFixed32:function(e,o){this.writeMessage(e,writePackedSFixed32,o)},writePackedFixed64:function(e,o){this.writeMessage(e,writePackedFixed64,o)},writePackedSFixed64:function(e,o){this.writeMessage(e,writePackedSFixed64,o)},writeBytesField:function(e,o){this.writeTag(e,Pbf.Bytes),this.writeBytes(o)},writeFixed32Field:function(e,o){this.writeTag(e,Pbf.Fixed32),this.writeFixed32(o)},writeSFixed32Field:function(e,o){this.writeTag(e,Pbf.Fixed32),this.writeSFixed32(o)},writeFixed64Field:function(e,o){this.writeTag(e,Pbf.Fixed64),this.writeFixed64(o)},writeSFixed64Field:function(e,o){this.writeTag(e,Pbf.Fixed64),this.writeSFixed64(o)},writeVarintField:function(e,o){this.writeTag(e,Pbf.Varint),this.writeVarint(o)},writeSVarintField:function(e,o){this.writeTag(e,Pbf.Varint),this.writeSVarint(o)},writeStringField:function(e,o){this.writeTag(e,Pbf.Bytes),this.writeString(o)},writeFloatField:function(e,o){this.writeTag(e,Pbf.Fixed32),this.writeFloat(o)},writeDoubleField:function(e,o){this.writeTag(e,Pbf.Fixed64),this.writeDouble(o)},writeBooleanField:function(e,o){this.writeVarintField(e,!!o)}};var Pbf$1=getDefaultExportFromCjs(pbf),pointGeometry=Point$1;function Point$1(e,o){this.x=e,this.y=o}Point$1.prototype={clone:function(){return new Point$1(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,o){return this.clone()._rotateAround(e,o)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var o=e.x-this.x,s=e.y-this.y;return o*o+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,o){return Math.atan2(this.x*o-this.y*e,this.x*e+this.y*o)},_matMult:function(e){var o=e[0]*this.x+e[1]*this.y,s=e[2]*this.x+e[3]*this.y;return this.x=o,this.y=s,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var o=Math.cos(e),s=Math.sin(e),h=o*this.x-s*this.y,d=s*this.x+o*this.y;return this.x=h,this.y=d,this},_rotateAround:function(e,o){var s=Math.cos(e),h=Math.sin(e),d=o.x+s*(this.x-o.x)-h*(this.y-o.y),g=o.y+h*(this.x-o.x)+s*(this.y-o.y);return this.x=d,this.y=g,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Point$1.convert=function(e){return e instanceof Point$1?e:Array.isArray(e)?new Point$1(e[0],e[1]):e};var Point=pointGeometry,vectortilefeature=VectorTileFeature$2;function VectorTileFeature$2(e,o,s,h,d){this.properties={},this.extent=s,this.type=0,this._pbf=e,this._geometry=-1,this._keys=h,this._values=d,e.readFields(readFeature,this,o)}function readFeature(e,o,s){e==1?o.id=s.readVarint():e==2?readTag(s,o):e==3?o.type=s.readVarint():e==4&&(o._geometry=s.pos)}function readTag(e,o){for(var s=e.readVarint()+e.pos;e.pos<s;){var h=o._keys[e.readVarint()],d=o._values[e.readVarint()];o.properties[h]=d}}function classifyRings(e){var o=e.length;if(o<=1)return[e];for(var s,h,d=[],g=0;g<o;g++){var _=signedArea$1(e[g]);_!==0&&(h===void 0&&(h=_<0),h===_<0?(s&&d.push(s),s=[e[g]]):s.push(e[g]))}return s&&d.push(s),d}function signedArea$1(e){for(var o,s,h=0,d=0,g=e.length,_=g-1;d<g;_=d++)o=e[d],h+=((s=e[_]).x-o.x)*(o.y+s.y);return h}VectorTileFeature$2.types=["Unknown","Point","LineString","Polygon"],VectorTileFeature$2.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var o,s=e.readVarint()+e.pos,h=1,d=0,g=0,_=0,j=[];e.pos<s;){if(!d){var $=e.readVarint();h=7&$,d=$>>3}if(d--,h===1||h===2)g+=e.readSVarint(),_+=e.readSVarint(),h===1&&(o&&j.push(o),o=[]),o.push(new Point(g,_));else{if(h!==7)throw new Error("unknown command "+h);o&&o.push(o[0].clone())}}return o&&j.push(o),j},VectorTileFeature$2.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var o=e.readVarint()+e.pos,s=1,h=0,d=0,g=0,_=1/0,j=-1/0,$=1/0,_t=-1/0;e.pos<o;){if(!h){var _e=e.readVarint();s=7&_e,h=_e>>3}if(h--,s===1||s===2)(d+=e.readSVarint())<_&&(_=d),d>j&&(j=d),(g+=e.readSVarint())<$&&($=g),g>_t&&(_t=g);else if(s!==7)throw new Error("unknown command "+s)}return[_,$,j,_t]},VectorTileFeature$2.prototype.toGeoJSON=function(e,o,s){var h,d,g=this.extent*Math.pow(2,s),_=this.extent*e,j=this.extent*o,$=this.loadGeometry(),_t=VectorTileFeature$2.types[this.type];function _e(_n){for(var _s=0;_s<_n.length;_s++){var _l=_n[_s],Ap=180-360*(_l.y+j)/g;_n[_s]=[360*(_l.x+_)/g-180,360/Math.PI*Math.atan(Math.exp(Ap*Math.PI/180))-90]}}switch(this.type){case 1:var _r=[];for(h=0;h<$.length;h++)_r[h]=$[h][0];_e($=_r);break;case 2:for(h=0;h<$.length;h++)_e($[h]);break;case 3:for($=classifyRings($),h=0;h<$.length;h++)for(d=0;d<$[h].length;d++)_e($[h][d])}$.length===1?$=$[0]:_t="Multi"+_t;var _i={type:"Feature",geometry:{type:_t,coordinates:$},properties:this.properties};return"id"in this&&(_i.id=this.id),_i};var VectorTileFeature=vectortilefeature,long=Long,wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Long(e,o,s){this.low=0|e,this.high=0|o,this.unsigned=!!s}function isLong(e){return(e&&e.__isLong__)===!0}Long.prototype.__isLong__,Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(e,o){var s,h,d;return o?(d=0<=(e>>>=0)&&e<256)&&(h=UINT_CACHE[e])?h:(s=fromBits(e,(0|e)<0?-1:0,!0),d&&(UINT_CACHE[e]=s),s):(d=-128<=(e|=0)&&e<128)&&(h=INT_CACHE[e])?h:(s=fromBits(e,e<0?-1:0,!1),d&&(INT_CACHE[e]=s),s)}function fromNumber(e,o){if(isNaN(e))return o?UZERO:ZERO;if(o){if(e<0)return UZERO;if(e>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(e<=-TWO_PWR_63_DBL)return MIN_VALUE;if(e+1>=TWO_PWR_63_DBL)return MAX_VALUE$1}return e<0?fromNumber(-e,o).neg():fromBits(e%TWO_PWR_32_DBL|0,e/TWO_PWR_32_DBL|0,o)}function fromBits(e,o,s){return new Long(e,o,s)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString$1(e,o,s){if(e.length===0)throw Error("empty string");if(e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return ZERO;if(typeof o=="number"?(s=o,o=!1):o=!!o,(s=s||10)<2||36<s)throw RangeError("radix");var h;if((h=e.indexOf("-"))>0)throw Error("interior hyphen");if(h===0)return fromString$1(e.substring(1),o,s).neg();for(var d=fromNumber(pow_dbl(s,8)),g=ZERO,_=0;_<e.length;_+=8){var j=Math.min(8,e.length-_),$=parseInt(e.substring(_,_+j),s);if(j<8){var _t=fromNumber(pow_dbl(s,j));g=g.mul(_t).add(fromNumber($))}else g=(g=g.mul(d)).add(fromNumber($))}return g.unsigned=o,g}function fromValue(e,o){return typeof e=="number"?fromNumber(e,o):typeof e=="string"?fromString$1(e,o):fromBits(e.low,e.high,typeof o=="boolean"?o:e.unsigned)}Long.fromString=fromString$1,Long.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE$1=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE$1;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype;LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(MIN_VALUE)){var o=fromNumber(e),s=this.div(o),h=s.mul(o).sub(this);return s.toString(e)+h.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var d=fromNumber(pow_dbl(e,6),this.unsigned),g=this,_="";;){var j=g.div(d),$=(g.sub(j.mul(d)).toInt()>>>0).toString(e);if((g=j).isZero())return $+_;for(;$.length<6;)$="0"+$;_=""+$+_}},LongPrototype.getHighBits=function(){return this.high},LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0},LongPrototype.getLowBits=function(){return this.low},LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0},LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,o=31;o>0&&!(e&1<<o);o--);return this.high!=0?o+33:o+1},LongPrototype.isZero=function(){return this.high===0&&this.low===0},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function(){return this.unsigned||this.high>=0},LongPrototype.isOdd=function(){return!(1&~this.low)},LongPrototype.isEven=function(){return!(1&this.low)},LongPrototype.equals=function(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function(e){return!this.eq(e)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function(e){return this.comp(e)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function(e){return this.comp(e)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function(e){return this.comp(e)>0},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function(e){return this.comp(e)>=0},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var o=this.isNegative(),s=e.isNegative();return o&&!s?-1:!o&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function(e){isLong(e)||(e=fromValue(e));var o=this.high>>>16,s=65535&this.high,h=this.low>>>16,d=65535&this.low,g=e.high>>>16,_=65535&e.high,j=e.low>>>16,$=0,_t=0,_e=0,_r=0;return _e+=(_r+=d+(65535&e.low))>>>16,_t+=(_e+=h+j)>>>16,$+=(_t+=s+_)>>>16,$+=o+g,fromBits((_e&=65535)<<16|(_r&=65535),($&=65535)<<16|(_t&=65535),this.unsigned)},LongPrototype.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function(e){if(this.isZero())return ZERO;if(isLong(e)||(e=fromValue(e)),wasm)return fromBits(wasm.mul(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned);if(e.isZero())return ZERO;if(this.eq(MIN_VALUE))return e.isOdd()?MIN_VALUE:ZERO;if(e.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TWO_PWR_24)&&e.lt(TWO_PWR_24))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var o=this.high>>>16,s=65535&this.high,h=this.low>>>16,d=65535&this.low,g=e.high>>>16,_=65535&e.high,j=e.low>>>16,$=65535&e.low,_t=0,_e=0,_r=0,_i=0;return _r+=(_i+=d*$)>>>16,_e+=(_r+=h*$)>>>16,_r&=65535,_e+=(_r+=d*j)>>>16,_t+=(_e+=s*$)>>>16,_e&=65535,_t+=(_e+=h*j)>>>16,_e&=65535,_t+=(_e+=d*_)>>>16,_t+=o*$+s*j+h*_+d*g,fromBits((_r&=65535)<<16|(_i&=65535),(_t&=65535)<<16|(_e&=65535),this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");var o,s,h;if(wasm)return this.unsigned||this.high!==-2147483648||e.low!==-1||e.high!==-1?fromBits((this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?UZERO:ZERO;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return UZERO;if(e.gt(this.shru(1)))return UONE;h=UZERO}else{if(this.eq(MIN_VALUE))return e.eq(ONE)||e.eq(NEG_ONE)?MIN_VALUE:e.eq(MIN_VALUE)?ONE:(o=this.shr(1).div(e).shl(1)).eq(ZERO)?e.isNegative()?ONE:NEG_ONE:(s=this.sub(e.mul(o)),h=o.add(s.div(e)));if(e.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();h=ZERO}for(s=this;s.gte(e);){o=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var d=Math.ceil(Math.log(o)/Math.LN2),g=d<=48?1:pow_dbl(2,d-48),_=fromNumber(o),j=_.mul(e);j.isNegative()||j.gt(s);)j=(_=fromNumber(o-=g,this.unsigned)).mul(e);_.isZero()&&(_=ONE),h=h.add(_),s=s.sub(j)}return h},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function(e){return isLong(e)||(e=fromValue(e)),wasm?fromBits((this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},LongPrototype.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},LongPrototype.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},LongPrototype.shiftLeft=function(e){return isLong(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function(e){return isLong(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function(e){if(isLong(e)&&(e=e.toInt()),(e&=63)===0)return this;var o=this.high;return e<32?fromBits(this.low>>>e|o<<32-e,o>>>e,this.unsigned):fromBits(e===32?o:o>>>e-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function(){var e=this.high,o=this.low;return[255&o,o>>>8&255,o>>>16&255,o>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},LongPrototype.toBytesBE=function(){var e=this.high,o=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,o>>>24,o>>>16&255,o>>>8&255,255&o]},Long.fromBytes=function(e,o,s){return s?Long.fromBytesLE(e,o):Long.fromBytesBE(e,o)},Long.fromBytesLE=function(e,o){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,o)},Long.fromBytesBE=function(e,o){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],o)};var Long$1=getDefaultExportFromCjs(long),indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){return hasRequiredAspromise||(hasRequiredAspromise=1,aspromise=function(e,o){for(var s=new Array(arguments.length-1),h=0,d=2,g=!0;d<arguments.length;)s[h++]=arguments[d++];return new Promise(function(_,j){s[h]=function($){if(g)if(g=!1,$)j($);else{for(var _t=new Array(arguments.length-1),_e=0;_e<_t.length;)_t[_e++]=arguments[_e];_.apply(null,_t)}};try{e.apply(o||null,s)}catch($){g&&(g=!1,j($))}})}),aspromise}var base64$1={},hasRequiredBase64,eventemitter,hasRequiredEventemitter,float$1,hasRequiredFloat,inquire_1,hasRequiredInquire;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(e){var o=e;o.length=function(_){var j=_.length;if(!j)return 0;for(var $=0;--j%4>1&&_.charAt(j)==="=";)++$;return Math.ceil(3*_.length)/4-$};for(var s=new Array(64),h=new Array(123),d=0;d<64;)h[s[d]=d<26?d+65:d<52?d+71:d<62?d-4:d-59|43]=d++;o.encode=function(_,j,$){for(var _t,_e=null,_r=[],_i=0,_n=0;j<$;){var _s=_[j++];switch(_n){case 0:_r[_i++]=s[_s>>2],_t=(3&_s)<<4,_n=1;break;case 1:_r[_i++]=s[_t|_s>>4],_t=(15&_s)<<2,_n=2;break;case 2:_r[_i++]=s[_t|_s>>6],_r[_i++]=s[63&_s],_n=0}_i>8191&&((_e||(_e=[])).push(String.fromCharCode.apply(String,_r)),_i=0)}return _n&&(_r[_i++]=s[_t],_r[_i++]=61,_n===1&&(_r[_i++]=61)),_e?(_i&&_e.push(String.fromCharCode.apply(String,_r.slice(0,_i))),_e.join("")):String.fromCharCode.apply(String,_r.slice(0,_i))};var g="invalid encoding";o.decode=function(_,j,$){for(var _t,_e=$,_r=0,_i=0;_i<_.length;){var _n=_.charCodeAt(_i++);if(_n===61&&_r>1)break;if((_n=h[_n])===void 0)throw Error(g);switch(_r){case 0:_t=_n,_r=1;break;case 1:j[$++]=_t<<2|(48&_n)>>4,_t=_n,_r=2;break;case 2:j[$++]=(15&_t)<<4|(60&_n)>>2,_t=_n,_r=3;break;case 3:j[$++]=(3&_t)<<6|_n,_r=0}}if(_r===1)throw Error(g);return $-_e},o.test=function(_){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(_)}}(base64$1)),base64$1}function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;function e(){this._listeners={}}return hasRequiredEventemitter=1,eventemitter=e,e.prototype.on=function(o,s,h){return(this._listeners[o]||(this._listeners[o]=[])).push({fn:s,ctx:h||this}),this},e.prototype.off=function(o,s){if(o===void 0)this._listeners={};else if(s===void 0)this._listeners[o]=[];else for(var h=this._listeners[o],d=0;d<h.length;)h[d].fn===s?h.splice(d,1):++d;return this},e.prototype.emit=function(o){var s=this._listeners[o];if(s){for(var h=[],d=1;d<arguments.length;)h.push(arguments[d++]);for(d=0;d<s.length;)s[d].fn.apply(s[d++].ctx,h)}return this},eventemitter}function requireFloat(){if(hasRequiredFloat)return float$1;function e(g){return typeof Float32Array<"u"?function(){var _=new Float32Array([-0]),j=new Uint8Array(_.buffer),$=j[3]===128;function _t(_n,_s,_l){_[0]=_n,_s[_l]=j[0],_s[_l+1]=j[1],_s[_l+2]=j[2],_s[_l+3]=j[3]}function _e(_n,_s,_l){_[0]=_n,_s[_l]=j[3],_s[_l+1]=j[2],_s[_l+2]=j[1],_s[_l+3]=j[0]}function _r(_n,_s){return j[0]=_n[_s],j[1]=_n[_s+1],j[2]=_n[_s+2],j[3]=_n[_s+3],_[0]}function _i(_n,_s){return j[3]=_n[_s],j[2]=_n[_s+1],j[1]=_n[_s+2],j[0]=_n[_s+3],_[0]}g.writeFloatLE=$?_t:_e,g.writeFloatBE=$?_e:_t,g.readFloatLE=$?_r:_i,g.readFloatBE=$?_i:_r}():function(){function _($,_t,_e,_r){var _i=_t<0?1:0;if(_i&&(_t=-_t),_t===0)$(1/_t>0?0:2147483648,_e,_r);else if(isNaN(_t))$(2143289344,_e,_r);else if(_t>34028234663852886e22)$((_i<<31|2139095040)>>>0,_e,_r);else if(_t<11754943508222875e-54)$((_i<<31|Math.round(_t/1401298464324817e-60))>>>0,_e,_r);else{var _n=Math.floor(Math.log(_t)/Math.LN2);$((_i<<31|_n+127<<23|8388607&Math.round(_t*Math.pow(2,-_n)*8388608))>>>0,_e,_r)}}function j($,_t,_e){var _r=$(_t,_e),_i=2*(_r>>31)+1,_n=_r>>>23&255,_s=8388607&_r;return _n===255?_s?NaN:_i*(1/0):_n===0?1401298464324817e-60*_i*_s:_i*Math.pow(2,_n-150)*(_s+8388608)}g.writeFloatLE=_.bind(null,o),g.writeFloatBE=_.bind(null,s),g.readFloatLE=j.bind(null,h),g.readFloatBE=j.bind(null,d)}(),typeof Float64Array<"u"?function(){var _=new Float64Array([-0]),j=new Uint8Array(_.buffer),$=j[7]===128;function _t(_n,_s,_l){_[0]=_n,_s[_l]=j[0],_s[_l+1]=j[1],_s[_l+2]=j[2],_s[_l+3]=j[3],_s[_l+4]=j[4],_s[_l+5]=j[5],_s[_l+6]=j[6],_s[_l+7]=j[7]}function _e(_n,_s,_l){_[0]=_n,_s[_l]=j[7],_s[_l+1]=j[6],_s[_l+2]=j[5],_s[_l+3]=j[4],_s[_l+4]=j[3],_s[_l+5]=j[2],_s[_l+6]=j[1],_s[_l+7]=j[0]}function _r(_n,_s){return j[0]=_n[_s],j[1]=_n[_s+1],j[2]=_n[_s+2],j[3]=_n[_s+3],j[4]=_n[_s+4],j[5]=_n[_s+5],j[6]=_n[_s+6],j[7]=_n[_s+7],_[0]}function _i(_n,_s){return j[7]=_n[_s],j[6]=_n[_s+1],j[5]=_n[_s+2],j[4]=_n[_s+3],j[3]=_n[_s+4],j[2]=_n[_s+5],j[1]=_n[_s+6],j[0]=_n[_s+7],_[0]}g.writeDoubleLE=$?_t:_e,g.writeDoubleBE=$?_e:_t,g.readDoubleLE=$?_r:_i,g.readDoubleBE=$?_i:_r}():function(){function _($,_t,_e,_r,_i,_n){var _s=_r<0?1:0;if(_s&&(_r=-_r),_r===0)$(0,_i,_n+_t),$(1/_r>0?0:2147483648,_i,_n+_e);else if(isNaN(_r))$(0,_i,_n+_t),$(2146959360,_i,_n+_e);else if(_r>17976931348623157e292)$(0,_i,_n+_t),$((_s<<31|2146435072)>>>0,_i,_n+_e);else{var _l;if(_r<22250738585072014e-324)$((_l=_r/5e-324)>>>0,_i,_n+_t),$((_s<<31|_l/4294967296)>>>0,_i,_n+_e);else{var Ap=Math.floor(Math.log(_r)/Math.LN2);Ap===1024&&(Ap=1023),$(4503599627370496*(_l=_r*Math.pow(2,-Ap))>>>0,_i,_n+_t),$((_s<<31|Ap+1023<<20|1048576*_l&1048575)>>>0,_i,_n+_e)}}}function j($,_t,_e,_r,_i){var _n=$(_r,_i+_t),_s=$(_r,_i+_e),_l=2*(_s>>31)+1,Ap=_s>>>20&2047,_h=4294967296*(1048575&_s)+_n;return Ap===2047?_h?NaN:_l*(1/0):Ap===0?5e-324*_l*_h:_l*Math.pow(2,Ap-1075)*(_h+4503599627370496)}g.writeDoubleLE=_.bind(null,o,0,4),g.writeDoubleBE=_.bind(null,s,4,0),g.readDoubleLE=j.bind(null,h,0,4),g.readDoubleBE=j.bind(null,d,4,0)}(),g}function o(g,_,j){_[j]=255&g,_[j+1]=g>>>8&255,_[j+2]=g>>>16&255,_[j+3]=g>>>24}function s(g,_,j){_[j]=g>>>24,_[j+1]=g>>>16&255,_[j+2]=g>>>8&255,_[j+3]=255&g}function h(g,_){return(g[_]|g[_+1]<<8|g[_+2]<<16|g[_+3]<<24)>>>0}function d(g,_){return(g[_]<<24|g[_+1]<<16|g[_+2]<<8|g[_+3])>>>0}return hasRequiredFloat=1,float$1=e(e)}function requireInquire(){if(hasRequiredInquire)return inquire_1;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}return hasRequiredInquire=1,inquire_1=inquire,inquire_1}var utf8$2={},hasRequiredUtf8,pool_1,hasRequiredPool,longbits,hasRequiredLongbits,hasRequiredMinimal;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(e){var o=e;o.length=function(s){for(var h=0,d=0,g=0;g<s.length;++g)(d=s.charCodeAt(g))<128?h+=1:d<2048?h+=2:(64512&d)==55296&&(64512&s.charCodeAt(g+1))==56320?(++g,h+=4):h+=3;return h},o.read=function(s,h,d){if(d-h<1)return"";for(var g,_=null,j=[],$=0;h<d;)(g=s[h++])<128?j[$++]=g:g>191&&g<224?j[$++]=(31&g)<<6|63&s[h++]:g>239&&g<365?(g=((7&g)<<18|(63&s[h++])<<12|(63&s[h++])<<6|63&s[h++])-65536,j[$++]=55296+(g>>10),j[$++]=56320+(1023&g)):j[$++]=(15&g)<<12|(63&s[h++])<<6|63&s[h++],$>8191&&((_||(_=[])).push(String.fromCharCode.apply(String,j)),$=0);return _?($&&_.push(String.fromCharCode.apply(String,j.slice(0,$))),_.join("")):String.fromCharCode.apply(String,j.slice(0,$))},o.write=function(s,h,d){for(var g,_,j=d,$=0;$<s.length;++$)(g=s.charCodeAt($))<128?h[d++]=g:g<2048?(h[d++]=g>>6|192,h[d++]=63&g|128):(64512&g)==55296&&(64512&(_=s.charCodeAt($+1)))==56320?(g=65536+((1023&g)<<10)+(1023&_),++$,h[d++]=g>>18|240,h[d++]=g>>12&63|128,h[d++]=g>>6&63|128,h[d++]=63&g|128):(h[d++]=g>>12|224,h[d++]=g>>6&63|128,h[d++]=63&g|128);return d-j}}(utf8$2)),utf8$2}function requirePool(){return hasRequiredPool||(hasRequiredPool=1,pool_1=function(e,o,s){var h=s||8192,d=h>>>1,g=null,_=h;return function(j){if(j<1||j>d)return e(j);_+j>h&&(g=e(h),_=0);var $=o.call(g,_,_+=j);return 7&_&&(_=1+(7|_)),$}}),pool_1}function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=o;var e=requireMinimal();function o(g,_){this.lo=g>>>0,this.hi=_>>>0}var s=o.zero=new o(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var h=o.zeroHash="\0\0\0\0\0\0\0\0";o.fromNumber=function(g){if(g===0)return s;var _=g<0;_&&(g=-g);var j=g>>>0,$=(g-j)/4294967296>>>0;return _&&($=~$>>>0,j=~j>>>0,++j>4294967295&&(j=0,++$>4294967295&&($=0))),new o(j,$)},o.from=function(g){if(typeof g=="number")return o.fromNumber(g);if(e.isString(g)){if(!e.Long)return o.fromNumber(parseInt(g,10));g=e.Long.fromString(g)}return g.low||g.high?new o(g.low>>>0,g.high>>>0):s},o.prototype.toNumber=function(g){if(!g&&this.hi>>>31){var _=1+~this.lo>>>0,j=~this.hi>>>0;return _||(j=j+1>>>0),-(_+4294967296*j)}return this.lo+4294967296*this.hi},o.prototype.toLong=function(g){return e.Long?new e.Long(0|this.lo,0|this.hi,!!g):{low:0|this.lo,high:0|this.hi,unsigned:!!g}};var d=String.prototype.charCodeAt;return o.fromHash=function(g){return g===h?s:new o((d.call(g,0)|d.call(g,1)<<8|d.call(g,2)<<16|d.call(g,3)<<24)>>>0,(d.call(g,4)|d.call(g,5)<<8|d.call(g,6)<<16|d.call(g,7)<<24)>>>0)},o.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},o.prototype.zzEncode=function(){var g=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^g)>>>0,this.lo=(this.lo<<1^g)>>>0,this},o.prototype.zzDecode=function(){var g=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^g)>>>0,this.hi=(this.hi>>>1^g)>>>0,this},o.prototype.length=function(){var g=this.lo,_=(this.lo>>>28|this.hi<<4)>>>0,j=this.hi>>>24;return j===0?_===0?g<16384?g<128?1:2:g<2097152?3:4:_<16384?_<128?5:6:_<2097152?7:8:j<128?9:10},longbits}function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(e){var o=e;function s(d,g,_){for(var j=Object.keys(g),$=0;$<j.length;++$)d[j[$]]!==void 0&&_||(d[j[$]]=g[j[$]]);return d}function h(d){function g(_,j){if(!(this instanceof g))return new g(_,j);Object.defineProperty(this,"message",{get:function(){return _}}),Error.captureStackTrace?Error.captureStackTrace(this,g):Object.defineProperty(this,"stack",{value:new Error().stack||""}),j&&s(this,j)}return(g.prototype=Object.create(Error.prototype)).constructor=g,Object.defineProperty(g.prototype,"name",{get:function(){return d}}),g.prototype.toString=function(){return this.name+": "+this.message},g}o.asPromise=requireAspromise(),o.base64=requireBase64(),o.EventEmitter=requireEventemitter(),o.float=requireFloat(),o.inquire=requireInquire(),o.utf8=requireUtf8(),o.pool=requirePool(),o.LongBits=requireLongbits(),o.isNode=!!(commonjsGlobal!==void 0&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),o.global=o.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,o.emptyArray=Object.freeze?Object.freeze([]):[],o.emptyObject=Object.freeze?Object.freeze({}):{},o.isInteger=Number.isInteger||function(d){return typeof d=="number"&&isFinite(d)&&Math.floor(d)===d},o.isString=function(d){return typeof d=="string"||d instanceof String},o.isObject=function(d){return d&&typeof d=="object"},o.isset=o.isSet=function(d,g){var _=d[g];return!(_==null||!d.hasOwnProperty(g))&&(typeof _!="object"||(Array.isArray(_)?_.length:Object.keys(_).length)>0)},o.Buffer=function(){try{var d=o.inquire("buffer").Buffer;return d.prototype.utf8Write?d:null}catch{return null}}(),o._Buffer_from=null,o._Buffer_allocUnsafe=null,o.newBuffer=function(d){return typeof d=="number"?o.Buffer?o._Buffer_allocUnsafe(d):new o.Array(d):o.Buffer?o._Buffer_from(d):typeof Uint8Array>"u"?d:new Uint8Array(d)},o.Array=typeof Uint8Array<"u"?Uint8Array:Array,o.Long=o.global.dcodeIO&&o.global.dcodeIO.Long||o.global.Long||o.inquire("long"),o.key2Re=/^true|false|0|1$/,o.key32Re=/^-?(?:0|[1-9][0-9]*)$/,o.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,o.longToHash=function(d){return d?o.LongBits.from(d).toHash():o.LongBits.zeroHash},o.longFromHash=function(d,g){var _=o.LongBits.fromHash(d);return o.Long?o.Long.fromBits(_.lo,_.hi,g):_.toNumber(!!g)},o.merge=s,o.lcFirst=function(d){return d.charAt(0).toLowerCase()+d.substring(1)},o.newError=h,o.ProtocolError=h("ProtocolError"),o.oneOfGetter=function(d){for(var g={},_=0;_<d.length;++_)g[d[_]]=1;return function(){for(var j=Object.keys(this),$=j.length-1;$>-1;--$)if(g[j[$]]===1&&this[j[$]]!==void 0&&this[j[$]]!==null)return j[$]}},o.oneOfSetter=function(d){return function(g){for(var _=0;_<d.length;++_)d[_]!==g&&delete this[d[_]]}},o.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},o._configure=function(){var d=o.Buffer;d?(o._Buffer_from=d.from!==Uint8Array.from&&d.from||function(g,_){return new d(g,_)},o._Buffer_allocUnsafe=d.allocUnsafe||function(g){return new d(g)}):o._Buffer_from=o._Buffer_allocUnsafe=null}}(minimal$1)),minimal$1}var writer=Writer$1,util$4=requireMinimal(),BufferWriter$1,LongBits$1=util$4.LongBits,base64=util$4.base64,utf8$1=util$4.utf8;function Op(e,o,s){this.fn=e,this.len=o,this.next=void 0,this.val=s}function noop(){}function State$2(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer$1(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create$1=function(){return util$4.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};function writeByte(e,o,s){o[s]=255&e}function writeVarint32(e,o,s){for(;e>127;)o[s++]=127&e|128,e>>>=7;o[s]=e}function VarintOp(e,o){this.len=e,this.next=void 0,this.val=o}function writeVarint64(e,o,s){for(;e.hi;)o[s++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)o[s++]=127&e.lo|128,e.lo=e.lo>>>7;o[s++]=e.lo}function writeFixed32(e,o,s){o[s]=255&e,o[s+1]=e>>>8&255,o[s+2]=e>>>16&255,o[s+3]=e>>>24}Writer$1.create=create$1(),Writer$1.alloc=function(e){return new util$4.Array(e)},util$4.Array!==Array&&(Writer$1.alloc=util$4.pool(Writer$1.alloc,util$4.Array.prototype.subarray)),Writer$1.prototype._push=function(e,o,s){return this.tail=this.tail.next=new Op(e,o,s),this.len+=o,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer$1.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer$1.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer$1.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer$1.prototype.uint64=function(e){var o=LongBits$1.from(e);return this._push(writeVarint64,o.length(),o)},Writer$1.prototype.int64=Writer$1.prototype.uint64,Writer$1.prototype.sint64=function(e){var o=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,o.length(),o)},Writer$1.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer$1.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32,Writer$1.prototype.fixed64=function(e){var o=LongBits$1.from(e);return this._push(writeFixed32,4,o.lo)._push(writeFixed32,4,o.hi)},Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64,Writer$1.prototype.float=function(e){return this._push(util$4.float.writeFloatLE,4,e)},Writer$1.prototype.double=function(e){return this._push(util$4.float.writeDoubleLE,8,e)};var writeBytes=util$4.Array.prototype.set?function(e,o,s){o.set(e,s)}:function(e,o,s){for(var h=0;h<e.length;++h)o[s+h]=e[h]};Writer$1.prototype.bytes=function(e){var o=e.length>>>0;if(!o)return this._push(writeByte,1,0);if(util$4.isString(e)){var s=Writer$1.alloc(o=base64.length(e));base64.decode(e,s,0),e=s}return this.uint32(o)._push(writeBytes,o,e)},Writer$1.prototype.string=function(e){var o=utf8$1.length(e);return o?this.uint32(o)._push(utf8$1.write,o,e):this._push(writeByte,1,0)},Writer$1.prototype.fork=function(){return this.states=new State$2(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer$1.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer$1.prototype.ldelim=function(){var e=this.head,o=this.tail,s=this.len;return this.reset().uint32(s),s&&(this.tail.next=e.next,this.tail=o,this.len+=s),this},Writer$1.prototype.finish=function(){for(var e=this.head.next,o=this.constructor.alloc(this.len),s=0;e;)e.fn(e.val,o,s),s+=e.len,e=e.next;return o},Writer$1._configure=function(e){BufferWriter$1=e,Writer$1.create=create$1(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$3=requireMinimal();function BufferWriter(){Writer.call(this)}function writeStringBuffer(e,o,s){e.length<40?util$3.utf8.write(e,o,s):o.utf8Write?o.utf8Write(e,s):o.write(e,s)}BufferWriter._configure=function(){BufferWriter.alloc=util$3._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$3.Buffer&&util$3.Buffer.prototype instanceof Uint8Array&&util$3.Buffer.prototype.set.name==="set"?function(e,o,s){o.set(e,s)}:function(e,o,s){if(e.copy)e.copy(o,s,0,e.length);else for(var h=0;h<e.length;)o[s++]=e[h++]}},BufferWriter.prototype.bytes=function(e){util$3.isString(e)&&(e=util$3._Buffer_from(e,"base64"));var o=e.length>>>0;return this.uint32(o),o&&this._push(BufferWriter.writeBytesBuffer,o,e),this},BufferWriter.prototype.string=function(e){var o=util$3.Buffer.byteLength(e);return this.uint32(o),o&&this._push(writeStringBuffer,o,e),this},BufferWriter._configure();var reader=Reader$1,util$2=requireMinimal(),BufferReader$1,LongBits=util$2.LongBits,utf8=util$2.utf8;function indexOutOfRange(e,o){return RangeError("index out of range: "+e.pos+" + "+(o||1)+" > "+e.len)}function Reader$1(e){this.buf=e,this.pos=0,this.len=e.length}var create_array=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader$1(e);throw Error("illegal buffer")},create=function(){return util$2.Buffer?function(e){return(Reader$1.create=function(o){return util$2.Buffer.isBuffer(o)?new BufferReader$1(o):create_array(o)})(e)}:create_array},value;function readLongVarint(){var e=new LongBits(0,0),o=0;if(!(this.len-this.pos>4)){for(;o<3;++o){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*o)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*o)>>>0,e}for(;o<4;++o)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*o)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(o=0,this.len-this.pos>4){for(;o<5;++o)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*o+3)>>>0,this.buf[this.pos++]<128)return e}else for(;o<5;++o){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*o+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,o){return(e[o-4]|e[o-3]<<8|e[o-2]<<16|e[o-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.create=create(),Reader$1.prototype._slice=util$2.Array.prototype.subarray||util$2.Array.prototype.slice,Reader$1.prototype.uint32=(value=4294967295,function(){if(value=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(value=(value|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(value=(value|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(value=(value|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(value=(value|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return value;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return value}),Reader$1.prototype.int32=function(){return 0|this.uint32()},Reader$1.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},Reader$1.prototype.bool=function(){return this.uint32()!==0},Reader$1.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=util$2.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader$1.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=util$2.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader$1.prototype.bytes=function(){var e=this.uint32(),o=this.pos,s=this.pos+e;if(s>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(o,s):o===s?new this.buf.constructor(0):this._slice.call(this.buf,o,s)},Reader$1.prototype.string=function(){var e=this.bytes();return utf8.read(e,0,e.length)},Reader$1.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(128&this.buf[this.pos++]);return this},Reader$1.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=7&this.uint32())!=4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader$1._configure=function(e){BufferReader$1=e,Reader$1.create=create(),BufferReader$1._configure();var o=util$2.Long?"toLong":"toNumber";util$2.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[o](!1)},uint64:function(){return readLongVarint.call(this)[o](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[o](!1)},fixed64:function(){return readFixed64.call(this)[o](!0)},sfixed64:function(){return readFixed64.call(this)[o](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$1=requireMinimal();function BufferReader(e){Reader.call(this,e)}BufferReader._configure=function(){util$1.Buffer&&(BufferReader.prototype._slice=util$1.Buffer.prototype.slice)},BufferReader.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader._configure();var rpc={},service=Service,util=requireMinimal(),exports;function Service(e,o,s){if(typeof e!="function")throw TypeError("rpcImpl must be a function");util.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!o,this.responseDelimited=!!s}(Service.prototype=Object.create(util.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(o,s,h,d,g){if(!d)throw TypeError("request must be specified");var _=this;if(!g)return util.asPromise(e,_,o,s,h,d);if(_.rpcImpl)try{return _.rpcImpl(o,s[_.requestDelimited?"encodeDelimited":"encode"](d).finish(),function(j,$){if(j)return _.emit("error",j,o),g(j);if($!==null){if(!($ instanceof h))try{$=h[_.responseDelimited?"decodeDelimited":"decode"]($)}catch(_t){return _.emit("error",_t,o),g(_t)}return _.emit("data",$,o),g(null,$)}_.end(!0)})}catch(j){return _.emit("error",j,o),void setTimeout(function(){g(j)},0)}else setTimeout(function(){g(Error("already ended"))},0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},exports=rpc,exports.Service=service;var roots={};(function(e){var o=e;function s(){o.util._configure(),o.Writer._configure(o.BufferWriter),o.Reader._configure(o.BufferReader)}o.build="minimal",o.Writer=writer,o.BufferWriter=writer_buffer,o.Reader=reader,o.BufferReader=reader_buffer,o.util=requireMinimal(),o.rpc=rpc,o.roots=roots,o.configure=s,s()})(indexMinimal);var minimal=indexMinimal,protobuf=getDefaultExportFromCjs(minimal);protobuf.util.Long=Long$1,protobuf.configure(),VectorTileFeature.prototype.loadGeometry=function(e){var o=this._pbf;o.pos=this._geometry;for(var s,h=o.readVarint()+o.pos,d=1,g=0,_=0,j=0,$=[];o.pos<h;){if(g<=0){var _t=o.readVarint();d=7&_t,g=_t>>3}if(g--,d===1||d===2)_+=o.readSVarint(),j+=o.readSVarint(),d===1&&(s&&$.push(s),s=[]),s.push([_*e,j*e]);else{if(d!==7)throw new Error("unknown command "+d);s&&s.push(s[0].slice())}}return s&&$.push(s),$};var MAX_SAFE_INTEGER=Long$1.fromNumber(Number.MAX_SAFE_INTEGER,!0),MIN_SAFE_INTEGER=Long$1.fromNumber(Number.MIN_SAFE_INTEGER,!1);function readLong(e,o,s){o.pos=e.pos;var h=s.call(o);return e.pos=o.pos,Long$1.isLong(h)?h.comp(MAX_SAFE_INTEGER)>0||h.comp(MIN_SAFE_INTEGER)<0?h.toString():h.toNumber():h}var VectorTileLayer=function(){return _createClass(function e(o,s){_classCallCheck(this,e),this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],this._protobufjsReader=protobuf.Reader.create(o.buf),o.readFields(readLayer,this,s),this.length=this._features.length},[{key:"feature",value:function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var o=this._pbf.readVarint()+this._pbf.pos;return new VectorTileFeature(this._pbf,o,this.extent,this._keys,this._values)}}])}();function readLayer(e,o,s){e===15?o.version=s.readVarint():e===1?o.name=s.readString():e===5?o.extent=s.readVarint():e===2?o._features.push(s.pos):e===3?o._keys.push(s.readString()):e===4&&o._values.push(readValueMessage(s,o._protobufjsReader))}function readValueMessage(e,o){for(var s=null,h=e.readVarint()+e.pos;e.pos<h;){var d=e.readVarint()>>3;s=d===1?e.readString():d===2?e.readFloat():d===3?e.readDouble():d===4?readLong(e,o,o.int64):d===5?readLong(e,o,o.uint64):d===6?readLong(e,o,o.sint64):d===7?e.readBoolean():null}return s}var VectorTile=_createClass(function e(o,s){_classCallCheck(this,e),this.layers=o.readFields(readTile,{},s)});function readTile(e,o,s){if(e===3){var h=new VectorTileLayer(s,s.readVarint()+s.pos);h.length&&(o[h.name]=h)}}function getLayersFromMVT(e){var o={};for(var s in e.layers){for(var h=e.layers[s],d=[],g=Geo$1.tile_scale/h.extent,_=0,j=h.length;_<j;_++){var $,_t=h.feature(_),_e=VectorTileFeature.types[_t.type];$=_t.loadGeometry(g);var _r=null;switch(_e){case"Point":_r=decodePoint({coordinates:$});break;case"LineString":_r=$.length===1?{type:_e,coordinates:$[0]}:{type:"MultiLineString",coordinates:$};break;case"Polygon":_r=decodeMultiPolygon({coordinates:$})}_r&&_r.coordinates&&d.push({type:"Feature",geometry:_r,properties:_t.properties})}o[s]={type:"FeatureCollection",features:d}}return o}var GeomType={UNKNOWN:0,POINT:1,LINESTRING:2,POLYGON:3};function parseGeoJSONVectorTile(e){var o=[],s=e&&e.features;if(s)for(var h=0,d=s.length;h<d;h++){var g=s[h],_=g.type,j=void 0;switch(_){case GeomType.POINT:j={type:"MultiPoint",coordinates:g.geometry.map(function($){return $.slice()})};break;case GeomType.LINESTRING:case GeomType.POLYGON:if(j={type:"MultiLineString",coordinates:g.geometry.map(function($){return $.map(function(_t){return _t.slice()})})},_===GeomType.POLYGON&&(j=decodeMultiPolygon(j))==null)continue;break;default:continue}o.push({id:g.id,type:"Feature",geometry:j,properties:g.tags})}return{type:"FeatureCollection",features:o}}function decodeMultiPolygon(e){for(var o,s=[],h=[],d=0,g=e.coordinates.length;d<g;d++){var _=e.coordinates[d],j=Geo$1.ringWinding(_);j!=null&&(j===(o=o||j)&&h.length&&(s.push(h),h=[]),h.push(_))}return h.length>0&&s.push(h),s.length===1?(e.type="Polygon",e.coordinates=s[0]):s.length>1?(e.type="MultiPolygon",e.coordinates=s):e=null,e}function decodePoint(e){var o=e.coordinates.length;if(o>1){e.type="MultiPoint";for(var s=[],h=0;h<o;h++)s.push(e.coordinates[h][0]);e.coordinates=s}else e.type="Point",e.coordinates=e.coordinates[0][0];return e}var EMPTY_FEATURE_COLLECTION$1={type:"FeatureCollection",features:[]},MVTSource=function(e){function o(s,h){return _classCallCheck(this,o),s.tiled=!0,_callSuper(this,o,[s,h])}return _inherits(o,e),_createClass(o,[{key:"fetchTile",value:function(s,h,d){return this.provider?this.provider.requestTileAsPromise(s,h,d).then(function(g){return g.data}):Promise.resolve()}},{key:"_load",value:function(s){var h=this,d=Geo$1.wrapTile(s.coords,{x:!0,y:!0}),g=d.x,_=d.y,j=d.z;return WorkerBroker.postMessage(this.target_name+".fetchTile",g,_,j).then(function($){if($ instanceof ArrayBuffer){var _t=new Pbf$1(new Uint8Array($));s.source_data.layers=getLayersFromMVT(new VectorTile(_t))}else $?s.source_data.error=$:s.source_data.layers={_default:EMPTY_FEATURE_COLLECTION$1};return h._postProcessTile(s),s})}},{key:"onReady",value:function(){this.dispatchUpdate()}}])}(MapsJsSource);DataSource.register(MVTSource,"MVT"),DataSource.register(MVTSource,"OMV");var csscolorparser={},parseCSSColor_1,kCSSColorTable={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function clamp_css_byte(e){return(e=Math.round(e))<0?0:e>255?255:e}function clamp_css_float(e){return e<0?0:e>1?1:e}function parse_css_int(e){return e[e.length-1]==="%"?clamp_css_byte(parseFloat(e)/100*255):clamp_css_byte(parseInt(e))}function parse_css_float(e){return e[e.length-1]==="%"?clamp_css_float(parseFloat(e)/100):clamp_css_float(parseFloat(e))}function css_hue_to_rgb(e,o,s){return s<0?s+=1:s>1&&(s-=1),6*s<1?e+(o-e)*s*6:2*s<1?o:3*s<2?e+(o-e)*(.6666666666666666-s)*6:e}function parseCSSColor(e){var o,s=e.replace(/ /g,"").toLowerCase();if(s in kCSSColorTable)return kCSSColorTable[s].slice();if(s[0]==="#")return s.length===4?(o=parseInt(s.substr(1),16))>=0&&o<=4095?[(3840&o)>>4|(3840&o)>>8,240&o|(240&o)>>4,15&o|(15&o)<<4,1]:null:s.length===7&&(o=parseInt(s.substr(1),16))>=0&&o<=16777215?[(16711680&o)>>16,(65280&o)>>8,255&o,1]:null;var h=s.indexOf("("),d=s.indexOf(")");if(h!==-1&&d+1===s.length){var g=s.substr(0,h),_=s.substr(h+1,d-(h+1)).split(","),j=1;switch(g){case"rgba":if(_.length!==4)return null;j=parse_css_float(_.pop());case"rgb":return _.length!==3?null:[parse_css_int(_[0]),parse_css_int(_[1]),parse_css_int(_[2]),j];case"hsla":if(_.length!==4)return null;j=parse_css_float(_.pop());case"hsl":if(_.length!==3)return null;var $=(parseFloat(_[0])%360+360)%360/360,_t=parse_css_float(_[1]),_e=parse_css_float(_[2]),_r=_e<=.5?_e*(_t+1):_e+_t-_e*_t,_i=2*_e-_r;return[clamp_css_byte(255*css_hue_to_rgb(_i,_r,$+.3333333333333333)),clamp_css_byte(255*css_hue_to_rgb(_i,_r,$)),clamp_css_byte(255*css_hue_to_rgb(_i,_r,$-.3333333333333333)),j];default:return null}}return null}try{parseCSSColor_1=csscolorparser.parseCSSColor=parseCSSColor}catch(e){}var StyleParser={},clampPositive=function(e){return Math.max(e,0)},noNaN=function(e){return isNaN(e)?0:e},parseNumber=function(e){return Array.isArray(e)?e.map(parseFloat).map(noNaN):noNaN(parseFloat(e))},parsePositiveNumber=function(e){return Array.isArray(e)?e.map(parseNumber).map(clampPositive):clampPositive(parseNumber(e))};Object.assign(StyleParser,{clampPositive,noNaN,parseNumber,parsePositiveNumber}),StyleParser.wrapFunction=function(e){return`
        var feature = context.feature.properties;
        var global = context.global;
        var $zoom = context.zoom;
        var $layer = context.layer;
        var $source = context.source;
        var sources = context.sources;
        var $geometry = context.geometry;
        var $meters_per_pixel = context.meters_per_pixel;

        var val = (function(){ `.concat(e,` }());

        if (typeof val === 'number' && isNaN(val)) {
            val = null; // convert NaNs to nulls
        }

        return val;
    `)},StyleParser.zeroPair=Object.freeze([0,0]),StyleParser.defaults={color:[1,1,1,1],width:1,size:1,extrude:!1,height:20,min_height:0,order:0,z:0,outline:{color:[0,0,0,0],width:0},material:{ambient:1,diffuse:1}},StyleParser.macros={"Style.color.pseudoRandomColor":function(){return[parseInt(feature.id,16)/100%1*.7,parseInt(feature.id,16)/1e4%1*.7,parseInt(feature.id,16)/1e6%1*.7,1]},"Style.color.randomColor":function(){return[.7*Math.random(),.7*Math.random(),.7*Math.random(),1]}},StyleParser.getFeatureParseContext=function(e,o,s,h){return{feature:e,tile:o,global:s,sources:h,zoom:o.style_zoom,geometry:Geo$1.geometryType(e.geometry.type),meters_per_pixel:o.meters_per_pixel,meters_per_pixel_sq:o.meters_per_pixel_sq,units_per_meter_overzoom:o.units_per_meter_overzoom}};var CACHE_TYPE={STATIC:0,DYNAMIC:1,ZOOM:2};StyleParser.CACHE_TYPE=CACHE_TYPE,StyleParser.createPropertyCache=function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(e!=null){if(e.value)return{value:e.value,zoom:e.zoom?{}:null,type:e.type};var s={value:e,type:CACHE_TYPE.STATIC};return Array.isArray(s.value)&&Array.isArray(s.value[0])?(s.zoom={},s.type=CACHE_TYPE.ZOOM):typeof s.value=="function"&&(s.type=CACHE_TYPE.DYNAMIC),typeof o=="function"&&(s.zoom?s.value=s.value.map(function(h,d){return[h[0],o(h[1],d)]}):typeof s.value!="function"&&(s.value=o(s.value,0))),s}},StyleParser.createColorPropertyCache=function(e){return StyleParser.createPropertyCache(e,function(o){return o==="Style.color.pseudoRandomColor"?Utils$1.stringToFunction(StyleParser.wrapFunction(StyleParser.macros["Style.color.pseudoRandomColor"])):o==="Style.color.randomColor"?StyleParser.macros["Style.color.randomColor"]:o})};var isPercent=function(e){return typeof e=="string"&&e[e.length-1]==="%"},isRatio=function(e){return e==="auto"},isComputed=function(e){return isPercent(e)||isRatio(e)},dualRatioError="'size' can specify either width or height as derived from aspect ratio, but not both";StyleParser.createPointSizePropertyCache=function(e){var o=null,s=null;if(isPercent(e))o=[!0];else if(Array.isArray(e)){if(Array.isArray(e[0])){if(e.some(function(h){return Array.isArray(h[1])?h[1].some(function(d){return isComputed(d)}):isPercent(h[1])})&&(o=e.map(function(h){return Array.isArray(h[1])?h[1].map(function(d){return isPercent(d)}):isPercent(h[1])}),(s=e.map(function(h){return Array.isArray(h[1])&&h[1].map(function(d){return isRatio(d)})})).some(function(h){return Array.isArray(h)&&h.every(function(d){return d})})))throw dualRatioError}else if(e.some(isComputed)&&(o=[e.map(isPercent)],(s=[e.map(isRatio)])[0].every(function(h){return h})))throw dualRatioError}return o?((e={value:e}).has_pct=o,e.has_ratio=s,e.sprites={}):e=StyleParser.createPropertyCache(e,parsePositiveNumber),e},StyleParser.evalCachedPointSizeProperty=function(e,o,s){return e.has_pct||e.has_ratio?o?(e.sprites[o.sprite]||(e.sprites[o.sprite]=StyleParser.createPropertyCache(e.value,function(h,d){return Array.isArray(h)?(h=h.map(function(g,_){return e.has_ratio[d][_]?g:parsePositiveNumber(g)}).map(function(g,_){return e.has_pct[d][_]?o.css_size[_]*g/100:g}),e.has_ratio[d][0]?h[0]=h[1]*o.aspect:e.has_ratio[d][1]&&(h[1]=h[0]/o.aspect)):(h=parsePositiveNumber(h),h=e.has_pct[d]?o.css_size.map(function(g){return g*h/100}):[h,h]),h})),StyleParser.evalCachedProperty(e.sprites[o.sprite],s)):void 0:StyleParser.evalCachedProperty(e,s)},StyleParser.evalCachedProperty=function(e,o){if(e!=null)return e.dynamic?e.dynamic(o):e.static?e.static:e.zoom&&e.zoom[o.zoom]?e.zoom[o.zoom]:typeof e.value=="function"?(e.dynamic=e.value,e.dynamic(o)):Array.isArray(e.value)&&Array.isArray(e.value[0])?(e.zoom=e.zoom||{},e.zoom[o.zoom]=Utils$1.interpolate(o.zoom,e.value),e.zoom[o.zoom]):(e.static=e.value,e.static)},StyleParser.convertUnits=function(e,o){if(e.val!=null)return e.units==="px"?e.val*Geo$1.metersPerPixel(o.zoom):e.val;if(typeof e=="string")e.trim().slice(-2)==="px"?(e=parseNumber(e),e*=Geo$1.metersPerPixel(o.zoom)):e=parseNumber(e);else if(Array.isArray(e))return Array.isArray(e[0])?e.map(function(s){return[s[0],StyleParser.convertUnits(s[1],o)]}):e.map(function(s){return StyleParser.convertUnits(s,o)});return e},StyleParser.parseUnits=function(e){var o={val:parseNumber(e)};return o.val!==0&&typeof e=="string"&&e.trim().slice(-2)==="px"&&(o.units="px"),o},StyleParser.evalCachedDistanceProperty=function(e,o){return e.dynamic?e.dynamic(o):e.zoom&&e.zoom[o.zoom]?e.zoom[o.zoom]:typeof e.value=="function"?(e.dynamic=e.value,e.dynamic(o)):e.zoom?(e.zoom[o.zoom]=Utils$1.interpolate(o.zoom,e.value,function(s){return StyleParser.convertUnits(s,o)}),e.zoom[o.zoom]):StyleParser.convertUnits(e.value,o)},StyleParser.string_colors={},StyleParser.colorForString=function(e){if(StyleParser.string_colors[e])return StyleParser.string_colors[e];var o=null;return e!=="none"&&((o=csscolorparser.parseCSSColor(e))&&o.length===4?(o[0]/=255,o[1]/=255,o[2]/=255):o=StyleParser.defaults.color),StyleParser.string_colors[e]=o,o},StyleParser.evalCachedColorProperty=function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e.dynamic){var s=e.dynamic(o);return typeof s=="string"&&(s=StyleParser.colorForString(s)),s&&s[3]==null&&(s[3]=1),s}if(e.static)return e.static;if(e.zoom&&e.zoom[o.zoom])return e.zoom[o.zoom];if(typeof e.value=="function"){e.dynamic=e.value;var h=e.dynamic(o);return typeof h=="string"&&(h=StyleParser.colorForString(h)),h&&h[3]==null&&(h[3]=1),h}if(typeof e.value=="string")return e.static=StyleParser.colorForString(e.value),e.static;if(e.zoom){if(!e.zoom_preprocessed){for(var d=0;d<e.value.length;d++){var g=e.value[d];g&&typeof g[1]=="string"&&(g[1]=StyleParser.colorForString(g[1]))}e.zoom_preprocessed=!0}return e.zoom[o.zoom]=Utils$1.interpolate(o.zoom,e.value),e.zoom[o.zoom][3]=e.zoom[o.zoom][3]||1,e.zoom[o.zoom]}return e.static=e.value.map(function(_){return _}),e.static&&e.static[3]==null&&(e.static[3]=1),e.static},StyleParser.parseColor=function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(typeof e=="function"&&(e=e(o)),typeof e=="string")e=StyleParser.colorForString(e);else if(Array.isArray(e)&&Array.isArray(e[0])){for(var s=0;s<e.length;s++){var h=e[s];typeof h[1]=="string"&&(h[1]=StyleParser.colorForString(h[1]))}o.zoom&&(e=Utils$1.interpolate(o.zoom,e))}return Array.isArray(e)?(e=e.map(function(d){return d}))[3]==null&&(e[3]=1):e=[0,0,0,1],e},StyleParser.calculateOrder=function(e,o){return typeof e=="function"?e=e(o):typeof e=="string"&&(e=o.feature.properties[e]?o.feature.properties[e]:parsePositiveNumber(e)),e},StyleParser.evalProperty=function(e,o){return typeof e=="function"?e(o):e};var RepeatGroup=function(){function e(o,s){_classCallCheck(this,e),this.key=o,this.repeat_dist=s,this.repeat_dist_sq=this.repeat_dist*this.repeat_dist,this.positions=[]}return _createClass(e,[{key:"check",value:function(o){for(var s=o.position,h=0;h<this.positions.length;h++){var d=this.positions[h],g=s[0]-d[0],_=s[1]-d[1],j=g*g+_*_;if(j<this.repeat_dist_sq)return{dist_sq:j,repeat_dist_sq:this.repeat_dist_sq}}}},{key:"add",value:function(o){o&&o.position&&this.positions.push(o.position)}}],[{key:"clear",value:function(o){this.groups[o]={}}},{key:"check",value:function(o,s,h){if(s.repeat_distance&&s.repeat_group&&this.groups[h][s.repeat_group])return this.groups[h][s.repeat_group].check(o)}},{key:"add",value:function(o,s,h){s.repeat_distance&&s.repeat_group&&(this.groups[h][s.repeat_group]==null&&(this.groups[h][s.repeat_group]=new e(s.repeat_group,s.repeat_distance*s.repeat_scale)),this.groups[h][s.repeat_group].add(o))}}])}();RepeatGroup.groups={};var GridIndex=function(){return _createClass(function e(o,s,h){_classCallCheck(this,e);var d=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(o/h),this.yCellCount=Math.ceil(s/h);for(var _=0;_<this.xCellCount*this.yCellCount;_++)d.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=s,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0},[{key:"keysLength",value:function(){return this.boxKeys.length+this.circleKeys.length}},{key:"insert",value:function(e,o,s,h,d){this._forEachCell(o,s,h,d,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(o),this.bboxes.push(s),this.bboxes.push(h),this.bboxes.push(d)}},{key:"insertCircle",value:function(e,o,s,h){this._forEachCell(o-h,s-h,o+h,s+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(o),this.circles.push(s),this.circles.push(h)}},{key:"insertCircleList",value:function(e,o){for(var s=0;s<o.length-2;s+=3)this.insertCircle("".concat(e,"/").concat(s),o[s],o[s+1],o[s+2])}},{key:"_insertBoxCell",value:function(e,o,s,h,d,g){this.boxCells[d].push(g)}},{key:"_insertCircleCell",value:function(e,o,s,h,d,g){this.circleCells[d].push(g)}},{key:"_query",value:function(e,o,s,h,d,g){if(s<0||e>this.width||h<0||o>this.height)return!d&&[];var _=[];if(e<=0&&o<=0&&this.width<=s&&this.height<=h){if(d)return!0;for(var j=0;j<this.boxKeys.length;j++)_.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(var $=0;$<this.circleKeys.length;$++){var _t=this.circles[3*$],_e=this.circles[3*$+1],_r=this.circles[3*$+2];_.push({key:this.circleKeys[$],x1:_t-_r,y1:_e-_r,x2:_t+_r,y2:_e+_r})}return g?_.filter(g):_}var _i={hitTest:d,seenUids:{box:{},circle:{}}};return this._forEachCell(e,o,s,h,this._queryCell,_,_i,g),d?_.length>0:_}},{key:"_queryCircle",value:function(e,o,s,h,d){var g=e-s,_=e+s,j=o-s,$=o+s;if(_<0||g>this.width||$<0||j>this.height)return!h&&[];var _t=[],_e={hitTest:h,circle:{x:e,y:o,radius:s},seenUids:{box:{},circle:{}}};return this._forEachCell(g,j,_,$,this._queryCellCircle,_t,_e,d),h?_t.length>0:_t}},{key:"query",value:function(e,o,s,h,d){return this._query(e,o,s,h,!1,d)}},{key:"hitTest",value:function(e,o,s,h,d){return this._query(e,o,s,h,!0,d)}},{key:"hitTestCircle",value:function(e,o,s,h){return this._queryCircle(e,o,s,!0,h)}},{key:"hitTestCircleList",value:function(e,o){for(var s=0;s<e.length-2;s+=3)if(this.hitTestCircle(e[s],e[s+1],e[s+2],o))return!0;return!1}},{key:"_queryCell",value:function(e,o,s,h,d,g,_,j){var $=_.seenUids,_t=this.boxCells[d];if(_t!==null){var _e,_r=this.bboxes,_i=_createForOfIteratorHelper(_t);try{for(_i.s();!(_e=_i.n()).done;){var _n=_e.value;if(!$.box[_n]){$.box[_n]=!0;var _s=4*_n;if(e<=_r[_s+2]&&o<=_r[_s+3]&&s>=_r[_s+0]&&h>=_r[_s+1]&&(!j||j(this.boxKeys[_n]))){if(_.hitTest)return g.push(!0),!0;g.push({key:this.boxKeys[_n],x1:_r[_s],y1:_r[_s+1],x2:_r[_s+2],y2:_r[_s+3]})}}}}catch(fy){_i.e(fy)}finally{_i.f()}}var _l=this.circleCells[d];if(_l!==null){var Ap,_h=this.circles,_p=_createForOfIteratorHelper(_l);try{for(_p.s();!(Ap=_p.n()).done;){var ty=Ap.value;if(!$.circle[ty]){$.circle[ty]=!0;var ry=3*ty;if(this._circleAndRectCollide(_h[ry],_h[ry+1],_h[ry+2],e,o,s,h)&&(!j||j(this.circleKeys[ty]))){if(_.hitTest)return g.push(!0),!0;var ly=_h[ry],uy=_h[ry+1],py=_h[ry+2];g.push({key:this.circleKeys[ty],x1:ly-py,y1:uy-py,x2:ly+py,y2:uy+py})}}}}catch(fy){_p.e(fy)}finally{_p.f()}}}},{key:"_queryCellCircle",value:function(e,o,s,h,d,g,_,j){var $=_.circle,_t=_.seenUids,_e=this.boxCells[d];if(_e!==null){var _r,_i=this.bboxes,_n=_createForOfIteratorHelper(_e);try{for(_n.s();!(_r=_n.n()).done;){var _s=_r.value;if(!_t.box[_s]){_t.box[_s]=!0;var _l=4*_s;if(this._circleAndRectCollide($.x,$.y,$.radius,_i[_l+0],_i[_l+1],_i[_l+2],_i[_l+3])&&(!j||j(this.boxKeys[_s])))return g.push(!0),!0}}}catch(uy){_n.e(uy)}finally{_n.f()}}var Ap=this.circleCells[d];if(Ap!==null){var _h,_p=this.circles,ty=_createForOfIteratorHelper(Ap);try{for(ty.s();!(_h=ty.n()).done;){var ry=_h.value;if(!_t.circle[ry]){_t.circle[ry]=!0;var ly=3*ry;if(this._circlesCollide(_p[ly],_p[ly+1],_p[ly+2],$.x,$.y,$.radius)&&(!j||j(this.circleKeys[ry])))return g.push(!0),!0}}}catch(uy){ty.e(uy)}finally{ty.f()}}}},{key:"_forEachCell",value:function(e,o,s,h,d,g,_,j){for(var $=this._convertToXCellCoord(e),_t=this._convertToYCellCoord(o),_e=this._convertToXCellCoord(s),_r=this._convertToYCellCoord(h),_i=$;_i<=_e;_i++)for(var _n=_t;_n<=_r;_n++){var _s=this.xCellCount*_n+_i;if(d.call(this,e,o,s,h,_s,g,_,j))return}}},{key:"_convertToXCellCoord",value:function(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}},{key:"_convertToYCellCoord",value:function(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}},{key:"_circlesCollide",value:function(e,o,s,h,d,g){var _=h-e,j=d-o,$=s+g;return $*$>_*_+j*j}},{key:"_circleAndRectCollide",value:function(e,o,s,h,d,g,_){var j=(g-h)/2,$=Math.abs(e-(h+j));if($>j+s)return!1;var _t=(_-d)/2,_e=Math.abs(o-(d+_t));if(_e>_t+s)return!1;if($<=j||_e<=_t)return!0;var _r=$-j,_i=_e-_t;return _r*_r+_i*_i<=s*s}}])}(),CollisionUtils={toDiscardLabel:function(e,o,s,h){var d;if(h&&(d=function(py){return py!==h.id}),!o){if(e.type==="point"&&!e.angle){var g=e.getAABB(),_=g.left,j=g.top,$=g.right,_t=g.bottom;if(s.hitTest(_,-j,$,-_t,d)){if(Array.isArray(e.layout.anchor))for(var _e=1;_e<e.layout.anchor.length;_e++){e.setAnchor(e.layout.anchor[_e]);var _r=e.getAABB(),_i=_r.left,_n=_r.top,_s=_r.right,_l=_r.bottom;if(!s.hitTest(_i,-_n,_s,-_l,d))return!1}return!0}return!1}var Ap=e.getBoundingCircles();return s.hitTestCircleList(Ap,d)}if(o){if(e.type==="point"&&!e.isFlat()){var _h=e.getScreenSpaceBoundingBox(),_p=_h.left,ty=_h.top,ry=_h.right,ly=_h.bottom;return s.hitTest(_p,ty,ry,ly,d)}var uy=e.getBoundingCircles();return s.hitTestCircleList(uy,d)}return!1},addLabel:function(e,o,s){var h=e.id;if(e.placed=!0,!o)if(e.type!=="point"||e.angle){var d=e.getBoundingCircles();s.insertCircleList(h,d)}else{var g=e.getAABB(),_=g.left,j=g.top,$=g.right,_t=g.bottom;s.insert(h,_,-j,$,-_t)}if(o)if(e.type!=="point"||e.isFlat()){var _e=e.getBoundingCircles();s.insertCircleList(h,_e)}else{var _r=e.getScreenSpaceBoundingBox(),_i=_r.left,_n=_r.top,_s=_r.right,_l=_r.bottom;s.insert(h,_i,_n,_s,_l)}}},Collision={tiles:{},startTile:function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.apply_repeat_groups,h=s===void 0||s,d=o.return_hidden,g=d!==void 0&&d,_=o.grid_index,j=_===void 0?null:_,$=this.tiles[e]={grid_index:j||new GridIndex(Geo$1.tile_scale,Geo$1.tile_scale,240),objects:{},labels:{},styles:{},repeat:h,return_hidden:g};$.complete==null&&($.complete=new Promise(function(_t,_e){$.resolve=_t,$.reject=_e}))},resetTile:function(e){delete this.tiles[e]},abortTile:function(e){this.tiles[e]&&this.tiles[e].resolve&&this.tiles[e].resolve([]),this.resetTile(e)},addStyle:function(e,o){this.tiles[o].styles[e]=!0},collide:function(e,o,s){var h=this.tiles[s];if(!h)return Promise.resolve([]);for(var d=h.objects,g=0;g<e.length;g++){var _=e[g],j=_.label.layout.priority;d[j]=d[j]||{},d[j][o]=d[j][o]||[],d[j][o].push(_)}return delete h.styles[o],Object.keys(h.styles).length===0&&this.endTile(s),h.complete.then(function(){return h.resolve=null,h.labels[o]||[]})},endTile:function(e){var o=this.tiles[e],s=o.labels;o.repeat&&RepeatGroup.clear(e);for(var h=Object.keys(o.objects).sort(function(_e,_r){return _e-_r}),d=0;d<h.length;d++){var g=o.objects[h[d]];if(g)for(var _ in g){var j=g[_];s[_]=s[_]||[];for(var $=0;$<j.length;$++){var _t=j[$];this.canBePlaced(_t,e,_t.linked,o)?_t.linked?this.canBePlaced(_t.linked,e,_t,o)?(_t.show=!0,(_t.label.breach||_t.linked.label.breach)&&(_t.label.breach=!0,_t.linked.label.breach=!0),s[_].push(_t),this.place(_t,e,o),this.place(_t.linked,e,o)):o.return_hidden&&(_t.show=!1,s[_].push(_t)):(_t.show=!0,s[_].push(_t),this.place(_t,e,o)):o.return_hidden&&(_t.show=!1,s[_].push(_t))}}}delete this.tiles[e],o.resolve()},canBePlaced:function(e,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,h=(arguments.length>3&&arguments[3]!==void 0?arguments[3]:{}).repeat,d=h===void 0||h,g=e.label,_=e.label.layout;if(g.placed!==null)return g.placed;var j=this.tiles[o].grid_index;if(_.collide&&CollisionUtils.toDiscardLabel(g,o==="main",j,s&&s.label))_.collide&&(g.placed=!1);else{if(!(d&&RepeatGroup.check(g,_,o)))return!0;g.placed=!1}return g.placed},place:function(e,o,s){var h=e.label,d=s.repeat,g=d===void 0||d;h.placed===null&&(g&&RepeatGroup.add(h,h.layout,o),CollisionUtils.addLabel(h,o==="main",this.tiles[o].grid_index))}},Task={id:0,queue:[],max_time:20,start_time:null,state:{},ignore_user_moving_view:!1,_ignoreViewMoveWithDebounce:debounce(function(){Task.ignore_user_moving_view=!0},0,500),add:function(e){e.id=Task.id++,e.max_time=e.max_time||Task.max_time,e.pause_factor=e.pause_factor||1;var o=new Promise(function(s,h){e.resolve=s,e.reject=h});return e.promise=o,e.total_elapsed=0,e.stats={calls:0},this.queue.push(e),this.start_time=this.start_time||performance.now(),this.elapsed=performance.now()-this.start_time,this.elapsed<Task.max_time&&this.process(e),e.promise},remove:function(e){var o=this.queue.indexOf(e);o>-1&&this.queue.splice(o,1)},process:function(e){if(!this.state.user_moving_view||e.user_moving_view!==!1||this.ignore_user_moving_view)return e.pause?(e.pause--,!0):(e.stats.calls++,e.start_time=performance.now(),e.run(e));Task._ignoreViewMoveWithDebounce()},processAll:function(){this.start_time=this.start_time||performance.now(),this.ignore_user_moving_view&&!this.hasPendingTasks()&&(this.ignore_user_moving_view=!1);for(var e=0;e<this.queue.length;e++){var o=this.queue[e];if(this.process(o)!==!0&&(o.pause||(o.pause=o.elapsed>o.max_time?o.pause_factor:0),o.total_elapsed+=o.elapsed),this.elapsed=performance.now()-this.start_time,this.elapsed>=Task.max_time){this.start_time=null;break}}},finish:function(e,o){return e.elapsed=performance.now()-e.start_time,e.total_elapsed+=e.elapsed,this.remove(e),e.resolve(o),e.promise},cancel:function(e){var o;e.cancel instanceof Function&&(o=e.cancel(e)),e.resolve(o||{})},shouldContinue:function(e){return e.elapsed=performance.now()-e.start_time,this.elapsed=performance.now()-this.start_time,e.elapsed<e.max_time&&this.elapsed<Task.max_time},removeForTile:function(e){for(var o=this.queue.length-1;o>=0;o--)this.queue[o].tile_id===e&&(this.cancel(this.queue[o]),this.queue.splice(o,1))},setState:function(e){this.state=e},hasPendingTasks:function(){return!!this.queue.length}};function sliceOptions(e){return{coords:e.coords,uid:e.uid,filtering:e.filtering,sprites:e.sprites,url:e.url,element:e.element,data:e.data,width:e.width,height:e.height,density:e.density,repeat:e.repeat,TEXTURE_WRAP_S:e.TEXTURE_WRAP_S,TEXTURE_WRAP_T:e.TEXTURE_WRAP_T,UNPACK_FLIP_Y_WEBGL:e.UNPACK_FLIP_Y_WEBGL,UNPACK_PREMULTIPLY_ALPHA_WEBGL:e.UNPACK_PREMULTIPLY_ALPHA_WEBGL}}var Texture=function(){return _createClass(function e(o,s,h){var d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};_classCallCheck(this,e),d=sliceOptions(d),this.gl=o,this.texture=o.createTexture(),this.texture&&(this.valid=!0),this.manager=h,this.bind(),this.name=s,this.retain_count=0,this.config_type=null,this.loading=null,this.loaded=!1,this.filtering=d.filtering,this.density=d.density||1,this.sprites=d.sprites,this.texcoords={},this.sizes={},this.css_sizes={},this.aspects={},this._byte_length=0,this.setData(1,1,new Uint8Array([0,0,0,0]),{filtering:"nearest"}),this.loaded=!1,this.manager.textures[this.name]&&(this.retain_count=this.manager.textures[this.name].retain_count,this.manager.textures[this.name].retain_count=0,this.manager.textures[this.name].destroy()),this.manager.textures[this.name]=this,this.manager.texture_configs[this.name]=JSON.stringify(Object.assign({name:s},d)),this.load(d),log("trace","creating Texture ".concat(this.name))},[{key:"destroy",value:function(){var e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).force;this.retain_count>0&&!e?log("error","Texture '".concat(this.name,"': destroying texture with retain count of '").concat(this.retain_count,"'")):this.valid&&(this.gl.deleteTexture(this.texture),this.texture=null,delete this.data,this.data=null,delete this.manager.textures[this.name],delete this.manager.texture_configs[this.name],this.valid=!1,this._byte_length=0,log("trace","destroying Texture ".concat(this.name)))}},{key:"retain",value:function(){this.retain_count++}},{key:"release",value:function(){this.retain_count<=0&&log("error","Texture '".concat(this.name,"': releasing texture with retain count of '").concat(this.retain_count,"'")),this.retain_count--,this.retain_count<=0&&this.destroy()}},{key:"bind",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.valid&&(this.manager.activeUnit!==e&&(this.gl.activeTexture(this.gl.TEXTURE0+e),this.manager.activeUnit=e,this.manager.boundTexture=null),this.manager.boundTexture!==this.texture&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.texture),this.manager.boundTexture=this.texture))}},{key:"load",value:function(e){var o=this;return e?(this.loading=null,typeof e.url=="string"?(this.config_type="url",this.setUrl(e.url,e)):e.element?(this.config_type="element",this.setElement(e.element,e)):e.data&&e.width&&e.height&&(this.config_type="data",this.setData(e.width,e.height,e.data,e)),this.loading=this.loading&&this.loading.then(function(){return o.calculateSprites(),o})||Promise.resolve(this),this.loading):this.loading||Promise.resolve(this)}},{key:"setUrl",value:function(e){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.valid)return this.url=e,this.loading=new Promise(function(h,d){var g=new Image;g.onload=function(){try{o.setElement(g,s)}catch(_){o.loaded=!1,log("warn","Texture '".concat(o.name,"': failed to load url: '").concat(o.url,"'"),_,s),o.manager.trigger("warning",{message:"Failed to load texture from ".concat(o.url),error:_,texture:s})}o.loaded=!0,h(o)},g.onerror=function(_){o.loaded=!1,log("warn","Texture '".concat(o.name,"': failed to load url: '").concat(o.url,"'"),_,s),o.manager.trigger("warning",{message:"Failed to load texture from ".concat(o.url),error:_,texture:s}),h(o)},Utils$1.isSafari()&&o.url.slice(0,5)==="data:"||(g.crossOrigin="anonymous"),g.src=o.url}),this.loading}},{key:"setData",value:function(e,o,s){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.width=e,this.height=o,Array.isArray(s)&&(s=new Uint8Array(s)),this.update(s,h),this.setFiltering(h),this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"setElement",value:function(e,o){var s=e;if(typeof e=="string"&&(e=document.querySelector(e)),e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof HTMLVideoElement)this.update(e,o),this.setFiltering(o);else{this.loaded=!1;var h="the 'element' parameter (`element: ".concat(JSON.stringify(s),"`) must be a CSS ");h+="selector string, or a <canvas>, <image> or <video> object",log("warn","Texture '".concat(this.name,"': ").concat(h),o),this.manager.trigger("warning",{message:"Failed to load texture because ".concat(h),texture:o})}return this.loaded=!0,this.loading=Promise.resolve(this),this.loading}},{key:"update",value:function(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.valid&&(this.bind(),e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof HTMLImageElement&&e.complete?(this.width=e.width,this.height=e.height,this._byte_length=this.width*this.height*4,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,o.UNPACK_FLIP_Y_WEBGL!==!1),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o.UNPACK_PREMULTIPLY_ALPHA_WEBGL||!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)):(this._byte_length=e?e.byteLength:0,this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.gl.pixelStorei(this.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.width,this.height,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e)),this.manager.trigger("update",this))}},{key:"getByteLength",value:function(){return this._byte_length}},{key:"setFiltering",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.valid){e.filtering=e.filtering||"linear";var o=this.gl;this.bind(),Utils$1.isPowerOf2(this.width)&&Utils$1.isPowerOf2(this.height)?(this.power_of_2=!0,o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,e.TEXTURE_WRAP_S||e.repeat&&o.REPEAT||o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,e.TEXTURE_WRAP_T||e.repeat&&o.REPEAT||o.CLAMP_TO_EDGE),e.filtering==="mipmap"?(this.filtering="mipmap",o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR_MIPMAP_LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.generateMipmap(o.TEXTURE_2D)):e.filtering==="linear"?(this.filtering="linear",o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR)):e.filtering==="nearest"&&(this.filtering="nearest",o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST))):(this.power_of_2=!1,o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),e.filtering==="nearest"?(this.filtering="nearest",o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST)):(this.filtering="linear",o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR))),this.manager.trigger("update",this)}}},{key:"calculateSprites",value:function(){if(this.sprites)for(var e in this.sprites){var o=this.sprites[e];this.texcoords[e]=this.manager.getTexcoordsForSprite([o[0],o[1]],[o[2],o[3]],[this.width,this.height]),this.sizes[e]=[o[2],o[3]],this.css_sizes[e]=[o[2]/this.density,o[3]/this.density],this.aspects[e]=o[2]/o[3]}}}])}();function subscribeMixin(e){var o=[];return Object.assign(e,{subscribe:function(s){o.indexOf(s)===-1&&o.push(s)},unsubscribe:function(s){var h=o.indexOf(s);h>-1&&o.splice(h,1)},unsubscribeAll:function(){o=[]},trigger:function(s){for(var h=arguments.length,d=new Array(h>1?h-1:0),g=1;g<h;g++)d[g-1]=arguments[g];o.forEach(function(_){if(typeof _[s]=="function")try{_[s].apply(_,d)}catch(j){log("warn","Caught exception in listener for event '".concat(s,"':"),j)}})},hasSubscribersFor:function(s){var h=!1;return o.forEach(function(d){typeof d[s]=="function"&&(h=!0)}),h}})}var TextureManager=function(){function e(o){_classCallCheck(this,e),this.default=e.DEFAULT_TEXTURE_NAME,this.textures={},this.texture_configs={},this.boundTexture=null,this.activeUnit=null,this.scene_id=o,WorkerBroker.addTarget("Texture"+this.scene_id,this),subscribeMixin(this)}return _createClass(e,[{key:"create",value:function(o,s,h){for(var d=e.matchers_,g=0;g<d.length;g++){var _=d[g][0],j=d[g][1];if(j&&j(h))return new _(o,s,this,h)}return new Texture(o,s,this,h)}},{key:"retain",value:function(o){this.textures[o]&&this.textures[o].retain()}},{key:"release",value:function(o){this.textures[o]&&this.textures[o].release()}},{key:"getRetainCount",value:function(o){if(this.textures[o])return this.textures[o].retain_count}},{key:"getByteLength",value:function(o){if(this.textures[o])return this.textures[o].getByteLength()}},{key:"destroy",value:function(o){var s=this;Object.keys(this.textures).forEach(function(h){var d=s.textures[h];h!==s.default&&d.gl===o&&d.destroy({force:!0})})}},{key:"getSpriteInfo",value:function(o,s){var h=this.textures[o];return h&&{size:h.sizes[s],css_size:h.css_sizes[s],aspect:h.aspects[s],texcoords:h.texcoords[s]}}},{key:"getTexcoordsForSprite",value:function(o,s,h){var d=h[1]-o[1]-s[1];return[o[0]/h[0],d/h[1],(s[0]+o[0])/h[0],(s[1]+d)/h[1]]}},{key:"createFromObject",value:function(o,s){var h=[];if(s)for(var d in s){var g=s[d];if(this.changed(d,g)){var _=this.create(o,d,g);h.push(_.loading)}}return Promise.all(h)}},{key:"createDefault",value:function(o){return this.create(o,this.default)}},{key:"changed",value:function(o,s){var h=this.textures[o];if(h){if(h.config_type==="element"||s.element!=null)return!0;if(s=sliceOptions(s),this.texture_configs[o]===JSON.stringify(Object.assign({name:o},s)))return!1}return!0}},{key:"getInfo",value:function(o){var s=this;if(o||(o=Object.keys(this.textures)),Array.isArray(o))return Promise.all(o.map(function(d){return s.getInfo(d)}));var h=this.textures[o];return h?(h.loading||Promise.resolve(h)).then(function(){return{name:h.name,width:h.width,height:h.height,density:h.density,sprites:h.sprites,texcoords:h.texcoords,sizes:h.sizes,css_sizes:h.css_sizes,aspects:h.aspects,filtering:h.filtering,power_of_2:h.power_of_2,valid:h.valid}}):Promise.resolve(null)}},{key:"syncTexturesToWorker",value:function(o){var s=this;return Thread.is_main?Promise.all(o.map(function(h){var d=s.textures[h];return d&&d.loading||Promise.resolve()})).then(function(){return s.textures}):WorkerBroker.postMessage("Texture"+this.scene_id+".getInfo",o).then(function(h){return h.forEach(function(d){s.textures[d.name]=d}),s.textures})}},{key:"getMaxTextureSize",value:function(o){return o.getParameter(o.MAX_TEXTURE_SIZE)}}],[{key:"register",value:function(o,s){var h=e.matchers_;if(!(o instanceof Function&&s instanceof Function))throw"Invalid texture constructor or matcher";this.deRegister(o),h.push([o,s])}},{key:"deRegister",value:function(o){for(var s=e.matchers_,h=0;h<s.length;h++)s[h][0]===o&&s.splice(h,1)}}])}();TextureManager.DEFAULT_TEXTURE_NAME="__default",TextureManager.matchers_=[];var Registry={};function getTextureManager(e){return Registry[e]||(Registry[e]=new TextureManager(e)),Registry[e]}var transformMat4_1$1=transformMat4$1;function transformMat4$1(e,o,s){var h=o[0],d=o[1],g=o[2],_=s[3]*h+s[7]*d+s[11]*g+s[15];return _=_||1,e[0]=(s[0]*h+s[4]*d+s[8]*g+s[12])/_,e[1]=(s[1]*h+s[5]*d+s[9]*g+s[13])/_,e[2]=(s[2]*h+s[6]*d+s[10]*g+s[14])/_,e}var vec3_transformMat4=getDefaultExportFromCjs(transformMat4_1$1),normalFromMat4_1=normalFromMat4;function normalFromMat4(e,o){var s=o[0],h=o[1],d=o[2],g=o[3],_=o[4],j=o[5],$=o[6],_t=o[7],_e=o[8],_r=o[9],_i=o[10],_n=o[11],_s=o[12],_l=o[13],Ap=o[14],_h=o[15],_p=s*j-h*_,ty=s*$-d*_,ry=s*_t-g*_,ly=h*$-d*j,uy=h*_t-g*j,py=d*_t-g*$,fy=_e*_l-_r*_s,my=_e*Ap-_i*_s,xy=_e*_h-_n*_s,Ly=_r*Ap-_i*_l,My=_r*_h-_n*_l,Ry=_i*_h-_n*Ap,Sy=_p*Ry-ty*My+ry*Ly+ly*xy-uy*my+py*fy;return Sy?(Sy=1/Sy,e[0]=(j*Ry-$*My+_t*Ly)*Sy,e[1]=($*xy-_*Ry-_t*my)*Sy,e[2]=(_*My-j*xy+_t*fy)*Sy,e[3]=(d*My-h*Ry-g*Ly)*Sy,e[4]=(s*Ry-d*xy+g*my)*Sy,e[5]=(h*xy-s*My-g*fy)*Sy,e[6]=(_l*py-Ap*uy+_h*ly)*Sy,e[7]=(Ap*ry-_s*py-_h*ty)*Sy,e[8]=(_s*uy-_l*ry+_h*_p)*Sy,e):null}var mat3_normalFromMat4=getDefaultExportFromCjs(normalFromMat4_1),invert_1$1=invert$1;function invert$1(e,o){var s=o[0],h=o[1],d=o[2],g=o[3],_=o[4],j=o[5],$=o[6],_t=o[7],_e=o[8],_r=_e*_-j*_t,_i=-_e*g+j*$,_n=_t*g-_*$,_s=s*_r+h*_i+d*_n;return _s?(_s=1/_s,e[0]=_r*_s,e[1]=(-_e*h+d*_t)*_s,e[2]=(j*h-d*_)*_s,e[3]=_i*_s,e[4]=(_e*s-d*$)*_s,e[5]=(-j*s+d*g)*_s,e[6]=_n*_s,e[7]=(-_t*s+h*$)*_s,e[8]=(_*s-h*g)*_s,e):null}var mat3_invert=getDefaultExportFromCjs(invert_1$1),identity_1$1=identity$2;function identity$2(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}var mat3_identity=getDefaultExportFromCjs(identity_1$1),multiply_1=multiply;function multiply(e,o,s){var h=o[0],d=o[1],g=o[2],_=o[3],j=o[4],$=o[5],_t=o[6],_e=o[7],_r=o[8],_i=o[9],_n=o[10],_s=o[11],_l=o[12],Ap=o[13],_h=o[14],_p=o[15],ty=s[0],ry=s[1],ly=s[2],uy=s[3];return e[0]=ty*h+ry*j+ly*_r+uy*_l,e[1]=ty*d+ry*$+ly*_i+uy*Ap,e[2]=ty*g+ry*_t+ly*_n+uy*_h,e[3]=ty*_+ry*_e+ly*_s+uy*_p,ty=s[4],ry=s[5],ly=s[6],uy=s[7],e[4]=ty*h+ry*j+ly*_r+uy*_l,e[5]=ty*d+ry*$+ly*_i+uy*Ap,e[6]=ty*g+ry*_t+ly*_n+uy*_h,e[7]=ty*_+ry*_e+ly*_s+uy*_p,ty=s[8],ry=s[9],ly=s[10],uy=s[11],e[8]=ty*h+ry*j+ly*_r+uy*_l,e[9]=ty*d+ry*$+ly*_i+uy*Ap,e[10]=ty*g+ry*_t+ly*_n+uy*_h,e[11]=ty*_+ry*_e+ly*_s+uy*_p,ty=s[12],ry=s[13],ly=s[14],uy=s[15],e[12]=ty*h+ry*j+ly*_r+uy*_l,e[13]=ty*d+ry*$+ly*_i+uy*Ap,e[14]=ty*g+ry*_t+ly*_n+uy*_h,e[15]=ty*_+ry*_e+ly*_s+uy*_p,e}var mat4_multiply=getDefaultExportFromCjs(multiply_1),translate_1=translate;function translate(e,o,s){var h,d,g,_,j,$,_t,_e,_r,_i,_n,_s,_l=s[0],Ap=s[1],_h=s[2];return o===e?(e[12]=o[0]*_l+o[4]*Ap+o[8]*_h+o[12],e[13]=o[1]*_l+o[5]*Ap+o[9]*_h+o[13],e[14]=o[2]*_l+o[6]*Ap+o[10]*_h+o[14],e[15]=o[3]*_l+o[7]*Ap+o[11]*_h+o[15]):(h=o[0],d=o[1],g=o[2],_=o[3],j=o[4],$=o[5],_t=o[6],_e=o[7],_r=o[8],_i=o[9],_n=o[10],_s=o[11],e[0]=h,e[1]=d,e[2]=g,e[3]=_,e[4]=j,e[5]=$,e[6]=_t,e[7]=_e,e[8]=_r,e[9]=_i,e[10]=_n,e[11]=_s,e[12]=h*_l+j*Ap+_r*_h+o[12],e[13]=d*_l+$*Ap+_i*_h+o[13],e[14]=g*_l+_t*Ap+_n*_h+o[14],e[15]=_*_l+_e*Ap+_s*_h+o[15]),e}var mat4_translate=getDefaultExportFromCjs(translate_1),scale_1$1=scale$1;function scale$1(e,o,s){var h=s[0],d=s[1],g=s[2];return e[0]=o[0]*h,e[1]=o[1]*h,e[2]=o[2]*h,e[3]=o[3]*h,e[4]=o[4]*d,e[5]=o[5]*d,e[6]=o[6]*d,e[7]=o[7]*d,e[8]=o[8]*g,e[9]=o[9]*g,e[10]=o[10]*g,e[11]=o[11]*g,e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15],e}var mat4_scale=getDefaultExportFromCjs(scale_1$1),perspective_1=perspective;function perspective(e,o,s,h,d){var g=1/Math.tan(o/2),_=1/(h-d);return e[0]=g/s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=g,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(d+h)*_,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*d*h*_,e[15]=0,e}var mat4_perspective=getDefaultExportFromCjs(perspective_1),identity_1=identity$1;function identity$1(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}var mat4_identity=getDefaultExportFromCjs(identity_1),identity=identity_1,lookAt_1=lookAt;function lookAt(e,o,s,h){var d,g,_,j,$,_t,_e,_r,_i,_n,_s=o[0],_l=o[1],Ap=o[2],_h=h[0],_p=h[1],ty=h[2],ry=s[0],ly=s[1],uy=s[2];return Math.abs(_s-ry)<1e-6&&Math.abs(_l-ly)<1e-6&&Math.abs(Ap-uy)<1e-6?identity(e):(_e=_s-ry,_r=_l-ly,_i=Ap-uy,d=_p*(_i*=_n=1/Math.sqrt(_e*_e+_r*_r+_i*_i))-ty*(_r*=_n),g=ty*(_e*=_n)-_h*_i,_=_h*_r-_p*_e,(_n=Math.sqrt(d*d+g*g+_*_))?(d*=_n=1/_n,g*=_n,_*=_n):(d=0,g=0,_=0),j=_r*_-_i*g,$=_i*d-_e*_,_t=_e*g-_r*d,(_n=Math.sqrt(j*j+$*$+_t*_t))?(j*=_n=1/_n,$*=_n,_t*=_n):(j=0,$=0,_t=0),e[0]=d,e[1]=j,e[2]=_e,e[3]=0,e[4]=g,e[5]=$,e[6]=_r,e[7]=0,e[8]=_,e[9]=_t,e[10]=_i,e[11]=0,e[12]=-(d*_s+g*_l+_*Ap),e[13]=-(j*_s+$*_l+_t*Ap),e[14]=-(_e*_s+_r*_l+_i*Ap),e[15]=1,e)}var mat4_lookAt=getDefaultExportFromCjs(lookAt_1),copy_1=copy;function copy(e,o){return e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],e[4]=o[4],e[5]=o[5],e[6]=o[6],e[7]=o[7],e[8]=o[8],e[9]=o[9],e[10]=o[10],e[11]=o[11],e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15],e}var mat4_copy=getDefaultExportFromCjs(copy_1),invert_1=invert;function invert(e,o){var s=o[0],h=o[1],d=o[2],g=o[3],_=o[4],j=o[5],$=o[6],_t=o[7],_e=o[8],_r=o[9],_i=o[10],_n=o[11],_s=o[12],_l=o[13],Ap=o[14],_h=o[15],_p=s*j-h*_,ty=s*$-d*_,ry=s*_t-g*_,ly=h*$-d*j,uy=h*_t-g*j,py=d*_t-g*$,fy=_e*_l-_r*_s,my=_e*Ap-_i*_s,xy=_e*_h-_n*_s,Ly=_r*Ap-_i*_l,My=_r*_h-_n*_l,Ry=_i*_h-_n*Ap,Sy=_p*Ry-ty*My+ry*Ly+ly*xy-uy*my+py*fy;return Sy?(Sy=1/Sy,e[0]=(j*Ry-$*My+_t*Ly)*Sy,e[1]=(d*My-h*Ry-g*Ly)*Sy,e[2]=(_l*py-Ap*uy+_h*ly)*Sy,e[3]=(_i*uy-_r*py-_n*ly)*Sy,e[4]=($*xy-_*Ry-_t*my)*Sy,e[5]=(s*Ry-d*xy+g*my)*Sy,e[6]=(Ap*ry-_s*py-_h*ty)*Sy,e[7]=(_e*py-_i*ry+_n*ty)*Sy,e[8]=(_*My-j*xy+_t*fy)*Sy,e[9]=(h*xy-s*My-g*fy)*Sy,e[10]=(_s*uy-_l*ry+_h*_p)*Sy,e[11]=(_r*ry-_e*uy-_n*_p)*Sy,e[12]=(j*my-_*Ly-$*fy)*Sy,e[13]=(s*Ly-h*my+d*fy)*Sy,e[14]=(_l*ty-_s*ly-Ap*_p)*Sy,e[15]=(_e*ly-_r*ty+_i*_p)*Sy,e):null}var mat4_invert=getDefaultExportFromCjs(invert_1),transformMat4_1=transformMat4;function transformMat4(e,o,s){var h=o[0],d=o[1],g=o[2],_=o[3];return e[0]=s[0]*h+s[4]*d+s[8]*g+s[12]*_,e[1]=s[1]*h+s[5]*d+s[9]*g+s[13]*_,e[2]=s[2]*h+s[6]*d+s[10]*g+s[14]*_,e[3]=s[3]*h+s[7]*d+s[11]*g+s[15]*_,e}var vec4_transformMat4=getDefaultExportFromCjs(transformMat4_1),normalize_1=normalize;function normalize(e,o){var s=o[0],h=o[1],d=o[2],g=o[3],_=s*s+h*h+d*d+g*g;return _>0&&(_=1/Math.sqrt(_),e[0]=s*_,e[1]=h*_,e[2]=d*_,e[3]=g*_),e}var vec4_normalize=getDefaultExportFromCjs(normalize_1),scale_1=scale;function scale(e,o,s){return e[0]=o[0]*s,e[1]=o[1]*s,e[2]=o[2]*s,e[3]=o[3]*s,e}var vec4_scale=getDefaultExportFromCjs(scale_1),vec3={fromValues:function(e,o,s){var h=new Float64Array(3);return h[0]=e,h[1]=o,h[2]=s,h},transformMat4:vec3_transformMat4},mat3={normalFromMat4:mat3_normalFromMat4,invert:mat3_invert,identity:mat3_identity},mat4={multiply:mat4_multiply,translate:mat4_translate,scale:mat4_scale,perspective:mat4_perspective,lookAt:mat4_lookAt,identity:mat4_identity,copy:mat4_copy,invert:mat4_invert},vec4={transformMat4:vec4_transformMat4,normalize:vec4_normalize,scale:vec4_scale},FeatureSelection=function(){function e(o,s){_classCallCheck(this,e),this._gl=o,this._requests={},this._pixels=null,this._has_dirty_buffer=!1,this._fbo=this._gl.createFramebuffer(),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._fbo_size={width:256,height:256};var h=getTextureManager(s).create(this._gl,"selection_fbo",{filtering:"nearest"});h.setData(this._fbo_size.width,this._fbo_size.height,null,{filtering:"nearest"}),this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER,this._gl.COLOR_ATTACHMENT0,this._gl.TEXTURE_2D,h.texture,0);var d=this._gl.createRenderbuffer();this._gl.bindRenderbuffer(this._gl.RENDERBUFFER,d),this._gl.renderbufferStorage(this._gl.RENDERBUFFER,this._gl.DEPTH_COMPONENT16,this._fbo_size.width,this._fbo_size.height),this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER,this._gl.DEPTH_ATTACHMENT,this._gl.RENDERBUFFER,d),this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null)}return _createClass(e,[{key:"destroy",value:function(){this._gl&&this._fbo&&(this._gl.deleteFramebuffer(this._fbo),this._fbo=null,this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,null))}},{key:"bind",value:function(){var o;this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,this._fbo),this._gl.viewport(0,0,this._fbo_size.width,this._fbo_size.height),(o=this._gl).clearColor.apply(o,_toConsumableArray(e.defaultColor))}},{key:"getFeatureAt",value:function(o,s,h){var d=s.radius,g=s.top_most_only,_=g===void 0||g;!o||o.x<0||o.y<0||o.x>1||o.y>1?h({features:null}):(this.selection_request_id=this.selection_request_id+1||0,this._requests[this.selection_request_id]={id:this.selection_request_id,point:o,radius:d,top_most_only:_,ttl:_?1:e.MAX_PICKING_TRIES,callback:h})}},{key:"has_dirty_buffer",get:function(){return this._has_dirty_buffer},set:function(o){this._has_dirty_buffer=!!this._pending_deep_request}},{key:"hasPendingRequests",value:function(){return Object.keys(this._requests).length>0}},{key:"clearPendingRequests",value:function(){for(var o in this._requests)this._requests[o].callback(new Error("cleared")),delete this._requests[o];this._pending_deep_request=null}},{key:"read",value:function(o){if(this.hasPendingRequests()){var s=this._gl;for(var h in s.bindFramebuffer(s.FRAMEBUFFER,this._fbo),this._pending_deep_request&&this.processRequest(this._pending_deep_request,o),this._requests)if(this.processRequest(this._requests[h],o))break;s.bindFramebuffer(s.FRAMEBUFFER,null)}}},{key:"processRequest",value:function(o,s){var h,d,g=this._gl,_=255,j=o.point,$=o.radius;if($){var _t=Math.min(this._fbo_size.width,this._fbo_size.height);d={x:Math.min(Math.ceil(2*$.x*this._fbo_size.width),_t),y:Math.min(Math.ceil(2*$.y*this._fbo_size.height),_t)}}else $={x:0,y:0},d={x:1,y:1};var _e=d.x*d.y*4;if(this._pixels==null||this._pixels.byteLength<_e)this._pixels=new Uint8Array(_e);else if(this._pixels.fill instanceof Function)this._pixels.fill(0,0,_e);else for(var _r=0;_r<_e;_r++)this._pixels[_r]=0;g.readPixels(Math.round((j.x-$.x)*this._fbo_size.width),Math.round((1-j.y-$.y)*this._fbo_size.height),d.x,d.y,g.RGBA,g.UNSIGNED_BYTE,this._pixels),o.ttl--;var _i=Math.floor(d.x/2),_n=Math.floor(d.y/2),_s=4*(_n*d.x+_i),_l=this._pixels.slice(_s,_s+4),Ap=_l[0]+(_l[1]<<8)+(_l[2]<<16);if(Ap>0)h=Ap+(_l[3]<<24)>>>0,_=_l[3];else if(_e>4){var _h=1/0;_s=0;for(var _p=0;_p<d.y;_p++)for(var ty=0;ty<d.x;ty++,_s+=4)if((Ap=(_l=this._pixels.slice(_s,_s+4))[0]+(_l[1]<<8)+(_l[2]<<16))>0){var ry=Math.pow(ty-_i,2)+Math.pow(_p-_n,2);ry<_h&&(h=Ap+(_l[3]<<24)>>>0,_=_l[3],_h=ry)}}if(_!==255){var ly=this._getFeatureByKey(h,s);if(o.features||(o.features=[]),!ly)return void this._finishRead(o);if(o.features.every(function(uy){return uy.id!==ly.id})&&o.features.push(ly),o.ttl)return this._pending_deep_request=o,e._discardColor(_l),this._has_dirty_buffer=!0,!0;this._finishRead(o)}else this._finishRead(o)}},{key:"_finishRead",value:function(o){var s=o.features||e.EMPTY_ARRAY;o.top_most_only||(this._pending_deep_request=null,e._resetDiscardedColors()),delete this._requests[o.id],o.callback({features:s})}},{key:"_getFeatureByKey",value:function(o,s){for(var h=null,d=0;d<s.length;d++){var g=s[d];if(g.selection_data&&(h=g.selection_data[o])){h.tile={coords:g.coords};break}}return h}},{key:"setupDiscards",value:function(o){for(var s=e.MAX_PICKING_TRIES;s--;)o.uniform("4fv","u_selection_discard".concat(s),e._discarded_colors[s]||e.defaultColor)}}],[{key:"makeEntry",value:function(){this.map_entry++;var o=255&this.map_entry,s=this.map_entry>>8&255,h=this.map_entry>>16&255,d=this.map_prefix;return{key:o+(s<<8)+(h<<16)+(d<<24)>>>0,color:[o/255,s/255,h/255,d/255]}}},{key:"reset",value:function(){this.map_entry=0}},{key:"setPrefix",value:function(o){this.map_prefix=o}},{key:"_discardColor",value:function(o){this._discarded_colors.push([o[0]/255,o[1]/255,o[2]/255,o[3]/255])}},{key:"_resetDiscardedColors",value:function(){this._discarded_colors.length=0}}])}();FeatureSelection._discarded_colors=[],FeatureSelection.map_entry=0,FeatureSelection.map_prefix=0,FeatureSelection.defaultColor=[0,0,0,1],FeatureSelection.MAX_PICKING_TRIES=10,FeatureSelection.EMPTY_ARRAY=Object.freeze([]);var GLSL={parseUniforms:function(e){var o=[];for(var s in e){var h,d=s,g=e[s];if(typeof g=="number")o.push({type:"float",method:"1f",name:s,value:g,key:d,uniforms:e});else if(Array.isArray(g)){if(typeof g[0]=="number")g.length>=2&&g.length<=4?o.push({type:"vec"+g.length,method:g.length+"fv",name:s,value:g,key:d,uniforms:e}):g.length>4&&o.push({type:"float[]",method:"1fv",name:s+"[0]",value:g,key:d,uniforms:e});else if(typeof g[0]=="string")for(h=0;h<g.length;h++)o.push({type:"sampler2D",method:"1i",name:s+"["+h+"]",value:g[h],key:h,uniforms:g});else if(Array.isArray(g[0])&&typeof g[0][0]=="number"&&g[0].length>=2&&g[0].length<=4)for(h=0;h<g.length;h++)o.push({type:"vec"+g[0].length,method:g[h].length+"fv",name:s+"["+h+"]",value:g[h],key:h,uniforms:g})}else typeof g=="boolean"?o.push({type:"bool",method:"1i",name:s,value:g,key:d,uniforms:e}):typeof g=="string"&&o.push({type:"sampler2D",method:"1i",name:s,value:g,key:d,uniforms:e})}return o},defineVariable:function(e,o){var s,h;if(typeof o=="number")s="float";else if(Array.isArray(o))typeof o[0]=="number"?o.length>=2&&o.length<=4?s="vec"+o.length:(s="float",h=o.length):typeof o[0]=="string"&&(s="sampler2D",h=o.length);else if(typeof o=="boolean")s="bool";else{if(typeof o!="string")return;s="sampler2D"}var d="";return d+="".concat(s," ").concat(e),h&&(d+="[".concat(h,"]")),d+=`;
`},defineUniform:function(e,o){var s=GLSL.defineVariable(e,o);if(s)return"uniform "+s},isUniformDefined:function(e,o){var s=new RegExp("uniform[^;]+(?:{[\\s\\S]*})?[^;]*\\b"+e+"\\b","g");return!!o.match(s)},isSymbolReferenced:function(e,o){var s=new RegExp("\\b"+e+"\\b","g");return o.search(s)>=0},expandVec3:function(e){var o,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(Array.isArray(e)){if(e.length!==2)return e;o=[].concat(_toConsumableArray(e),[s]).map(parseFloat)}else o=[e,e,e].map(parseFloat);if(o&&o.every(function(h){return typeof h=="number"&&!isNaN(h)}))return o},expandVec4:function(e){var o,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(Array.isArray(e)){if(e.length!==3)return e;o=[].concat(_toConsumableArray(e),[s]).map(parseFloat)}else o=[e,e,e,s].map(parseFloat);if(o&&o.every(function(h){return typeof h=="number"&&!isNaN(h)}))return o}},extensions=[];function getExtension(e,o){var s=extensions.filter(function(h){return h[0]===e})[0];return(s=s&&s[1])||(extensions.push([e,{}]),s=extensions[extensions.length-1][1]),s[o]||(s[o]=e.getExtension(o)),s[o]}function hashString(e){var o,s,h=0;if(e.length===0)return h;for(o=0,s=e.length;o<s;o++)h=(h<<5)-h+e.charCodeAt(o),h|=0;return h}var stripComments={exports:{}},reBlock="\\/\\*",reBlockIgnore="\\/\\*(?!\\*?\\!)",reBlockEnd="(.|[\\r\\n]|\\n)*?\\*\\/\\n?\\n?",reLine=/(^|[^\S\n])(?:\/\/)([\s\S]+?)$/gm,reLineIgnore=/(^|[^\S\n])(?:\/\/[^!])([\s\S]+?)$/gm,strip=stripComments.exports=function(e,o){return e?strip.block(strip.line(e,o),o):""};/*!
	 * strip-comments <https://github.com/jonschlinkert/strip-comments>
	 *
	 * Copyright (c) 2014 Jon Schlinkert, contributors.
	 * Licensed under the MIT license.
	 */strip.block=function(e,o){o=o||{};var s=new RegExp(reBlock+reBlockEnd,"gm");return o.safe&&(s=new RegExp(reBlockIgnore+reBlockEnd,"gm")),e?e.replace(s,""):""},strip.line=function(e,o){var s=reLine;return(o=o||{}).safe&&(s=reLineIgnore),e?e.replace(s,""):""};var stripCommentsExports=stripComments.exports,strip$1=getDefaultExportFromCjs(stripCommentsExports),glShaderErrors=parseErrors;function parseErrors(e){e=String(e);for(var o,s=[];o=e.match(/ERROR\:([^\n]+)/);){e=e.slice(o.index+1);var h=(_=o[1].trim()).split(":"),d=h.slice(2).join(":").trim(),g=parseInt(h[0],10),_=parseInt(h[1],10);s.push({message:d,file:g,line:_})}return s}var parseShaderErrors=getDefaultExportFromCjs(glShaderErrors),re_pragma=/^\s*#pragma.*$/gm,re_continue_line=/\\\s*\n/gm,ShaderProgram=function(){function e(o,s,h,d,g){if(_classCallCheck(this,e),g=g||{},this.textureManager=getTextureManager(d),this.gl=o,this.program=null,this.compiled=!1,this.compiling=!1,this.error=null,!e.polyfills[d]){e.polyfills[d]={};try{this.gl.uniformMatrix3fv(null,!1,new Float64Array(9))}catch{e.polyfills[d].uniformMatrix3fv=this.gl.uniformMatrix3fv,this.gl.uniformMatrix3fv=function(j,$,_t){e.polyfills[d].uniformMatrix3fv.call(this,j,$,new Float32Array(_t))}}try{this.gl.uniformMatrix4fv(null,!1,new Float64Array(16))}catch{e.polyfills[d].uniformMatrix4fv=this.gl.uniformMatrix4fv,this.gl.uniformMatrix4fv=function(j,$,_t){e.polyfills[d].uniformMatrix4fv.call(this,j,$,new Float32Array(_t))}}}this.defines=Object.assign({},g.defines||{}),this.blocks=Object.assign({},g.blocks||{}),this.block_scopes=Object.assign({},g.block_scopes||{}),this.extensions=g.extensions||[],this.dependent_uniforms=g.uniforms,this.uniforms={},this.attribs={},this.vertex_source=s,this.fragment_source=h,this.id=e.id++,this.name=g.name}return _createClass(e,[{key:"destroy",value:function(){this.gl.useProgram(null),this.gl.deleteProgram(this.program),this.program=null,this.uniforms={},this.attribs={},this.compiled=!1}},{key:"use",value:function(){this.compiled&&(e.current!==this&&this.gl.useProgram(this.program),e.current=this)}},{key:"compile",value:function(){var o=this;if(this.compiling)throw new Error("ShaderProgram.compile(): skipping for ".concat(this.id," (").concat(this.name,") because already compiling"));this.compiling=!0,this.compiled=!1,this.error=null,this.computed_vertex_source=this.vertex_source,this.computed_fragment_source=this.fragment_source;var s,h=this.checkExtensions(),d=this.buildDefineList(),g=this.buildShaderBlockList();for(var _ in g){var j=g[_];if(j&&(!Array.isArray(j)||j.length!==0)){s=new RegExp("^\\s*#pragma\\s+tangram:\\s+"+_+"\\s*$","m");var $=this.computed_vertex_source.match(s),_t=this.computed_fragment_source.match(s);if($!=null||_t!=null){var _e="";j.forEach(function(_n){var _s="".concat(_n.scope,", ").concat(_n.key,", ").concat(_n.num);_e+=`
// tangram-block-start: `.concat(_s,`
`),_e+=_n.source,_e+=`
// tangram-block-end: `.concat(_s,`
`)}),$!=null&&(this.computed_vertex_source=this.computed_vertex_source.replace(s,_e)),_t!=null&&(this.computed_fragment_source=this.computed_fragment_source.replace(s,_e)),d["TANGRAM_BLOCK_"+_.replace(/[\s-]+/g,"_").toUpperCase()]=!0}}}this.computed_vertex_source=this.computed_vertex_source.replace(re_pragma,""),this.computed_fragment_source=this.computed_fragment_source.replace(re_pragma,""),this.ensureUniforms(this.dependent_uniforms);var _r="",_i=this.gl.getShaderPrecisionFormat(this.gl.FRAGMENT_SHADER,this.gl.HIGH_FLOAT);_r=_i&&_i.precision>0?`precision highp float;
`:`precision mediump float;
`,d.TANGRAM_VERTEX_SHADER=!0,d.TANGRAM_FRAGMENT_SHADER=!1,this.computed_vertex_source=_r+e.buildDefineString(d)+this.computed_vertex_source,d.TANGRAM_VERTEX_SHADER=!1,d.TANGRAM_FRAGMENT_SHADER=!0,this.computed_fragment_source=e.buildExtensionString(h)+_r+e.buildDefineString(d)+this.computed_fragment_source,this.computed_vertex_source=this.computed_vertex_source.replace(re_continue_line,""),this.computed_fragment_source=this.computed_fragment_source.replace(re_continue_line,"");try{this.program=e.updateProgram(this.gl,this.program,this.computed_vertex_source,this.computed_fragment_source),this.compiled=!0,this.compiling=!1}catch(_n){throw this.program=null,this.compiled=!1,this.compiling=!1,this.error=_n,_n.type!=="vertex"&&_n.type!=="fragment"||(this.shader_errors=_n.errors,this.shader_errors.forEach(function(_s){_s.type=_n.type,_s.block=o.block(_n.type,_s.line)})),_n}this.computed_vertex_source=null,this.computed_fragment_source=null,this.use(),this.refreshUniforms(),this.refreshAttributes()}},{key:"buildDefineList",value:function(){var o,s={};for(o in e.defines)s[o]=e.defines[o];for(o in this.defines)s[o]=this.defines[o];return s}},{key:"buildShaderBlockList",value:function(){var o,s={};for(o in e.blocks){var h;s[o]=[],Array.isArray(e.blocks[o])?(h=s[o]).push.apply(h,_toConsumableArray(e.blocks[o].map(function($,_t){return{key:o,source:$,num:_t,scope:"ShaderProgram"}}))):s[o]=[{key:o,source:e.blocks[o],num:0,scope:"ShaderProgram"}]}for(o in this.blocks)if(s[o]=s[o]||[],Array.isArray(this.blocks[o]))for(var d=this.block_scopes&&this.block_scopes[o]||[],g=null,_=0,j=0;j<this.blocks[o].length;j++)d[j]!==g&&(g=d[j],_=0),s[o].push({key:o,source:this.blocks[o][j],num:_,scope:g||this.name}),_++;else s[o].push({key:o,source:this.blocks[o],num:0,scope:this.name});return s}},{key:"ensureUniforms",value:function(o){if(o){var s,h=strip$1(this.computed_vertex_source),d=strip$1(this.computed_fragment_source),g=[],_=[];for(var j in o){var $=GLSL.isUniformDefined(j,h),_t=GLSL.isUniformDefined(j,d);if(!$||!_t){if(!(s=GLSL.defineUniform(j,o[j])))continue;$||(log("trace","Program ".concat(this.name,": ").concat(j," not defined in vertex shader, injecting: '").concat(s,"'")),g.push(s)),_t||(log("trace","Program ".concat(this.name,": ").concat(j," not defined in fragment shader, injecting: '").concat(s,"'")),_.push(s))}}g.length>0&&(this.computed_vertex_source=g.join(`
`)+this.computed_vertex_source),_.length>0&&(this.computed_fragment_source=_.join(`
`)+this.computed_fragment_source)}}},{key:"setUniforms",value:function(o){var s=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];if(this.compiled){s&&(this.texture_unit=0);for(var h=GLSL.parseUniforms(o),d=0;d<h.length;d++){var g=h[d];g.type==="sampler2D"?this.setTextureUniform(g.name,g.value):this.uniform(g.method,g.name,g.value)}}}},{key:"saveUniforms",value:function(o){var s=o||this.uniforms;for(var h in s){var d=this.uniforms[h];d&&(d.saved_value=d.value)}this.saved_texture_unit=this.texture_unit||0}},{key:"restoreUniforms",value:function(o){var s=o||this.uniforms;for(var h in s){var d=this.uniforms[h];d&&d.saved_value&&(d.value=d.saved_value,this.updateUniform(d))}this.texture_unit=this.saved_texture_unit||0}},{key:"setTextureUniform",value:function(o,s){var h=this.textureManager.textures[s];h!=null?(h.bind(this.texture_unit),this.uniform("1i",o,this.texture_unit),this.texture_unit++):log("warn","Cannot find texture '".concat(s,"'"))}},{key:"uniform",value:function(o,s,h){if(this.compiled){this.uniforms[s]=this.uniforms[s]||{};var d=this.uniforms[s];d.name=s,d.location===void 0&&(d.location=this.gl.getUniformLocation(this.program,s)),d.method=o,d.value=h,this.updateUniform(d)}}},{key:"updateUniform",value:function(o){this.compiled&&o&&o.location!=null&&(this.use(),this.commitUniform(o))}},{key:"commitUniform",value:function(o){var s=o.location,h=o.value;switch(o.method){case"1i":this.gl.uniform1i(s,h);break;case"1f":this.gl.uniform1f(s,h);break;case"2f":this.gl.uniform2f(s,h[0],h[1]);break;case"3f":this.gl.uniform3f(s,h[0],h[1],h[2]);break;case"4f":this.gl.uniform4f(s,h[0],h[1],h[2],h[3]);break;case"1iv":this.gl.uniform1iv(s,h);break;case"3iv":this.gl.uniform3iv(s,h);break;case"1fv":this.gl.uniform1fv(s,h);break;case"2fv":this.gl.uniform2fv(s,h);break;case"3fv":this.gl.uniform3fv(s,h);break;case"4fv":this.gl.uniform4fv(s,h);break;case"Matrix3fv":this.gl.uniformMatrix3fv(s,!1,h);break;case"Matrix4fv":this.gl.uniformMatrix4fv(s,!1,h)}}},{key:"refreshUniforms",value:function(){if(this.compiled)for(var o in this.uniforms){var s=this.uniforms[o];s.location=this.gl.getUniformLocation(this.program,o),this.updateUniform(s)}}},{key:"refreshAttributes",value:function(){this.attribs={}}},{key:"attribute",value:function(o){if(this.compiled){var s=this.attribs[o]=this.attribs[o]||{};return s.location!=null||(s.name=o,s.location=this.gl.getAttribLocation(this.program,o)),s}}},{key:"source",value:function(o){return o==="vertex"?this.computed_vertex_source:o==="fragment"?this.computed_fragment_source:void 0}},{key:"lines",value:function(o){var s=this.source(o);return s?s.split(`
`):[]}},{key:"line",value:function(o,s){var h=this.lines(o);if(h)return h[s]}},{key:"block",value:function(o,s){for(var h,d=this.lines(o),g=0;g<s&&g<d.length;g++){var _=d[g],j=_.match(/\/\/ tangram-block-start: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/);j&&j.length>1?h={scope:j[1],name:j[2],num:j[3]}:(j=_.match(/\/\/ tangram-block-end: ([A-Za-z0-9_-]+), ([A-Za-z0-9_-]+), (\d+)/))&&j.length>1&&(h=null),h&&(h.line=h.line==null?-1:h.line+1,h.source=_)}return h}},{key:"checkExtensions",value:function(){var o=this,s=[];return this.extensions.forEach(function(h){var d=getExtension(o.gl,h),g="TANGRAM_EXTENSION_".concat(h);o.defines[g]=d!=null,d?s.push(h):log("debug","Could not enable extension '".concat(h,"'"))}),s}}])}();ShaderProgram.polyfills={},ShaderProgram.id=0,ShaderProgram.current=null,ShaderProgram.defines={},ShaderProgram.blocks={},ShaderProgram.reset=function(){ShaderProgram.programs_by_source={},ShaderProgram.shaders_by_source={}},ShaderProgram.reset(),ShaderProgram.buildDefineString=function(e){var o="";for(var s in e)e[s]!=null&&e[s]!==!1&&(typeof e[s]=="boolean"&&e[s]===!0?o+="#define "+s+`
`:typeof e[s]=="number"&&Math.floor(e[s])===e[s]?o+="#define "+s+" "+e[s].toFixed(1)+`
`:o+="#define "+s+" "+e[s]+`
`);return o},ShaderProgram.buildExtensionString=function(e){var o="";return(e=e||[]).forEach(function(s){o+="#ifdef GL_".concat(s,`
#extension GL_`).concat(s,` : enable
#endif
`)}),o},ShaderProgram.addBlock=function(e){var o;ShaderProgram.blocks[e]=ShaderProgram.blocks[e]||[];for(var s=arguments.length,h=new Array(s>1?s-1:0),d=1;d<s;d++)h[d-1]=arguments[d];(o=ShaderProgram.blocks[e]).push.apply(o,h)},ShaderProgram.removeBlock=function(e){ShaderProgram.blocks[e]=[]},ShaderProgram.replaceBlock=function(e){ShaderProgram.removeBlock(e);for(var o=arguments.length,s=new Array(o>1?o-1:0),h=1;h<o;h++)s[h-1]=arguments[h];ShaderProgram.addBlock.apply(ShaderProgram,[e].concat(s))},ShaderProgram.updateProgram=function(e,o,s,h){var d=hashString(e._tangram_id+"::"+s+"::"+h);if(ShaderProgram.programs_by_source[d])return log("trace","Reusing identical source GL program object"),ShaderProgram.programs_by_source[d];var g=ShaderProgram.createShader(e,s,e.VERTEX_SHADER),_=ShaderProgram.createShader(e,h,e.FRAGMENT_SHADER);if(e.useProgram(null),o!=null)for(var j=e.getAttachedShaders(o),$=0;$<j.length;$++)e.detachShader(o,j[$]);else o=e.createProgram();if(g==null||_==null)return o;if(e.attachShader(o,g),e.attachShader(o,_),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS)){var _t=new Error(`WebGL program error:
            VALIDATE_STATUS: `.concat(e.getProgramParameter(o,e.VALIDATE_STATUS),`
            ERROR: `).concat(e.getError(),`
            --- Vertex Shader ---
            `).concat(s,`
            --- Fragment Shader ---
            `).concat(h));throw Object.assign(new Error(_t),{type:"program"})}return ShaderProgram.programs_by_source[d]=o,o},ShaderProgram.createShader=function(e,o,s){var h=hashString(e._tangram_id+"::"+o);if(ShaderProgram.shaders_by_source[h])return log("trace","Reusing identical source GL shader object"),ShaderProgram.shaders_by_source[h];var d=e.createShader(s);if(e.shaderSource(d,o),e.compileShader(d),!e.getShaderParameter(d,e.COMPILE_STATUS)){var g=s===e.VERTEX_SHADER?"vertex":"fragment",_=e.getShaderInfoLog(d),j=parseShaderErrors(_);throw Object.assign(new Error(_),{type:g,errors:j})}return ShaderProgram.shaders_by_source[h]=d,d};var VertexArrayObject={disabled:!1,bound_vao:[],init:function(e){var o;this.disabled!==!0&&(o=getExtension(e,"OES_vertex_array_object")),o!=null?log("info","Vertex Array Object extension available"):this.disabled!==!0?log("warn","Vertex Array Object extension NOT available"):log("warn","Vertex Array Object extension force disabled")},create:function(e,o,s){var h={};h.setup=o,h.teardown=s;var d=getExtension(e,"OES_vertex_array_object");return d!=null&&(h._vao=d.createVertexArrayOES(),d.bindVertexArrayOES(h._vao)),h.setup(!0),h},getCurrentBinding:function(e){var o=this.bound_vao.filter(function(s){return s[0]===e})[0];return o&&o[1]},setCurrentBinding:function(e,o){var s=this.bound_vao,h=s.filter(function(d){return d[0]===e})[0];h==null?s.push([e,o]):h[1]=o},bind:function(e,o){var s=getExtension(e,"OES_vertex_array_object");if(o!=null)s!=null&&o._vao!=null?(s.bindVertexArrayOES(o._vao),this.setCurrentBinding(e,o)):o.setup(!1);else{var h=this.getCurrentBinding(e);s!=null?s.bindVertexArrayOES(null):h!=null&&typeof h.teardown=="function"&&h.teardown(),this.setCurrentBinding(e,null)}},destroy:function(e,o){var s=getExtension(e,"OES_vertex_array_object");s!=null&&o!=null&&o._vao!=null&&(s.deleteVertexArrayOES(o._vao),o._vao=null)}},VBOMesh=function(){return _createClass(function e(o,s,h,d,g,_){_classCallCheck(this,e),_=_||{},this.textureManager=getTextureManager(g),this.gl=o,this.vertex_data=s,this.element_data=h,this.vertex_layout=d,this.vertex_buffer=this.gl.createBuffer(),this.buffer_size=this.vertex_data.byteLength,this.draw_mode=_.draw_mode||this.gl.TRIANGLES,this.data_usage=_.data_usage||this.gl.STATIC_DRAW,this.vertices_per_geometry=3,this.uniforms=_.uniforms,this.textures=_.textures,this.retain=_.retain||!1,this.created_at=+new Date,this.fade_in_time=_.fade_in_time||0,this.vertex_count=this.vertex_data.byteLength/this.vertex_layout.stride,this.element_count=0,this.vaos={},this.toggle_element_array=!1,this.element_data?(this.toggle_element_array=!0,this.element_count=this.element_data.length,this.geometry_count=this.element_count/this.vertices_per_geometry,this.element_type=this.element_data.constructor===Uint16Array?this.gl.UNSIGNED_SHORT:this.gl.UNSIGNED_INT,this.element_buffer=this.gl.createBuffer(),this.buffer_size+=this.element_data.byteLength,this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.element_buffer),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.element_data,this.data_usage)):this.geometry_count=this.vertex_count/this.vertices_per_geometry,this.upload(),this.retain||(delete this.vertex_data,delete this.element_data),this.valid=!0},[{key:"render",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.valid)return!1;var o=e.program||ShaderProgram.current;o.use(),this.uniforms&&(o.saveUniforms(this.uniforms),o.setUniforms(this.uniforms,!1));var s=(+new Date-this.created_at)/1e3;return o.uniform("1f","u_visible_time",s),this.bind(o),this.toggle_element_array?this.gl.drawElements(this.draw_mode,this.element_count,this.element_type,0):this.gl.drawArrays(this.draw_mode,0,this.vertex_count),VertexArrayObject.bind(this.gl,null),this.uniforms&&o.restoreUniforms(this.uniforms),s<this.fade_in_time}},{key:"bind",value:function(e){var o=this,s=this.vaos[e.id];s?VertexArrayObject.bind(this.gl,s):this.vaos[e.id]=VertexArrayObject.create(this.gl,function(h){o.gl.bindBuffer(o.gl.ARRAY_BUFFER,o.vertex_buffer),o.toggle_element_array&&o.gl.bindBuffer(o.gl.ELEMENT_ARRAY_BUFFER,o.element_buffer),o.vertex_layout.enable(o.gl,e,h)})}},{key:"upload",value:function(){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertex_buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertex_data,this.data_usage)}},{key:"destroy",value:function(){var e=this;if(!this.valid)return!1;for(var o in this.valid=!1,this.vaos)VertexArrayObject.destroy(this.gl,this.vaos[o]);return this.gl.deleteBuffer(this.vertex_buffer),this.vertex_buffer=null,this.element_buffer&&(this.gl.deleteBuffer(this.element_buffer),this.element_buffer=null),delete this.vertex_data,delete this.element_data,this.textures&&this.textures.forEach(function(s){return e.textureManager.release(s)}),!0}}])}(),shaderSrc_material=`/*Defines globals:materiallight_accumulator_**/struct Material{
#ifdef TANGRAM_MATERIAL_EMISSION
vec4 emission;
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE
vec3 emissionScale;
#endif
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT
vec4 ambient;
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE
vec3 ambientScale;
#endif
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE
vec4 diffuse;
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE
vec3 diffuseScale;
#endif
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR
vec4 specular;float shininess;
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE
vec3 specularScale;
#endif
#endif
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE
vec3 normalScale;float normalAmount;
#endif
};uniform Material u_material;Material material;
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE
uniform sampler2D u_material_emission_texture;
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE
uniform sampler2D u_material_ambient_texture;
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE
uniform sampler2D u_material_diffuse_texture;
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE
uniform sampler2D u_material_specular_texture;
#endif
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE
uniform sampler2D u_material_normal_texture;
#endif
vec4 light_accumulator_ambient=vec4(vec3(0.0),1.);vec4 light_accumulator_diffuse=vec4(vec3(0.0),1.);
#ifdef TANGRAM_MATERIAL_SPECULAR
vec4 light_accumulator_specular=vec4(vec3(0.0),1.);
#endif
#ifdef TANGRAM_MATERIAL_TEXTURE_SPHEREMAP
vec4 getSphereMap(in sampler2D _tex,in vec3 _eyeToPoint,in vec3 _normal,in vec2 _skew){vec3 eye=normalize(_eyeToPoint);eye.xy-=_skew;eye=normalize(eye);vec3 r=reflect(eye,_normal);r.z+=1.0;float m=2.*length(r);vec2 uv=r.xy/m+.5;return texture2D(_tex,uv);}
#endif
#ifdef TANGRAM_MATERIAL_TEXTURE_TRIPLANAR
vec3 getTriPlanarBlend(in vec3 _normal){vec3 blending=abs(_normal);blending=normalize(max(blending,0.00001));float b=(blending.x+blending.y+blending.z);return blending/b;}vec4 getTriPlanar(in sampler2D _tex,in vec3 _pos,in vec3 _normal,in vec3 _scale){vec3 blending=getTriPlanarBlend(_normal);vec4 xaxis=texture2D(_tex,fract(_pos.yz*_scale.x));vec4 yaxis=texture2D(_tex,fract(_pos.xz*_scale.y));vec4 zaxis=texture2D(_tex,fract(_pos.xy*_scale.z));return xaxis*blending.x+yaxis*blending.y+zaxis*blending.z;}
#endif
#ifdef TANGRAM_MATERIAL_TEXTURE_PLANAR
vec4 getPlanar(in sampler2D _tex,in vec3 _pos,in vec2 _scale){return texture2D(_tex,fract(_pos.xy*_scale.x));}
#endif
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE
void calculateNormal(inout vec3 _normal){
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_UV
_normal+=texture2D(u_material_normal_texture,fract(v_texcoord*material.normalScale.xy)).rgb*2.0-1.0;
#endif
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_PLANAR
vec3 normalTex=getPlanar(u_material_normal_texture,v_world_position.xyz,material.normalScale.xy).rgb*2.0-1.0;_normal+=normalTex;
#endif
#ifdef TANGRAM_MATERIAL_NORMAL_TEXTURE_TRIPLANAR
vec3 normalTex=getTriPlanar(u_material_normal_texture,v_world_position.xyz,_normal,material.normalScale).rgb*2.0-1.0;_normal+=normalTex;
#endif
_normal=normalize(_normal);}
#endif
void calculateMaterial(in vec3 _eyeToPoint,inout vec3 _normal){
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_UV
material.emission*=texture2D(u_material_emission_texture,v_texcoord);
#endif
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_PLANAR
material.emission*=getPlanar(u_material_emission_texture,v_world_position.xyz,material.emissionScale.xy);
#endif
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_TRIPLANAR
material.emission*=getTriPlanar(u_material_emission_texture,v_world_position.xyz,_normal,material.emissionScale);
#endif
#ifdef TANGRAM_MATERIAL_EMISSION_TEXTURE_SPHEREMAP
material.emission*=getSphereMap(u_material_emission_texture,_eyeToPoint,_normal,u_center_offset);
#endif
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_UV
material.ambient*=texture2D(u_material_ambient_texture,v_texcoord);
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_PLANAR
material.ambient*=getPlanar(u_material_ambient_texture,v_world_position.xyz,material.ambientScale.xy);
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_TRIPLANAR
material.ambient*=getTriPlanar(u_material_ambient_texture,v_world_position.xyz,_normal,material.ambientScale);
#endif
#ifdef TANGRAM_MATERIAL_AMBIENT_TEXTURE_SPHEREMAP
material.ambient*=getSphereMap(u_material_ambient_texture,_eyeToPoint,_normal,u_center_offset);
#endif
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_UV
material.diffuse*=texture2D(u_material_diffuse_texture,v_texcoord);
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_PLANAR
material.diffuse*=getPlanar(u_material_diffuse_texture,v_world_position.xyz,material.diffuseScale.xy);
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_TRIPLANAR
material.diffuse*=getTriPlanar(u_material_diffuse_texture,v_world_position.xyz,_normal,material.diffuseScale);
#endif
#ifdef TANGRAM_MATERIAL_DIFFUSE_TEXTURE_SPHEREMAP
material.diffuse*=getSphereMap(u_material_diffuse_texture,_eyeToPoint,_normal,u_center_offset);
#endif
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_UV
material.specular*=texture2D(u_material_specular_texture,v_texcoord);
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_PLANAR
material.specular*=getPlanar(u_material_specular_texture,v_world_position.xyz,material.specularScale.xy);
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_TRIPLANAR
material.specular*=getTriPlanar(u_material_specular_texture,v_world_position.xyz,_normal,material.specularScale);
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR_TEXTURE_SPHEREMAP
material.specular*=getSphereMap(u_material_specular_texture,_eyeToPoint,_normal,u_center_offset);
#endif
#endif
}`,material_props=["emission","ambient","diffuse","specular"],Material=function(){function e(o){var s=this;_classCallCheck(this,e),o=o||{},material_props.forEach(function(h){var d=o[h];d!=null&&(d.texture?s[h]={texture:d.texture,mapping:d.mapping||"spheremap",scale:GLSL.expandVec3(d.scale!=null?d.scale:1),amount:GLSL.expandVec4(d.amount!=null?d.amount:1)}:typeof d=="number"||Array.isArray(d)?s[h]={amount:GLSL.expandVec4(d)}:s[h]=typeof d=="string"?{amount:StyleParser.parseColor(d)}:d)}),this.specular&&(this.specular.shininess=o.shininess?parseFloat(o.shininess):.2),o.normal!=null&&(this.normal={texture:o.normal.texture,mapping:o.normal.mapping||"triplanar",scale:GLSL.expandVec3(o.normal.scale!=null?o.normal.scale:1),amount:o.normal.amount!=null?o.normal.amount:1})}return _createClass(e,[{key:"inject",value:function(o){var s=this;material_props.forEach(function(h){var d="TANGRAM_MATERIAL_".concat(h.toUpperCase()),g=d+"_TEXTURE";o.defines[d]=s[h]!=null,s[h]&&s[h].texture&&(o.defines[g]=!0,o.defines[g+"_"+s[h].mapping.toUpperCase()]=!0,o.defines["TANGRAM_MATERIAL_TEXTURE_".concat(s[h].mapping.toUpperCase())]=!0,o.texcoords=o.texcoords||s[h].mapping==="uv")}),this.normal&&this.normal.texture&&(o.defines.TANGRAM_MATERIAL_NORMAL_TEXTURE=!0,o.defines["TANGRAM_MATERIAL_NORMAL_TEXTURE_"+this.normal.mapping.toUpperCase()]=!0,o.defines["TANGRAM_MATERIAL_TEXTURE_".concat(this.normal.mapping.toUpperCase())]=!0,o.texcoords=o.texcoords||this.normal.mapping==="uv"),o.replaceShaderBlock(e.block,shaderSrc_material,"Material"),o.addShaderBlock("setup",`
material = u_material;
`,"Material")}},{key:"setupProgram",value:function(o){var s=this;material_props.forEach(function(h){s[h]&&(s[h].texture?(o.setTextureUniform("u_material_".concat(h,"_texture"),s[h].texture),o.uniform("3fv","u_material.".concat(h,"Scale"),s[h].scale),o.uniform("4fv","u_material.".concat(h),s[h].amount)):s[h].amount&&o.uniform("4fv","u_material.".concat(h),s[h].amount))}),this.specular&&o.uniform("1f","u_material.shininess",this.specular.shininess),this.normal&&this.normal.texture&&(o.setTextureUniform("u_material_normal_texture",this.normal.texture),o.uniform("3fv","u_material.normalScale",this.normal.scale),o.uniform("1f","u_material.normalAmount",this.normal.amount))}}],[{key:"isValid",value:function(o){return o!=null&&(o.emission!=null||o.ambient!=null||o.diffuse!=null||o.specular!=null)}}])}(),Vector;Material.block="material";var Vector$1=Vector={};Vector.copy=function(e){for(var o=[],s=e.length,h=0;h<s;h++)o[h]=e[h];return o},Vector.neg=function(e){for(var o=[],s=e.length,h=0;h<s;h++)o[h]=-e[h];return o},Vector.add=function(e,o){for(var s=[],h=Math.min(e.length,o.length),d=0;d<h;d++)s[d]=e[d]+o[d];return s},Vector.sub=function(e,o){for(var s=[],h=Math.min(e.length,o.length),d=0;d<h;d++)s[d]=e[d]-o[d];return s},Vector.signed_area=function(e,o,s){return(o[0]-e[0])*(s[1]-e[1])-(s[0]-e[0])*(o[1]-e[1])},Vector.mult=function(e,o){var s,h=[],d=e.length;if(typeof o=="number")for(s=0;s<d;s++)h[s]=e[s]*o;else for(d=Math.min(e.length,o.length),s=0;s<d;s++)h[s]=e[s]*o[s];return h},Vector.multMatrix=function(e,o){return[e[0][0]*o[0]+e[0][1]*o[1],e[1][0]*o[0]+e[1][1]*o[1]]},Vector.div=function(e,o){var s,h=[];if(typeof o=="number")for(s=0;s<e.length;s++)h[s]=e[s]/o;else{var d=Math.min(e.length,o.length);for(s=0;s<d;s++)h[s]=e[s]/o[s]}return h},Vector.perp=function(e,o){return[o[1]-e[1],e[0]-o[0]]},Vector.rot=function(e,o){var s=Math.cos(o),h=Math.sin(o);return[e[0]*s-e[1]*h,e[0]*h+e[1]*s]},Vector.angle=function(e){var o=_slicedToArray(e,2),s=o[0],h=o[1];return Math.atan2(h,s)},Vector.angleBetween=function(e,o){var s=Vector.dot(Vector.normalize(Vector.copy(e)),Vector.normalize(Vector.copy(o)));return s>1&&(s=1),Math.acos(s)},Vector.signedAngleBetween=function(e,o){return Math.atan2(e[0]*o[1]-e[1]*o[0],e[0]*o[0]+e[1]*o[1])},Vector.isEqual=function(e,o){for(var s=e.length,h=0;h<s;h++)if(e[h]!==o[h])return!1;return!0},Vector.lengthSq=function(e){return e.length===2?e[0]*e[0]+e[1]*e[1]:e.length>=3?e[0]*e[0]+e[1]*e[1]+e[2]*e[2]:0},Vector.length=function(e){return Math.sqrt(Vector.lengthSq(e))},Vector.normalize=function(e){var o;if(e.length===2){if((o=e[0]*e[0]+e[1]*e[1])===1)return e;(o=Math.sqrt(o))!==0?(e[0]/=o,e[1]/=o):(e[0]=0,e[1]=0)}else if(e.length>=3){if((o=e[0]*e[0]+e[1]*e[1]+e[2]*e[2])===1)return e;(o=Math.sqrt(o))!==0?(e[0]/=o,e[1]/=o,e[2]/=o):(e[0]=0,e[1]=0,e[2]=0)}return e},Vector.cross=function(e,o){return e.length===2?e[0]*o[1]-e[1]*o[0]:e.length===3?[e[1]*o[2]-e[2]*o[1],e[2]*o[0]-e[0]*o[2],e[0]*o[1]-e[1]*o[0]]:void 0},Vector.dot=function(e,o){for(var s=0,h=Math.min(e.length,o.length),d=0;d<h;d++)s+=e[d]*o[d];return s};var shaderSrc_ambientLight="/*Expected globals:light_accumulator_**/struct AmbientLight{vec3 ambient;};void calculateLight(in AmbientLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;}",shaderSrc_directionalLight=`/*Expected globals:materiallight_accumulator_**/struct DirectionalLight{vec3 ambient;vec3 diffuse;vec3 specular;vec3 direction;};void calculateLight(in DirectionalLight _light,in vec3 _eyeToPoint,in vec3 _normal){light_accumulator_ambient.rgb+=_light.ambient;float nDotVP=clamp(dot(_normal,-_light.direction),0.0,1.0);
#ifdef TANGRAM_MATERIAL_DIFFUSE
light_accumulator_diffuse.rgb+=_light.diffuse*nDotVP;
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR
float pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(_light.direction,_normal);float eyeDotR=max(dot(normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf;
#endif
}`,shaderSrc_pointLight=`/*Expected globals:materiallight_accumulator_**/struct PointLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT
float attenuationExponent;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
float innerRadius;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float outerRadius;
#endif
};void calculateLight(in PointLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(VP,_normal),0.0,1.0);float attenuation=1.0;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT
float Rin=1.0;float e=_light.attenuationExponent;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
Rin=_light.innerRadius;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));
#else
float d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);
#endif
#else
float Rin=0.0;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
Rin=_light.innerRadius;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;
#else
float d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);
#endif
#else
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;
#else
attenuation=1.0;
#endif
#endif
#endif
light_accumulator_ambient.rgb+=_light.ambient*attenuation;
#ifdef TANGRAM_MATERIAL_DIFFUSE
light_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation;
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR
float pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(0.0,dot(-normalize(_eyeToPoint),reflectVector));pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation;
#endif
}`,shaderSrc_spotLight=`/*Expected globals:materiallight_accumulator_**/struct SpotLight{vec3 ambient;vec3 diffuse;vec3 specular;vec4 position;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT
float attenuationExponent;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
float innerRadius;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float outerRadius;
#endif
vec3 direction;float spotCosCutoff;float spotExponent;};void calculateLight(in SpotLight _light,in vec3 _eyeToPoint,in vec3 _normal){float dist=length(_light.position.xyz-_eyeToPoint);vec3 VP=(_light.position.xyz-_eyeToPoint)/dist;float nDotVP=clamp(dot(_normal,VP),0.0,1.0);float attenuation=1.0;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT
float Rin=1.0;float e=_light.attenuationExponent;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
Rin=_light.innerRadius;
#endif
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-(pow(d,e));
#else
float d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/(pow(d,e)),0.0,1.0);
#endif
#else
float Rin=0.0;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS
Rin=_light.innerRadius;
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float Rdiff=_light.outerRadius-Rin;float d=clamp(max(0.0,dist-Rin)/Rdiff,0.0,1.0);attenuation=1.0-d*d;
#else
float d=max(0.0,dist-Rin)/Rin+1.0;attenuation=clamp(1.0/d,0.0,1.0);
#endif
#else
#ifdef TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS
float d=clamp(dist/_light.outerRadius,0.0,1.0);attenuation=1.0-d*d;
#else
attenuation=1.0;
#endif
#endif
#endif
float spotAttenuation=0.0;float spotDot=clamp(dot(-VP,_light.direction),0.0,1.0);if(spotDot>=_light.spotCosCutoff){spotAttenuation=pow(spotDot,_light.spotExponent);}light_accumulator_ambient.rgb+=_light.ambient*attenuation*spotAttenuation;
#ifdef TANGRAM_MATERIAL_DIFFUSE
light_accumulator_diffuse.rgb+=_light.diffuse*nDotVP*attenuation*spotAttenuation;
#endif
#ifdef TANGRAM_MATERIAL_SPECULAR
float pf=0.0;if(nDotVP>0.0){vec3 reflectVector=reflect(-VP,_normal);float eyeDotR=max(dot(-normalize(_eyeToPoint),reflectVector),0.0);pf=pow(eyeDotR,material.shininess);}light_accumulator_specular.rgb+=_light.specular*pf*attenuation*spotAttenuation;
#endif
}`,Light=function(){function e(o,s){_classCallCheck(this,e),this.name=s.name,this.view=o,s.ambient==null||typeof s.ambient=="number"?this.ambient=GLSL.expandVec3(s.ambient||0):this.ambient=StyleParser.parseColor(s.ambient).slice(0,3),s.diffuse==null||typeof s.diffuse=="number"?this.diffuse=GLSL.expandVec3(s.diffuse!=null?s.diffuse:1):this.diffuse=StyleParser.parseColor(s.diffuse).slice(0,3),s.specular==null||typeof s.specular=="number"?this.specular=GLSL.expandVec3(s.specular||0):this.specular=StyleParser.parseColor(s.specular).slice(0,3)}return _createClass(e,[{key:"inject",value:function(){var o=`
            uniform `.concat(this.struct_name," u_").concat(this.name,`;
            `).concat(this.struct_name," ").concat(this.name,`;
            `),s=`
            `.concat(this.name," = u_").concat(this.name,`;

        `);ShaderProgram.addBlock(e.block,o),ShaderProgram.addBlock("setup",s)}},{key:"update",value:function(){}},{key:"setupProgram",value:function(o){o.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient),o.uniform("3fv","u_".concat(this.name,".diffuse"),this.diffuse),o.uniform("3fv","u_".concat(this.name,".specular"),this.specular)}}],[{key:"create",value:function(o,s){if(e.types[s.type])return new e.types[s.type](o,s)}},{key:"setMode",value:function(o,s){o===!0&&(o="fragment"),o=e.enabled&&(o??"fragment"),s.defines.TANGRAM_LIGHTING_FRAGMENT=o==="fragment",s.defines.TANGRAM_LIGHTING_VERTEX=o==="vertex"}},{key:"inject",value:function(o){if(ShaderProgram.removeBlock(e.block),e.enabled){var s="";if(o&&Object.keys(o).length>0){var h={};for(var d in o)h[o[d].type]=!0;for(var g in h)e.types[g].inject();for(var _ in o)o[_].inject(),s+="calculateLight(".concat(_,`, _eyeToPoint, _normal);
`)}var j=`
            vec4 calculateLighting(in vec3 _eyeToPoint, in vec3 _normal, in vec4 _color) {

                // Do initial material calculations over normal, emission, ambient, diffuse and specular values
                calculateMaterial(_eyeToPoint,_normal);

                // Un roll the loop of individual ligths to calculate
                `.concat(s,`

                //  Final light intensity calculation
                vec4 color = vec4(vec3(0.), _color.a); // start with vertex color alpha

                #ifdef TANGRAM_MATERIAL_EMISSION
                    color.rgb = material.emission.rgb;
                    color.a *= material.emission.a;
                #endif

                #ifdef TANGRAM_MATERIAL_AMBIENT
                    color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.ambient.rgb;
                    color.a *= material.ambient.a;
                #else
                    #ifdef TANGRAM_MATERIAL_DIFFUSE
                        color.rgb += light_accumulator_ambient.rgb * _color.rgb * material.diffuse.rgb;
                    #endif
                #endif

                #ifdef TANGRAM_MATERIAL_DIFFUSE
                    color.rgb += light_accumulator_diffuse.rgb * _color.rgb * material.diffuse.rgb;
                    color.a *= material.diffuse.a;
                #endif

                #ifdef TANGRAM_MATERIAL_SPECULAR
                    color.rgb += light_accumulator_specular.rgb * material.specular.rgb;
                    color.a *= material.specular.a;
                #endif

                // Clamp final color
                color = clamp(color, 0.0, 1.0);

                return color;
            }`);ShaderProgram.addBlock(e.block,j)}}}])}();Light.types={},Light.block="lighting",Light.enabled=!0;var AmbientLight=function(e){function o(s,h){var d;return _classCallCheck(this,o),(d=_callSuper(this,o,[s,h])).type="ambient",d.struct_name="AmbientLight",d}return _inherits(o,e),_createClass(o,[{key:"setupProgram",value:function(s){s.uniform("3fv","u_".concat(this.name,".ambient"),this.ambient)}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_ambientLight)}}])}(Light);Light.types.ambient=AmbientLight;var DirectionalLight=function(e){function o(s,h){var d;if(_classCallCheck(this,o),(d=_callSuper(this,o,[s,h])).type="directional",d.struct_name="DirectionalLight",h.direction)d._direction=h.direction;else{var g=Math.sin(60*Math.PI/180);d._direction=[Math.cos(135*Math.PI/180)*g,Math.sin(135*Math.PI/180)*g,-.5]}return h.ambient==null&&(d.ambient=GLSL.expandVec3(.5)),d.direction=d._direction.map(parseFloat),d._initial_direction=[d.direction[0],d.direction[1],d.direction[2]],d}return _inherits(o,e),_createClass(o,[{key:"direction",get:function(){return this._direction},set:function(s){this._direction=Vector$1.normalize(Vector$1.copy(s))}},{key:"update",value:function(){vec3.transformMat4(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}},{key:"setupProgram",value:function(s){_get(_getPrototypeOf(o.prototype),"setupProgram",this).call(this,s),s.uniform("3fv","u_".concat(this.name,".direction"),this.direction)}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_directionalLight)}}])}(Light);Light.types.directional=DirectionalLight;var PointLight=function(e){function o(s,h){var d;return _classCallCheck(this,o),(d=_callSuper(this,o,[s,h])).type="point",d.struct_name="PointLight",d.position=h.position||[0,0,"100px"],d.position_eye=[],d.origin=h.origin||"ground",d.attenuation=isNaN(parseFloat(h.attenuation))?0:parseFloat(h.attenuation),h.radius?Array.isArray(h.radius)&&h.radius.length===2?d.radius=h.radius:d.radius=[null,h.radius]:d.radius=null,d}return _inherits(o,e),_createClass(o,[{key:"inject",value:function(){_get(_getPrototypeOf(o.prototype),"inject",this).call(this),ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT=this.attenuation!==0,ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS=this.radius!=null&&this.radius[0]!=null,ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS=this.radius!=null}},{key:"update",value:function(){var s=this.view.lookAtManipulator.getLookAtData().zoom;if(this.origin==="world"){var h=_slicedToArray(Geo$1.latLngToMeters(this.position),2),d=h[0],g=h[1];this.position_eye[0]=d-this.view.lookAtManipulator.getLookAtData().position[0],this.position_eye[1]=g-this.view.lookAtManipulator.getLookAtData().position[1],this.position_eye[2]=StyleParser.convertUnits(this.position[2],{zoom:s,meters_per_pixel:Geo$1.metersPerPixel(s)}),this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance}else this.origin!=="ground"&&this.origin!=="camera"||(this.position_eye=StyleParser.convertUnits(this.position,{zoom:s,meters_per_pixel:Geo$1.metersPerPixel(s)}),this.origin==="ground"&&(this.position_eye[2]=this.position_eye[2]-this.view.lookAtManipulator.getLookAtData().distance));this.position_eye[3]=1}},{key:"setupProgram",value:function(s){_get(_getPrototypeOf(o.prototype),"setupProgram",this).call(this,s),s.uniform("4fv","u_".concat(this.name,".position"),this.position_eye),ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_EXPONENT&&s.uniform("1f","u_".concat(this.name,".attenuationExponent"),this.attenuation);var h=this.view.lookAtManipulator.getLookAtData().zoom;ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_INNER_RADIUS&&s.uniform("1f","u_".concat(this.name,".innerRadius"),StyleParser.convertUnits(this.radius[0],{zoom:h,meters_per_pixel:Geo$1.metersPerPixel(h)})),ShaderProgram.defines.TANGRAM_POINTLIGHT_ATTENUATION_OUTER_RADIUS&&s.uniform("1f","u_".concat(this.name,".outerRadius"),StyleParser.convertUnits(this.radius[1],{zoom:h,meters_per_pixel:Geo$1.metersPerPixel(h)}))}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_pointLight)}}])}(Light);Light.types.point=PointLight;var SpotLight=function(e){function o(s,h){var d;return _classCallCheck(this,o),(d=_callSuper(this,o,[s,h])).type="spotlight",d.struct_name="SpotLight",d.direction=d._direction=(h.direction||[0,0,-1]).map(parseFloat),d._initial_direction=[d.direction[0],d.direction[1],d.direction[2]],d.exponent=h.exponent?parseFloat(h.exponent):.2,d.angle=h.angle?parseFloat(h.angle):20,d}return _inherits(o,e),_createClass(o,[{key:"direction",get:function(){return this._direction},set:function(s){this._direction=Vector$1.normalize(Vector$1.copy(s))}},{key:"setupProgram",value:function(s){_get(_getPrototypeOf(o.prototype),"setupProgram",this).call(this,s),s.uniform("3fv","u_".concat(this.name,".direction"),this.direction),s.uniform("1f","u_".concat(this.name,".spotCosCutoff"),Math.cos(3.14159*this.angle/180)),s.uniform("1f","u_".concat(this.name,".spotExponent"),this.exponent)}},{key:"update",value:function(){_get(_getPrototypeOf(o.prototype),"update",this).call(this),vec3.transformMat4(this.direction,this._initial_direction,this.view.lookAtManipulator.getTransformationMatrix())}}],[{key:"inject",value:function(){ShaderProgram.addBlock(Light.block,shaderSrc_spotLight)}}])}(PointLight);function mergeObjects(e){for(var o=0;o<(arguments.length<=1?0:arguments.length-1);o++){var s=o+1<1||arguments.length<=o+1?void 0:arguments[o+1];if(s)for(var h in s){var d=s[h];d===null||_typeof(d)!=="object"||Array.isArray(d)?d!==void 0&&(e[h]=d):e[h]===null||_typeof(e[h])!=="object"||Array.isArray(e[h])?e[h]=mergeObjects({},d):e[h]=mergeObjects(e[h],d)}}return e}Light.types.spotlight=SpotLight;var shaderSrc_selectionFragment=`
#ifdef TANGRAM_FEATURE_SELECTION
varying vec4 v_selection_color;
#endif
void main(void){
#ifdef TANGRAM_FEATURE_SELECTION
gl_FragColor=v_selection_color;
#else
gl_FragColor=vec4(0.,0.,0.,1.);
#endif
}`,shaderSrc_selectionCropFragment=`
#pragma tangram: utils
#ifdef TANGRAM_FEATURE_SELECTION
uniform float u_meters_per_pixel;varying vec4 v_selection_color;varying vec4 v_local_space_position;
#endif
void main(void){
#ifdef TANGRAM_FEATURE_SELECTION
if(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}else{gl_FragColor=v_selection_color;}
#else
gl_FragColor=vec4(0.,0.,0.,1.);
#endif
}`,shaderSrc_rasters=`#ifdef TANGRAM_FRAGMENT_SHADER
uniform sampler2D u_raster;uniform vec3 u_raster_offset;
#define sampleRaster() (texture2D(u_raster, v_modelpos_base_zoom.xy * u_raster_offset.z + u_raster_offset.xy))
#endif
`,Style={init:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=e.generation,s=e.styles,h=e.sources,d=h===void 0?{}:h,g=e.introspection,_=e.id,j=_!==void 0?_+"/":"";this.scene_id=_,this.textureManager=getTextureManager(_),this.main_thread_target="".concat(j,"Style/").concat(this.name),this.setGeneration(o),this.styles=s,this.sources=d,this.defines=this.hasOwnProperty("defines")&&this.defines||{},this.shaders=this.hasOwnProperty("shaders")&&this.shaders||{},this.introspection=g||!1,this.selection=this.selection||this.introspection||!1,this.compile_setup=!1,this.program=null,this.selection_program=null,this.feature_style={},this.vertex_template=[],this.tile_data={},this.defines.TANGRAM_WORLD_POSITION_WRAP=1e5,this.blend=this.blend||"opaque",this.defines["TANGRAM_BLEND_".concat(this.blend.toUpperCase())]=!0,this.blend_order==null&&(this.blend_order=-1),this.removeShaderBlock("setup"),this.material instanceof Material||(Material.isValid(this.material)||(this.material=StyleParser.defaults.material),this.material=new Material(this.material)),this.material.inject(this),Light.setMode(this.lighting,this),this.setupRasters(),this.initialized=!0},destroy:function(){this.program&&(this.program.destroy(),this.program=null),this.selection_program&&(this.selection_program.destroy(),this.selection_program=null),WorkerBroker.removeTarget(this.main_thread_target),this.gl=null,this.initialized=!1},reset:function(){},baseStyle:function(){return this.base||this.name},setGeneration:function(e){this.generation=e,Thread.is_main&&WorkerBroker.addTarget(this.main_thread_target,this)},fillVertexTemplate:function(e,o,s,h){var d=h.size,g=h.offset;g=g===void 0?0:g;var _=e.index[o];if(_!==void 0)for(var j=0;j<d;++j){var $=s.length>j?s[j]:s;this.vertex_template[_+j+g]=$}else log("warn","Style: in style '".concat(this.name,"', no index found in vertex layout for attribute '").concat(o,"'"))},startData:function(e){this.tile_data[e.id]=this.tile_data[e.id]||{meshes:{},uniforms:{},textures:[]}},endData:function(e){var o=this.tile_data[e.id];if(this.tile_data[e.id]=null,o&&Object.keys(o.meshes).length>0){for(var s in o.meshes){var h=o.meshes[s];h.vertex_data.vertex_count!==0?(h.vertex_data.end(),h.vertex_elements=h.vertex_data.element_buffer,h.vertex_data=h.vertex_data.vertex_buffer):delete o.meshes[s]}return e.mesh_data[this.name]=o,this.buildRasterTextures(e,o).then(function(d){return d})}return Promise.resolve(null)},hasDataForTile:function(e){return this.tile_data[e.id]!=null},getTileMesh:function(e,o){var s=this.tile_data[e.id].meshes;return s[o.key]==null&&(s[o.key]={variant:o,vertex_data:this.vertexLayoutForMeshVariant(o).createVertexData()}),s[o.key]},vertexLayoutForMeshVariant:function(e){return this.vertex_layout},default_mesh_variant:{key:0},style_mesh_variants:{default:{variants:{0:{variant:{key:0},times_unref:0}}}},addMeshVariantForDraw:function(e,o){this.style_mesh_variants[e]||(this.style_mesh_variants[e]={variants:{}});var s=this.computeVariantForDraw(o);return this.style_mesh_variants[e].variants[s.key]={variant:s,times_unref:0},this.style_mesh_variants[e].variants[s.key].variant},getMeshVariantTypeForDraw:function(e){return this.getMeshVariantType(this.base,e)},getMeshVariantType:function(e,o){e===void 0&&(e="default");var s=this.style_mesh_variants[e];if(o.variantKey===void 0||!s||!s.variants[o.variantKey])return this.addMeshVariantForDraw(e,o);var h=o.variantKey,d=s.variants[h];return d.times_unref=0,d.variant},updateMeshVariantTypeCache:function(e){for(var o in this.style_mesh_variants){var s=this.style_mesh_variants[o].variants;for(var h in s){var d=s[h];d.times_unref++,d.times_unref>e&&(o!=="default"||+h!=0)&&(delete s[h],Object.keys(s).length===0&&delete this.style_mesh_variants[o])}}},computeVariantForDraw:function(e){return this.default_mesh_variant},addFeature:function(e,o,s){var h=s.tile;this.tile_data[h.id]||this.startData(h);var d=this.parseFeature(e,o,s);if(d){var g=this.base==="lines"?this.getMeshVariantTypeForDraw(o):this.getMeshVariantTypeForDraw(d),_=this.getTileMesh(h,g),j=_.vertex_data.offset,$=_.vertex_data.vertex_count;this.buildGeometry(e.geometry,d,_,s)>0?e.generation=this.generation:_.vertex_data.vertex_count>$&&(_.vertex_data.vertex_buffer.fill(0,j,_.vertex_data.offset),_.vertex_data.vertex_count=$,_.vertex_data.offset=j)}},buildGeometry:function(e,o,s,h){var d;return e.type==="Polygon"?d=this.buildPolygons([e.coordinates],o,s,h):e.type==="MultiPolygon"?d=this.buildPolygons(e.coordinates,o,s,h):e.type==="LineString"?d=this.buildLines([e.coordinates],o,s,h):e.type==="MultiLineString"?d=this.buildLines(e.coordinates,o,s,h):e.type==="Point"?d=this.buildPoints([e.coordinates],o,s,h):e.type==="MultiPoint"&&(d=this.buildPoints(e.coordinates,o,s,h)),d},parseFeature:function(e,o,s){try{var h=this.feature_style;if(h.order=this.parseOrder(o.order,s),h.order==null&&this.blend!=="overlay"){var d="Layer '".concat(o.layers.join(", "),"', draw group '").concat(o.group,"': ");return d+="'order' parameter is required unless blend mode is 'overlay'",o.order!=null&&(d+="; 'order' was set to a dynamic value (e.g. string tied to feature property, ",d+="or JS function), but evaluated to null for one or more features"),void log({level:"warn",once:!0},d)}if(!(h=this._parseFeature(e,o,s)))return;if(this.selection?h.interactive=StyleParser.evalProperty(this.introspection||o.interactive,s):h.interactive=!1,h.interactive===!0){var g=FeatureSelection.makeEntry(),_=g.color,j=g.key;h.selection_color=_,s.tile.selection_data||(s.tile.selection_data={}),s.tile.selection_data[j]={id:e.id||j,properties:e.properties,source_name:s.source,source_layer:s.layer,layers:s.layers}}else h.selection_color=FeatureSelection.defaultColor;return h}catch($){log("error","Style.parseFeature: style parsing error",e,h,$.stack)}},_parseFeature:function(e,o,s){return this.feature_style},preprocess:function(e,o){if(!e.preprocessed){if(this.draw)for(var s in this.draw){var h=this.draw[s];_typeof(h)!=="object"||Array.isArray(h)?e[s]==null&&(e[s]=h):e[s]=mergeObjects({},h,e[s])}var d=o||"";if(!(e=this._preprocess(e,d)))return;e.preprocessed=!0}return e},_preprocess:function(e,o){return e},parseOrder:function(e,o){return typeof e!="number"?StyleParser.calculateOrder(e,o):e},scaleOrder:function(e){return 2*e},parseColor:function(e,o){return e?StyleParser.evalCachedColorProperty(e,o):this.shaders.blocks.color||this.shaders.blocks.filter?StyleParser.defaults.color:void 0},buildPolygons:function(){return 0},buildLines:function(){return 0},buildPoints:function(){return 0},setGL:function(e){this.gl=e,this.max_texture_size=this.textureManager.getMaxTextureSize(this.gl)},makeMesh:function(e,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=this.vertexLayoutForMeshVariant(s.variant);return new VBOMesh(this.gl,e,o,h,this.scene_id,s)},render:function(e){return e.render()},getProgram:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"program";this.compileSetup();var o=this[e];if(o&&!o.error){if(!o.compiled)try{o.compile()}catch(s){log("error","Style: error compiling program for style '".concat(this.name,"' (program key '").concat(e,"')"),this,s.stack)}return o}},compileSetup:function(){if(!this.compile_setup){if(!this.gl)throw new Error("style.compile(): skipping for ".concat(this.name," because no GL context"));var e=this.buildDefineList();if(this.selection){var o=Object.assign({},e);o.TANGRAM_FEATURE_SELECTION=!0}var s=this.shaders&&this.shaders.blocks,h=this.shaders&&this.shaders.block_scopes,d=Object.assign({},this.shaders&&this.shaders.uniforms);for(var g in d)d[g]==null&&log({level:"warn",once:!0},"Style '".concat(this.name,"' has invalid uniform '").concat(g,"': uniform values must be non-null"));var _=this.shaders&&this.shaders.extensions;typeof _=="string"&&(_=[_]),this.program=new ShaderProgram(this.gl,this.vertex_shader_src,this.fragment_shader_src,this.scene_id,{name:this.name,defines:e,uniforms:d,blocks:s,block_scopes:h,extensions:_}),this.selection?this.selection_program=new ShaderProgram(this.gl,this.vertex_shader_src,this.crop_by_tile?shaderSrc_selectionCropFragment:shaderSrc_selectionFragment,this.scene_id,{name:this.name+" (selection)",defines:o,uniforms:d,blocks:s,block_scopes:h,extensions:_}):this.selection_program=null,this.compile_setup=!0}},addShaderBlock:function(e,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.shaders.blocks=this.shaders.blocks||{},this.shaders.blocks[e]=this.shaders.blocks[e]||[],this.shaders.blocks[e].push(o),this.shaders.block_scopes=this.shaders.block_scopes||{},this.shaders.block_scopes[e]=this.shaders.block_scopes[e]||[],this.shaders.block_scopes[e].push(s)},removeShaderBlock:function(e){this.shaders.blocks&&(this.shaders.blocks[e]=null)},replaceShaderBlock:function(e,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;this.removeShaderBlock(e),this.addShaderBlock(e,o,s)},buildDefineList:function(){var e={};if(this.defines!=null)for(var o in this.defines)e[o]=this.defines[o];if(this.shaders!=null&&this.shaders.defines!=null)for(o in this.shaders.defines)e[o]=this.shaders.defines[o];return e},hasRasters:function(){return["color","normal","custom"].indexOf(this.raster)>-1},setupRasters:function(){if(!Thread.is_main||!this.hasRasters())return!1;this.raster==="color"?this.defines.TANGRAM_RASTER_TEXTURE_COLOR=!0:this.raster==="normal"&&(this.defines.TANGRAM_RASTER_TEXTURE_NORMAL=!0);var e=!1;for(var o in this.sources)if(this.sources[o]instanceof RasterTileSource){e=!0;break}return!!e&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",shaderSrc_rasters,"Raster"),!0)},buildRasterTextures:function(e,o){var s=this;if(!this.hasRasters())return Promise.resolve(o);var h={};return e.rasters.map(function(d){return s.sources[d]}).filter(function(d){return d}).forEach(function(d,g){if(d instanceof RasterTileSource){var _=d.tileTexture(e);h[_.url]=_}}),Object.keys(h).length===0?Promise.resolve(o):WorkerBroker.postMessage(this.main_thread_target+".loadTextures",h).then(function(d){if(!d||d.length<1)return log("trace","Missing texture info for tile ".concat(e.key)),null;if(d.some(function(_t){return!_t.loaded}))return null;o.uniforms=o.uniforms||{},o.textures=o.textures||[];var g=d[0].name,_=h[g].coords;if(o.uniforms.u_raster=g,o.textures.push(g),e.coords.z>_.z){var j=e.coords.z-_.z,$=Math.pow(2,j);o.uniforms.u_raster_offset=[(e.coords.x%$+$)%$/$,($-1-e.coords.y%$)/$,1/$]}else o.uniforms.u_raster_offset=[0,0,1];return o})},loadTextures:function(e){var o=this;return this.textureManager.createFromObject(this.gl,e).then(function(){return Promise.all(Object.keys(e).map(function(s){return o.textureManager.textures[s]&&o.textureManager.textures[s].load()}).filter(function(s){return s}))}).then(function(s){return s.forEach(function(h){return h.retain()}),s.map(function(h){return{name:h.name,width:h.width,height:h.height,loaded:h.loaded}})})},setup:function(){this.setUniforms(),this.material.setupProgram(ShaderProgram.current)},setUniforms:function(){var e=ShaderProgram.current;e&&e.setUniforms(this.shaders&&this.shaders.uniforms,!0)},render_states:{opaque:{depth_test:!0,depth_write:!0},translucent:{depth_test:!0,depth_write:!0},add:{depth_test:!0,depth_write:!1},multiply:{depth_test:!0,depth_write:!1},inlay:{depth_test:!0,depth_write:!1},overlay:{depth_test:!1,depth_write:!1}},default_blend_orders:{opaque:0,add:1,multiply:2,inlay:3,translucent:4,overlay:5},sortByBlendOrderWithinLayers:function(e){var o=[],s={};for(var h in e.forEach(function(d){var g=parseInt(d.name,10)||0;s[g]||(s[g]=[]),s[g].push(d)}),s)o.push.apply(o,_toConsumableArray(s[h].sort(Style.blendOrderSort)));return o},blendOrderSort:function(e,o){return e.blend==="opaque"||o.blend==="opaque"?e.blend==="opaque"&&o.blend==="opaque"?e.name<o.name?-1:1:e.blend==="opaque"?-1:1:e.blend_order<o.blend_order?-1:e.blend_order>o.blend_order?1:Style.default_blend_orders[e.blend]<Style.default_blend_orders[o.blend]?-1:Style.default_blend_orders[e.blend]>Style.default_blend_orders[o.blend]?1:e.name<o.name?-1:1}},id$1=0,build_id=0,Tile=function(){function e(o){var s=o.coords,h=o.style_zoom,d=o.source,g=o.worker,_=o.view,j=o.sceneId;_classCallCheck(this,e),this.textureManager=getTextureManager(j),this.id=id$1++,this.worker=g,this.view=_,this.source=d,this.generation=null,this.valid=!0,this.proxy_for=null,this.proxy_depth=0,this.proxied_as=null,this.fade_in=!0,this.loading=!1,this.loaded=!1,this.built=!1,this.labeled=!1,this.error=null,this.style_zoom=h,this.coords=e.normalizedCoordinate(s,this.source,this.style_zoom),this.key=e.key(this.coords,this.source,this.style_zoom),this.overzoom=Math.max(this.style_zoom-this.coords.z,0),this.overzoom2=Math.pow(2,this.overzoom),this.min=Geo$1.metersForTile(this.coords),this.max=Geo$1.metersForTile({x:this.coords.x+1,y:this.coords.y+1,z:this.coords.z}),this.span={x:this.max.x-this.min.x,y:this.max.y-this.min.y},this.bounds={sw:{x:this.min.x,y:this.max.y},ne:{x:this.max.x,y:this.min.y}},this.center_dist=0,this.meters_per_pixel=Geo$1.metersPerPixel(this.style_zoom),this.meters_per_pixel_sq=this.meters_per_pixel*this.meters_per_pixel,this.units_per_pixel=Geo$1.units_per_pixel/this.overzoom2,this.units_per_meter_overzoom=Geo$1.unitsPerMeter(this.coords.z)*this.overzoom2,this.meshes={},this.new_mesh_styles=[]}return _createClass(e,[{key:"freeResources",value:function(){for(var o in this.meshes)this.meshes[o].forEach(function(s){return s.destroy()});this.meshes={}}},{key:"destroy",value:function(){Task.removeForTile(this.id),this.workerMessage("self.removeTile",this.id),this.freeResources(),this.worker=null,this.valid=!1}},{key:"buildAsMessage",value:function(){return{id:this.id,key:this.key,source:this.source.name,coords:this.coords,min:this.min,max:this.max,units_per_pixel:this.units_per_pixel,meters_per_pixel:this.meters_per_pixel,meters_per_pixel_sq:this.meters_per_pixel_sq,units_per_meter_overzoom:this.units_per_meter_overzoom,style_zoom:this.style_zoom,overzoom:this.overzoom,overzoom2:this.overzoom2,generation:this.generation}}},{key:"workerMessage",value:function(){for(var o=arguments.length,s=new Array(o),h=0;h<o;h++)s[h]=arguments[h];return WorkerBroker.postMessage.apply(WorkerBroker,[this.worker].concat(s))}},{key:"build",value:function(o){var s=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).fade_in,h=s===void 0||s;return this.generation=o,this.fade_in=h,this.loaded||(this.loading=!0,this.built=!1,this.labeled=!1),this.workerMessage("self.buildTile",{tile:this.buildAsMessage()})}},{key:"buildMeshes",value:function(o,s){if(!this.error){this.build_id=build_id++;var h={},d=this.mesh_data;if(d)for(var g in d){for(var _ in d[g].meshes){var j=d[g].meshes[_];if(j.vertex_data){if(!o[g]){log("warn","Could not create mesh because style '".concat(g,"' not found, for tile ").concat(this.key,", aborting tile"));break}var $=Object.assign({},d[g]);$.uniforms=Object.assign({},$.uniforms,j.uniforms),$.variant=j.variant,j.textures&&($.textures=j.textures),j.labels&&($.retain=!0);var _t=o[g].makeMesh(j.vertex_data,j.vertex_elements,$);_t.variant=$.variant,_t.labels=j.labels,h[g]=h[g]||[],h[g].push(_t),_t.variant.order==null&&(_t.variant.order=h[g].length-1)}}h[g]&&h[g].sort(function(_i,_n){var _s=_i.variant.order,_l=_n.variant.order;return _s==null?1:_l==null||_s<_l?-1:1})}for(var _e in delete this.mesh_data,h)this.meshes[_e]&&this.meshes[_e].forEach(function(_i){return _i.destroy()}),this.meshes[_e]=h[_e],this.new_mesh_styles.push(_e);if(s.done){for(var _r in this.meshes)this.new_mesh_styles.indexOf(_r)===-1&&(this.meshes[_r].forEach(function(_i){return _i.destroy()}),delete this.meshes[_r]);this.new_mesh_styles=[]}}}},{key:"setProxyFor",value:function(o){o?(this.proxy_for=this.proxy_for||[],this.proxy_for.push(o),this.proxy_depth=1,o.proxied_as=o.style_zoom>this.style_zoom?"child":"parent"):(this.proxy_for=null,this.proxy_depth=0)}},{key:"isProxy",value:function(){return this.proxy_for!=null}},{key:"shouldProxyForStyle",value:function(o){return!this.proxy_for||this.proxy_for.some(function(s){return s.meshes[o]==null})}},{key:"setupProgram",value:function(o,s){var h=o.model,d=o.model32;s.uniform("4fv","u_tile_origin",[this.min.x,this.min.y,this.style_zoom,this.coords.z]),s.uniform("1f","u_tile_proxy_depth",this.proxy_depth),mat4.identity(h),mat4.translate(h,h,vec3.fromValues(this.min.x,this.min.y,0)),mat4.scale(h,h,vec3.fromValues(this.span.x/Geo$1.tile_scale,-1*this.span.y/Geo$1.tile_scale,1)),mat4.copy(d,h),s.uniform("Matrix4fv","u_model",d),s.uniform("1i","u_tile_fade_in",this.fade_in&&this.proxied_as!=="child")}},{key:"merge",value:function(o){return this.loading=o.loading,this.loaded=o.loaded,this.generation=o.generation,this.error=o.error,this.mesh_data=o.mesh_data,this.selection_data?Object.assign(this.selection_data,o.selection_data):this.selection_data=o.selection_data,this}}],[{key:"coord",value:function(o){return{x:o.x,y:o.y,z:o.z,key:e.coordKey(o)}}},{key:"coordKey",value:function(o){return o.x+"/"+o.y+"/"+o.z}},{key:"key",value:function(o,s,h){if(!(o.y<0||o.y>=1<<o.z||o.z<0))return[s.name,h,o.x,o.y,o.z].join("/")}},{key:"normalizedKey",value:function(o,s,h){return e.key(e.normalizedCoordinate(o,s,h),s,h)}},{key:"normalizedCoordinate",value:function(o,s,h){return s.zoom_bias&&(o=e.coordinateAtZoom(o,Math.max(0,o.z-s.zoom_bias))),e.coordinateWithMaxZoom(o,s.max_zoom)}},{key:"coordinateAtZoom",value:function(o,s){var h=o.x,d=o.y,g=o.z;if(g!==s){var _=Math.pow(2,g-s);h=Math.floor(h/_),d=Math.floor(d/_),g=s}return e.coord({x:h,y:d,z:g})}},{key:"coordinateWithMaxZoom",value:function(o,s){var h=o.x,d=o.y,g=o.z;return s!==void 0&&g>s?e.coordinateAtZoom({x:h,y:d,z:g},s):e.coord({x:h,y:d,z:g})}},{key:"childrenForCoordinate",value:function(o){var s=o.x,h=o.y,d=o.z,g=o.key;return e.coord_children[g]||(d++,s*=2,h*=2,e.coord_children[g]=[e.coord({x:s,y:h,z:d}),e.coord({x:s+1,y:h,z:d}),e.coord({x:s,y:h+1,z:d}),e.coord({x:s+1,y:h+1,z:d})]),e.coord_children[g]}},{key:"isDescendant",value:function(o,s){if(s.z>o.z){var h=e.coordinateAtZoom(s,o.z),d=h.x,g=h.y;return o.x===d&&o.y===g}return!1}},{key:"cancel",value:function(o){o&&(o.canceled=!0,o.source_data&&o.source_data.request_id&&(Utils$1.cancelRequest(o.source_data.request_id),o.source_data.request_id=null),e.abortBuild(o))}},{key:"buildGeometry",value:function(o,s){var h=s.scene_id,d=s.layers,g=s.styles,_=s.global,j=s.sources,$=s.meshVariantMaxLife,_t=o.source_data;for(var _e in Collision.startTile(o.id,{apply_repeat_groups:!0}),d){var _r=d[_e];if(_r&&_r.config_data){if(_r.config_data.source===o.source)for(var _i=e._getDataForSource(_t,_r.config_data,_e),_n=0;_n<_i.length;_n++){var _s=_i[_n],_l=_s.geom;if(_l)for(var Ap=0;Ap<_l.features.length;Ap++){var _h=_l.features[Ap];if(_h.geometry!=null){var _p=StyleParser.getFeatureParseContext(_h,o,_,j);_p.winding=o.default_winding,_p.source=o.source,_p.layer=_s.layer;var ty=_r.buildDrawGroups(_p,!0);if(ty)for(var ry in ty){var ly=ty[ry],uy=ly.style||ry,py=g[uy];py?(ly=py.preprocess(ly,o.source))!=null&&ly.visible!==!1&&(_p.layers=ly.layers,py.addFeature(_h,ly,_p)):log("warn","Style '".concat(uy,"' not found, skipping layer '").concat(_e,"':"),ly,_h)}}}}}else log("warn","Layer ".concat(_e," was defined without a geometry data source and will not be rendered."))}var fy=e._stylesForTile(o,g);e._sendStyleGroups(o,fy,{scene_id:h,meshVariantMaxLife:$},function(my){return my.collision?"collision":"non-collision"})}},{key:"_stylesForTile",value:function(o,s){var h=[];for(var d in s)s[d].hasDataForTile(o)&&h.push(s[d]);return h}},{key:"_sendStyleGroups",value:function(o,s,h,d){var g=h.scene_id,_=h.meshVariantMaxLife,j={};if(s.forEach(function(_r){var _i=d(_r);j[_i]=j[_i]||[],j[_i].push(_r)}),Object.keys(j).length>0){var $={start:!0};o.mesh_data={};var _t=function(_r){var _i=j[_r];Promise.all(_i.map(function(_n){return _n.endData(o)})).then(function(){log("trace","Finished style group '".concat(_r,"' for tile ").concat(o.key)),j[_r]=[],Object.keys(j).every(function(_n){return j[_n].length===0})&&($.done=!0),WorkerBroker.postMessage("TileManager_".concat(g,".buildTileStylesCompleted"),WorkerBroker.withTransferables({tile:e.slice(o,["mesh_data","selection_data"]),progress:$})),$.start=null,o.mesh_data={},o.selection_data={},$.done&&Collision.resetTile(o.id)},function(_n){log("error","Error for style group '".concat(_r,"' for tile ").concat(o.key),_n)})};for(var _e in j)_t(_e);Style.updateMeshVariantTypeCache(_)}else WorkerBroker.postMessage("TileManager_".concat(g,".buildTileStylesCompleted"),WorkerBroker.withTransferables({tile:e.slice(o),progress:{start:!0,done:!0}})),Collision.resetTile(o.id)}},{key:"_getDataForSource",value:function(o,s){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,d=[];return s!=null&&o!=null&&o.layers!=null&&(!s.layer&&o.layers._default||typeof s.layer=="string"&&!o.layers[s.layer]&&new RegExp("^\\d+_"+s.layer+"$").test(h)&&o.layers._default?d.push({geom:o.layers._default}):!s.layer&&h?d.push({layer:h,geom:o.layers[h]}):typeof s.layer=="string"?d.push({layer:s.layer,geom:o.layers[s.layer]}):Array.isArray(s.layer)&&s.layer.forEach(function(g){o.layers[g]&&o.layers[g].features&&d.push({layer:g,geom:o.layers[g]})})),d}},{key:"abortBuild",value:function(o,s){if(Task.removeForTile(o.id),Collision.abortTile(o.id),o.mesh_data)for(var h in o.mesh_data){var d=o.mesh_data[h].textures;d&&d.forEach(function(g){var _=getTextureManager(s).textures[g];_&&(log("trace","releasing texture ".concat(g," for tile ").concat(o.key)),_.release())})}}},{key:"slice",value:function(o,s){var h=["id","key","loading","loaded","generation","error","debug"];Array.isArray(s)&&h.push.apply(h,_toConsumableArray(s));for(var d={},g=0;g<h.length;g++){var _=h[g];d[_]=o[_]}return d}}])}();Tile.coord_children={};var RasterTileSource=function(e){function o(s,h){var d;return _classCallCheck(this,o),(d=_callSuper(this,o,[s,h])).rasters.indexOf(d.name)===-1&&d.rasters.unshift(d.name),d.filtering=s.filtering,d.textures={},d}return _inherits(o,e),_createClass(o,[{key:"load",value:function(s){s.source_data={},s.source_data.layers={},s.pad_scale=this.pad_scale,s.rasters=_toConsumableArray(this.rasters);var h=Geo$1.tile_scale;return s.source_data.layers={_default:{type:"FeatureCollection",features:[{geometry:{type:"Polygon",coordinates:[[[0,0],[h,0],[h,-h],[0,-h],[0,0]]]},properties:{}}]}},s.default_winding="CW",Promise.resolve(s)}},{key:"tileTexture",value:function(s){var h=s.coords.key;if(!this.textures[h]){var d=Tile.coordinateWithMaxZoom(s.coords,this.max_zoom),g=this.formatUrl(this.url,{coords:d});this.textures[h]={url:g,filtering:this.filtering,coords:d}}return this.textures[h]}}])}(NetworkTileSource),ArrayUtils;DataSource.register(RasterTileSource,"Raster");var ArrayUtils$1=ArrayUtils={};function simplify(e,o,s,h){for(var d,g=h,_=s-o>>1,j=s-o,$=e[o],_t=e[o+1],_e=e[s],_r=e[s+1],_i=o+3;_i<s;_i+=3){var _n=getSqSegDist(e[_i],e[_i+1],$,_t,_e,_r);if(_n>g)d=_i,g=_n;else if(_n===g){var _s=Math.abs(_i-_);_s<j&&(d=_i,j=_s)}}g>h&&(d-o>3&&simplify(e,o,d,h),e[d+2]=g,s-d>3&&simplify(e,d,s,h))}function getSqSegDist(e,o,s,h,d,g){var _=d-s,j=g-h;if(_!==0||j!==0){var $=((e-s)*_+(o-h)*j)/(_*_+j*j);$>1?(s=d,h=g):$>0&&(s+=_*$,h+=j*$)}return(_=e-s)*_+(j=o-h)*j}function createFeature(e,o,s,h){var d={id:e===void 0?null:e,type:o,geometry:s,tags:h,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return calcBBox(d),d}function calcBBox(e){var o=e.geometry,s=e.type;if(s==="Point"||s==="MultiPoint"||s==="LineString")calcLineBBox(e,o);else if(s==="Polygon"||s==="MultiLineString")for(var h=0;h<o.length;h++)calcLineBBox(e,o[h]);else if(s==="MultiPolygon")for(h=0;h<o.length;h++)for(var d=0;d<o[h].length;d++)calcLineBBox(e,o[h][d])}function calcLineBBox(e,o){for(var s=0;s<o.length;s+=3)e.minX=Math.min(e.minX,o[s]),e.minY=Math.min(e.minY,o[s+1]),e.maxX=Math.max(e.maxX,o[s]),e.maxY=Math.max(e.maxY,o[s+1])}function convert(e,o){var s=[];if(e.type==="FeatureCollection")for(var h=0;h<e.features.length;h++)convertFeature(s,e.features[h],o,h);else e.type==="Feature"?convertFeature(s,e,o):convertFeature(s,{geometry:e},o);return s}function convertFeature(e,o,s,h){if(o.geometry){var d=o.geometry.coordinates,g=o.geometry.type,_=Math.pow(s.tolerance/((1<<s.maxZoom)*s.extent),2),j=[],$=o.id;if(s.promoteId?$=o.properties[s.promoteId]:s.generateId&&($=h||0),g==="Point")convertPoint(d,j);else if(g==="MultiPoint")for(var _t=0;_t<d.length;_t++)convertPoint(d[_t],j);else if(g==="LineString")convertLine(d,j,_,!1);else if(g==="MultiLineString"){if(s.lineMetrics){for(_t=0;_t<d.length;_t++)j=[],convertLine(d[_t],j,_,!1),e.push(createFeature($,"LineString",j,o.properties));return}convertLines(d,j,_,!1)}else if(g==="Polygon")convertLines(d,j,_,!0);else{if(g!=="MultiPolygon"){if(g==="GeometryCollection"){for(_t=0;_t<o.geometry.geometries.length;_t++)convertFeature(e,{id:$,geometry:o.geometry.geometries[_t],properties:o.properties},s,h);return}throw new Error("Input data is not a valid GeoJSON object.")}for(_t=0;_t<d.length;_t++){var _e=[];convertLines(d[_t],_e,_,!0),j.push(_e)}}e.push(createFeature($,g,j,o.properties))}}function convertPoint(e,o){o.push(projectX(e[0])),o.push(projectY(e[1])),o.push(0)}function convertLine(e,o,s,h){for(var d,g,_=0,j=0;j<e.length;j++){var $=projectX(e[j][0]),_t=projectY(e[j][1]);o.push($),o.push(_t),o.push(0),j>0&&(_+=h?(d*_t-$*g)/2:Math.sqrt(Math.pow($-d,2)+Math.pow(_t-g,2))),d=$,g=_t}var _e=o.length-3;o[2]=1,simplify(o,0,_e,s),o[_e+2]=1,o.size=Math.abs(_),o.start=0,o.end=o.size}function convertLines(e,o,s,h){for(var d=0;d<e.length;d++){var g=[];convertLine(e[d],g,s,h),o.push(g)}}function projectX(e){return e/360+.5}function projectY(e){var o=Math.sin(e*Math.PI/180),s=.5-.25*Math.log((1+o)/(1-o))/Math.PI;return s<0?0:s>1?1:s}function clip(e,o,s,h,d,g,_,j){if(h/=o,g>=(s/=o)&&_<h)return e;if(_<s||g>=h)return null;for(var $=[],_t=0;_t<e.length;_t++){var _e=e[_t],_r=_e.geometry,_i=_e.type,_n=d===0?_e.minX:_e.minY,_s=d===0?_e.maxX:_e.maxY;if(_n>=s&&_s<h)$.push(_e);else if(!(_s<s||_n>=h)){var _l=[];if(_i==="Point"||_i==="MultiPoint")clipPoints(_r,_l,s,h,d);else if(_i==="LineString")clipLine(_r,_l,s,h,d,!1,j.lineMetrics);else if(_i==="MultiLineString")clipLines(_r,_l,s,h,d,!1);else if(_i==="Polygon")clipLines(_r,_l,s,h,d,!0);else if(_i==="MultiPolygon")for(var Ap=0;Ap<_r.length;Ap++){var _h=[];clipLines(_r[Ap],_h,s,h,d,!0),_h.length&&_l.push(_h)}if(_l.length){if(j.lineMetrics&&_i==="LineString"){for(Ap=0;Ap<_l.length;Ap++)$.push(createFeature(_e.id,_i,_l[Ap],_e.tags));continue}_i!=="LineString"&&_i!=="MultiLineString"||(_l.length===1?(_i="LineString",_l=_l[0]):_i="MultiLineString"),_i!=="Point"&&_i!=="MultiPoint"||(_i=_l.length===3?"Point":"MultiPoint"),$.push(createFeature(_e.id,_i,_l,_e.tags))}}}return $.length?$:null}function clipPoints(e,o,s,h,d){for(var g=0;g<e.length;g+=3){var _=e[g+d];_>=s&&_<=h&&(o.push(e[g]),o.push(e[g+1]),o.push(e[g+2]))}}function clipLine(e,o,s,h,d,g,_){for(var j,$,_t=newSlice(e),_e=d===0?intersectX:intersectY,_r=e.start,_i=0;_i<e.length-3;_i+=3){var _n=e[_i],_s=e[_i+1],_l=e[_i+2],Ap=e[_i+3],_h=e[_i+4],_p=d===0?_n:_s,ty=d===0?Ap:_h,ry=!1;_&&(j=Math.sqrt(Math.pow(_n-Ap,2)+Math.pow(_s-_h,2))),_p<s?ty>s&&($=_e(_t,_n,_s,Ap,_h,s),_&&(_t.start=_r+j*$)):_p>h?ty<h&&($=_e(_t,_n,_s,Ap,_h,h),_&&(_t.start=_r+j*$)):addPoint(_t,_n,_s,_l),ty<s&&_p>=s&&($=_e(_t,_n,_s,Ap,_h,s),ry=!0),ty>h&&_p<=h&&($=_e(_t,_n,_s,Ap,_h,h),ry=!0),!g&&ry&&(_&&(_t.end=_r+j*$),o.push(_t),_t=newSlice(e)),_&&(_r+=j)}var ly=e.length-3;_n=e[ly],_s=e[ly+1],_l=e[ly+2],(_p=d===0?_n:_s)>=s&&_p<=h&&addPoint(_t,_n,_s,_l),ly=_t.length-3,g&&ly>=3&&(_t[ly]!==_t[0]||_t[ly+1]!==_t[1])&&addPoint(_t,_t[0],_t[1],_t[2]),_t.length&&o.push(_t)}function newSlice(e){var o=[];return o.size=e.size,o.start=e.start,o.end=e.end,o}function clipLines(e,o,s,h,d,g){for(var _=0;_<e.length;_++)clipLine(e[_],o,s,h,d,g,!1)}function addPoint(e,o,s,h){e.push(o),e.push(s),e.push(h)}function intersectX(e,o,s,h,d,g){var _=(g-o)/(h-o);return e.push(g),e.push(s+(d-s)*_),e.push(1),_}function intersectY(e,o,s,h,d,g){var _=(g-s)/(d-s);return e.push(o+(h-o)*_),e.push(g),e.push(1),_}function wrap$1(e,o){var s=o.buffer/o.extent,h=e,d=clip(e,1,-1-s,s,0,-1,2,o),g=clip(e,1,1-s,2+s,0,-1,2,o);return(d||g)&&(h=clip(e,1,-s,1+s,0,-1,2,o)||[],d&&(h=shiftFeatureCoords(d,1).concat(h)),g&&(h=h.concat(shiftFeatureCoords(g,-1)))),h}function shiftFeatureCoords(e,o){for(var s=[],h=0;h<e.length;h++){var d,g=e[h],_=g.type;if(_==="Point"||_==="MultiPoint"||_==="LineString")d=shiftCoords(g.geometry,o);else if(_==="MultiLineString"||_==="Polygon"){d=[];for(var j=0;j<g.geometry.length;j++)d.push(shiftCoords(g.geometry[j],o))}else if(_==="MultiPolygon")for(d=[],j=0;j<g.geometry.length;j++){for(var $=[],_t=0;_t<g.geometry[j].length;_t++)$.push(shiftCoords(g.geometry[j][_t],o));d.push($)}s.push(createFeature(g.id,_,d,g.tags))}return s}function shiftCoords(e,o){var s=[];s.size=e.size,e.start!==void 0&&(s.start=e.start,s.end=e.end);for(var h=0;h<e.length;h+=3)s.push(e[h]+o,e[h+1],e[h+2]);return s}function transformTile(e,o){if(e.transformed)return e;var s,h,d,g=1<<e.z,_=e.x,j=e.y;for(s=0;s<e.features.length;s++){var $=e.features[s],_t=$.geometry,_e=$.type;if($.geometry=[],_e===1)for(h=0;h<_t.length;h+=2)$.geometry.push(transformPoint(_t[h],_t[h+1],o,g,_,j));else for(h=0;h<_t.length;h++){var _r=[];for(d=0;d<_t[h].length;d+=2)_r.push(transformPoint(_t[h][d],_t[h][d+1],o,g,_,j));$.geometry.push(_r)}}return e.transformed=!0,e}function transformPoint(e,o,s,h,d,g){return[Math.round(s*(e*h-d)),Math.round(s*(o*h-g))]}function createTile(e,o,s,h,d){for(var g=o===d.maxZoom?0:d.tolerance/((1<<o)*d.extent),_={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:s,y:h,z:o,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},j=0;j<e.length;j++){_.numFeatures++,addFeature(_,e[j],g,d);var $=e[j].minX,_t=e[j].minY,_e=e[j].maxX,_r=e[j].maxY;$<_.minX&&(_.minX=$),_t<_.minY&&(_.minY=_t),_e>_.maxX&&(_.maxX=_e),_r>_.maxY&&(_.maxY=_r)}return _}function addFeature(e,o,s,h){var d=o.geometry,g=o.type,_=[];if(g==="Point"||g==="MultiPoint")for(var j=0;j<d.length;j+=3)_.push(d[j]),_.push(d[j+1]),e.numPoints++,e.numSimplified++;else if(g==="LineString")addLine(_,d,e,s,!1,!1);else if(g==="MultiLineString"||g==="Polygon")for(j=0;j<d.length;j++)addLine(_,d[j],e,s,g==="Polygon",j===0);else if(g==="MultiPolygon")for(var $=0;$<d.length;$++){var _t=d[$];for(j=0;j<_t.length;j++)addLine(_,_t[j],e,s,!0,j===0)}if(_.length){var _e=o.tags||null;if(g==="LineString"&&h.lineMetrics){for(var _r in _e={},o.tags)_e[_r]=o.tags[_r];_e.mapbox_clip_start=d.start/d.size,_e.mapbox_clip_end=d.end/d.size}var _i={geometry:_,type:g==="Polygon"||g==="MultiPolygon"?3:g==="LineString"||g==="MultiLineString"?2:1,tags:_e};o.id!==null&&(_i.id=o.id),e.features.push(_i)}}function addLine(e,o,s,h,d,g){var _=h*h;if(h>0&&o.size<(d?_:h))s.numPoints+=o.length/3;else{for(var j=[],$=0;$<o.length;$+=3)(h===0||o[$+2]>_)&&(s.numSimplified++,j.push(o[$]),j.push(o[$+1])),s.numPoints++;d&&rewind(j,g),e.push(j)}}function rewind(e,o){for(var s=0,h=0,d=e.length,g=d-2;h<d;g=h,h+=2)s+=(e[h]-e[g])*(e[h+1]+e[g+1]);if(s>0===o)for(h=0,d=e.length;h<d/2;h+=2){var _=e[h],j=e[h+1];e[h]=e[d-2-h],e[h+1]=e[d-1-h],e[d-2-h]=_,e[d-1-h]=j}}ArrayUtils.deepClone=function(e){return Array.isArray(e)?e.map(ArrayUtils.deepClone):e};var defaults={maxZoom:14,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1};function createGeoJsonTile(e,o,s,h,d){var g=Object.assign({},defaults,d),_=convert(e,g),j=getBBox(_=wrap$1(_,g)),$=j.minX,_t=j.minY,_e=j.maxX,_r=j.maxY,_i=1<<o,_n=g.buffer/g.extent,_s=1+_n;return _=clip(_,_i,s-_n,s+_s,0,$,_e,g)||[],transformTile(createTile(_=clip(_,_i,h-_n,h+_s,1,_t,_r,g)||[],o,s,h,g),g.extent)}function getBBox(e){var o,s=2,h=-1,d=1,g=0,_=_createForOfIteratorHelper(e);try{for(_.s();!(o=_.n()).done;){var j=o.value;j.minX<s&&(s=j.minX),j.maxX>h&&(h=j.maxX),j.minY<d&&(d=j.minY),j.maxY>g&&(g=j.maxY)}}catch($){_.e($)}finally{_.f()}return{minX:s,maxX:h,minY:d,maxY:g}}function PackingSmith$1(e,o){this.items=[],this.algorithm=e;var s=(o=o||{}).sort===void 0||o.sort;this.sort=s}PackingSmith$1.prototype={addItem:function(e){this.items.push(e)},normalizeCoordinates:function(){var e=this.items,o=1/0,s=1/0;e.forEach(function(h){var d=h;o=Math.min(o,d.x),s=Math.min(s,d.y)}),e.forEach(function(h){var d=h;d.x-=o,d.y-=s})},getStats:function(){var e=this.items.map(function(g){return g}),o=e.map(function(g){return g.x}),s=e.map(function(g){return g.y}),h=e.map(function(g){return g.x+g.width}),d=e.map(function(g){return g.y+g.height});return{minX:Math.max.apply(Math,o),minY:Math.max.apply(Math,s),maxX:Math.max.apply(Math,h),maxY:Math.max.apply(Math,d)}},getItems:function(){return this.items},processItems:function(){var e=this.items;return this.sort&&(e=this.algorithm.sort(e)),e=this.algorithm.placeItems(e),this.items=e,e},exportItems:function(){return this.processItems(),this.normalizeCoordinates(),this.items},export:function(){var e=this.exportItems(),o=this.getStats();return{height:o.maxY,width:o.maxX,items:e}}};var packing_smith=PackingSmith$1;global$1.TYPED_ARRAY_SUPPORT===void 0||global$1.TYPED_ARRAY_SUPPORT;function isBuffer(e){return e!=null&&(!!e._isBuffer||isFastBuffer(e)||isSlowBuffer(e))}function isFastBuffer(e){return!!e.constructor&&typeof e.constructor.isBuffer=="function"&&e.constructor.isBuffer(e)}function isSlowBuffer(e){return typeof e.readFloatLE=="function"&&typeof e.slice=="function"&&isFastBuffer(e.slice(0,0))}global$1.setTimeout,global$1.clearTimeout;var performance$1=global$1.performance||{},inherits;performance$1.now||performance$1.mozNow||performance$1.msNow||performance$1.oNow||performance$1.webkitNow,inherits=typeof Object.create=="function"?function(e,o){e.super_=o,e.prototype=Object.create(o.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,o){e.super_=o;var s=function(){};s.prototype=o.prototype,e.prototype=new s,e.prototype.constructor=e};var inherits$1=inherits;function inspect$1(e,o){var s={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(s.depth=arguments[2]),arguments.length>=4&&(s.colors=arguments[3]),isBoolean$1(o)?s.showHidden=o:o&&_extend(s,o),isUndefined(s.showHidden)&&(s.showHidden=!1),isUndefined(s.depth)&&(s.depth=2),isUndefined(s.colors)&&(s.colors=!1),isUndefined(s.customInspect)&&(s.customInspect=!0),s.colors&&(s.stylize=stylizeWithColor),formatValue(s,e,s.depth)}function stylizeWithColor(e,o){var s=inspect$1.styles[o];return s?"\x1B["+inspect$1.colors[s][0]+"m"+e+"\x1B["+inspect$1.colors[s][1]+"m":e}function stylizeNoColor(e,o){return e}function arrayToHash(e){var o={};return e.forEach(function(s,h){o[s]=!0}),o}function formatValue(e,o,s){if(e.customInspect&&o&&isFunction(o.inspect)&&o.inspect!==inspect$1&&(!o.constructor||o.constructor.prototype!==o)){var h=o.inspect(s,e);return isString(h)||(h=formatValue(e,h,s)),h}var d=formatPrimitive(e,o);if(d)return d;var g=Object.keys(o),_=arrayToHash(g);if(e.showHidden&&(g=Object.getOwnPropertyNames(o)),isError(o)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return formatError$1(o);if(g.length===0){if(isFunction(o)){var j=o.name?": "+o.name:"";return e.stylize("[Function"+j+"]","special")}if(isRegExp(o))return e.stylize(RegExp.prototype.toString.call(o),"regexp");if(isDate(o))return e.stylize(Date.prototype.toString.call(o),"date");if(isError(o))return formatError$1(o)}var $,_t="",_e=!1,_r=["{","}"];return isArray(o)&&(_e=!0,_r=["[","]"]),isFunction(o)&&(_t=" [Function"+(o.name?": "+o.name:"")+"]"),isRegExp(o)&&(_t=" "+RegExp.prototype.toString.call(o)),isDate(o)&&(_t=" "+Date.prototype.toUTCString.call(o)),isError(o)&&(_t=" "+formatError$1(o)),g.length!==0||_e&&o.length!=0?s<0?isRegExp(o)?e.stylize(RegExp.prototype.toString.call(o),"regexp"):e.stylize("[Object]","special"):(e.seen.push(o),$=_e?formatArray(e,o,s,_,g):g.map(function(_i){return formatProperty(e,o,s,_,_i,_e)}),e.seen.pop(),reduceToSingleString($,_t,_r)):_r[0]+_t+_r[1]}function formatPrimitive(e,o){if(isUndefined(o))return e.stylize("undefined","undefined");if(isString(o)){var s="'"+JSON.stringify(o).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(s,"string")}return isNumber(o)?e.stylize(""+o,"number"):isBoolean$1(o)?e.stylize(""+o,"boolean"):isNull$1(o)?e.stylize("null","null"):void 0}function formatError$1(e){return"["+Error.prototype.toString.call(e)+"]"}function formatArray(e,o,s,h,d){for(var g=[],_=0,j=o.length;_<j;++_)hasOwnProperty(o,String(_))?g.push(formatProperty(e,o,s,h,String(_),!0)):g.push("");return d.forEach(function($){$.match(/^\d+$/)||g.push(formatProperty(e,o,s,h,$,!0))}),g}function formatProperty(e,o,s,h,d,g){var _,j,$;if(($=Object.getOwnPropertyDescriptor(o,d)||{value:o[d]}).get?j=$.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):$.set&&(j=e.stylize("[Setter]","special")),hasOwnProperty(h,d)||(_="["+d+"]"),j||(e.seen.indexOf($.value)<0?(j=isNull$1(s)?formatValue(e,$.value,null):formatValue(e,$.value,s-1)).indexOf(`
`)>-1&&(j=g?j.split(`
`).map(function(_t){return"  "+_t}).join(`
`).substr(2):`
`+j.split(`
`).map(function(_t){return"   "+_t}).join(`
`)):j=e.stylize("[Circular]","special")),isUndefined(_)){if(g&&d.match(/^\d+$/))return j;(_=JSON.stringify(""+d)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(_=_.substr(1,_.length-2),_=e.stylize(_,"name")):(_=_.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),_=e.stylize(_,"string"))}return _+": "+j}function reduceToSingleString(e,o,s){return e.reduce(function(h,d){return d.indexOf(`
`),h+d.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?s[0]+(o===""?"":o+`
 `)+" "+e.join(`,
  `)+" "+s[1]:s[0]+o+" "+e.join(", ")+" "+s[1]}function isArray(e){return Array.isArray(e)}function isBoolean$1(e){return typeof e=="boolean"}function isNull$1(e){return e===null}function isNumber(e){return typeof e=="number"}function isString(e){return typeof e=="string"}function isUndefined(e){return e===void 0}function isRegExp(e){return isObject$1(e)&&objectToString(e)==="[object RegExp]"}function isObject$1(e){return typeof e=="object"&&e!==null}function isDate(e){return isObject$1(e)&&objectToString(e)==="[object Date]"}function isError(e){return isObject$1(e)&&(objectToString(e)==="[object Error]"||e instanceof Error)}function isFunction(e){return typeof e=="function"}function isPrimitive(e){return e===null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||typeof e=="symbol"||e===void 0}function objectToString(e){return Object.prototype.toString.call(e)}function _extend(e,o){if(!o||!isObject$1(o))return e;for(var s=Object.keys(o),h=s.length;h--;)e[s[h]]=o[s[h]];return e}function hasOwnProperty(e,o){return Object.prototype.hasOwnProperty.call(e,o)}function compare(e,o){if(e===o)return 0;for(var s=e.length,h=o.length,d=0,g=Math.min(s,h);d<g;++d)if(e[d]!==o[d]){s=e[d],h=o[d];break}return s<h?-1:h<s?1:0}inspect$1.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect$1.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var hasOwn=Object.prototype.hasOwnProperty,objectKeys=Object.keys||function(e){var o=[];for(var s in e)hasOwn.call(e,s)&&o.push(s);return o},pSlice=Array.prototype.slice,_functionsHaveNames;function functionsHaveNames(){return _functionsHaveNames!==void 0?_functionsHaveNames:_functionsHaveNames=(function(){}).name==="foo"}function pToString(e){return Object.prototype.toString.call(e)}function isView(e){return!isBuffer(e)&&typeof global$1.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer)))}function assert$1(e,o){e||fail(e,!0,o,"==",ok)}var regex=/\s*function\s+([^\(\s]*)\s*/;function getName(e){if(isFunction(e)){if(functionsHaveNames())return e.name;var o=e.toString().match(regex);return o&&o[1]}}function AssertionError(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=getMessage(this),this.generatedMessage=!0);var o=e.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,o);else{var s=new Error;if(s.stack){var h=s.stack,d=getName(o),g=h.indexOf(`
`+d);if(g>=0){var _=h.indexOf(`
`,g+1);h=h.substring(_+1)}this.stack=h}}}function truncate(e,o){return typeof e=="string"?e.length<o?e:e.slice(0,o):e}function inspect(e){if(functionsHaveNames()||!isFunction(e))return inspect$1(e);var o=getName(e);return"[Function"+(o?": "+o:"")+"]"}function getMessage(e){return truncate(inspect(e.actual),128)+" "+e.operator+" "+truncate(inspect(e.expected),128)}function fail(e,o,s,h,d){throw new AssertionError({message:s,actual:e,expected:o,operator:h,stackStartFunction:d})}function ok(e,o){e||fail(e,!0,o,"==",ok)}function equal(e,o,s){e!=o&&fail(e,o,s,"==",equal)}function notEqual(e,o,s){e==o&&fail(e,o,s,"!=",notEqual)}function deepEqual(e,o,s){_deepEqual(e,o,!1)||fail(e,o,s,"deepEqual",deepEqual)}function deepStrictEqual(e,o,s){_deepEqual(e,o,!0)||fail(e,o,s,"deepStrictEqual",deepStrictEqual)}function _deepEqual(e,o,s,h){if(e===o)return!0;if(isBuffer(e)&&isBuffer(o))return compare(e,o)===0;if(isDate(e)&&isDate(o))return e.getTime()===o.getTime();if(isRegExp(e)&&isRegExp(o))return e.source===o.source&&e.global===o.global&&e.multiline===o.multiline&&e.lastIndex===o.lastIndex&&e.ignoreCase===o.ignoreCase;if(e!==null&&typeof e=="object"||o!==null&&typeof o=="object"){if(isView(e)&&isView(o)&&pToString(e)===pToString(o)&&!(e instanceof Float32Array||e instanceof Float64Array))return compare(new Uint8Array(e.buffer),new Uint8Array(o.buffer))===0;if(isBuffer(e)!==isBuffer(o))return!1;var d=(h=h||{actual:[],expected:[]}).actual.indexOf(e);return d!==-1&&d===h.expected.indexOf(o)||(h.actual.push(e),h.expected.push(o),objEquiv(e,o,s,h))}return s?e===o:e==o}function isArguments(e){return Object.prototype.toString.call(e)=="[object Arguments]"}function objEquiv(e,o,s,h){if(e==null||o==null)return!1;if(isPrimitive(e)||isPrimitive(o))return e===o;if(s&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(o))return!1;var d=isArguments(e),g=isArguments(o);if(d&&!g||!d&&g)return!1;if(d)return _deepEqual(e=pSlice.call(e),o=pSlice.call(o),s);var _,j,$=objectKeys(e),_t=objectKeys(o);if($.length!==_t.length)return!1;for($.sort(),_t.sort(),j=$.length-1;j>=0;j--)if($[j]!==_t[j])return!1;for(j=$.length-1;j>=0;j--)if(!_deepEqual(e[_=$[j]],o[_],s,h))return!1;return!0}function notDeepEqual(e,o,s){_deepEqual(e,o,!1)&&fail(e,o,s,"notDeepEqual",notDeepEqual)}function notDeepStrictEqual(e,o,s){_deepEqual(e,o,!0)&&fail(e,o,s,"notDeepStrictEqual",notDeepStrictEqual)}function strictEqual(e,o,s){e!==o&&fail(e,o,s,"===",strictEqual)}function notStrictEqual(e,o,s){e===o&&fail(e,o,s,"!==",notStrictEqual)}function expectedException(e,o){if(!e||!o)return!1;if(Object.prototype.toString.call(o)=="[object RegExp]")return o.test(e);try{if(e instanceof o)return!0}catch{}return!Error.isPrototypeOf(o)&&o.call({},e)===!0}function _tryBlock(e){var o;try{e()}catch(s){o=s}return o}function _throws(e,o,s,h){var d;if(typeof o!="function")throw new TypeError('"block" argument must be a function');typeof s=="string"&&(h=s,s=null),d=_tryBlock(o),h=(s&&s.name?" ("+s.name+").":".")+(h?" "+h:"."),e&&!d&&fail(d,s,"Missing expected exception"+h);var g=typeof h=="string",_=!e&&d&&!s;if((!e&&isError(d)&&g&&expectedException(d,s)||_)&&fail(d,s,"Got unwanted exception"+h),e&&d&&s&&!expectedException(d,s)||!e&&d)throw d}function throws(e,o,s){_throws(!0,e,o,s)}function doesNotThrow(e,o,s){_throws(!1,e,o,s)}function ifError(e){if(e)throw e}assert$1.AssertionError=AssertionError,inherits$1(AssertionError,Error),assert$1.fail=fail,assert$1.ok=ok,assert$1.equal=equal,assert$1.notEqual=notEqual,assert$1.deepEqual=deepEqual,assert$1.deepStrictEqual=deepStrictEqual,assert$1.notDeepEqual=notDeepEqual,assert$1.notDeepStrictEqual=notDeepStrictEqual,assert$1.strictEqual=strictEqual,assert$1.notStrictEqual=notStrictEqual,assert$1.throws=throws,assert$1.doesNotThrow=doesNotThrow,assert$1.ifError=ifError;var assert$2=Object.freeze({__proto__:null,default:assert$1,AssertionError,fail,ok,assert:ok,equal,notEqual,deepEqual,deepStrictEqual,notDeepEqual,notDeepStrictEqual,strictEqual,notStrictEqual,throws,doesNotThrow,ifError}),require$$1=getAugmentedNamespace(assert$2),topDown_algorithm={},hasRequiredTopDown_algorithm;function requireTopDown_algorithm(){return hasRequiredTopDown_algorithm||(hasRequiredTopDown_algorithm=1,topDown_algorithm.sort=function(e){return e.sort(function(o,s){return o.height-s.height}),e},topDown_algorithm.placeItems=function(e){var o=0;return e.forEach(function(s){s.x=0,s.y=o,o+=s.height}),e}),topDown_algorithm}var leftRight_algorithm={},hasRequiredLeftRight_algorithm;function requireLeftRight_algorithm(){return hasRequiredLeftRight_algorithm||(hasRequiredLeftRight_algorithm=1,leftRight_algorithm.sort=function(e){return e.sort(function(o,s){return o.width-s.width}),e},leftRight_algorithm.placeItems=function(e){var o=0;return e.forEach(function(s){s.x=o,s.y=0,o+=s.width}),e}),leftRight_algorithm}var diagonal_algorithm={},hasRequiredDiagonal_algorithm;function requireDiagonal_algorithm(){return hasRequiredDiagonal_algorithm||(hasRequiredDiagonal_algorithm=1,diagonal_algorithm.sort=function(e){return e.sort(function(o,s){return Math.sqrt(Math.pow(o.height,2)+Math.pow(o.width,2))-Math.sqrt(Math.pow(s.height,2)+Math.pow(s.width,2))}),e},diagonal_algorithm.placeItems=function(e){var o=0,s=0;return e.forEach(function(h){h.x=o,h.y=s,o+=h.width,s+=h.height}),e}),diagonal_algorithm}var altDiagonal_algorithm={},hasRequiredAltDiagonal_algorithm;function requireAltDiagonal_algorithm(){return hasRequiredAltDiagonal_algorithm||(hasRequiredAltDiagonal_algorithm=1,altDiagonal_algorithm.sort=function(e){return e.sort(function(o,s){return Math.sqrt(Math.pow(o.height,2)+Math.pow(o.width,2))-Math.sqrt(Math.pow(s.height,2)+Math.pow(s.width,2))}),e},altDiagonal_algorithm.placeItems=function(e){var o=0,s=0;return e.forEach(function(h){var d=h.width;h.x=o-d,h.y=s,o-=d,s+=h.height}),e}),altDiagonal_algorithm}var binaryTree_algorithm={},packer_growing,hasRequiredPacker_growing,binPack,hasRequiredBinPack,hasRequiredBinaryTree_algorithm;function requirePacker_growing(){if(hasRequiredPacker_growing)return packer_growing;hasRequiredPacker_growing=1;var e=function(){};return e.prototype={fit:function(o){var s,h,d,g,_=o.length,j=_>0?o[0].width:0,$=_>0?o[0].height:0;for(this.root={x:0,y:0,width:j,height:$},s=0;s<_;s++)d=o[s],(h=this.findNode(this.root,d.width,d.height))?(g=this.splitNode(h,d.width,d.height),d.x=g.x,d.y=g.y):(g=this.growNode(d.width,d.height),d.x=g.x,d.y=g.y)},findNode:function(o,s,h){return o.used?this.findNode(o.right,s,h)||this.findNode(o.down,s,h):s<=o.width&&h<=o.height?o:null},splitNode:function(o,s,h){return o.used=!0,o.down={x:o.x,y:o.y+h,width:o.width,height:o.height-h},o.right={x:o.x+s,y:o.y,width:o.width-s,height:h},o},growNode:function(o,s){var h=o<=this.root.width,d=s<=this.root.height,g=d&&this.root.height>=this.root.width+o,_=h&&this.root.width>=this.root.height+s;return g?this.growRight(o,s):_?this.growDown(o,s):d?this.growRight(o,s):h?this.growDown(o,s):null},growRight:function(o,s){var h;return this.root={used:!0,x:0,y:0,width:this.root.width+o,height:this.root.height,down:this.root,right:{x:this.root.width,y:0,width:o,height:this.root.height}},(h=this.findNode(this.root,o,s))?this.splitNode(h,o,s):null},growDown:function(o,s){var h;return this.root={used:!0,x:0,y:0,width:this.root.width,height:this.root.height+s,down:{x:0,y:this.root.height,width:this.root.width,height:s},right:this.root},(h=this.findNode(this.root,o,s))?this.splitNode(h,o,s):null}},packer_growing=e}function requireBinPack(){if(hasRequiredBinPack)return binPack;hasRequiredBinPack=1;var e=requirePacker_growing();return binPack=function(o,s){s=s||{};var h=new e,d=s.inPlace||!1,g=o.map(function(j){return d?j:{width:j.width,height:j.height,item:j}});g=g.sort(function(j,$){return $.width*$.height-j.width*j.height}),h.fit(g);var _={width:g.reduce(function(j,$){return Math.max(j,$.x+$.width)},0),height:g.reduce(function(j,$){return Math.max(j,$.y+$.height)},0)};return d||(_.items=g),_}}function requireBinaryTree_algorithm(){if(hasRequiredBinaryTree_algorithm)return binaryTree_algorithm;hasRequiredBinaryTree_algorithm=1;var e=requireBinPack();return binaryTree_algorithm.sort=function(o){return o},binaryTree_algorithm.placeItems=function(o){return e(o,{inPlace:!0}),o},binaryTree_algorithm}var PackingSmith=packing_smith,assert=require$$1,algorithms={};function Layout(e,o){var s=e||"top-down";return typeof s=="string"&&(s=algorithms[e],assert(s,"Sorry, the '"+e+"' algorithm could not be loaded.")),new PackingSmith(s,o)}function addAlgorithm(e,o){algorithms[e]=o}Layout.PackingSmith=PackingSmith,Layout.addAlgorithm=addAlgorithm,Layout.algorithms=algorithms,addAlgorithm("top-down",requireTopDown_algorithm()),addAlgorithm("left-right",requireLeftRight_algorithm()),addAlgorithm("diagonal",requireDiagonal_algorithm()),addAlgorithm("alt-diagonal",requireAltDiagonal_algorithm()),addAlgorithm("binary-tree",requireBinaryTree_algorithm());var layout=Layout,layout$1=getDefaultExportFromCjs(layout);function isTainting(e){var o;try{e.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1)}catch(s){o=s.message}return o}function bitmapToCanvas(e,o,s){if(e instanceof HTMLImageElement){var h=e.ownerDocument.createElement("canvas");h.width=o,h.height=s,h.getContext("2d").drawImage(e,0,0,o,s),e=h}return e}var MAX_LNG_LAT=Geo$1.metersToLatLng([Geo$1.half_circumference_meters,Geo$1.half_circumference_meters]),TILE_EXPONENT=Math.log(Geo$1.tile_size)/Math.LN2,ICON_READY=1,DOM_MARKER_TYPE=8,GROUP_TYPE=16,TILE_MARGIN=100,AFFECTED_BBOX_CALC_THRESHOLD=10,ObjectSource=function(e){function o(s,h){var d;return _classCallCheck(this,o),d=_callSuper(this,o,[s,h]),Thread.is_worker&&(d._quad_tree=new ns.H.geo.QuadTree,d._marker_quad_tree=new ns.H.geo.QuadTree,d._tree_entries_by_object_id={},d._groups_by_id={},d._layersCache=new ns.H.util.Cache(100)),Thread.is_main&&(d._objects_by_id={},d._commands=[],d._sendCommands=debounce(d._sendCommands,100,200),d.dispatchUpdate=d.dispatchUpdate.bind(d)),d}return _inherits(o,e),_createClass(o,[{key:"hasLabeledData",value:function(){return!1}},{key:"onReady",value:function(){this._synced_at=this.provider.getInvalidations().getMark();var s,h,d=this.provider.getRootGroup(),g=d.getObjects(!0),_=[];for(g.push(d),s=g.length;s--;)h=g[s],this._isObjectSupported(h)&&this._shouldBeStored(h)&&(this._objects_by_id[h.getId()]=h,_.push(h.forWorkerMessage()));var j=[{method_name:"addObjects",arguments:[_]}];this._sendImmediateCommands(j)}},{key:"onProviderUpdate",value:function(s){var h=s.target,d=s.currentTarget.getInvalidations(h.type);if(this._isObjectSupported(h)){var g=this._synced_at,_=h.getId();if(d.isRemove(g))delete this._objects_by_id[_],this._commands.push({method_name:"removeObjectsByIds",arguments:[[_],!0]});else if(d.isAdd(g))this._shouldBeStored(h)&&(this._objects_by_id[_]=h,this._commands.push({method_name:"addObjects",arguments:[[h.forWorkerMessage()]]}));else if(d.isSpatial(g)||d.isZOrder(g)){if(this._shouldBeStored(h)){this._objects_by_id[_]=h;var j=[{method_name:"removeObjectsByIds",arguments:[[_],!0]},{method_name:"addObjects",arguments:[[h.forWorkerMessage()]]}];this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands(j):this._commands.push(j[0],j[1])}}else if(d.isVisual(g)){if(this._shouldBeStored(h)){this._objects_by_id[_]=h;var $={method_name:"updateObjectProperties",arguments:[h.forWorkerMessage()]};this.has_volatile_data&&!this.hasPendingCommands()?this._sendImmediateCommands([$]):this._commands.push($)}}else d.isVolatility(g)&&(delete this._objects_by_id[_],this._commands.push({method_name:"removeObjectsByIds",arguments:[[_],!0]}),this._shouldBeStored(h)&&(this._objects_by_id[_]=h,this._commands.push({method_name:"addObjects",arguments:[[h.forWorkerMessage()]]})));this._commands.length&&this._sendCommands()}this._synced_at=d.getMark()}},{key:"_shouldBeStored",value:function(s){return s.type===GROUP_TYPE||(!s.getIcon||s.getIcon().getState()===ICON_READY)&&this._hasSameVolatility(s)}},{key:"_hasSameVolatility",value:function(s){return s.getVolatility(!0)===this.has_volatile_data}},{key:"hasPendingCommands",value:function(){return this._commands.length>0}},{key:"_sendCommands",value:function(){this._sendImmediateCommands(this._commands),this._commands=[]}},{key:"_sendImmediateCommands",value:function(s){s.length&&WorkerBroker.postMessage(this.worker,this.target_name+".executeCommands",s).then(this.dispatchUpdate)}},{key:"_isObjectSupported",value:function(s){return s.forWorkerMessage&&s.type!==DOM_MARKER_TYPE}},{key:"getSyncedAt",value:function(){return this._synced_at}},{key:"getMapObjectById",value:function(s){return this._objects_by_id[s]}},{key:"getIconBitmapByObjectId",value:function(s,h){var d=this.getMapObjectById(s);if(d){var g=d.getIcon();if(g.uid===h&&g.getState()===ICON_READY){var _=g.getSize();return bitmapToCanvas(g.getBitmap(),_.w,_.h)}}}},{key:"_getRastersForMarkers",value:function(s){for(var h={},d=layout$1("binary-tree"),g=0;g<s.length;g++){var _=s[g],j=_.properties.icon;h[j.id]||(d.addItem({width:j.size.w,height:j.size.h,meta:{objectId:_.id,id:j.id}}),h[j.id]=!0)}return d.export()}},{key:"fetchFeaturesForTile",value:function(s){var h=[],d=[],g=[],_=[],j=[],$=this._marker_quad_tree.intersectBoundingBox(Geo$1.getTileBoundingBox(s.coords,this.tile_size));s.source_data.error=null;for(var _t=0;_t<$.length;_t++){var _e={id:$[_t].$feature$.id,properties:Object.assign({},$[_t].$feature$.properties),geometry:{type:$[_t].$feature$.geometry.type,coordinates:ArrayUtils$1.deepClone($[_t].$feature$.geometry.coordinates)}};h.push(_e)}$=this._quad_tree.intersectBoundingBox(Geo$1.getTileBoundingBox(s.coords,this.tile_size,TILE_MARGIN));for(var _r=0;_r<$.length;_r++){var _i={id:$[_r].$feature$.id,properties:Object.assign({},$[_r].$feature$.properties),geometry:{type:$[_r].$feature$.geometry.type,coordinates:ArrayUtils$1.deepClone($[_r].$feature$.geometry.coordinates)}};if(_i.properties.overlay)d.push(_i);else if(_i.geometry.type.includes("LineString"))g.push(_i);else if(_i.geometry.type.includes("Polygon")){_.push(_i);var _n={id:_i.id,properties:_i.properties,geometry:{type:_i.geometry.type,coordinates:ArrayUtils$1.deepClone(_i.geometry.coordinates)}};j.push(_n)}}h.sort(o._compareZInfo),_.sort(o._compareZInfo),d.sort(o._compareZInfo);var _s=this.has_volatile_data?4096:0;j.sort(o._compareZInfo);for(var _l=0;_l<j.length;_l++)j[_l].properties.effectiveZIdx=_s++;g.sort(o._compareZInfo);for(var Ap=0;Ap<g.length;Ap++)g[Ap].properties.effectiveZIdx=_s++;s.source_data.layers.markers={type:"FeatureCollection",features:h},s.source_data.layers.polylines={type:"FeatureCollection",features:g},s.source_data.layers.polygons={type:"FeatureCollection",features:_},s.source_data.layers.outlines={type:"FeatureCollection",features:j},s.source_data.layers.overlays={type:"FeatureCollection",features:d}}},{key:"tileTexture",value:function(s){var h=s.source_data.layers.overlays;if(h){var d=this.name+"_"+s.coords.key,g=Tile.coordinateWithMaxZoom(s.coords,this.max_zoom),_=h.features[0].properties.overlays_config;return{name:d,filtering:this.filtering,coords:g,width:Geo$1.tile_size,height:Geo$1.tile_size,overlays_config:_,source:this.name}}}},{key:"_load",value:function(s){var h=Geo$1.wrapTile(s.coords,{x:!0}),d=h.z,g=h.x,_=h.y,j="".concat(d,"_").concat(g,"_").concat(_),$=this._layersCache.get(j),_t=!1;if($)s.source_data.layers=$;else{this.fetchFeaturesForTile(s);var _e={maxZoom:this.max_zoom,tolerance:1.5,extent:Geo$1.tile_scale},_r=s.source_data.layers.overlays;_r.features.length&&delete s.source_data.layers.overlays;var _i=s.source_data.layers.markers;for(var _n in _i.features.length&&delete s.source_data.layers.markers,s.source_data.layers){var _s=s.source_data.layers[_n];if(_s.features.length){_e.buffer=_n.includes("lines")?TILE_MARGIN*Geo$1.units_per_pixel:0;var _l=createGeoJsonTile(_s,d,g,_,_e);s.source_data.layers[_n]=parseGeoJSONVectorTile(_l)}}s.source_data.layers.overlays=this._processOverlays(s,_r);for(var Ap=s.source_data.layers.overlays.features.length;Ap--;)if(!s.source_data.layers.overlays.features[Ap].id){_t=!0,this._layersCache.drop(j);break}s.source_data.layers.markers=this._processMarkers(s,_i),this._postProcessTile(s),_t||this._layersCache.add(j,s.source_data.layers,1)}return s.rasters=this._getRastersForMarkers(s.source_data.layers.markers.features),Promise.resolve(s)}},{key:"_processMarkers",value:function(s,h){var d=h.features.length;if(d){for(var g=Geo$1.unitsPerMeter(s.coords.z),_=Geo$1.wrapTile(s.coords,{x:!0}),j=Geo$1.metersForTile(_),$=Geo$1.isLastTile(_),_t=Geo$1.wrapMeters(s.min),_e=Geo$1.wrapMeters(s.max),_r=function(_h){DataSource.coordsToMeters(_h);var _p=_slicedToArray(_h,2),ty=_p[0],ry=_p[1],ly=ty>=_t.x&&($.column||ty<_e.x)&&ry>=_e.y&&($.row||!s.coords.y||ry<_t.y);return DataSource.metersToTileUnits(g,j,_h),ly},_i=[],_n=0;_n<d;_n++){var _s=h.features[_n].geometry,_l=!1;if(_s.type==="Point"){var Ap=_s.coordinates;_r(Ap)?_s.coordinates=Ap:_l=!0}else _s.type==="MultiPoint"&&(_s.coordinates=_s.coordinates.filter(_r),_s.coordinates.length===0&&(_l=!0));_l||_i.push(h.features[_n])}h.features=_i}return h}},{key:"_processOverlays",value:function(s,h){var d=this;if(!h.features.length)return h;var g={coords:s.coords,min:Geo$1.metersForTile(Geo$1.wrapTile(s.coords,{x:!0}))},_={coords:s.coords,source_data:{layers:{_default:{type:"FeatureCollection",features:h.features}}}},j=Math.pow(2,s.coords.z+TILE_EXPONENT);MapsJsSource.projectData(_.source_data),MapsJsSource.scaleData(_.source_data,g);var $=h.features.map(function(_e){var _r=_e.geometry.coordinates[0],_i=_r[0],_n=_r[_r.length===5?2:3],_s=Math.floor(_i[0]/Geo$1.tile_scale*Geo$1.tile_size),_l=Math.floor(_i[1]/Geo$1.tile_scale*Geo$1.tile_size),Ap=Math.floor(_n[0]/Geo$1.tile_scale*Geo$1.tile_size),_h=Math.floor(_n[1]/Geo$1.tile_scale*Geo$1.tile_size)-_l,_p=_s>=Ap,ty=_p?j-(_s-Ap):Ap-_s,ry=[];return _s<=Geo$1.tile_size&&ry.push([_s,_l,ty,_h]),_p&&Ap>0&&ry.push([_s-j,_l,ty,_h]),{id:_e.id,properties:_e.properties,texcoords:ry}}).filter(function(_e){return d._isVisible(_e.properties)&&d.isInMinMaxRange(_e.properties,s.style_zoom)}),_t=Geo$1.tile_scale;return s.pad_scale=this.pad_scale,s.default_winding="CW",h.features=$.length?[{geometry:{type:"Polygon",coordinates:[[[0,0],[_t,0],[_t,_t],[0,_t],[0,0]]]},properties:{overlays_config:$}}]:$,h}},{key:"executeCommands",value:function(s){for(var h,d=s.length<AFFECTED_BBOX_CALC_THRESHOLD,g=0;g<s.length;g++){var _=s[g];_.arguments.push(d);var j=this[_.method_name].apply(this,_.arguments);d&&(j&&h?h.mergeRect(j,!0,h):j&&(h=j))}return h?h.forWorkerMessage():void 0}},{key:"_getClampedGeoRectForFeature",value:function(s){var h=s.geometry.boundingBox;return new ns.H.geo.Rect(MathUtils$1.clamp(h[0],-MAX_LNG_LAT[1],MAX_LNG_LAT[1]),h[1],MathUtils$1.clamp(h[2],-MAX_LNG_LAT[1],MAX_LNG_LAT[1]),h[3])}},{key:"addObjects",value:function(s){for(var h,d=arguments.length>1&&arguments[1]!==void 0&&arguments[1],g=0;g<s.length;g++){var _=s[g];if(_.type==="Group")_.$children_ids$={},this._groups_by_id[_.id]=_;else{o._preprocessGeometry(_.geometry);var j=this._getClampedGeoRectForFeature(_);d&&(h?h.mergeRect(j,!0,h):h=j);var $=_.geometry.type.indexOf("Point")!==-1?this._marker_quad_tree:this._quad_tree,_t=$.insertBoundingBox(j);_t.$tree=$,_t.$feature$=_,this._tree_entries_by_object_id[_.id]=_t}}for(var _e=0;_e<s.length;_e++){var _r=s[_e];_r.properties.parent&&(this._groups_by_id[_r.properties.parent].$children_ids$[_r.id]=_r.id),_r.properties.ref={effectiveVisibility:this._isVisible(_r.properties),zInfo:this._getZInfo([],_r)}}return this._layersCache.removeAll(),h}},{key:"removeObjectsByIds",value:function(s,h){for(var d,g=arguments.length>2&&arguments[2]!==void 0&&arguments[2],_=0;_<s.length;_++){var j=s[_],$=void 0,_t=void 0;if($=this._tree_entries_by_object_id[j]){if(g){var _e=this._getClampedGeoRectForFeature($.$feature$);d?d.mergeRect(_e,!0,d):d=_e}delete this._groups_by_id[$.$feature$.properties.parent].$children_ids$[j],$.$tree.remove($),delete this._tree_entries_by_object_id[j]}else(_t=this._groups_by_id[j])&&(_t.properties.parent&&delete this._groups_by_id[_t.properties.parent].$children_ids$[j],h&&this.removeObjectsByIds(Object.keys(_t.$children_ids$),!0),delete this._groups_by_id[j])}return this._layersCache.removeAll(),d}},{key:"updateObjectProperties",value:function(s){var h,d=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return s.type==="Group"?(mergeObjects(this._groups_by_id[s.id].properties,s.properties),this._groups_by_id[s.id].properties.ref.effectiveVisibility=this._isVisible(s.properties)):(this._tree_entries_by_object_id[s.id]||this.addObjects([s]),mergeObjects(this._tree_entries_by_object_id[s.id].$feature$.properties,s.properties),this._tree_entries_by_object_id[s.id].$feature$.properties.ref.effectiveVisibility=this._isVisible(s.properties),d&&(h=this._getClampedGeoRectForFeature(s))),h}},{key:"_getZInfo",value:function(s,h){var d=h.properties.zIdx,g=h.properties.sIdx;return s[0]|=d!==void 0,s.splice(1,0,d||0,g<0?h.id:g),h.properties.parent===0?s:this._getZInfo(s,this._groups_by_id[h.properties.parent])}},{key:"_isVisible",value:function(s){var h=s.visible,d=!s.parent||this._isVisible(this._groups_by_id[s.parent].properties);return h&&d}},{key:"isInMinMaxRange",value:function(s,h){var d=s.min<=h&&s.max>=h,g=!s.parent||this.isInMinMaxRange(this._groups_by_id[s.parent].properties,h);return d&&g}},{key:"dispose",value:function(){this._commands=[],_get(_getPrototypeOf(o.prototype),"dispose",this).call(this)}}],[{key:"_compareZInfo",value:function(s,h){for(var d,g=s.properties.ref.zInfo,_=h.properties.ref.zInfo,j=g.length,$=_.length,_t=Math.min(j,$),_e=1;_e<_t;_e++)if(d=g[_e]-_[_e])return d;return j-$}},{key:"_preprocessGeometry",value:function(s){var h=s.type;s.coordinates=h==="Point"?o._processPointCoordinates(s.coordinates):h==="MultiPoint"?s.coordinates.map(o._processPointCoordinates):h==="LineString"?o._processLineStringCoordinates(s.coordinates):h==="MultiLineString"?s.coordinates.map(o._processLineStringCoordinates):h==="Polygon"?s.coordinates.map(o._processPolygonCoordinates):h==="MultiPolygon"?s.coordinates.map(o._processMultiPolygonCoordinates):[]}},{key:"_processPointCoordinates",value:function(s){return[s[1],s[0],s[2]]}},{key:"_processLineStringCoordinates",value:function(s){return o._latLngAltArrayToLineString(s,!1)}},{key:"_processPolygonCoordinates",value:function(s){return o._latLngAltArrayToLineString(s,!0)}},{key:"_processMultiPolygonCoordinates",value:function(s){return s.map(o._processPolygonCoordinates)}},{key:"_latLngAltArrayToLineString",value:function(s,h){for(var d=[],g=s.length,_=0;_<g;_+=3)d.push([s[_+1],s[_]]);return h&&d.push([s[1],s[0]]),d}}])}(MapsJsSource);MapsJsSource.register(ObjectSource,"ObjectSource");var GEOMETRY_TYPE={POLYGON:1,POLYLINE:2,OUTLINE:3},IconMap=function(){return _createClass(function e(){_classCallCheck(this,e),this._map={}},[{key:"set",value:function(e,o,s){if(this._map[e])this._map[e].accumulator.add(s);else{var h=new Set;h.add(s),this._map[e]={value:o,accumulator:h}}}},{key:"get",value:function(e){return this._map[e]&&this._map[e].value}},{key:"delete",value:function(e,o){var s=this._map[e];s&&s.accumulator&&(s.accumulator.delete(o),s.accumulator.size===0&&delete this._map[e])}}])}(),ObjectTileSource=function(e){function o(s,h){var d;return _classCallCheck(this,o),d=_callSuper(this,o,[s,h]),Thread.is_worker||(d._icons=new IconMap),d}return _inherits(o,e),_createClass(o,[{key:"onProviderUpdate",value:function(s){s.target instanceof H.map.provider.Tile?this.dispatchUpdate(s.target,s.data):this.dispatchUpdate(void 0,s.data)}},{key:"onReady",value:function(){var s=this.provider;s.setTileCanvasRendering&&s.setTileCanvasRendering(!1),s.providesMarkers()&&(this._onCacheDrop=this._onCacheDrop.bind(this),s.getCache().registerOnDrop(this._onCacheDrop)),this.dispatchUpdate()}},{key:"dispose",value:function(){_get(_getPrototypeOf(o.prototype),"dispose",this).call(this);var s=this.provider;s.providesMarkers()&&s.getCache().deRegisterOnDrop(this._onCacheDrop)}},{key:"_onCacheDrop",value:function(s,h,d){this.provider.cacheFilter(s)&&this._deleteIcons(s,h.data)}},{key:"_deleteIcons",value:function(s,h){for(var d=0,g=h.length;d<g;d++){var _=h[d].getIcon();this._icons.delete(_.uid,s)}}},{key:"getIconBitmapByObjectId",value:function(s,h){var d=this._icons.get(h);return d&&d.getBitmap()}},{key:"requestMarkerTile",value:function(s){var h=this,d=new Promise(function(g,_){h.provider?h.provider.requestTileAsPromise(s.x,s.y,s.z,!1).then(function(j){var $,_t,_e=[];if(j.data)for(_t=($=j.data).length;_t--;){var _r=$[_t],_i=_r.getIcon();h._icons.set(_i.uid,_i,j.key),_e.push(_r.forWorkerMessage())}g(_e)}):g([])});return d}},{key:"requestSpatialTile",value:function(s){var h=this,d=new Promise(function(g,_){h.provider?h.provider.requestTileAsPromise(s.x,s.y,s.z,!1).then(function(j){var $,_t=[];if(j.getObjects){$=j.getObjects();for(var _e=0;_e<$.length;_e++){var _r=$[_e];_t.push({id:_r.getId(),geometries:_r.getGeometriesForTile(j),isClosed:_r.isClosed(),style:_r.getStyle().forWorkerMessage()})}}g(_t)}):g([])});return d}},{key:"_pointToArray",value:function(s){var h=Geo$1.tile_scale/this.tile_size;return[s.x*h,s.y*h]}},{key:"_getGeoJsonMultiPolygon",value:function(s){for(var h=s.geometries,d=h.length,g=[],_={coordinates:g,type:"MultiPolygon"},j=0;j<d;j++){var $=h[j],_t=$.paths,_e=_t.length,_r=$.interiorsIndex,_i=$.outlinesIndex,_n=Math.min(_r,_i,_e),_s=void 0,_l=void 0;for(_l=0;_l<_n;_l++)_s=[_t[_l].map(this._pointToArray,this)],g.push(_s);if(_n===1)for(_n=Math.min(_i,_e),_l=_r;_l<_n;_l++)_s.push(_t[_l].map(this._pointToArray,this))}return _}},{key:"_getGeoJsonMultiLineString",value:function(s){for(var h=arguments.length>1&&arguments[1]!==void 0&&arguments[1],d={coordinates:[],type:"MultiLineString"},g=s.geometries,_=0;_<g.length;_++)for(var j=g[_],$=h?j.outlinesIndex:0,_t=h?j.paths.length:Math.min(j.interiorsIndex,j.outlinesIndex,j.paths.length),_e=$;_e<_t;_e++){var _r=j.paths[_e].map(this._pointToArray,this);d.coordinates.push(_r)}return d}},{key:"_getGeoJsonGeometry",value:function(s,h){var d;return(d=h===GEOMETRY_TYPE.POLYGON?this._getGeoJsonMultiPolygon(s):this._getGeoJsonMultiLineString(s,h===GEOMETRY_TYPE.OUTLINE)).coordinates.length?d:null}},{key:"_load",value:function(s){var h,d=this;return h=new Promise(function(g,_){var j=WorkerBroker.postMessage(d.target_name+".requestMarkerTile",s.coords).then(d._prepareTileData.bind(d,s)),$=new Promise(function(_t,_e){WorkerBroker.postMessage(d.target_name+".requestSpatialTile",s.coords).then(function(_r){for(var _i=[],_n=[],_s=[],_l=0;_l<_r.length;_l++){var Ap=_r[_l],_h=void 0,_p=void 0;Ap.isClosed?(_h=_n,_p=GEOMETRY_TYPE.POLYGON):(_h=_i,_p=GEOMETRY_TYPE.POLYLINE);var ty=d._getGeoJsonGeometry(Ap,_p);if(ty){var ry={id:Ap.id,type:"Feature",properties:{height:0,style:Ap.style},geometry:ty};_p===GEOMETRY_TYPE.POLYLINE&&(ry.properties.effectiveZIdx=_i.length),_h.push(ry)}var ly=d._getGeoJsonGeometry(Ap,GEOMETRY_TYPE.OUTLINE);ly&&_s.push({id:Ap.id,type:"Feature",properties:{height:0,style:Ap.style,effectiveZIdx:_s.length},geometry:ly})}s.source_data.layers.polylines={type:"FeatureCollection",features:_i},s.source_data.layers.polygons={type:"FeatureCollection",features:_n},s.source_data.layers.outlines={type:"FeatureCollection",features:_s},_t(s)})});Promise.all([j,$]).then(function(_t){d._postProcessTile(s),g(s)})}),h}},{key:"_prepareTileData",value:function(s,h){var d=Geo$1.wrapTile(s.coords,{x:!0,y:!0}),g=Geo$1.metersForTile(d);s.source_data.layers={markers:{features:h,type:"FeatureCollection"}};var _={coords:d,min:g},j=s.source_data,$=layout$1("binary-tree"),_t={};for(var _e in j.layers)for(var _r=j.layers[_e].features.length,_i=0;_i<_r;_i++){var _n=j.layers[_e].features[_i],_s=_n.properties.icon;_t[_s.id]||($.addItem({width:_s.size.w,height:_s.size.h,meta:{objectId:_n.id,id:_s.id}}),_t[_s.id]=!0),Geo$1.transformGeometry(_n.geometry,function(_l){var Ap=_l[0];_l[0]=_l[1],_l[1]=Ap})}return s.rasters=$.export(),MapsJsSource.projectData(s.source_data),MapsJsSource.scaleData(s.source_data,_),s}}])}(MapsJsSource);MapsJsSource.register(ObjectTileSource,"ObjectTileSource");var RemoteRasterTileSource=function(e){function o(s,h){var d;return _classCallCheck(this,o),(d=_callSuper(this,o,[s,h])).uid_=s.uid,d}return _inherits(o,e),_createClass(o,[{key:"initialize",value:function(s,h,d,g){this.provider=s,this._on_update=h,this._onProviderUpdate=this._onProviderUpdate.bind(this),s.addEventListener("update",this._onProviderUpdate)}},{key:"_onProviderUpdate",value:function(s){this._on_update(this.name)}},{key:"tileTexture",value:function(s){return Object.assign(_get(_getPrototypeOf(o.prototype),"tileTexture",this).call(this,s),{uid:this.uid_,url:this.uid_+"_"+s.coords.key,coords:s.coords})}},{key:"dispose",value:function(){this.provider.removeEventListener("update",this._onProviderUpdate)}}])}(RasterTileSource);function geojsonvt(e,o){return new GeoJSONVT(e,o)}function GeoJSONVT(e,o){var s=(o=this.options=extend$1(Object.create(this.options),o)).debug;if(s&&console.time("preprocess data"),o.maxZoom<0||o.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(o.promoteId&&o.generateId)throw new Error("promoteId and generateId cannot be used together.");var h=convert(e,o);this.tiles={},this.tileCoords=[],s&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",o.indexMaxZoom,o.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(h=wrap$1(h,o)).length&&this.splitTile(h,0,0,0),s&&(h.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function toID(e,o,s){return 32*((1<<e)*s+o)+e}function extend$1(e,o){for(var s in o)e[s]=o[s];return e}DataSource.register(RemoteRasterTileSource,"RemoteRasterTileSource"),GeoJSONVT.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},GeoJSONVT.prototype.splitTile=function(e,o,s,h,d,g,_){for(var j=[e,o,s,h],$=this.options,_t=$.debug;j.length;){h=j.pop(),s=j.pop(),o=j.pop(),e=j.pop();var _e=1<<o,_r=toID(o,s,h),_i=this.tiles[_r];if(!_i&&(_t>1&&console.time("creation"),_i=this.tiles[_r]=createTile(e,o,s,h,$),this.tileCoords.push({z:o,x:s,y:h}),_t)){_t>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",o,s,h,_i.numFeatures,_i.numPoints,_i.numSimplified),console.timeEnd("creation"));var _n="z"+o;this.stats[_n]=(this.stats[_n]||0)+1,this.total++}if(_i.source=e,d){if(o===$.maxZoom||o===d)continue;var _s=1<<d-o;if(s!==Math.floor(g/_s)||h!==Math.floor(_/_s))continue}else if(o===$.indexMaxZoom||_i.numPoints<=$.indexMaxPoints)continue;if(_i.source=null,e.length!==0){_t>1&&console.time("clipping");var _l,Ap,_h,_p,ty,ry,ly=.5*$.buffer/$.extent,uy=.5-ly,py=.5+ly,fy=1+ly;_l=Ap=_h=_p=null,ty=clip(e,_e,s-ly,s+py,0,_i.minX,_i.maxX,$),ry=clip(e,_e,s+uy,s+fy,0,_i.minX,_i.maxX,$),e=null,ty&&(_l=clip(ty,_e,h-ly,h+py,1,_i.minY,_i.maxY,$),Ap=clip(ty,_e,h+uy,h+fy,1,_i.minY,_i.maxY,$),ty=null),ry&&(_h=clip(ry,_e,h-ly,h+py,1,_i.minY,_i.maxY,$),_p=clip(ry,_e,h+uy,h+fy,1,_i.minY,_i.maxY,$),ry=null),_t>1&&console.timeEnd("clipping"),j.push(_l||[],o+1,2*s,2*h),j.push(Ap||[],o+1,2*s,2*h+1),j.push(_h||[],o+1,2*s+1,2*h),j.push(_p||[],o+1,2*s+1,2*h+1)}}},GeoJSONVT.prototype.getTile=function(e,o,s){var h=this.options,d=h.extent,g=h.debug;if(e<0||e>24)return null;var _=1<<e,j=toID(e,o=(o%_+_)%_,s);if(this.tiles[j])return transformTile(this.tiles[j],d);g>1&&console.log("drilling down to z%d-%d-%d",e,o,s);for(var $,_t=e,_e=o,_r=s;!$&&_t>0;)_t--,_e=Math.floor(_e/2),_r=Math.floor(_r/2),$=this.tiles[toID(_t,_e,_r)];return $&&$.source?(g>1&&console.log("found parent tile z%d-%d-%d",_t,_e,_r),g>1&&console.time("drilling down"),this.splitTile($.source,_t,_e,_r,e,o,s),g>1&&console.timeEnd("drilling down"),this.tiles[j]?transformTile(this.tiles[j],d):null):null};var EMPTY_FEATURE_COLLECTION={type:"FeatureCollection",features:[]},GeoJSONTileSource=function(e){function o(s,h){return _classCallCheck(this,o),s.tiled=!0,s.url="",_callSuper(this,o,[s,h])}return _inherits(o,e),_createClass(o,[{key:"fetchTile",value:function(s,h,d){return this.provider?this.provider.requestTileAsPromise(s,h,d).then(function(g){return g.data}):Promise.resolve(EMPTY_FEATURE_COLLECTION)}},{key:"_load",value:function(s){var h=this,d=Geo$1.wrapTile(s.coords,{x:!0,y:!0}),g={indexMaxZoom:0,maxZoom:this.max_zoom,tolerance:1.5,extent:Geo$1.tile_scale};return WorkerBroker.postMessage(this.target_name+".fetchTile",d.x,d.y,d.z).then(function(_){for(var j in s.source_data.layers=_.type==="FeatureCollection"?{_default:_}:_,s.source_data.layers){var $=geojsonvt(s.source_data.layers[j],g).getTile(d.z,d.x,d.y);s.source_data.layers[j]=parseGeoJSONVectorTile($)}return h._postProcessTile(s),s})}},{key:"onReady",value:function(){this.dispatchUpdate()}}])}(MapsJsSource);DataSource.register(GeoJSONTileSource,"GeoJSONTileSource");var DEFAULT_RESPONSE={layers:{_default:{type:"FeatureCollection",features:[{type:"Point",geometry:{}}]}}},SkyBoxSource=function(e){function o(s,h){return _classCallCheck(this,o),s.max_zoom=0,_callSuper(this,o,[s,h])}return _inherits(o,e),_createClass(o,[{key:"load",value:function(s){return s.source_data=s.coords.key==="0/0/0"?DEFAULT_RESPONSE:void 0,Promise.resolve(s)}}])}(DataSource),debugSettings;DataSource.register(SkyBoxSource,"SkyBox");var debugSettings$1=debugSettings={draw_label_collision_boxes:!1,draw_label_texture_boxes:!1,suppress_label_fade_in:!1,suppress_snap_animation:!1,show_hidden_labels:!1,layer_stats:!1};function mergeDebugSettings(e){Object.assign(debugSettings,e)}var WorkerType={NATIVE:0,FAKE:1},Context;function sliceObject(e,o){var s={};return o.forEach(function(h){return s[h]=e[h]}),s}var Context$1=Context={},context_id=0,gl;Context.getContext=function(e,o){var s=!1;e==null&&((e=document.createElement("canvas")).style.position="absolute",e.style.top=0,e.style.left=0,e.style.zIndex=-1,document.body.appendChild(e),s=!0);var h=e.getContext("webgl",o)||e.getContext("experimental-webgl",o);if(!h)throw new Error("Couldn't create WebGL context.");return h._tangram_id=context_id++,s?(Context.resize(h,window.innerWidth,window.innerHeight,o.device_pixel_ratio),window.addEventListener("resize",function(){Context.resize(h,window.innerWidth,window.innerHeight,o.device_pixel_ratio)})):Context.resize(h,parseFloat(e.style.width),parseFloat(e.style.height),o.device_pixel_ratio),h},Context.resize=function(e,o,s,h){e.canvas.style.width=o+"px",e.canvas.style.height=s+"px",e.canvas.width=Math.round(o*h),e.canvas.height=Math.round(s*h),e.bindFramebuffer(e.FRAMEBUFFER,null),e.viewport(0,0,e.canvas.width,e.canvas.height)};var gl$1=gl={};gl.BYTE=5120,gl.UNSIGNED_BYTE=5121,gl.SHORT=5122,gl.UNSIGNED_SHORT=5123,gl.INT=5124,gl.UNSIGNED_INT=5125,gl.FLOAT=5126;var MAX_VALUE=Math.pow(2,16)-1,DEFAULT_SIZE=1024,HAS_ELEMENT_INDEX_UINT=!1,VertexElements=function(){return _createClass(function e(o){_classCallCheck(this,e),this.size_=o||DEFAULT_SIZE,this.position_=0,this.ArrayType_=Uint16Array,this.buffer_=new this.ArrayType_(this.size_),this.overflows_=!1},[{key:"push",value:function(e){if(!this.overflows_||HAS_ELEMENT_INDEX_UINT){if(e>MAX_VALUE){if(this.overflows_=!0,!HAS_ELEMENT_INDEX_UINT)return;this.ArrayType_===Uint16Array&&(this.ArrayType_=Uint32Array,this.buffer_=new this.ArrayType_(this.buffer_))}this.position_===this.size_&&this.expand_(),this.buffer_[this.position_]=e,this.position_+=1}}},{key:"end",value:function(){if(this.position_!==0){var e=this.buffer_,o=this.position_;return this.buffer_=new this.ArrayType_(this.size_),this.position_=0,this.overflows_=!1,e.subarray(0,o)}return!1}},{key:"expand_",value:function(){this.size_=this.size_<<1;var e=new this.ArrayType_(this.size_);e.set(this.buffer_),this.buffer_=e}}])}();VertexElements.setElementIndexUint=function(e){HAS_ELEMENT_INDEX_UINT=e};var array_types=_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},gl$1.FLOAT,Float32Array),gl$1.BYTE,Int8Array),gl$1.UNSIGNED_BYTE,Uint8Array),gl$1.INT,Int32Array),gl$1.UNSIGNED_INT,Uint32Array),gl$1.SHORT,Int16Array),gl$1.UNSIGNED_SHORT,Uint16Array),VertexData=function(){function e(o){var s=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).prealloc,h=s===void 0?500:s;_classCallCheck(this,e),this.vertex_layout=o,this.vertex_elements=new VertexElements,this.stride=this.vertex_layout.stride,e.array_pool.length>0?(this.vertex_buffer=e.array_pool.pop(),this.byte_length=this.vertex_buffer.byteLength,this.size=Math.floor(this.byte_length/this.stride),log("trace","VertexData: reused buffer of bytes ".concat(this.byte_length,", ").concat(this.size," vertices"))):(this.size=h,this.byte_length=this.stride*this.size,this.vertex_buffer=new Uint8Array(this.byte_length)),this.offset=0,this.vertex_count=0,this.realloc_count=0,this.setBufferViews(),this.setAddVertexFunction()}return _createClass(e,[{key:"setBufferViews",value:function(){var o=this;this.views={},this.views[gl$1.UNSIGNED_BYTE]=this.vertex_buffer,this.vertex_layout.dynamic_attribs.forEach(function(s){if(o.views[s.type]==null){var h=array_types[s.type];o.views[s.type]=new h(o.vertex_buffer.buffer)}})}},{key:"checkBufferSize",value:function(){if(this.offset+this.stride>this.byte_length){this.size=Math.floor(1.5*this.size),this.size-=this.size%4,this.byte_length=this.stride*this.size;var o=new Uint8Array(this.byte_length);o.set(this.vertex_buffer),e.array_pool.push(this.vertex_buffer),this.vertex_buffer=o,this.setBufferViews(),this.realloc_count++}}},{key:"setAddVertexFunction",value:function(){this.vertexLayoutAddVertex=this.vertex_layout.getAddVertexFunction()}},{key:"addVertex",value:function(o){this.checkBufferSize(),this.vertexLayoutAddVertex(o,this.views,this.offset),this.offset+=this.stride,this.vertex_count++}},{key:"end",value:function(){return this.vertex_buffer=this.vertex_buffer.subarray(0,this.offset),this.element_buffer=this.vertex_elements.end(),log("trace","VertexData: ".concat(this.size," vertices total, realloc count ").concat(this.realloc_count)),this}}])}();VertexData.array_pool=[];var VertexLayout=function(){function e(o){_classCallCheck(this,e),this.attribs=o,this.dynamic_attribs=this.attribs.filter(function(_t){return!_t.static}),this.components=[],this.index={},this.offset={},this.stride=0;for(var s=0,h=0,d=0;d<this.attribs.length;d++){var g=this.attribs[d];if(g.static==null){g.offset=this.stride,g.byte_size=g.size;var _=0;switch(g.type){case gl$1.FLOAT:case gl$1.INT:case gl$1.UNSIGNED_INT:g.byte_size*=4,_=2;break;case gl$1.SHORT:case gl$1.UNSIGNED_SHORT:g.byte_size*=2,_=1}3&g.byte_size&&(g.byte_size+=4-(3&g.byte_size)),this.stride+=g.byte_size;for(var j=g.offset>>_,$=0;$<g.size;$++)this.components.push({type:g.type,shift:_,offset:j++,index:h++});this.index[g.name]=s,s+=g.size,this.offset[g.name]=g.offset}else g.static=Array.isArray(g.static)?g.static:[g.static],g.method="vertexAttrib".concat(g.static.length,"fv")}}return _createClass(e,[{key:"enable",value:function(o,s,h){for(var d,g,_=0;_<this.attribs.length;_++)d=this.attribs[_],(g=s.attribute(d.name).location)!==-1&&(d.static==null?(e.enabled_attribs[g]&&!h||o.enableVertexAttribArray(g),o.vertexAttribPointer(g,d.size,d.type,d.normalized,this.stride,d.offset),e.enabled_attribs[g]=s):o[d.method]instanceof Function&&(o.enableVertexAttribArray(g),o[d.method](g,d.static),o.disableVertexAttribArray(g),delete e.enabled_attribs[g]));for(g in e.enabled_attribs)this.disableUnusedAttribute(o,g,s)}},{key:"disableUnusedAttribute",value:function(o,s,h){e.enabled_attribs[s]!==h&&(o.disableVertexAttribArray(s),delete e.enabled_attribs[s])}},{key:"createVertexData",value:function(){return new VertexData(this)}},{key:"getAddVertexFunction",value:function(){return this.addVertex==null&&this.createAddVertexFunction(),this.addVertex}},{key:"createAddVertexFunction",value:function(){var o=hashString(JSON.stringify(this.attribs));if(e.add_vertex_funcs[o]==null){var s,h=["var t, o;"],d=_toConsumableArray(this.components);d.sort(function($,_t){return $.type!==_t.type?$.type-_t.type:$.index-_t.index});for(var g=0;g<d.length;g++){var _=d[g];s!==_.type&&(h.push("t = vs[".concat(_.type,"];")),h.push("o = off".concat(_.shift?" >> "+_.shift:"",";")),s=_.type),h.push("t[o + ".concat(_.offset,"] = v[").concat(_.index,"];"))}h=h.join(`
`);var j=new Function("v","vs","off",h);e.add_vertex_funcs[o]=j}this.addVertex=e.add_vertex_funcs[o]}}])}();VertexLayout.enabled_attribs={},VertexLayout.add_vertex_funcs={};var tile_bounds=[{x:0,y:0},{x:Geo$1.tile_scale,y:-Geo$1.tile_scale}],default_uvs=[0,0,1,1];function outsideTile(e,o,s){var h=tile_bounds[0],d=tile_bounds[1];return e[0]<=h.x+s&&o[0]<=h.x+s||e[0]>=d.x-s&&o[0]>=d.x-s||e[1]>=h.y-s&&o[1]>=h.y-s||e[1]<=d.y+s&&o[1]<=d.y+s}function isCoordOutsideTile(e,o){o=o||0;var s=tile_bounds[0],h=tile_bounds[1];return e[0]<=s.x+o||e[0]>=h.x-o||e[1]>=s.y-o||e[1]<=h.y+o}var earcut_1=earcut;function earcut(e,o,s){s=s||2;var h,d,g,_,j,$,_t,_e=o&&o.length,_r=_e?o[0]*s:e.length,_i=linkedList(e,0,_r,s,!0),_n=[];if(!_i)return _n;if(_e&&(_i=eliminateHoles(e,o,_i,s)),e.length>80*s){h=g=e[0],d=_=e[1];for(var _s=s;_s<_r;_s+=s)(j=e[_s])<h&&(h=j),($=e[_s+1])<d&&(d=$),j>g&&(g=j),$>_&&(_=$);_t=Math.max(g-h,_-d)}return earcutLinked(_i,_n,s,h,d,_t),_n}function linkedList(e,o,s,h,d){var g,_;if(d===signedArea(e,o,s,h)>0)for(g=o;g<s;g+=h)_=insertNode(g,e[g],e[g+1],_);else for(g=s-h;g>=o;g-=h)_=insertNode(g,e[g],e[g+1],_);return _&&equals(_,_.next)&&(removeNode(_),_=_.next),_}function filterPoints(e,o){if(!e)return e;o||(o=e);var s,h=e;do if(s=!1,h.steiner||!equals(h,h.next)&&area(h.prev,h,h.next)!==0)h=h.next;else{if(removeNode(h),(h=o=h.prev)===h.next)return null;s=!0}while(s||h!==o);return o}function earcutLinked(e,o,s,h,d,g,_){if(e){!_&&g&&indexCurve(e,h,d,g);for(var j,$,_t=e;e.prev!==e.next;)if(j=e.prev,$=e.next,g?isEarHashed(e,h,d,g):isEar(e))o.push(j.i/s),o.push(e.i/s),o.push($.i/s),removeNode(e),e=$.next,_t=$.next;else if((e=$)===_t){_?_===1?earcutLinked(e=cureLocalIntersections(e,o,s),o,s,h,d,g,2):_===2&&splitEarcut(e,o,s,h,d,g):earcutLinked(filterPoints(e),o,s,h,d,g,1);break}}}function isEar(e){var o=e.prev,s=e,h=e.next;if(area(o,s,h)>=0)return!1;for(var d=e.next.next;d!==e.prev;){if(pointInTriangle(o.x,o.y,s.x,s.y,h.x,h.y,d.x,d.y)&&area(d.prev,d,d.next)>=0)return!1;d=d.next}return!0}function isEarHashed(e,o,s,h){var d=e.prev,g=e,_=e.next;if(area(d,g,_)>=0)return!1;for(var j=d.x<g.x?d.x<_.x?d.x:_.x:g.x<_.x?g.x:_.x,$=d.y<g.y?d.y<_.y?d.y:_.y:g.y<_.y?g.y:_.y,_t=d.x>g.x?d.x>_.x?d.x:_.x:g.x>_.x?g.x:_.x,_e=d.y>g.y?d.y>_.y?d.y:_.y:g.y>_.y?g.y:_.y,_r=zOrder(j,$,o,s,h),_i=zOrder(_t,_e,o,s,h),_n=e.nextZ;_n&&_n.z<=_i;){if(_n!==e.prev&&_n!==e.next&&pointInTriangle(d.x,d.y,g.x,g.y,_.x,_.y,_n.x,_n.y)&&area(_n.prev,_n,_n.next)>=0)return!1;_n=_n.nextZ}for(_n=e.prevZ;_n&&_n.z>=_r;){if(_n!==e.prev&&_n!==e.next&&pointInTriangle(d.x,d.y,g.x,g.y,_.x,_.y,_n.x,_n.y)&&area(_n.prev,_n,_n.next)>=0)return!1;_n=_n.prevZ}return!0}function cureLocalIntersections(e,o,s){var h=e;do{var d=h.prev,g=h.next.next;!equals(d,g)&&intersects(d,h,h.next,g)&&locallyInside(d,g)&&locallyInside(g,d)&&(o.push(d.i/s),o.push(h.i/s),o.push(g.i/s),removeNode(h),removeNode(h.next),h=e=g),h=h.next}while(h!==e);return h}function splitEarcut(e,o,s,h,d,g){var _=e;do{for(var j=_.next.next;j!==_.prev;){if(_.i!==j.i&&isValidDiagonal(_,j)){var $=splitPolygon(_,j);return _=filterPoints(_,_.next),$=filterPoints($,$.next),earcutLinked(_,o,s,h,d,g),void earcutLinked($,o,s,h,d,g)}j=j.next}_=_.next}while(_!==e)}function eliminateHoles(e,o,s,h){var d,g,_,j=[];for(d=0,g=o.length;d<g;d++)(_=linkedList(e,o[d]*h,d<g-1?o[d+1]*h:e.length,h,!1))===_.next&&(_.steiner=!0),j.push(getLeftmost(_));for(j.sort(compareX),d=0;d<j.length;d++)eliminateHole(j[d],s),s=filterPoints(s,s.next);return s}function compareX(e,o){return e.x-o.x}function eliminateHole(e,o){if(o=findHoleBridge(e,o)){var s=splitPolygon(o,e);filterPoints(s,s.next)}}function findHoleBridge(e,o){var s,h=o,d=e.x,g=e.y,_=-1/0;do{if(g<=h.y&&g>=h.next.y){var j=h.x+(g-h.y)*(h.next.x-h.x)/(h.next.y-h.y);if(j<=d&&j>_){if(_=j,j===d){if(g===h.y)return h;if(g===h.next.y)return h.next}s=h.x<h.next.x?h:h.next}}h=h.next}while(h!==o);if(!s)return null;if(d===_)return s.prev;var $,_t=s,_e=s.x,_r=s.y,_i=1/0;for(h=s.next;h!==_t;)d>=h.x&&h.x>=_e&&pointInTriangle(g<_r?d:_,g,_e,_r,g<_r?_:d,g,h.x,h.y)&&(($=Math.abs(g-h.y)/(d-h.x))<_i||$===_i&&h.x>s.x)&&locallyInside(h,e)&&(s=h,_i=$),h=h.next;return s}function indexCurve(e,o,s,h){var d=e;do d.z===null&&(d.z=zOrder(d.x,d.y,o,s,h)),d.prevZ=d.prev,d.nextZ=d.next,d=d.next;while(d!==e);d.prevZ.nextZ=null,d.prevZ=null,sortLinked(d)}function sortLinked(e){var o,s,h,d,g,_,j,$,_t=1;do{for(s=e,e=null,g=null,_=0;s;){for(_++,h=s,j=0,o=0;o<_t&&(j++,h=h.nextZ);o++);for($=_t;j>0||$>0&&h;)j===0?(d=h,h=h.nextZ,$--):$!==0&&h?s.z<=h.z?(d=s,s=s.nextZ,j--):(d=h,h=h.nextZ,$--):(d=s,s=s.nextZ,j--),g?g.nextZ=d:e=d,d.prevZ=g,g=d;s=h}g.nextZ=null,_t*=2}while(_>1);return e}function zOrder(e,o,s,h,d){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)/d)|e<<8))|e<<4))|e<<2))|e<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-h)/d)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function getLeftmost(e){var o=e,s=e;do o.x<s.x&&(s=o),o=o.next;while(o!==e);return s}function pointInTriangle(e,o,s,h,d,g,_,j){return(d-_)*(o-j)-(e-_)*(g-j)>=0&&(e-_)*(h-j)-(s-_)*(o-j)>=0&&(s-_)*(g-j)-(d-_)*(h-j)>=0}function isValidDiagonal(e,o){return e.next.i!==o.i&&e.prev.i!==o.i&&!intersectsPolygon(e,o)&&locallyInside(e,o)&&locallyInside(o,e)&&middleInside(e,o)}function area(e,o,s){return(o.y-e.y)*(s.x-o.x)-(o.x-e.x)*(s.y-o.y)}function equals(e,o){return e.x===o.x&&e.y===o.y}function intersects(e,o,s,h){return!!(equals(e,o)&&equals(s,h)||equals(e,h)&&equals(s,o))||area(e,o,s)>0!=area(e,o,h)>0&&area(s,h,e)>0!=area(s,h,o)>0}function intersectsPolygon(e,o){var s=e;do{if(s.i!==e.i&&s.next.i!==e.i&&s.i!==o.i&&s.next.i!==o.i&&intersects(s,s.next,e,o))return!0;s=s.next}while(s!==e);return!1}function locallyInside(e,o){return area(e.prev,e,e.next)<0?area(e,o,e.next)>=0&&area(e,e.prev,o)>=0:area(e,o,e.prev)<0||area(e,e.next,o)<0}function middleInside(e,o){var s=e,h=!1,d=(e.x+o.x)/2,g=(e.y+o.y)/2;do s.y>g!=s.next.y>g&&d<(s.next.x-s.x)*(g-s.y)/(s.next.y-s.y)+s.x&&(h=!h),s=s.next;while(s!==e);return h}function splitPolygon(e,o){var s=new Node(e.i,e.x,e.y),h=new Node(o.i,o.x,o.y),d=e.next,g=o.prev;return e.next=o,o.prev=e,s.next=d,d.prev=s,h.next=s,s.prev=h,g.next=h,h.prev=g,h}function insertNode(e,o,s,h){var d=new Node(e,o,s);return h?(d.next=h.next,d.prev=h,h.next.prev=d,h.next=d):(d.prev=d,d.next=d),d}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,o,s){this.i=e,this.x=o,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(e,o,s,h){for(var d=0,g=o,_=s-h;g<s;g+=h)d+=(e[_]-e[g])*(e[g+1]+e[_+1]),_=g;return d}earcut.deviation=function(e,o,s,h){var d=o&&o.length,g=d?o[0]*s:e.length,_=Math.abs(signedArea(e,0,g,s));if(d)for(var j=0,$=o.length;j<$;j++){var _t=o[j]*s,_e=j<$-1?o[j+1]*s:e.length;_-=Math.abs(signedArea(e,_t,_e,s))}var _r=0;for(j=0;j<h.length;j+=3){var _i=h[j]*s,_n=h[j+1]*s,_s=h[j+2]*s;_r+=Math.abs((e[_i]-e[_s])*(e[_n+1]-e[_i+1])-(e[_i]-e[_n])*(e[_s+1]-e[_i+1]))}return _===0&&_r===0?0:Math.abs((_r-_)/_)},earcut.flatten=function(e){for(var o=e[0][0].length,s={vertices:[],holes:[],dimensions:o},h=0,d=0;d<e.length;d++){for(var g=0;g<e[d].length;g++)for(var _=0;_<o;_++)s.vertices.push(e[d][g][_]);d>0&&(h+=e[d-1].length,s.holes.push(h))}return s};var earcut$1=getDefaultExportFromCjs(earcut_1),up_vec3=[0,0,1];function buildPolygons(e,o,s,h){var d=h.texcoord_index,g=h.texcoord_scale,_=h.texcoord_normalize,j=o.vertex_elements;if(d){_=_||1;var $=_slicedToArray(g||default_uvs,4),_t=$[0],_e=$[1],_r=$[2],_i=$[3]}for(var _n=0,_s=e.length,_l=0;_l<_s;_l++){var Ap=o.vertex_count,_h=e[_l];if(d)var _p=_slicedToArray(Geo$1.findBoundingBox(_h),4),ty=_p[0],ry=_p[1],ly=(_r-_t)/(_p[2]-ty),uy=(_i-_e)/(_p[3]-ry);for(var py=0;py<_h.length;py++)for(var fy=_h[py],my=0;my<fy.length;my++){var xy=fy[my];s[0]=xy[0],s[1]=xy[1],d&&(s[d+0]=((xy[0]-ty)*ly+_t)*_,s[d+1]=((xy[1]-ry)*uy+_e)*_),o.addVertex(s)}for(var Ly=triangulatePolygon(earcut$1.flatten(_h)),My=0;My<Ly.length;My++)j.push(Ap+Ly[My]);_n+=Ly.length/3}return _n}function buildExtrudedPolygons(e,o,s,h,d,g,_,j,$){var _t=$.remove_tile_edges,_e=$.tile_edge_tolerance,_r=$.texcoord_index,_i=$.texcoord_scale,_n=$.texcoord_normalize,_s=$.winding,_l=o+(h||0),Ap=o+s;g[2]=Ap;var _h=buildPolygons(e,d,g,{texcoord_index:_r,texcoord_scale:_i,texcoord_normalize:_n}),_p=d.vertex_elements,ty=d.vertex_count;if(_r){_n=_n||1;var ry=_slicedToArray(_i||default_uvs,4),ly=ry[0],uy=ry[1],py=ry[2],fy=ry[3],my=[[ly,fy],[ly,uy],[py,uy],[py,fy]]}for(var xy=e.length,Ly=0;Ly<xy;Ly++)for(var My=e[Ly],Ry=0;Ry<My.length;Ry++)for(var Sy=My[Ry],Zy=0;Zy<Sy.length-1;Zy++)if(!_t||!outsideTile(Sy[Zy],Sy[Zy+1],_e)){var qy=void 0,_m=void 0;_s==="CCW"?(qy=Zy,_m=Zy+1):(qy=Zy+1,_m=Zy);var ky=[[Sy[_m][0],Sy[_m][1],Ap],[Sy[_m][0],Sy[_m][1],_l],[Sy[qy][0],Sy[qy][1],_l],[Sy[qy][0],Sy[qy][1],Ap]],Dy=Vector$1.normalize([Sy[_m][0]-Sy[qy][0],Sy[_m][1]-Sy[qy][1],0]),Gy=Vector$1.cross(up_vec3,Dy);g[_+0]=Gy[0]*j,g[_+1]=Gy[1]*j,g[_+2]=Gy[2]*j;for(var Ky=0;Ky<ky.length;Ky++)g[0]=ky[Ky][0],g[1]=ky[Ky][1],g[2]=ky[Ky][2],_r&&(g[_r+0]=my[Ky][0]*_n,g[_r+1]=my[Ky][1]*_n),d.addVertex(g);_p.push(ty+0),_p.push(ty+1),_p.push(ty+2),_p.push(ty+2),_p.push(ty+3),_p.push(ty+0),ty+=4,_h+=2}return _h}function triangulatePolygon(e){return earcut$1(e.vertices,e.holes,e.dimensions)}var shaderSrc_polygonsVertex=`uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;attribute vec4 a_position;attribute vec4 a_color;
#ifdef TANGRAM_NORMAL_ATTRIBUTE
attribute vec3 a_normal;
#define TANGRAM_NORMAL a_normal
#else
#define TANGRAM_NORMAL vec3(0., 0., 1.)
#endif
#ifdef TANGRAM_EXTRUDE_LINES
attribute vec2 a_extrude;attribute vec2 a_offset;attribute vec2 a_scaling;uniform float u_v_scale_adjust;
#endif
varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;
#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)
attribute vec2 a_texcoord;varying vec2 v_texcoord;
#endif
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
varying vec4 v_modelpos_base_zoom;
#endif
#if defined(TANGRAM_LIGHTING_VERTEX)
varying vec4 v_lighting;
#endif
#define UNPACK_SCALING(x) (x / 1024.)
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: raster
#pragma tangram: global
void main(){
#pragma tangram: setup
#ifdef TANGRAM_TEXTURE_COORDS
v_texcoord=a_texcoord;
#ifdef TANGRAM_EXTRUDE_LINES
v_texcoord.y*=u_v_scale_adjust;
#endif
#endif
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
v_modelpos_base_zoom=modelPositionBaseZoom();
#endif
vec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.);
#ifdef TANGRAM_EXTRUDE_LINES
vec2 extrude=a_extrude.xy;vec2 offset=a_offset.xy;float dz=clamp(u_map_position.z-u_tile_origin.z,0.,4.);dz+=step(1.,dz)*(1.-dz)+mix(0.,2.,clamp((dz-2.)/2.,0.,1.));float mdz=(dz-0.5)*2.;extrude-=extrude*UNPACK_SCALING(a_scaling.x)*mdz;float dwdz=UNPACK_SCALING(a_scaling.y);float sdwdz=sign(step(0.,dwdz)-0.5);offset-=offset*abs(dwdz)*((1.-step(0.,sdwdz))-(dz*-sdwdz));float ssz=exp2(-dz-(u_tile_origin.z-u_tile_origin.w));extrude*=ssz;offset*=ssz;
#ifdef TANGRAM_BLOCK_WIDTH
float width=1.;
#pragma tangram: width
extrude*=width;
#endif
position.xy+=extrude+offset;
#endif
v_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;
#pragma tangram: position
v_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);v_color=a_color;
#if defined(TANGRAM_LIGHTING_VERTEX)
vec3 normal=v_normal;
#pragma tangram: normal
v_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));
#endif
cameraProjection(position);applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);
#if defined(SNAP_TO_PIXEL_GRID)
snapToPixelGrid(position);
#endif
gl_Position=position;}`,shaderSrc_polygonsFragment=`uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;
#ifdef TANGRAM_EXTRUDE_LINES
uniform bool u_has_line_texture;uniform sampler2D u_texture;uniform float u_texture_ratio;uniform vec4 u_dash_background_color;
#endif
#define TANGRAM_NORMAL v_normal
#if defined(TANGRAM_TEXTURE_COORDS) || defined(TANGRAM_EXTRUDE_LINES)
varying vec2 v_texcoord;
#endif
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
varying vec4 v_modelpos_base_zoom;
#endif
#if defined(TANGRAM_LIGHTING_VERTEX)
varying vec4 v_lighting;
#endif
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: raster
#pragma tangram: global
#pragma tangram: utils
void main(void){
#pragma tangram: setup
vec4 color=v_color;vec3 normal=TANGRAM_NORMAL;
#ifdef TANGRAM_CROP_BY_TILE
if(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}
#endif
#ifdef TANGRAM_RASTER_TEXTURE_COLOR
color*=sampleRaster();
#endif
#ifdef TANGRAM_EXTRUDE_LINES
if(u_has_line_texture){vec2 _line_st=vec2(v_texcoord.x,fract(v_texcoord.y/u_texture_ratio));vec4 _line_color=texture2D(u_texture,_line_st);if(_line_color.a<TANGRAM_ALPHA_TEST){
#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY)
if(u_dash_background_color.a==0.){discard;}color=u_dash_background_color;
#else
color=vec4(u_dash_background_color.rgb,color.a*step(TANGRAM_EPSILON,u_dash_background_color.a));
#endif
}else{color*=_line_color;}}
#endif
#ifdef TANGRAM_RASTER_TEXTURE_NORMAL
normal=normalize(sampleRaster().rgb*2.-1.);
#endif
#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)
calculateNormal(normal);
#endif
#if !defined(TANGRAM_LIGHTING_VERTEX)
#pragma tangram: normal
#endif
#pragma tangram: color
#if defined(TANGRAM_LIGHTING_FRAGMENT)
color=calculateLighting(v_position.xyz-u_eye,normal,color);
#elif defined(TANGRAM_LIGHTING_VERTEX)
color*=v_lighting;
#endif
#pragma tangram: filter
gl_FragColor=color;}`,Polygons=Object.create(Style);Object.assign(Polygons,{name:"polygons",built_in:!0,vertex_shader_src:shaderSrc_polygonsVertex,fragment_shader_src:shaderSrc_polygonsFragment,selection:!0,init:function(){Style.init.apply(this,arguments),this.defines.TANGRAM_NORMAL_ATTRIBUTE=!0,this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.texcoords&&(this.defines.TANGRAM_TEXTURE_COORDS=!0)},vertexLayoutForMeshVariant:function(e){if(!this.vertex_layout){var o=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_normal",size:3,type:gl$1.BYTE,normalized:!0},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0}];this.texcoords&&o.push({name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0}),this.vertex_layout=new VertexLayout(o)}return this.vertex_layout},_parseFeature:function(e,o,s){var h=this.feature_style;return h.color=this.parseColor(o.color,s),h.color?(h.z=o.z&&StyleParser.evalCachedDistanceProperty(o.z,s)||StyleParser.defaults.z,h.z*=Geo$1.height_scale,h.extrude=StyleParser.evalProperty(o.extrude,s),h.extrude&&(h.extrude===!0?(h.height=e.properties.height!==void 0?e.properties.height:StyleParser.defaults.height,h.min_height=e.properties.min_height!==void 0?e.properties.min_height:StyleParser.defaults.min_height):typeof h.extrude=="number"?(h.height=h.extrude,h.min_height=0):Array.isArray(h.extrude)&&(h.min_height=h.extrude[0],h.height=h.extrude[1]),h.height*=Geo$1.height_scale,h.min_height*=Geo$1.height_scale),h.tile_edges=o.tile_edges,h):null},_preprocess:function(e){return e.color=StyleParser.createColorPropertyCache(e.color),e.z=StyleParser.createPropertyCache(e.z,StyleParser.parseUnits),e},makeVertexTemplate:function(e){var o=0;return this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=e.z||0,this.vertex_template[o++]=this.scaleOrder(e.order),this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template[o++]=127,this.vertex_template[o++]=255*e.color[0],this.vertex_template[o++]=255*e.color[1],this.vertex_template[o++]=255*e.color[2],this.vertex_template[o++]=255*e.color[3],this.selection&&(this.vertex_template[o++]=255*e.selection_color[0],this.vertex_template[o++]=255*e.selection_color[1],this.vertex_template[o++]=255*e.selection_color[2],this.vertex_template[o++]=255*e.selection_color[3]),this.texcoords&&(this.vertex_template[o++]=0,this.vertex_template[o++]=0),this.vertex_template},buildPolygons:function(e,o,s,h){var d=this.makeVertexTemplate(o),g={texcoord_index:this.vertex_layout.index.a_texcoord,texcoord_normalize:65535,remove_tile_edges:!o.tile_edges,tile_edge_tolerance:Geo$1.tile_scale*h.tile.pad_scale*4,winding:h.winding};return o.extrude&&o.height?buildExtrudedPolygons(e,o.z,o.height,o.min_height,s.vertex_data,d,this.vertex_layout.index.a_normal,127,g):buildPolygons(e,s.vertex_data,d,g)}});var zero_vec2=[0,0],CAP_TYPE$1={butt:0,square:1,round:2},JOIN_TYPE$1={miter:0,bevel:1,round:2},DEFAULT={MITER_LIMIT:3,TEXCOORD_NORMALIZE:1,TEXCOORD_RATIO:1,MIN_FAN_WIDTH:5},v_scale_adjust=Geo$1.tile_scale,zero_v=[0,0],one_v=[1,0],mid_v=[.5,0];function buildPolylines$1(e,o,s,h,d){var g=d.closed_polygon,_=d.remove_tile_edges,j=d.tile_edge_tolerance,$=d.texcoord_index,_t,_e=d.texcoord_width,_r=d.texcoord_ratio,_i=d.texcoord_normalize,_n=d.extrude_index,_s=d.offset_index,_l=d.join,Ap=d.cap,_h=d.miter_limit,_p=d.offset,ty=d.crop_by_tile,ry=Ap?CAP_TYPE$1[Ap]:CAP_TYPE$1.butt,ly=_l?JOIN_TYPE$1[_l]:JOIN_TYPE$1.miter;if(ly===JOIN_TYPE$1.miter)var uy=(_h=_h||DEFAULT.MITER_LIMIT)*_h;$&&(_i=_i||DEFAULT.TEXCOORD_NORMALIZE,_t=1/(_e*(_r=_r||DEFAULT.TEXCOORD_RATIO)*v_scale_adjust));for(var py={closed_polygon:g,remove_tile_edges:_,tile_edge_tolerance:j,miter_len_sq:uy,join_type:ly,cap_type:ry,vertex_data:s,vertex_template:h,half_width:o/2,extrude_index:_n,offset_index:_s,v_scale:_t,texcoord_index:$,texcoord_width:_e,texcoord_normalize:_i,offset:_p,geom_count:0,crop_by_tile:ty},fy=0;fy<e.length;fy++)buildPolyline$1(e[fy],py);if(py.extra_lines)for(var my=0;my<py.extra_lines.length;my++)buildPolyline$1(py.extra_lines[my],py);return py.geom_count}function buildPolyline$1(e,o){if(!(e.length<2)){var s,h,d,g,_=o.join_type,j=o.cap_type,$=o.closed_polygon,_t=o.remove_tile_edges,_e=o.tile_edge_tolerance,_r=o.v_scale,_i=o.miter_len_sq,_n=o.crop_by_tile,_s=o.texcoord_index!=null,_l=0;if($&&_===JOIN_TYPE$1.miter){var Ap=getTileBoundaryIndex(e);if(Ap!==0){var _h=permuteLine(e,Ap);return o.extra_lines=o.extra_lines||[],void o.extra_lines.push(_h)}}var _p=0,ty=e.length-1,ry=0;for(s=e[_p],h=e[_p+1];Vector$1.isEqual(s,h);)if(s=h,h=e[++_p+1],ry++,_p===e.length-1)return;for(;Vector$1.isEqual(e[ty],e[ty-1]);)if(ry++,--ty===0)return;if(!(e.length<2+ry))if(g=Vector$1.normalize(Vector$1.perp(s,h)),_t&&outsideTile(s,h,_e)){var ly=getNextNonBoundarySegment(e,_p,_e);ly&&(o.extra_lines=o.extra_lines||[],o.extra_lines.push(ly))}else{$?startPolygon(s,d=Vector$1.normalize(Vector$1.perp(e[ty-1],s)),g,_,o):(!_n&&isCoordOutsideTile(s)||(addCap(s,_l,g,j,!0,o),_s&&j!==CAP_TYPE$1.butt&&(_l+=.5*_r*o.texcoord_width)),addVertex$1(s,g,g,1,_l,o,1),addVertex$1(s,g,g,0,_l,o,-1)),_s&&(_l+=_r*Vector$1.length(Vector$1.sub(h,s)));for(var uy=_p+1;uy<ty;uy++){var py=uy,fy=uy+1;if(s=e[py],h=e[fy],!Vector$1.isEqual(s,h)){if(_t&&outsideTile(s,h,_e)){addVertex$1(s,g,g,1,_l,o,1),addVertex$1(s,g,g,0,_l,o,-1),indexPairs(1,o);var my=getNextNonBoundarySegment(e,py+1,_e);return void(my&&(o.extra_lines=o.extra_lines||[],o.extra_lines.push(my)))}d=g,g=Vector$1.normalize(Vector$1.perp(s,h)),_===JOIN_TYPE$1.miter?addMiter(_l,s,d,g,_i,!1,o):addJoin(_,_l,s,d,g,!1,o),_s&&(_l+=_r*Vector$1.length(Vector$1.sub(h,s)))}}s=h,d=g,$?endPolygon(s,d,g=Vector$1.normalize(Vector$1.perp(s,e[1])),_,_l,o):(addVertex$1(s,d,g,1,_l,o,1),addVertex$1(s,d,g,0,_l,o,-1),indexPairs(1,o),!_n&&isCoordOutsideTile(s)||addCap(s,_l,d,j,!1,o))}}}function getTileBoundaryIndex(e){if(isCoordOutsideTile(e[0]))return 0;for(var o=0;o<e.length;o++)if(isCoordOutsideTile(e[e.length-1-o]))return e.length-1-o;return 0}function getNextNonBoundarySegment(e,o,s){for(var h=o;e[h+1]&&outsideTile(e[h],e[h+1],s);)h++;return e.length-h>=2&&e.slice(h)}function startPolygon(e,o,s,h,d){h===void 0||isCoordOutsideTile(e)&&!d.crop_by_tile?(addVertex$1(e,s,s,1,0,d,1),addVertex$1(e,s,s,0,0,d,-1)):h===JOIN_TYPE$1.miter?addMiter(0,e,o,s,d.miter_len_sq,!0,d):addJoin(h,0,e,o,s,!0,d)}function endPolygon(e,o,s,h,d,g){if(isCoordOutsideTile(e)&&!g.crop_by_tile)addVertex$1(e,o,o,1,d,g,1),addVertex$1(e,o,o,0,d,g,-1),indexPairs(1,g);else{var _=createMiterVec(o,s);h===JOIN_TYPE$1.miter&&Vector$1.lengthSq(_)>g.miter_len_sq&&(h=JOIN_TYPE$1.bevel),h===JOIN_TYPE$1.miter?(addVertex$1(e,_,o,1,d,g,1),addVertex$1(e,_,o,0,d,g,-1),indexPairs(1,g)):(addVertex$1(e,o,o,1,d,g,1),addVertex$1(e,o,o,0,d,g,-1),indexPairs(1,g))}}function createMiterVec(e,o){var s=Vector$1.normalize(Vector$1.add(e,o)),h=2/(1+Math.abs(Vector$1.dot(e,s)));return Vector$1.mult(s,h*h)}function addMiter(e,o,s,h,d,g,_){var j=createMiterVec(s,h);Vector$1.lengthSq(j)>d?addJoin(JOIN_TYPE$1.bevel,e,o,s,h,g,_):(addVertex$1(o,j,j,1,e,_,1),addVertex$1(o,j,j,0,e,_,-1),g||indexPairs(1,_))}function addJoin(e,o,s,h,d,g,_){var j=createMiterVec(h,d),$=d[0]*h[1]-d[1]*h[0]>0;_.texcoord_index!=null&&(zero_v[1]=o,one_v[1]=o),$?(addVertex$1(s,j,j,1,o,_,1),addVertex$1(s,h,j,0,o,_,-1),g||indexPairs(1,_),addFan(s,Vector$1.neg(h),j,Vector$1.neg(d),j,zero_v,one_v,zero_v,!1,e===JOIN_TYPE$1.bevel,_),addVertex$1(s,j,j,1,o,_,1),addVertex$1(s,d,j,0,o,_,-1)):(addVertex$1(s,h,j,1,o,_,1),addVertex$1(s,j,j,0,o,_,-1),g||indexPairs(1,_),addFan(s,h,Vector$1.neg(j),d,j,one_v,zero_v,one_v,!1,e===JOIN_TYPE$1.bevel,_),addVertex$1(s,d,j,1,o,_,1),addVertex$1(s,j,j,0,o,_,-1))}function indexPairs(e,o){for(var s=o.vertex_data.vertex_elements,h=o.vertex_data.vertex_count-2*e-2,d=0;d<e;d++)s.push(h+2*d+2),s.push(h+2*d+1),s.push(h+2*d+0),s.push(h+2*d+2),s.push(h+2*d+3),s.push(h+2*d+1),o.geom_count+=2}function addVertex$1(e,o,s,h,d,g,_){var j=g.vertex_template,$=g.vertex_data;j[0]=e[0],j[1]=e[1];var _t=g.half_width*_;j[g.extrude_index+0]=o[0]*_t,j[g.extrude_index+1]=o[1]*_t,g.offset&&(j[g.offset_index+0]=s[0]*g.offset,j[g.offset_index+1]=s[1]*g.offset),g.texcoord_index!=null&&(j[g.texcoord_index+0]=h*g.texcoord_normalize,j[g.texcoord_index+1]=d*g.texcoord_normalize),$.addVertex(j)}var uvCurr=[0,0];function addFan(e,o,s,h,d,g,_,j,$,_t,_e){for(var _r=o[0]*h[1]-o[1]*h[0],_i=Vector$1.dot(o,h),_n=Math.atan2(_r,_i);_n>=Math.PI;)_n-=2*Math.PI;if(_t)_s=1;else{var _s=trianglesPerArc(_n,_e.half_width);if(_s<1)return}var _l=_e.vertex_data.vertex_count,Ap=_e.vertex_data.vertex_elements;addVertex$1(e,s,d,_[0],_[1],_e,1),addVertex$1(e,o,d,g[0],g[1],_e,1);var _h=o,_p=_e.texcoord_index!=null;if(_p)if($)var ty=Vector$1.sub(g,_);else{uvCurr=Vector$1.copy(g);var ry=Vector$1.div(Vector$1.sub(j,g),_s)}var ly,uy,py=_n/_s,fy=_n<0?-1:1;_r>0?(ly=2,uy=1):(ly=1,uy=2);for(var my=0;my<_s;my++)my===0&&_n<0&&(_h=Vector$1.neg(_h)),_h=Vector$1.rot(_h,py),_p&&($?(ty=Vector$1.rot(ty,py),uvCurr[0]=ty[0]+_[0],uvCurr[1]=ty[1]*_e.texcoord_width*_e.v_scale+_[1]):uvCurr=Vector$1.add(uvCurr,ry)),addVertex$1(e,_h,d,uvCurr[0],uvCurr[1],_e,fy),Ap.push(_l+my+ly),Ap.push(_l),Ap.push(_l+my+uy)}function addCap(e,o,s,h,d,g){var _=Vector$1.neg(s),j=g.texcoord_index!=null;switch(h){case CAP_TYPE$1.square:var $;d?($=[s[1],-s[0]],addVertex$1(e,Vector$1.add(s,$),s,1,o,g,1),addVertex$1(e,Vector$1.add(_,$),s,0,o,g,1),j&&(o+=.5*g.texcoord_width*g.v_scale),addVertex$1(e,s,s,1,o,g,1),addVertex$1(e,_,s,0,o,g,1)):($=[-s[1],s[0]],addVertex$1(e,s,s,1,o,g,1),addVertex$1(e,_,s,0,o,g,1),j&&(o+=.5*g.texcoord_width*g.v_scale),addVertex$1(e,Vector$1.add(s,$),s,1,o,g,1),addVertex$1(e,Vector$1.add(_,$),s,0,o,g,1)),indexPairs(1,g);break;case CAP_TYPE$1.round:var _t,_e,_r=zero_v,_i=one_v,_n=mid_v;d?(_t=s,_e=_,j&&(o+=.5*g.texcoord_width*g.v_scale,_r=one_v,_i=zero_v,_n=mid_v)):(_t=_,_e=s),j&&(zero_v[1]=o,one_v[1]=o,mid_v[1]=o),addFan(e,_t,zero_vec2,_e,s,_r,_n,_i,!0,!1,g);break;case CAP_TYPE$1.butt:return}}function trianglesPerArc(e,o){e<0&&(e=-e);var s=o>2*DEFAULT.MIN_FAN_WIDTH?Math.log2(o/DEFAULT.MIN_FAN_WIDTH):1;return Math.ceil(e/Math.PI*s)}function permuteLine(e,o){for(var s=[],h=0;h<e.length;h++){var d=(h+o)%e.length;d!==0&&s.push(e[d])}return s.push(s[0]),s}var default_dash_color=[255,255,255,255],default_background_color=[0,0,0,0];function renderDashArray(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.dash_color||default_dash_color,h=o.background_color||default_background_color,d=e,g=o.scale||1;d.length%2==1&&Array.prototype.push.apply(d,d);for(var _=!0,j=[],$=0;$<d.length;$++){for(var _t=Math.floor(d[$]*g),_e=0;_e<_t;_e++)Array.prototype.push.apply(j,_?s:h);_=!_}return{pixels:j=new Uint8Array(j),length:j.length/4}}var Lines=Object.create(Style);Lines.vertex_layouts=[[],[]],Lines.dash_textures={};var DASH_SCALE=20;function buildPolylines(e,o,s,h,d,g){for(var _={closed:g,vertex_data:s,vertex_template:h,half_width:o/2,vertex_layout_index:d,geom_count:0},j=0,$=e.length;j<$;j++)buildPolyline(e[j],_);return _.geom_count}function buildPolyline(e,o){if(!(e.length<2)){for(var s=[e[0]],h=0,d=[],g=[],_=1,j=e.length;_<j;_++)if(e[_][0]!==e[_-1][0]||e[_][1]!==e[_-1][1]){s.push(e[_]);var $=Vector$1.sub(e[_],e[_-1]),_t=Vector$1.length($);d.push($),g.push([h,h+_t]),h+=_t}if(!(s.length<2)){var _e=0,_r=d[d.length-1],_i=d[0],_n=d[1],_s=[0,0];s.length>2&&(o.closed&&(_s[0]=Vector$1.signedAngleBetween(_r,_i)),_s[1]=Vector$1.signedAngleBetween(_i,_n));var _l=s[0],Ap=g[0];o.closed?(addVertex(_l,o,_e++,Ap,h,_s,[_r,_i]),addVertex(_l,o,_e++,Ap,h,_s,[_r,_i])):(addVertex(_l,o,_e++,Ap,h,_s,[_i,_i]),addVertex(_l,o,_e++,Ap,h,_s,[_i,_i]));for(var _h=1,_p=s.length-1;_h<_p;_h++)_l=s[_h],_r=d[_h-1],_i=d[_h],_n=d[_h+1],addVertex(_l,o,_e++,Ap=g[_h-1],h,_s,[_r,_i]),addVertex(_l,o,_e++,Ap,h,_s,[_r,_i]),triangulate(o),Ap=g[_h],_s[0]=_s[1],_s[1]=_h!==_p-1?Vector$1.signedAngleBetween(_i,_n):o.closed?Vector$1.signedAngleBetween(_i,d[0]):0,addVertex(_l,o,_e++,Ap,h,_s,[_r,_i]),addVertex(_l,o,_e++,Ap,h,_s,[_r,_i]);_l=s[s.length-1],Ap=g[g.length-1],_i=d[d.length-1],o.closed?(addVertex(_l,o,_e++,Ap,h,_s,[_i,d[0]]),addVertex(_l,o,_e++,Ap,h,_s,[_i,d[0]])):(addVertex(_l,o,_e++,Ap,h,_s,[_i,_i]),addVertex(_l,o,_e++,Ap,h,_s,[_i,_i])),triangulate(o)}}}function triangulate(e){var o=e.vertex_data.vertex_elements,s=e.vertex_data.vertex_count-4;o.push(s+2),o.push(s+1),o.push(s+0),o.push(s+2),o.push(s+3),o.push(s+1),e.geom_count+=2}Object.assign(Lines,{name:"lines",built_in:!0,vertex_shader_src:shaderSrc_polygonsVertex,fragment_shader_src:shaderSrc_polygonsFragment,selection:!0,init:function(){Style.init.apply(this,arguments),this.styles=this.styles||{},this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_EXTRUDE_LINES=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_TEXTURE_COORDS=!0,this.outline_feature_style={},this.inline_feature_style=this.feature_style},calcDistance:function(e,o){return e&&StyleParser.evalCachedDistanceProperty(e,o)||0},calcDistanceNextZoom:function(e,o){o.zoom++;var s=this.calcDistance(e,o);return o.zoom--,s},calcWidth:function(e,o,s){var h=this.calcDistance(e.width,s);if(!(h<0)){var d;if(d=e.next_width?this.calcDistanceNextZoom(e.next_width,s):h/2,h===0&&d===0||d<0)return!1;if(o.width_unscaled=h,o.next_width_unscaled=d,e.next_width){var g=.5*(h+(d*=2));o.width=g*s.units_per_meter_overzoom,o.width_scale=1-d/g}else o.width=h*s.units_per_meter_overzoom,o.width_scale=0;return e.texcoords&&(e.inline_texcoord_width?o.texcoord_width=e.inline_texcoord_width:o.texcoord_width=(o.width_unscaled||o.next_width_unscaled)*s.units_per_meter_overzoom/s.tile.overzoom2),!0}},calcOffset:function(e,o,s){if(e.offset_precalc)o.offset=e.offset_precalc,o.offset_scale=e.offset_scale_precalc;else if(e.offset){var h=this.calcDistance(e.offset,s);if(e.next_offset){var d=2*this.calcDistanceNextZoom(e.next_offset,s);Math.abs(h)>=Math.abs(d)?(o.offset=h*s.units_per_meter_overzoom,o.offset_scale=h!==0?1-d/h:0):(o.offset=d*s.units_per_meter_overzoom,o.offset_scale=d!==0?-1*(1-h/d):0)}else o.offset=h*s.units_per_meter_overzoom,o.offset_scale=0}else o.offset=0,o.offset_scale=0;StyleParser.evalProperty(e.offset_reverse,s)&&(o.offset*=-1)},_parseFeature:function(e,o,s){var h=this.feature_style;if(this.calcWidth(o,h,s)!==!1&&(this.calcOffset(o,h,s),h.color=this.parseColor(o.color,s),h.color)){if(h.variantKey=o.variantKey,h.z=o.z&&StyleParser.evalCachedDistanceProperty(o.z||0,s)||StyleParser.defaults.z,h.height=e.properties.height||StyleParser.defaults.height,h.extrude=StyleParser.evalProperty(o.extrude,s),h.extrude&&(typeof h.extrude=="number"?h.height=h.extrude:Array.isArray(h.extrude)&&(h.height=h.extrude[1])),h.extrude&&h.height&&(h.z+=h.height),h.z*=Geo$1.height_scale,h.height*=Geo$1.height_scale,h.cap=StyleParser.evalProperty(o.cap,s),h.join=StyleParser.evalProperty(o.join,s),h.miter_limit=StyleParser.evalProperty(o.miter_limit,s),h.tile_edges=o.tile_edges,h.outline=h.outline||{width:{},next_width:{},preprocessed:!0},o.outline&&o.outline.visible!==!1&&o.outline.color&&o.outline.width){var d=2*this.calcDistance(o.outline.width,s),g=2*this.calcDistanceNextZoom(o.outline.next_width,s);d===0&&g===0||d<0||g<0?(h.outline.width.value=null,h.outline.next_width.value=null,h.outline.color=null,h.outline.inline_texcoord_width=null,h.outline.texcoords=!1):(h.outline.width.value=d+h.width_unscaled,h.outline.next_width.value=g+h.next_width_unscaled,h.outline.inline_texcoord_width=h.texcoord_width,h.outline.offset_precalc=h.offset,h.outline.offset_scale_precalc=h.offset_scale,h.outline.color=o.outline.color,h.outline.cap=o.outline.cap,h.outline.join=o.outline.join,h.outline.miter_limit=o.outline.miter_limit,h.outline.texcoords=o.outline.texcoords,h.outline.style=o.outline.style,h.outline.variantKey=o.outline.variantKey,o.outline.order?h.outline.order=this.parseOrder(o.outline.order,s):h.outline.order=h.order,h.outline.order>h.order&&(h.outline.order=h.order),h.outline.order-=.5,h.outline.variant_order=0)}else h.outline.width.value=null,h.outline.next_width.value=null,h.outline.color=null,h.outline.inline_texcoord_width=null;return h}},_preprocess:function(e,o){var s=this.sources[o]?this.sources[o].config.uid:"";if(e.color=StyleParser.createColorPropertyCache(e.color),e.width=StyleParser.createPropertyCache(e.width,StyleParser.parseUnits),e.width&&e.width.type!==StyleParser.CACHE_TYPE.STATIC&&(e.next_width=StyleParser.createPropertyCache(e.width,StyleParser.parseUnits)),e.offset=e.offset&&StyleParser.createPropertyCache(e.offset,StyleParser.parseUnits),e.offset&&e.offset.type!==StyleParser.CACHE_TYPE.STATIC&&(e.next_offset=StyleParser.createPropertyCache(e.offset,StyleParser.parseUnits)),e.z=StyleParser.createPropertyCache(e.z,StyleParser.parseUnits),e.dash=e.dash!==void 0?e.dash:this.dash,e.dash_key=e.dash&&this.dashTextureKey(e.dash,s),e.dash_background_color=e.dash_background_color!==void 0?e.dash_background_color:this.dash_background_color,e.dash_background_color=e.dash_background_color&&StyleParser.parseColor(e.dash_background_color),e.texture_merged=e.dash_key||(e.texture!==void 0?e.texture:this.texture),e.texcoords=this.texcoords||e.texture_merged?1:0,this.addMeshVariantForDraw(this.base,e),e.outline){e.outline.style=e.outline.style||this.name,e.outline.color=StyleParser.createColorPropertyCache(e.outline.color),e.outline.width=StyleParser.createPropertyCache(e.outline.width,StyleParser.parseUnits),e.outline.next_width=StyleParser.createPropertyCache(e.outline.width,StyleParser.parseUnits),e.outline.cap=e.outline.cap||e.cap,e.outline.join=e.outline.join||e.join,e.outline.miter_limit=e.outline.miter_limit||e.miter_limit,e.outline.offset=e.offset;var h=this.styles[e.outline.style];h?(e.outline.dash=e.outline.dash!==void 0?e.outline.dash:h.dash,e.outline.texture=e.outline.texture!==void 0?e.outline.texture:h.texture,e.outline.dash!=null?(e.outline.dash_key=e.outline.dash&&this.dashTextureKey(e.outline.dash,s),e.outline.texture_merged=e.outline.dash_key):e.outline.dash===null||e.outline.texture!=null?(e.outline.dash_key=null,e.outline.texture_merged=e.outline.texture):(e.outline.dash=e.dash,e.outline.dash_key=e.outline.dash&&this.dashTextureKey(e.outline.dash,s),e.outline.texture_merged=e.outline.dash_key),e.outline.dash_background_color=e.outline.dash_background_color!==void 0?e.outline.dash_background_color:h.dash_background_color,e.outline.dash_background_color=e.outline.dash_background_color!==void 0?e.outline.dash_background_color:e.dash_background_color,e.outline.dash_background_color=e.outline.dash_background_color&&StyleParser.parseColor(e.outline.dash_background_color),e.outline.texcoords=h.texcoords||e.outline.texture_merged?1:0,this.addMeshVariantForDraw(this.base,e.outline)):(log({level:"warn",once:!0},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"line 'outline' specifies non-existent draw style '".concat(e.outline.style,"' (or maybe the style is ")+"defined but is missing a 'base' or has another error), skipping outlines in layer"),e.outline=null)}return e},dashTextureKey:function(e,o){return"__dash_"+o+"_"+this.scene_id+"_"+JSON.stringify(e)},getDashTexture:function(e,o){var s=this.dashTextureKey(e,this.sources[o].config.uid);if(Lines.dash_textures[s]==null){Lines.dash_textures[s]=!0;var h=renderDashArray(e,{scale:DASH_SCALE});this.textureManager.create(this.gl,s,{data:h.pixels,height:h.length,width:1,filtering:"nearest"})}},endData:function(e){var o=this;return Style.endData.call(this,e).then(function(s){if(s){s.uniforms.u_has_line_texture=!1,s.uniforms.u_texture=o.textureManager.default,s.uniforms.u_v_scale_adjust=Geo$1.tile_scale;var h=[],d=function(){var _=s.meshes[g].variant;if(_.texture){var j=s.meshes[g].uniforms=s.meshes[g].uniforms||{};if(j.u_has_line_texture=!0,j.u_texture=_.texture,j.u_texture_ratio=1,_.dash&&(j.u_v_scale_adjust=Geo$1.tile_scale*DASH_SCALE,j.u_dash_background_color=_.dash_background_color||[0,0,0,0]),_.dash_key&&Lines.dash_textures[_.dash_key]==null&&(Lines.dash_textures[_.dash_key]=!0,WorkerBroker.postMessage(o.main_thread_target+".getDashTexture",_.dash,e.source)),o.textureManager.textures[_.texture]==null)h.push(o.textureManager.syncTexturesToWorker([_.texture]).then(function(_t){var _e=_t[_.texture];_e&&(j.u_texture_ratio=_e.height/_e.width)}));else{var $=o.textureManager.textures[_.texture];j.u_texture_ratio=$.height/$.width}}};for(var g in s.meshes)d();return e.mesh_data[o.name]=s,Promise.all(h).then(function(){return s})}return s})},computeVariantForDraw:function(e){var o=e.offset?1:0;return e.dash_key&&(o+=e.dash_key,e.dash_background_color&&(o+=e.dash_background_color)),e.texture_merged&&(o+=e.texture_merged),o=hashString(o+="/"+e.texcoords),e.variantKey=o,{key:o,order:e.variant_order,offset:e.offset?1:0,texcoords:e.texcoords,texture:e.texture_merged,dash:e.dash,dash_key:e.dash_key,dash_background_color:e.dash_background_color}},vertexLayoutForMeshVariant:function(e){if(Lines.vertex_layouts[e.key]==null){var o=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_extrude",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_offset",size:2,type:gl$1.SHORT,normalized:!1,static:e.offset?null:[0,0]},{name:"a_scaling",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0,static:e.texcoords?null:[0,0]},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0}];Lines.vertex_layouts[e.key]=new VertexLayout(o)}return Lines.vertex_layouts[e.key]},makeVertexTemplate:function(e,o){var s=0;return this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=e.z||0,this.vertex_template[s++]=this.scaleOrder(e.order),this.vertex_template[s++]=0,this.vertex_template[s++]=0,o.variant.offset&&(this.vertex_template[s++]=0,this.vertex_template[s++]=0),this.vertex_template[s++]=1024*e.width_scale,this.vertex_template[s++]=1024*e.offset_scale,o.variant.texcoords&&(this.vertex_template[s++]=0,this.vertex_template[s++]=0),this.vertex_template[s++]=255*e.color[0],this.vertex_template[s++]=255*e.color[1],this.vertex_template[s++]=255*e.color[2],this.vertex_template[s++]=255*e.color[3],this.selection&&(this.vertex_template[s++]=255*e.selection_color[0],this.vertex_template[s++]=255*e.selection_color[1],this.vertex_template[s++]=255*e.selection_color[2],this.vertex_template[s++]=255*e.selection_color[3]),this.vertex_template},buildLines:function(e,o,s,h,d){if(this.feature_style=this.outline_feature_style,o.outline&&o.outline.color!=null&&o.outline.width.value!=null){var g=this.styles[o.outline.style];g&&g.addFeature(h.feature,o.outline,h)}this.feature_style=this.inline_feature_style;var _=s.vertex_data,j=_.vertex_layout,$=this.makeVertexTemplate(o,s);return buildPolylines$1(e,o.width,_,$,{cap:o.cap,join:o.join,miter_limit:o.miter_limit,extrude_index:j.index.a_extrude,offset_index:j.index.a_offset,texcoord_index:j.index.a_texcoord,texcoord_width:o.texcoord_width,texcoord_normalize:65535,closed_polygon:d&&d.closed_polygon,remove_tile_edges:!o.tile_edges&&d&&d.remove_tile_edges,tile_edge_tolerance:Geo$1.tile_scale*h.tile.pad_scale*2,offset:o.offset,crop_by_tile:this.crop_by_tile})},buildPolygons:function(e,o,s,h){for(var d=0,g=0;g<e.length;g++)d+=this.buildLines(e[g],o,s,h,{closed_polygon:!0,remove_tile_edges:!this.crop_by_tile});return d}});var TEX_COORDS=[[1,1],[1,-1],[-1,1],[-1,-1]];function addVertex(e,o,s,h,d,g,_){var j=o.vertex_template,$=o.vertex_data;if(setAttribute(o,"a_position",e),setAttribute(o,"a_width",o.half_width),o.vertex_layout_index.a_barycentric){var _t=[0,0,0];_t[s%3]=1,setAttribute(o,"a_barycentric",_t)}setAttribute(o,"a_tangents",_[0].concat(_[1])),setAttribute(o,"a_segment",h),setAttribute(o,"a_texcoord",TEX_COORDS[s%4]),setAttribute(o,"a_length",d),setAttribute(o,"a_closed",o.closed?1:0),setAttribute(o,"a_angles",g),$.addVertex(j)}function setAttribute(e,o,s){var h=s.length,d=e.vertex_template,g=e.vertex_layout_index[o],_=0;if(h)for(;_!==h;)d[g+_]=s[_],_++;else d[g+_]=s}function buildPatternBuffer(e,o){for(var s=e.reduce(function(_n,_s){return _n+_s}),h=0,d=[],g=0,_=e.length;g<=_;g+=2){var j=Math.max(1e-4,e[g%_]),$=Math.max(1e-4,e[(g+1)%_]);d.push(h,h+j),h+=j+$}for(var _t=new Uint8Array(4*o),_e=0,_r=function(){var _n,_s,_l,Ap=s*_i/(o-1),_h=minIdx(d.map(function(_p){return Math.abs(_p-Ap)}));_h%2==0?(_n=Ap<=d[_h]?1:0,_s=d[_h],_l=d[_h+1]):(_n=Ap>d[_h]?2:0,_s=d[_h-1],_l=d[_h]),_t[_e++]=d[_h],_t[_e++]=_n,_t[_e++]=_s,_t[_e++]=_l},_i=0;_i<o;_i++)_r();return _t}function minIdx(e){for(var o=e[0],s=0,h=1,d=e.length;h<d;h++)e[h]<o&&(s=h,o=e[h]);return s}var vertex_shader_src=`uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform sampler2D u_uniforms;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform vec3 u_map_position;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_index;uniform vec2 u_dash_caps;uniform float u_dash_phase;uniform float u_dash_period;attribute vec4 a_position;attribute vec4 a_color;attribute float a_width;
#ifdef TANGRAM_DEBUG_TRIANGLES
attribute vec3 a_barycentric;
#endif
attribute vec2 a_normal;attribute float a_length;attribute vec2 a_segment;attribute vec2 a_texcoord;attribute vec2 a_angles;attribute vec4 a_tangents;attribute float a_closed;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;
#ifdef TANGRAM_DEBUG_TRIANGLES
varying vec3 v_barycentric;
#endif
varying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;
#define TANGRAM_NORMAL vec3(0., 0., 1.)
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
varying vec4 v_modelpos_base_zoom;
#endif
#if defined(TANGRAM_LIGHTING_VERTEX)
varying vec4 v_lighting;
#endif
#ifndef TANGRAM_HEIGHT_SCALE
float TANGRAM_HEIGHT_SCALE=16.0;
#endif
#define UNPACK_SCALING(x) (x / 1024.)
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: global
const float PI=3.141592653589793;const float THETA=15.0*PI/180.0;float cross(in vec2 v1,in vec2 v2){return v1.x*v2.y-v1.y*v2.x;}float signed_distance(in vec2 v1,in vec2 v2,in vec2 v3){return cross(v2-v1,v1-v3)/length(v2-v1);}void rotate(in vec2 v,in float angle,out vec2 result){float cosine=cos(angle);float sine=sin(angle);result=vec2(cosine*v.x-sine*v.y,sine*v.x+cosine*v.y);}void main(){
#pragma tangram: setup
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
v_modelpos_base_zoom=modelPositionBaseZoom();
#endif
float linewidth=a_width*2.0;v_angles=a_angles;v_segment=a_segment;v_color=a_color;v_length=a_length;v_texcoord=a_texcoord;
#ifdef TANGRAM_DEBUG_TRIANGLES
v_barycentric=a_barycentric;
#endif
v_color.a=min(linewidth,v_color.a);linewidth=max(linewidth,1.0);linewidth/=exp2(u_map_position.z-u_tile_origin.w);v_linewidth_and_closed=linewidth*(a_closed>0.0 ?-1.0 : 1.0);if(v_color.a<=0.0){gl_Position=vec4(0.0,0.0,0.0,1.0);return;}float width=ceil(1.25*u_antialias+linewidth)/2.0;vec2 t1=normalize(a_tangents.xy);vec2 t2=normalize(a_tangents.zw);float u=a_texcoord.x;u*=-1.0;float v=a_texcoord.y;vec4 position=vec4(a_position.xy,a_position.z/TANGRAM_HEIGHT_SCALE,1.0);if(t1!=t2){float angle=a_texcoord.x==1.0 ? a_angles.x : a_angles.y;vec2 t=normalize(t1+t2);vec2 o=vec2(+t.y,-t.x);float segmentLength=a_segment.y-a_segment.x;float magnitude=width/cos(angle/2.0);float sqMagnitude=magnitude*magnitude;float seg1SqMagnitude=dot(a_tangents.xy,a_tangents.xy);float seg2SqMagnitude=dot(a_tangents.zw,a_tangents.zw);if((abs(magnitude)>linewidth)&&(sqMagnitude>=min(seg1SqMagnitude,seg2SqMagnitude))){if(u==1.0){o=vec2(-t2.y,+t2.x);}else{o=vec2(-t1.y,+t1.x);}magnitude=width;angle=0.0;v_angles.x=0.0;v_angles.y=0.0;}if(u_dash_index>0.0){if((abs(angle)>THETA)){position.xy+=v*width*o/cos(angle/2.0);float s=sign(angle);if(angle<0.0){if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==1.0){position.xy-=2.0*width*t1/sin(angle);u-=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==1.0){position.xy+=2.0*width*t2/sin(angle);u+=2.0*width/sin(angle);}}}else{if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);if(v==-1.0){position.xy+=2.0*width*t1/sin(angle);u+=2.0*width/sin(angle);}}else{u=v_segment.x-v*width*tan(angle/2.0);if(v==-1.0){position.xy-=2.0*width*t2/sin(angle);u-=2.0*width/sin(angle);}}}}else{position.xy+=v*width*o/cos(angle/2.0);if(u==+1.0){u=v_segment.y;}else{u=v_segment.x;}}}else{position.xy+=v*o*magnitude;if(u==+1.0){u=v_segment.y+v*width*tan(angle/2.0);}else{u=v_segment.x-v*width*tan(angle/2.0);}}v_joinIndicator=(segmentLength+v*width*tan(angle/2.0))/segmentLength;}else{v_joinIndicator=-1.0;vec2 o=vec2(+t1.y,-t1.x);position.xy+=v*width*o;if(u==-1.0){u=v_segment.x-width;position.xy-=width*t1;}else{u=v_segment.y+width;position.xy+=width*t2;}}vec2 t;vec2 curr=a_position.xy;if(a_texcoord.x>=0.0){vec2 next=curr+t2*(v_segment.y-v_segment.x);rotate(t1,+a_angles.x/2.0,t);v_miter.x=signed_distance(curr,curr+t,position.xy);rotate(t2,+a_angles.y/2.0,t);v_miter.y=signed_distance(next,next+t,position.xy);}else{vec2 prev=curr-t1*(v_segment.y-v_segment.x);rotate(t1,-a_angles.x/2.0,t);v_miter.x=signed_distance(prev,prev+t,position.xy);rotate(t2,-a_angles.y/2.0,t);v_miter.y=signed_distance(curr,curr+t,position.xy);}v_distances=vec2(u,v*width);v_world_position=wrapWorldPosition(u_model*position);v_local_space_position=position;position=u_modelView*position;
#pragma tangram: position
v_position=position;v_normal=normalize(u_normalMatrix*TANGRAM_NORMAL);
#if defined(TANGRAM_LIGHTING_VERTEX)
vec3 normal=v_normal;
#pragma tangram: normal
v_lighting=calculateLighting(position.xyz-u_eye,normal,vec4(1.));
#endif
cameraProjection(position);
#ifdef TANGRAM_LAYER_ORDER
applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);
#endif
gl_Position=position;}`,fragment_shader_src=`uniform vec2 u_resolution;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_dash_atlas;uniform float u_antialias;uniform vec2 u_linecaps;uniform float u_linejoin;uniform float u_miter_limit;uniform float u_dash_phase;uniform float u_dash_period;uniform float u_dash_index;uniform vec2 u_dash_caps;varying vec4 v_position;varying vec4 v_local_space_position;varying vec3 v_normal;varying vec4 v_color;varying vec4 v_world_position;
#ifdef TANGRAM_DEBUG_TRIANGLES
varying vec3 v_barycentric;
#endif
varying vec2 v_segment;varying vec2 v_angles;varying vec2 v_texcoord;varying vec2 v_distances;varying vec2 v_miter;varying float v_length;varying float v_linewidth_and_closed;varying float v_joinIndicator;
#define TANGRAM_NORMAL v_normal
#ifdef TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING
varying vec4 v_modelpos_base_zoom;
#endif
#if defined(TANGRAM_LIGHTING_VERTEX)
varying vec4 v_lighting;
#endif
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: global
#pragma tangram: utils
const float PI=3.141592653589793;const float HALF_PI=PI/2.0;const float THETA=15.0*PI/180.0;/***Compute distance to cap.*@param{int}type The Type of the cap(see CAP_TYPE in pattern_lines)*@param{float}dx The distance of the pixel from the beginning of the line(not straight distance,but along the legs)*@param{float}dy The distance of the pixel from the midline(see v_distances in vertex shader,aka 1*half_line_width)*@param{float}aa_radius The distance from the mid-line from where antialiasing starts.*For example for a linewidth 10px width and 2px filter radius it is 10px/2-2px=3px.*@return{float}distance*/float cap(int type,float dx,float dy,float aa_radius){float dist=0.0;dx=abs(dx);dy=abs(dy);if(type==1)dist=sqrt(dx*dx+dy*dy);else if(type==3)dist=(dx+abs(dy));else if(type==2)dist=max(abs(dy),(aa_radius+dx-abs(dy)));else if(type==4)dist=max(dx,dy);else if(type==5)dist=max(dx+aa_radius,dy);return dist;}/***Compute distance to join.*@param{int}type The type of the join(see JOIN_TYPE in pattern_lines)*@param{vec2}segment Interpolated a_segment attribute from the vertex shader*@param{vec2}texcoord Pair of u/v coordinates to identify the 4 different extruded points of the segment.*@param{vec2}distances 2 component vector where:*x is the distance of the pixel from the beginning of the line(along the legs)*y is the  distance of the pixel from the midline(see v_distances in vertex shader,1*half_line_width)*@param{vec2}miter Miter point coordiante*@param{float}miter_limit The miter limit*@param{float}linewidth The width of the line*@return{float}computed distance*/float join(in int type,in vec2 segment,in vec2 texcoord,in vec2 distances,in vec2 miter,in float miter_limit,in float linewidth){float dx=distances.x;float result=abs(distances.y);if((dx<segment.x)||(dx>segment.y)){if(type==1){float s=dx<segment.x ? segment.x : segment.y;result=max(result,length(distances-vec2(s,0.0)));}else{float m=abs(texcoord.x>=0.0 ? miter.x : miter.y);if(type==2){result=max(result,m);}else if(type==0){result=max(result,m-miter_limit*linewidth/2.0);}}}return result;}void main(void){
#pragma tangram: setup
vec4 color=v_color;vec3 normal=TANGRAM_NORMAL;
#ifdef TANGRAM_CROP_BY_TILE
if(isLocalSpacePixelOutsideTile(v_local_space_position,TANGRAM_TILE_SCALE.x)){discard;}
#endif
#if defined(TANGRAM_LIGHTING_FRAGMENT) && defined(TANGRAM_MATERIAL_NORMAL_TEXTURE)
calculateNormal(normal);
#endif
#if !defined(TANGRAM_LIGHTING_VERTEX)
#pragma tangram: normal
#endif
#pragma tangram: color
#if defined(TANGRAM_LIGHTING_FRAGMENT)
color=calculateLighting(v_position.xyz-u_eye,normal,color);
#elif defined(TANGRAM_LIGHTING_VERTEX)
color*=v_lighting;
#endif
#pragma tangram: filter
if(v_color.a<=0.0){discard;}bool solid=(u_dash_index==0.0);bool closed=v_linewidth_and_closed<0.0;float dx=v_distances.x;float dy=v_distances.y;float linewidth=abs(v_linewidth_and_closed);float aa_radius=linewidth/2.0-u_antialias;float dist=0.0;vec2 linecaps=u_linecaps;vec2 dash_caps=u_dash_caps;float line_start=0.0;float line_stop=v_length;if(solid){dist=abs(dy);bool potentialCap=!closed&&v_joinIndicator<0.0;if(potentialCap&&dx<line_start){dist=cap(int(u_linecaps.x),abs(dx),abs(dy),aa_radius);}else if(potentialCap&&dx>line_stop){dist=cap(int(u_linecaps.y),abs(dx)-line_stop,abs(dy),aa_radius);}else{dist=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);}}else{float segment_start=v_segment.x;float segment_stop=v_segment.y;float segment_center=(segment_start+segment_stop)/2.0;float freq=u_dash_period*linewidth;float dash_phase=u_dash_phase-1e-5;float u=mod(dx+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));float dash_center=float(tex.x)*255.0*linewidth;float dash_type=floor(float(tex.y)*255.0+0.5);float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;float dash_start=dx-u+_start;float dash_stop=dx-u+_stop;if((dash_stop<segment_start)&&(dash_caps.x!=5.0)){float u=mod(segment_start+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_start-u+_start;dash_stop=segment_start-u+_stop;}else if((dash_start>segment_stop)&&(dash_caps.y!=5.0)){float u=mod(segment_stop+dash_phase*linewidth,freq);vec4 tex=texture2D(u_dash_atlas,vec2(u/freq,u_dash_index));dash_center=float(tex.x)*255.0*linewidth;float _start=float(tex.z)*255.0*linewidth;float _stop=float(tex.a)*255.0*linewidth;dash_start=segment_stop-u+_start;dash_stop=segment_stop-u+_stop;}bool discontinuous=((dx<segment_center)&&abs(v_angles.x)>THETA)||((dx>=segment_center)&&abs(v_angles.y)>THETA);float d_join=join(int(u_linejoin),v_segment,v_texcoord,v_distances,v_miter,u_miter_limit,linewidth);if(closed){line_start+=linewidth/2.0;line_stop-=linewidth/2.0;}if(dash_stop<=line_start){discard;}if(dash_start>=line_stop){discard;}if(discontinuous){if((dash_start>segment_stop)){discard;}if((dash_stop<segment_start)){discard;}if(dash_caps.x==1.0){if((u>_stop)&&(dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){discard;}}if(dash_caps.y==1.0){if((u<_start)&&(dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){discard;}}if((dash_caps.x!=1.0)&&(dash_caps.x!=5.0)){if((dash_start<segment_start)&&(abs(v_angles.x)<HALF_PI)){float a=v_angles.x/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(segment_start-dx)*cos_a-dy*sin_a;float y=(segment_start-dx)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.x=4.0;}}if((dash_caps.y!=1.0)&&(dash_caps.y!=5.0)){if((dash_stop>segment_stop)&&(abs(v_angles.y)<HALF_PI)){float a=v_angles.y/2.0;float cos_a=cos(a);float sin_a=sin(a);float x=(dx-segment_stop)*cos_a-dy*sin_a;float y=(dx-segment_stop)*sin_a+dy*cos_a;if(x>0.0){discard;}dash_caps.y=4.0;}}}if((dx<line_start)&&(dash_start<=line_start)&&(dash_stop>line_start)){dist=cap(int(linecaps.x),dx-line_start,dy,aa_radius);}else if((dx>line_stop)&&(dash_stop>line_stop)&&(dash_start<line_stop)){dist=cap(int(linecaps.y),dx-line_stop,dy,aa_radius);}else if(dash_type==1.0){dist=cap(int(dash_caps.x),abs(dash_center-u),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}else if(dash_type==0.0){dist=abs(dy);}else if(dash_type==2.0){dist=cap(int(dash_caps.y),abs(u-dash_center),dy,aa_radius);if((dx>line_start)&&(dx<line_stop)){dist=max(dist,d_join);}}if((dx>line_start)&&(dx<line_stop)){if((dx<=segment_start)&&(dash_start<=segment_start)&&(dash_stop>=segment_start)){dist=d_join;float angle=HALF_PI+v_angles.x;float f=abs((segment_start-dx)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if((dx>segment_stop)&&(dash_start<=segment_stop)&&(dash_stop>=segment_stop)){dist=d_join;float angle=HALF_PI+v_angles.y;float f=abs((dx-segment_stop)*cos(angle)-dy*sin(angle));dist=max(f,dist);}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}else if(dx<(segment_start-linewidth/2.)){discard;}else if(dx>(segment_stop+linewidth/2.)){discard;}}dist=dist-aa_radius;if(dist>=0.0){if(u_antialias==0.0){discard;}else{color=vec4(color.rgb,exp(-dist*dist)*color.a);}}
#ifdef TANGRAM_DEBUG_TRIANGLES
if(any(lessThan(v_barycentric,vec3(0.0085)))){color=vec4(0.0,1.0,0.0,1.0);}
#endif
gl_FragColor=color;}`,PatternLines=Object.create(Style),CAP_TYPE={round:1,"arrow-tail":2,"arrow-head":3,square:4,butt:5},JOIN_TYPE={miter:0,round:1,bevel:2},PATTERN_MAX_WIDTH=1024,DEFAULT_LINE_CAP=CAP_TYPE.round,DEFAULT_JOIN_TYPE=JOIN_TYPE.miter,DEFAULT_DASH_PATTERN=[0,0],VARIANT_UNIQUE_PROP_NAMES="antialias join linecaps miter_limit dash_index dash dash_caps dash_phase".split(" ");function getHashForStyle(e){for(var o=[],s=0,h=VARIANT_UNIQUE_PROP_NAMES.length;s<h;s++){var d=e[VARIANT_UNIQUE_PROP_NAMES[s]];Array.isArray(d)?o.push(d.join("_")):typeof d=="boolean"?o.push(d?1:0):d&&o.push(d.toString())}return o.join("/")}Object.assign(PatternLines,{name:"pattern-lines",built_in:!0,vertex_shader_src,fragment_shader_src,selection:!0,init:function(){Style.init.apply(this,arguments),this.defines.TANGRAM_LAYER_ORDER=!0,this.defines.TANGRAM_CROP_BY_TILE=this.crop_by_tile,this.defines.TANGRAM_DEBUG_TRIANGLES=!1,this.defines.TANGRAM_DEBUG_NO_TEXTURE_FLOAT_SUPPORT=!1,this.styles=this.styles||{},PatternLines.vertex_layouts=[]},calcDistance:function(e,o){return e&&StyleParser.evalCachedDistanceProperty(e,o)||0},calcDash:function(e,o){var s=StyleParser.evalProperty(e.dash,o),h=0;return s&&((s=Array.isArray(s)&&s.length?s:DEFAULT_DASH_PATTERN).length%2==1&&(s=s.concat(s)),h=s.reduce(function(d,g){return d+g}),h=+h||0),{dash:s,dash_period:h}},calcWidth:function(e,o,s){var h=this.calcDistance(e.width,s);return!(h<0)&&(o.width=h*s.units_per_meter_overzoom,!0)},getCapType:function(e,o,s){var h=StyleParser.evalProperty(e,o);return CAP_TYPE[h]!==void 0?CAP_TYPE[h]:s},_parseFeature:function(e,o,s){if(this.calcWidth(o,this.feature_style,s)!==!1){var h=this.parseColor(o.color,s);if(h&&h[3]!==0){var d=this.getCapType(o.cap,s,DEFAULT_LINE_CAP),g=StyleParser.evalProperty(o.join,s),_=+StyleParser.evalProperty(o.miter_limit,s),j=this.calcDash(o,s),$=j.dash,_t=j.dash_period,_e=Object.assign({color:h,antialias:o.antialias,linecaps:[this.getCapType(o.tail_cap,s,d),this.getCapType(o.head_cap,s,d)],join:JOIN_TYPE[g]!==void 0?JOIN_TYPE[g]:DEFAULT_JOIN_TYPE,miter_limit:_>=0?_:3,dash_index:_t===0?0:1,dash:$,dash_caps:[this.getCapType(o.tail_cap,s,d),this.getCapType(o.head_cap,s,d)],dash_phase:+StyleParser.evalProperty(o.dash_phase,s)||0,dash_period:_t},this.feature_style);return _e.z=o.z&&StyleParser.evalCachedDistanceProperty(o.z||0,s)||StyleParser.defaults.z,_e.z*=Geo$1.height_scale,_e.extrude=StyleParser.evalProperty(o.extrude,s),_e.extrude&&(_e.extrude===!0?(_e.height=e.properties.height!==void 0?e.properties.height:StyleParser.defaults.height,_e.min_height=e.properties.min_height!==void 0?e.properties.min_height:StyleParser.defaults.min_height):typeof _e.extrude=="number"?(_e.height=_e.extrude,_e.min_height=0):Array.isArray(_e.extrude)&&(_e.min_height=_e.extrude[0],_e.height=_e.extrude[1]),_e.height*=Geo$1.height_scale,_e.min_height*=Geo$1.height_scale),this.addMeshVariantForDraw(this.base,_e),_e}}},_preprocess:function(e,o){e.color=StyleParser.createColorPropertyCache(e.color),e.width=StyleParser.createPropertyCache(e.width,StyleParser.parseUnits),e.width&&e.width.type!==StyleParser.CACHE_TYPE.STATIC&&(e.next_width=StyleParser.createPropertyCache(e.width,StyleParser.parseUnits)),e.z=StyleParser.createPropertyCache(e.z,StyleParser.parseUnits);var s=+e.antialias;return e.antialias=isNaN(s)?0:s,e},buildRasterTextures:function(e,o){var s=[];for(var h in o.meshes){var d=this.getMeshVariantTypeForDraw({variantKey:h}),g=d.uniforms,_=d.pattern;if(g.u_dash_index){var j="__dash_"+_.join("_")+"_"+e.key+"_"+e.id;s.push({name:j,data:buildPatternBuffer(_,PATTERN_MAX_WIDTH)}),g.u_dash_atlas=j,o.meshes[h].textures=[j]}o.meshes[h].uniforms=g}return o.uniforms=o.uniforms||{},s.length?WorkerBroker.postMessage(this.main_thread_target+".loadTextures",s).then(function($){return o}):Promise.resolve(o)},loadTextures:function(e){for(var o=[],s=0;s<e.length;s++){var h=e[s],d=this.textureManager.textures[h.name];d||(d=this.textureManager.create(this.gl,h.name,{filtering:"nearest",repeat:!0,width:PATTERN_MAX_WIDTH,height:1,data:h.data})),o.push(d.loading)}return Promise.all(o).then(function(g){return g.map(function(_){return _.retain(),_.name})})},computeVariantForDraw:function(e){var o=getHashForStyle(e);return e.variantKey=o,{key:o,order:e.variant_order,uniforms:{u_antialias:e.antialias,u_linecaps:e.linecaps,u_linejoin:e.join,u_miter_limit:e.miter_limit,u_dash_index:e.dash_index,u_dash_caps:e.dash_caps,u_dash_phase:e.dash_phase,u_dash_period:e.dash_period},pattern:e.dash}},vertexLayoutForMeshVariant:function(e){if(PatternLines.vertex_layouts[e.key]==null){var o=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_width",size:1,type:gl$1.FLOAT,normalized:!1},{name:"a_tangents",size:4,type:gl$1.FLOAT,normalized:!1},{name:"a_segment",size:2,type:gl$1.FLOAT,normalized:!1},{name:"a_angles",size:2,type:gl$1.FLOAT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.FLOAT,normalized:!0},{name:"a_length",size:1,type:gl$1.FLOAT,normalized:!1},{name:"a_closed",size:1,type:gl$1.FLOAT,normalized:!1},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0}];this.defines.TANGRAM_DEBUG_TRIANGLES&&o.push({name:"a_barycentric",size:3,type:gl$1.SHORT,normalized:!1}),PatternLines.vertex_layouts[e.key]=new VertexLayout(o)}return PatternLines.vertex_layouts[e.key]},makeVertexTemplate:function(e,o){var s=0;return this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=e.z+e.height||0,this.vertex_template[s++]=this.scaleOrder(e.order),this.vertex_template[s++]=255*e.color[0],this.vertex_template[s++]=255*e.color[1],this.vertex_template[s++]=255*e.color[2],this.vertex_template[s++]=255*e.color[3],this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.selection&&(this.vertex_template[s++]=255*e.selection_color[0],this.vertex_template[s++]=255*e.selection_color[1],this.vertex_template[s++]=255*e.selection_color[2],this.vertex_template[s++]=255*e.selection_color[3]),this.defines.TANGRAM_DEBUG_TRIANGLES&&(this.vertex_template[s++]=0,this.vertex_template[s++]=0,this.vertex_template[s++]=0),this.vertex_template},buildLines:function(e,o,s,h){var d=arguments.length>4&&arguments[4]!==void 0&&arguments[4],g=s.vertex_data,_=g.vertex_layout,j=this.makeVertexTemplate(o,s);return buildPolylines(e,o.width,g,j,_.index,d)},buildPolygons:function(e,o,s,h){for(var d=0,g=0,_=e.length;g<_;g++)d+=this.buildLines(e[g],o,s,h,!0);return d}});var STICK_WIDTH=1;function buildQuadsForPoints(e,o,s,h){var d=h.quad,g=h.quad_normalize,_=h.offset,j=h.offsets,$=h.offsets_alt,_t=h.pre_angles,_e=h.pre_angles_alt,_r=h.angle,_i=h.angles,_n=h.angles_alt,_s=h.is_flat,_l=h.elevate_by_altitude,Ap=h.build_stick_points,_h=h.color,_p=h.stick_color,ty=h.curve,ry=h.texcoord_scale,ly=h.texcoord_normalize,uy=h.pre_angles_normalize,py=h.angles_normalize,fy=h.offsets_normalize;g=g||1;var my,xy=d[0]/2*g,Ly=d[1]/2*g,My=[[-xy,-Ly],[xy,-Ly],[xy,Ly],[-xy,Ly]],Ry=o.vertex_elements,Sy=o.vertex_count,Zy=o.vertex_layout.index,qy=Zy.a_texcoord,_m=Zy.a_position,ky=Zy.a_shape,Dy=Zy.a_offset,Gy=Zy.a_offsets,Ky=Zy.a_offsets_alt,sv=Zy.a_pre_angles,Hy=Zy.a_pre_angles_alt,vv=Zy.a_angles,_v=Zy.a_angles_alt,Av=Zy.a_is_flat,Mv=Zy.a_is_stick,Nv=Zy.a_color;if(qy){ly=ly||1;var iv=_slicedToArray(ry||default_uvs,4),Ov=iv[0],Qv=iv[1],t0=iv[2],s0=iv[3];my=[[Ov,Qv],[t0,Qv],[t0,s0],[Ov,s0]]}for(var Gv=0,Zv=e.length,Wv=0;Wv<Zv;Wv++){var Dv=e[Wv];if(Ap){for(var Pv=STICK_WIDTH/2*g,a0=1*g,Fv=[[-Pv,0],[+Pv,0],[+Pv,a0],[-Pv,a0]],$v=0;$v<4;$v++)qy&&(s[qy+0]=my[$v][0]*ly,s[qy+1]=my[$v][1]*ly),s[_m+0]=Dv[0],s[_m+1]=Dv[1],_l&&(s[_m+2]=MathUtils$1.clamp(Dv[2],0,32767)),s[ky+0]=Fv[$v][0],s[ky+1]=Fv[$v][1],s[ky+2]=0,s[Nv+0]=_p[0],s[Nv+1]=_p[1],s[Nv+2]=_p[2],s[Nv+3]=_p[3],s[Mv+0]=255,o.addVertex(s);Ry.push(Sy+0),Ry.push(Sy+1),Ry.push(Sy+2),Ry.push(Sy+2),Ry.push(Sy+3),Ry.push(Sy+0),Sy+=4,Gv+=2}for(var kv=0;kv<4;kv++)qy&&(s[qy+0]=my[kv][0]*ly,s[qy+1]=my[kv][1]*ly),s[_m+0]=Dv[0],s[_m+1]=Dv[1],_l&&(s[_m+2]=MathUtils$1.clamp(Dv[2],0,32767)),s[ky+0]=My[kv][0],s[ky+1]=My[kv][1],s[ky+2]=_r,s[Nv+0]=_h[0],s[Nv+1]=_h[1],s[Nv+2]=_h[2],s[Nv+3]=_h[3],s[Dy+0]=_[0],s[Dy+1]=_[1],s[Av+0]=_s?255:0,Ap&&(s[Mv+0]=0),ty&&(s[sv+0]=uy*_t[0],s[sv+1]=uy*_t[1],s[sv+2]=uy*_t[2],s[sv+3]=uy*_t[3],s[vv+0]=py*_i[0],s[vv+1]=py*_i[1],s[vv+2]=py*_i[2],s[vv+3]=py*_i[3],s[Gy+0]=fy*j[0],s[Gy+1]=fy*j[1],s[Gy+2]=fy*j[2],s[Gy+3]=fy*j[3],$&&(s[Ky+0]=fy*$[0],s[Ky+1]=fy*$[1],s[Ky+2]=fy*$[2],s[Ky+3]=fy*$[3],s[Hy+0]=uy*_e[0],s[Hy+1]=uy*_e[1],s[Hy+2]=uy*_e[2],s[Hy+3]=uy*_e[3],s[_v+0]=py*_n[0],s[_v+1]=py*_n[1],s[_v+2]=py*_n[2],s[_v+3]=py*_n[3])),o.addVertex(s);Ry.push(Sy+0),Ry.push(Sy+1),Ry.push(Sy+2),Ry.push(Sy+2),Ry.push(Sy+3),Ry.push(Sy+0),Sy+=4,Gv+=2}return Gv}var id=0,Label={id_prefix:"",nextLabelId:function(){return"".concat(Label.id_prefix,"/").concat(id++)}};function textLayoutToJSON(e){return{priority:e.priority,collide:e.collide,repeat_distance:e.repeat_distance,repeat_group:e.repeat_group,buffer:e.buffer,italic:e.italic}}var lefts=["left","top-left","bottom-left"],rights=["right","top-right","bottom-right"],tops=["top","top-left","top-right"],bottoms=["bottom","bottom-left","bottom-right"],PointAnchor={computeOffset:function(e,o,s){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!s||s==="center")return e;var d=[e[0],e[1]];return h=h||this.default_buffer,this.isLeftAnchor(s)?(d[0]-=o[0]/2,s==="left"&&(d[0]-=h[0])):this.isRightAnchor(s)&&(d[0]+=o[0]/2,s==="right"&&(d[0]+=h[1])),this.isTopAnchor(s)?(d[1]-=o[1]/2,s==="top"&&(d[1]-=h[2])):this.isBottomAnchor(s)&&(d[1]+=o[1]/2,s==="bottom"&&(d[1]+=h[3])),d},alignForAnchor:function(e){if(e&&e!=="center"){if(this.isLeftAnchor(e))return"right";if(this.isRightAnchor(e))return"left"}return"center"},isLeftAnchor:function(e){return lefts.indexOf(e)>-1},isRightAnchor:function(e){return rights.indexOf(e)>-1},isTopAnchor:function(e){return tops.indexOf(e)>-1},isBottomAnchor:function(e){return bottoms.indexOf(e)>-1},default_buffer:[2.5,2.5,1.5,.75],zero_buffer:[0,0,0,0]};function encircleLine(e,o,s,h,d){var g=[],_=s-e,j=h-o,$=MathUtils$1.getLineLength(e,o,s,h),_t=2*d,_e=$/_t;if(_e<=1)g.push(e+_/2,o+j/2,d);else{var _r=_t/$,_i=_*_r,_n=j*_r;(_e=$/d/2)%1&&g.push(s-_i/2,h-_n/2,d),_e|=0;for(var _s=e+_i/2,_l=o+_n/2;_e--;)g.push(_s,_l,d),_s+=_i,_l+=_n}return g}var LabelPoint=function(){return _createClass(function e(o,s,h,d){_classCallCheck(this,e),this.id=Label.nextLabelId(),this.position=[o[0],o[1]],o[2]!==void 0&&this.position.push(o[2]),this.size=s,this.layout=d,this.anchor=Array.isArray(this.layout.anchor)?this.layout.anchor[0]:this.layout.anchor,this.placed=null,this.type="point",this.parent=this.layout.parent,this.offset=this.computeOffset(),this.align=this.layout.align||PointAnchor.alignForAnchor(this.anchor),this._is_flat=h},[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,align:this.align,sides:this.getSides(),breach:!this.inTileBounds(),layout:textLayoutToJSON(this.layout)}}},{key:"inTileBounds",value:function(){var e=this.getAABB(),o=e.left,s=e.top,h=e.right,d=e.bottom;return Utils$1.pointInTile([o,s])&&Utils$1.pointInTile([h,d])}},{key:"isFlat",value:function(){return this._is_flat}},{key:"setAnchor",value:function(e){this._circles=void 0,this._aabb=void 0,this.anchor=e,this.offset=this.computeOffset()}},{key:"computeOffset",value:function(){var e=[this.layout.offset[0],this.layout.offset[1]];if(this.parent){var o=this.parent;e=PointAnchor.computeOffset(e,o.size,o.anchor,PointAnchor.zero_buffer),e=PointAnchor.computeOffset(e,o.size,this.anchor,PointAnchor.zero_buffer),o.offset!==StyleParser.zeroPair&&(e===StyleParser.zeroPair?e=o.offset:(e[0]+=o.offset[0],e[1]+=o.offset[1]))}return PointAnchor.computeOffset(e,this.size,this.anchor)}},{key:"getBoundingCircles",value:function(){if(!this.angle)return[];if(!this._circles){var e=this.layout.units_per_pixel,o=this.size[0]/2*e,s=o*Math.cos(this.angle),h=o*Math.sin(this.angle),d=-s,g=-h,_=_slicedToArray(this.position,2),j=_[0],$=_[1];s+=j,h+=$*=-1,d+=j,g+=$;var _t=this.size[1]/2*e;this._circles=encircleLine(s,h,d,g,_t)}return this._circles}},{key:"getAABB",value:function(){if(!this._aabb){var e=this.layout.units_per_pixel,o=(this.size[0]/2+this.layout.buffer[0])*e,s=(this.size[1]/2+this.layout.buffer[1])*e,h=this.position[0]+this.offset[0]*e,d=this.position[1]-this.offset[1]*e;this._aabb={left:h-o,top:d+s,right:h+o,bottom:d-s}}return this._aabb}},{key:"getSides",value:function(){var e=this.getAABB(),o=e.left,s=e.top,h=e.right,d=(s+e.bottom)/2;return[o,d,h,d]}}])}();LabelPoint.PLACEMENT={VERTEX:0,MIDPOINT:1,SPACED:2,CENTROID:3};var PLACEMENT$1=LabelPoint.PLACEMENT,default_spacing=80;function placePointsOnLine(e,o,s,h){var d=[],g=h.placement,_=Math.max(o[0],o[1])*h.placement_min_length_ratio*h.units_per_pixel;switch(g){case PLACEMENT$1.SPACED:var j=getPositionsAndAngles(e,_,h);if(!j)return[];for(var $=j.positions,_t=j.angles,_e=0;_e<$.length;_e++){var _r=$[_e],_i=_t[_e];if(h.tile_edges===!0||!isCoordOutsideTile(_r)){var _n=new LabelPoint(_r,o,s,h);_n.angle=_i,d.push(_n)}}break;case PLACEMENT$1.VERTEX:for(var _s,_l,Ap,_h=0;_h<e.length-1;_h++)_s=e[_h],_l=e[_h+1],h.tile_edges!==!0&&isCoordOutsideTile(_s)||((Ap=new LabelPoint(_s,o,s,h)).angle=getAngle(_s,_l,h.angle),d.push(Ap));(Ap=new LabelPoint(_l,o,s,h)).angle=getAngle(_s,_l,h.angle),d.push(Ap);break;case PLACEMENT$1.MIDPOINT:for(var _p=0;_p<e.length-1;_p++){var ty=e[_p],ry=e[_p+1],ly=[.5*(ty[0]+ry[0]),.5*(ty[1]+ry[1])];if((h.tile_edges===!0||!isCoordOutsideTile(ly))&&(!_||norm(ty,ry)>_)){var uy=new LabelPoint(ly,o,s,h);uy.angle=getAngle(ty,ry,h.angle),d.push(uy)}}}return d}function getPositionsAndAngles(e,o,s){var h=s.units_per_pixel,d=(s.placement_spacing||default_spacing)*h,g=getLineLength(e);if(g<=o)return!1;for(var _=Math.max(Math.floor(g/d),1),j=[],$=[],_t=.5*(g-(_-1)*d),_e=0;_e<_;_e++){var _r=interpolateLine(e,_t,o,s),_i=_r.position,_n=_r.angle;_i!=null&&_n!=null&&(j.push(_i),$.push(_n)),_t+=d}return{positions:j,angles:$}}function getAngle(e,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return s==="auto"?Math.atan2(o[0]-e[0],o[1]-e[1]):s}function getLineLength(e){for(var o=0,s=0;s<e.length-1;s++)o+=norm(e[s],e[s+1]);return o}function norm(e,o){return Math.sqrt(Math.pow(e[0]-o[0],2)+Math.pow(e[1]-o[1],2))}function interpolateLine(e,o,s,h){for(var d,g,_=0,j=0;j<e.length-1;j++){var $=e[j],_t=e[j+1],_e=norm($,_t);if(!(_e<=s)&&(_+=_e)>o){d=interpolateSegment($,_t,_-o),g=getAngle($,_t,h.angle);break}}return{position:d,angle:g}}function interpolateSegment(e,o,s){var h=s/norm(e,o);return[h*e[0]+(1-h)*o[0],h*e[1]+(1-h)*o[1]]}var TextSettings={key:function(e){return[e.style,e.weight,e.family,e.px_size,e.fill,e.stroke,e.stroke_width,e.transform,e.text_wrap,e.max_lines,e.supersample,e.background_color,e.outline_color,e.outline_width,e.padding,Utils$1.device_pixel_ratio].join("/")},defaults:{style:"normal",weight:null,size:"12px",px_size:12,family:"Helvetica",fill:"white",text_wrap:15,max_lines:5,align:"center",stroke:null,stroke_width:0,background_color:null,outline_color:null,outline_width:0,padding:[0,0,0,0]},compute:function(e,o,s){var h={};if(o.font=o.font||this.defaults,h.can_articulate=o.can_articulate,h.fill=o.font.fill&&Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(o.font.fill,s))||this.defaults.fill,h.style=o.font.style||this.defaults.style,h.weight=o.font.weight||this.defaults.weight,o.font.family?(h.family=o.font.family,h.family!==this.defaults.family&&(h.family+=", "+this.defaults.family)):h.family=this.defaults.family,h.transform=o.font.transform,h.size=o.font.size||this.defaults.size,h.supersample=o.supersample_text?1.5:1,h.px_size=StyleParser.evalCachedProperty(o.font.px_size,s)*h.supersample,h.px_size!==0){o.font.stroke&&o.font.stroke.color&&(h.stroke=Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(o.font.stroke.color,s)||this.defaults.stroke),h.stroke_width=StyleParser.evalCachedProperty(o.font.stroke.width,s)||this.defaults.stroke_width),h.font_css=this.fontCSS(h);var d=o.text_wrap;return d==null&&Geo$1.geometryType(e.geometry.type)!=="line"&&(d=!0),d===!0&&(d=this.defaults.text_wrap),h.text_wrap=d,h.max_lines=o.max_lines||this.defaults.max_lines,h.background_color=o.background&&o.background.color&&!o.can_articulate?Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(o.background.color,s)):this.defaults.background_color,h.outline_color=o.outline&&o.outline.color&&!o.can_articulate?Utils$1.toCSSColor(StyleParser.evalCachedColorProperty(o.outline.color,s)):this.defaults.outline_color,h.outline_width=o.outline&&o.outline.width&&!o.can_articulate?StyleParser.evalCachedProperty(o.outline.width,s):this.defaults.outline_width,h.padding=o.padding&&!o.can_articulate?StyleParser.evalCachedProperty(o.padding,s):this.defaults.padding,h}},fontCSS:function(e){return[e.style,e.weight,e.px_size+"px",e.family].filter(function(o){return o}).join(" ")}},fontfaceobserver_standalone={exports:{}};(function(e){(function(){function o(_n,_s){document.addEventListener?_n.addEventListener("scroll",_s,!1):_n.attachEvent("scroll",_s)}function s(_n){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(_n)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function h(_n,_s){_n.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;left:-999px;white-space:nowrap;font:"+_s+";"}function d(_n){var _s=_n.a.offsetWidth,_l=_s+100;return _n.f.style.width=_l+"px",_n.c.scrollLeft=_l,_n.b.scrollLeft=_n.b.scrollWidth+100,_n.g!==_s&&(_n.g=_s,!0)}function g(_n,_s){function _l(){var _h=Ap;d(_h)&&_h.a.parentNode&&_s(_h.g)}var Ap=_n;o(_n.b,_l),o(_n.c,_l),d(_n)}function _(_n,_s){var _l=_s||{};this.family=_n,this.style=_l.style||"normal",this.weight=_l.weight||"normal",this.stretch=_l.stretch||"normal"}var j=null,$=null,_t=null,_e=null;function _r(){if(_t===null){var _n=document.createElement("div");try{_n.style.font="condensed 100px sans-serif"}catch{}_t=_n.style.font!==""}return _t}function _i(_n,_s){return[_n.style,_n.weight,_r()?_n.stretch:"","100px",_s].join(" ")}_.prototype.load=function(_n,_s){var _l=this,Ap=_n||"BESbswy",_h=0,_p=_s||3e3,ty=new Date().getTime();return new Promise(function(ry,ly){var uy;if(_e===null&&(_e=!!document.fonts),(uy=_e)&&($===null&&($=/OS X.*Version\/10\..*Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),uy=!$),uy){uy=new Promise(function(fy,my){(function xy(){new Date().getTime()-ty>=_p?my():document.fonts.load(_i(_l,'"'+_l.family+'"'),Ap).then(function(Ly){1<=Ly.length?fy():setTimeout(xy,25)},function(){my()})})()});var py=new Promise(function(fy,my){_h=setTimeout(my,_p)});Promise.race([py,uy]).then(function(){clearTimeout(_h),ry(_l)},function(){ly(_l)})}else(function(fy){document.body?fy():document.addEventListener?document.addEventListener("DOMContentLoaded",function my(){document.removeEventListener("DOMContentLoaded",my),fy()}):document.attachEvent("onreadystatechange",function my(){document.readyState!="interactive"&&document.readyState!="complete"||(document.detachEvent("onreadystatechange",my),fy())})})(function(){function fy(){var Dy;(Dy=My!=-1&&Ry!=-1||My!=-1&&Sy!=-1||Ry!=-1&&Sy!=-1)&&((Dy=My!=Ry&&My!=Sy&&Ry!=Sy)||(j===null&&(Dy=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),j=!!Dy&&(536>parseInt(Dy[1],10)||parseInt(Dy[1],10)===536&&11>=parseInt(Dy[2],10))),Dy=j&&(My==Zy&&Ry==Zy&&Sy==Zy||My==qy&&Ry==qy&&Sy==qy||My==_m&&Ry==_m&&Sy==_m)),Dy=!Dy),Dy&&(ky.parentNode&&ky.parentNode.removeChild(ky),clearTimeout(_h),ry(_l))}var my=new s(Ap),xy=new s(Ap),Ly=new s(Ap),My=-1,Ry=-1,Sy=-1,Zy=-1,qy=-1,_m=-1,ky=document.createElement("div");ky.dir="ltr",h(my,_i(_l,"sans-serif")),h(xy,_i(_l,"serif")),h(Ly,_i(_l,"monospace")),ky.appendChild(my.a),ky.appendChild(xy.a),ky.appendChild(Ly.a),document.body.appendChild(ky),Zy=my.a.offsetWidth,qy=xy.a.offsetWidth,_m=Ly.a.offsetWidth,function Dy(){if(new Date().getTime()-ty>=_p)ky.parentNode&&ky.parentNode.removeChild(ky),ly(_l);else{var Gy=document.hidden;Gy!==!0&&Gy!==void 0||(My=my.a.offsetWidth,Ry=xy.a.offsetWidth,Sy=Ly.a.offsetWidth,fy()),_h=setTimeout(Dy,50)}}(),g(my,function(Dy){My=Dy,fy()}),h(my,_i(_l,'"'+_l.family+'",sans-serif')),g(xy,function(Dy){Ry=Dy,fy()}),h(xy,_i(_l,'"'+_l.family+'",serif')),g(Ly,function(Dy){Sy=Dy,fy()}),h(Ly,_i(_l,'"'+_l.family+'",monospace'))})})},e.exports=_})()})(fontfaceobserver_standalone);var fontfaceobserver_standaloneExports=fontfaceobserver_standalone.exports,FontFaceObserver=getDefaultExportFromCjs(fontfaceobserver_standaloneExports),FontManager={fonts_loaded:Promise.resolve(),last_loaded:null,loadFonts:function(e){var o=this,s=JSON.stringify(e)===this.last_loaded;if(e&&!s){var h=[],d=function(_){Array.isArray(e[_])?e[_].forEach(function(j){return h.push(o.loadFontFace(_,j))}):h.push(o.loadFontFace(_,e[_]))};for(var g in e)d(g);this.last_loaded=JSON.stringify(e),this.fonts_loaded=Promise.all(h.filter(function(_){return _}))}return this.fonts_loaded},loadFontFace:function(e,o){if(o!=null&&(_typeof(o)==="object"||o==="external")){var s={family:e},h=Promise.resolve();_typeof(o)==="object"&&(Object.assign(s,o),typeof o.url=="string"&&(h=this.injectFontFace(s)));var d=new FontFaceObserver(e,s);return h.then(function(){return d.load()}).then(function(){log("debug","Font face '".concat(e,"' is available"),s)},function(){log("debug","Font face '".concat(e,"' is NOT available"),s)})}},injectFontFace:function(e){var o=this,s=e.family,h=e.url,d=e.weight,g=e.style;this.supports_native_font_loading===void 0&&(this.supports_native_font_loading=window.FontFace!==void 0);var _=Promise.resolve(h);return h.slice(0,5)==="blob:"&&(_=Utils$1.io(h,6e4,"arraybuffer").then(function(j){var $=new Uint8Array(j);if(o.supports_native_font_loading)return $;for(var _t="",_e=0;_e<$.length;_e++)_t+=String.fromCharCode($[_e]);return"data:font/opentype;base64,"+btoa(_t)})),_.then(function(j){if(o.supports_native_font_loading){var $;typeof j=="string"?$=new FontFace(s,"url(".concat(encodeURI(j),")"),{weight:d,style:g}):j instanceof Uint8Array&&($=new FontFace(s,j,{weight:d,style:g})),document.fonts.add($),log("trace","Adding FontFace to document.fonts:",$)}else{var _t=`
                    @font-face {
                        font-family: '`.concat(s,`';
                        font-weight: `).concat(d||"normal",`;
                        font-style: `).concat(g||"normal",`;
                        src: url(`).concat(encodeURI(j),`);
                    }
                `),_e=document.createElement("style");_e.appendChild(document.createTextNode("")),document.head.appendChild(_e),_e.sheet.insertRule(_t,0),log("trace","Injecting CSS font face:",_t)}})}},CanvasText=function(){function e(){_classCallCheck(this,e),this.vertical_text_buffer=1,this.horizontal_text_buffer=1,this.layout=layout$1("binary-tree")}return _createClass(e,[{key:"createCanvas",value:function(o,s){var h=document.createElement("canvas");return o&&s&&(h.width=o,h.height=s),h.style.backgroundColor="transparent",h}},{key:"setFont",value:function(o,s){var h=s.font_css,d=s.fill,g=s.stroke,_=s.stroke_width,j=s.px_size,$=s.supersample;this.px_size=j;var _t=Utils$1.device_pixel_ratio*$;g&&_>0&&(o.strokeStyle=g,o.lineWidth=_*_t),o.fillStyle=d,o.textBaseline="bottom",o.font=h,o.miterLimit=2}},{key:"textSizes",value:function(o,s,h){var d=this;return FontManager.loadFonts().then(function(){return Task.add({type:"textSizes",run:d.processTextSizesTask.bind(d),texts:s,tile_id:o,cursor:{ctx:h,styles:Object.keys(s),texts:null,style_idx:null,text_idx:null}})})}},{key:"processTextSizesTask",value:function(o){var s=o.cursor,h=o.texts,d=s.ctx;for(s.style_idx=s.style_idx||0;s.style_idx<s.styles.length;){var g=s.styles[s.style_idx];s.text_idx==null&&(s.text_idx=0,s.texts=Object.keys(h[g]));for(var _=h[g],j=!0;s.text_idx<s.texts.length;){var $=s.texts[s.text_idx],_t=_[$],_e=_t.text_settings;if(j&&(this.setFont(d,_e),j=!1),_t.size=this.textSize(d,g,$,_e).size,_e.can_articulate){var _r=!1,_i=!1;if(isTextRTL($)&&(isTextNeutral($)?_r=!0:_i=!0),_t.isRTL=_r,_t.no_curving=_i||isTextCurveBlacklisted($),_t.vertical_buffer=this.vertical_text_buffer+_e.outline_width+(_e.padding[0]+_e.padding[2])/2,_t.segment_sizes=[],!_t.no_curving){var _n=splitLabelText($,_r);_t.segments=_n;for(var _s=0;_s<_n.length;_s++)_t.segment_sizes.push(this.textSize(d,g,_n[_s],_e).size)}}if(s.text_idx++,!Task.shouldContinue(o))return!1}s.text_idx=null,s.style_idx++}return Task.finish(o,{texts:h}),!0}},{key:"textSize",value:function(o,s,h,d){var g=d.transform,_=d.text_wrap,j=d.max_lines,$=d.stroke_width,_t=$===void 0?0:$,_e=d.supersample,_r=d.padding,_i=d.outline_width,_n=d.can_articulate;if(e.cache.text[s]=e.cache.text[s]||{},e.cache.text[s][h])return e.cache.stats.text_hits++,e.cache.text[s][h];e.cache.stats.text_misses++,e.cache.text_count++;var _s=Utils$1.device_pixel_ratio*_e,_l=this.applyTextTransform(h,g),Ap=_s*(this.vertical_text_buffer+_i+(_r[0]+_r[2])/2),_h=_s*(this.horizontal_text_buffer+_i+_t+(_r[1]+_r[3])/2),_p=2*_s,ty=this.px_size+_p,ry=MultiLine.parse(_l,_,j,ty,o),ly=ry.height,uy=ry.width,py=ry.lines,fy=[uy/_s,ly/_s];_n||(fy[0]+=2*_h/_s,fy[1]+=2*Ap/_s);var my=[uy+2*_h,ly+2*Ap],xy=[my[0]/_s,my[1]/_s];return e.cache.text[s][h]={lines:py,size:{collision_size:fy,texture_size:my,logical_size:xy,line_height:ty}},e.cache.text[s][h]}},{key:"drawTextMultiLine",value:function(o,s,h,d,g,_){var j=_slicedToArray(h,2),$=j[0],_t=j[1],_e=Utils$1.device_pixel_ratio*g.supersample,_r=g.stroke_width||0,_i=g.stroke;g.background_color&&(o.fillStyle=g.background_color,o.fillRect($,_t,d.texture_size[0],d.texture_size[1]));var _n=g.outline_width*_e,_s=g.outline_color;_n&&_s&&(o.strokeStyle=_s,o.lineWidth=_n,o.strokeRect($+_n/2,_t+_n/2,d.texture_size[0]-_n,d.texture_size[1]-_n)),(g.background_color||_n&&_s)&&this.setFont(o,g);for(var _l=d.line_height,Ap=_t,_h=0;_h<s.length;_h++){var _p=s[_h];this.drawTextLine(o,_p,[$,Ap],d,g,_),Ap+=_l}if(debugSettings$1.draw_label_collision_boxes){o.save();var ty=_e*(this.horizontal_text_buffer+g.outline_width+_r+(g.padding[1]+g.padding[3])/2),ry=_e*(this.vertical_text_buffer+g.outline_width+(g.padding[0]+g.padding[2])/2),ly=d.collision_size;o.strokeStyle="blue",o.lineWidth=2,o.strokeRect($+ty,_t+ry,_e*ly[0],_e*ly[1]),_==="curved"&&_i&&_r>0&&o.strokeRect($+d.texture_size[0]+ty,_t+ry,_e*ly[0],_e*ly[1]),o.restore()}if(debugSettings$1.draw_label_texture_boxes){o.save();var uy=d.texture_size;o.strokeStyle="green",o.lineWidth=2,o.strokeRect($+2,_t+2,uy[0]-4,uy[1]-4),_==="curved"&&_i&&_r>0&&o.strokeRect($+2+d.texture_size[0],_t+2,uy[0]-4,uy[1]-4),o.restore()}}},{key:"drawTextLine",value:function(o,s,h,d,g,_){var j=_slicedToArray(h,2),$=j[0],_t=j[1],_e=g.stroke,_r=g.stroke_width,_i=_r===void 0?0:_r,_n=g.transform,_s=g.align,_l=g.supersample,Ap=g.padding,_h=g.outline_width,_p=Utils$1.device_pixel_ratio*_l;_s=_s||"center";var ty,ry=d.texture_size,ly=d.line_height,uy=_p*(this.vertical_text_buffer+_h),py=_p*(this.horizontal_text_buffer+_h+_i),fy=this.applyTextTransform(s.text,_n);_s==="left"?ty=$+py+Ap[3]*_p:_s==="center"?ty=$+ry[0]/2-s.width/2-(Ap[1]-Ap[3])*_p/2:_s==="right"&&(ty=$+ry[0]-s.width-py-Ap[1]*_p);var my=_t+uy+ly+Ap[0]*_p;if(_e&&_i>0){var xy=_==="curved"?ry[0]:0;o.strokeText(fy,ty+xy,my)}o.fillText(fy,ty,my)}},{key:"rasterize",value:function(o,s,h,d,g,_){return Task.removeForTile(h),Task.add({type:"rasterizeLabels",run:this.processRasterizeTask.bind(this),cancel:e.returnNoTextures,pause_factor:2,user_moving_view:!1,texts:o,textures:s,texture_prefix:d,gl:g,tile_id:h,texture_manager:_,cursor:{styles:Object.keys(o),texts:null,style_idx:0,text_idx:null,texture_idx:0,texture_names:[]}})}},{key:"processRasterizeTask",value:function(o){if(!Task.shouldContinue(o))return!1;for(var s,h=o.cursor,d=o.texts,g=o.textures;h.texture_idx<o.textures.length;){var _=!1;s=g[h.texture_idx];for(var j=this.createCanvas.apply(this,_toConsumableArray(s.texture_size)),$=j.getContext("2d");h.style_idx<h.styles.length;){var _t=h.styles[h.style_idx];h.text_idx==null&&(h.text_idx=0,h.texts=Object.keys(d[_t]));for(var _e=d[_t],_r=!0;h.text_idx<h.texts.length;){var _i=h.texts[h.text_idx],_n=_e[_i],_s=_n.text_settings;if(_r&&(this.setFont($,_s),_r=!1),_s.can_articulate){_n.texcoords=_n.texcoords||{};for(var _l=0;_l<_n.type.length;_l++){var Ap=_n.type[_l];switch(Ap){case"straight":if(_n.textures[_l]!==h.texture_idx)continue;var _h=_n.isRTL?_i.split().reverse().join():_i,_p=s.texcoord_cache[_t][_h],ty=void 0;if(_p.texcoord)ty=_p.texcoord;else{var ry=_p.texture_position,ly=this.textSize($,_t,_h,_s),uy=ly.size,py=ly.lines;this.drawTextMultiLine($,py,ry,uy,_s,Ap),ty=o.texture_manager.getTexcoordsForSprite(ry,uy.texture_size,s.texture_size),_p.texcoord=ty}_n.texcoords[Ap]={texcoord:ty,texture_id:_p.texture_id};break;case"curved":var fy=_n.segments;_n.texcoords.curved=[],_n.texcoords_stroke=[];for(var my=0;my<fy.length;my++)if(_n.textures[_l][my]===h.texture_idx){var xy=fy[my],Ly=s.texcoord_cache[_t][xy],My=void 0,Ry=void 0;if(Ly.texcoord&&Ly.texcoord_stroke)My=Ly.texcoord,Ry=Ly.texcoord_stroke,_n.texcoords_stroke.push(Ry);else{var Sy=Ly.texture_position,Zy=this.textSize($,_t,xy,_s),qy=Zy.size,_m=Zy.lines;this.drawTextMultiLine($,_m,Sy,qy,_s,Ap),My=o.texture_manager.getTexcoordsForSprite(Sy,qy.texture_size,s.texture_size),_s.stroke&&_s.stroke_width>0?Ry=o.texture_manager.getTexcoordsForSprite([Sy[0]+qy.texture_size[0],Sy[1]],qy.texture_size,s.texture_size):(_=!0,Ry=o.texture_manager.getTexcoordsForSprite([s.texture_size[0],s.texture_size[1]],[0,0],s.texture_size)),Ly.texcoord=My,Ly.texcoord_stroke=Ry,_n.texcoords_stroke.push(Ry)}_n.texcoords.curved.push({texcoord:My,texture_id:Ly.texture_id})}}}}else{var ky=this.textSize($,_t,_i,_s).lines;for(var Dy in _n.align)_n.align[Dy].texture_id===h.texture_idx&&(this.drawTextMultiLine($,ky,_n.align[Dy].texture_position,_n.size,{stroke:_s.stroke,stroke_width:_s.stroke_width,transform:_s.transform,supersample:_s.supersample,align:Dy,background_color:_s.background_color,outline_width:_s.outline_width,outline_color:_s.outline_color,padding:_s.padding,fill:_s.fill,font_css:_s.font_css,px_size:_s.px_size}),_n.align[Dy].texcoords=o.texture_manager.getTexcoordsForSprite(_n.align[Dy].texture_position,_n.size.texture_size,s.texture_size))}h.text_idx++}h.text_idx=null,h.style_idx++}_===!0&&($.fillStyle="rgba(0, 0, 0, 0)",$.fillRect(j.width-1,j.height-1,1,1));var Gy=o.texture_prefix+h.texture_idx;o.texture_manager.create(o.gl,Gy,{element:j,filtering:"linear",UNPACK_PREMULTIPLY_ALPHA_WEBGL:!0}),h.texture_names.push(Gy),h.texture_idx++,h.style_idx=0,j.width=0,j.height=0}return Task.finish(o,h.texture_names),!0}},{key:"setTextureTextPositions",value:function(o){var s={texture_id:0,texcoord_cache:{}},h=[];for(var d in o){var g=o[d];for(var _ in g){var j=g[_],$=j.text_settings,_t=$.can_articulate,_e=$.stroke,_r=$.stroke_width;if(_t){j.textures=[],s.texcoord_cache[d]=s.texcoord_cache[d]||{};for(var _i=0;_i<j.type.length;_i++)switch(j.type[_i]){case"straight":var _n=j.isRTL?_.split().reverse().join():_;if(!s.texcoord_cache[d][_n]){var _s=j.size.texture_size;s.texcoord_cache[d][_n]={},this.placeText(_s[0],_s[1],{can_articulate:_t,style:d,word:_n})}j.textures[_i]=s.texture_id;break;case"curved":j.textures[_i]=[];for(var _l=0;_l<j.segment_sizes.length;_l++){var Ap=j.segments[_l];if(!s.texcoord_cache[d][Ap]){var _h=j.segment_sizes[_l].texture_size,_p=_h[0];_e&&_r>0&&(_p*=2),s.texcoord_cache[d][Ap]={},this.placeText(_p,_h[1],{can_articulate:_t,style:d,word:Ap})}j.textures[_i].push(s.texture_id)}}}else{var ty=j.size.texture_size;this.placeText(ty[0],ty[1],{can_articulate:_t,text_info:j})}}}var ry=this.layout.export(),ly=ry.items,uy=ry.width,py=ry.height;s.texcoord_cache={};for(var fy=0,my=ly.length;fy<my;fy++){var xy=ly[fy],Ly=xy.x,My=xy.y;if(xy.meta.can_articulate){var Zy=xy.meta,qy=Zy.style,_m=Zy.word;s.texcoord_cache[qy]=s.texcoord_cache[qy]||{},s.texcoord_cache[qy][_m]||(s.texcoord_cache[qy][_m]={texture_id:s.texture_id,texture_position:[Ly,My]})}else{var Ry=xy.meta.text_info;for(var Sy in Ry.align)Ry.align[Sy].texture_id=s.texture_id,Ry.align[Sy].texture_position=[Ly,My]}}return uy>0&&py>0&&(h[s.texture_id]={texture_size:[uy,py],texcoord_cache:s.texcoord_cache}),h}},{key:"placeText",value:function(o,s,h){this.layout.addItem({width:o+this.vertical_text_buffer,height:s+this.vertical_text_buffer,meta:h})}},{key:"applyTextTransform",value:function(o,s){return s==="capitalize"?o.replace(/\w\S*/g,function(h){return h.charAt(0).toUpperCase()+h.substr(1)}):s==="uppercase"?o.toUpperCase():s==="lowercase"?o.toLowerCase():o}}],[{key:"fontPixelSize",value:function(o){if(o!=null){var s=_slicedToArray((o=typeof o=="string"?o:String(o)).match(e.font_size_re)||[],3),h=s[1],d=s[2];return(d=d||"px")==="em"?h*=16:d==="pt"?h/=.75:d==="%"&&(h/=6.25),h=StyleParser.parsePositiveNumber(h),h*=Utils$1.device_pixel_ratio}}},{key:"pruneTextCache",value:function(){e.cache.text_count>e.cache.text_count_max&&(e.cache.text={},e.cache.text_count=0,log("debug","CanvasText: pruning text cache")),Object.keys(e.cache.segment).length>e.cache.segment_count_max&&(e.cache.segment={},log("debug","CanvasText: pruning segment cache"))}}])}();CanvasText.font_size_re=/((?:[0-9]*\.)?[0-9]+)\s*(px|pt|em|%)?/,CanvasText.cache={text:{},text_count:0,text_count_max:2e3,segment:{},segment_count_max:2e3,stats:{text_hits:0,text_misses:0,segment_hits:0,segment_misses:0}},CanvasText.EMPTY_TEXTURES_ARR=[],CanvasText.returnNoTextures=function(){return CanvasText.EMPTY_TEXTURES_ARR};var rtlDirCheck=new RegExp("[---]");function isTextRTL(e){return rtlDirCheck.test(e)}var neutral_chars="\0-/:-@[-`{----\u2029-",neutralDirCheck=new RegExp("["+neutral_chars+"]+");function isTextNeutral(e){return neutralDirCheck.test(e)}var markRTL="",arabic_range=new RegExp("^["+neutral_chars+"-]+"),arabic_splitters=new RegExp("["+neutral_chars+"-----]"),arabic_vowels=new RegExp("^[-----]+"),accents_and_vowels="[------------------------------------------]",combo_characters="[]",graphemeRegex=new RegExp("^.(?:"+accents_and_vowels+"+)?("+combo_characters+"\\W(?:"+accents_and_vowels+"+)?)*"),curve_blacklist={Mongolian:"-"},curve_blacklist_range=Object.keys(curve_blacklist).map(function(e){return curve_blacklist[e]}).join(""),curve_blacklist_test=new RegExp("["+curve_blacklist_range+"]");function isTextCurveBlacklisted(e){return curve_blacklist_test.test(e)}var default_segment_length=2;function splitLabelText(e,o){var s=o?1:default_segment_length;if(e.length<s)return[e];var h=e;if(CanvasText.cache.segment[h])return CanvasText.cache.stats.segment_hits++,CanvasText.cache.segment[h];var d=[];if(arabic_range.exec(e)){d=e.split(arabic_splitters);for(var g=-1,_=0;_<d.length-1;_++){if(_>0){var j=arabic_vowels.exec(d[_]);j&&(d[_]=d[_].substring(j[0].length),d[_-1]+=j[0],g+=j[0].length)}g+=1+d[_].length,d[_]+=e.slice(g,g+1)}e=""}for(;e.length;){for(var $="",_t=e,_e=0;_e<s&&_t.length;_e++){var _r=(graphemeRegex.exec(_t)||_t)[0];$+=_r,_t=_t.substring(_r.length)}d.push($),e=e.substring($.length)}return o&&d.reverse(),CanvasText.cache.stats.segment_misses++,CanvasText.cache.segment[h]=d,d}var MultiLine=function(){function e(o){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0;_classCallCheck(this,e),this.width=0,this.height=0,this.lines=[],this.max_lines=s,this.text_wrap=h,this.context=o}return _createClass(e,[{key:"createLine",value:function(o){return this.lines.length<this.max_lines&&new Line(o,this.text_wrap)}},{key:"push",value:function(o){if(this.lines.length<this.max_lines){var s=this.context.measureText(o.text).width;return o.width=s,s>this.width&&(this.width=Math.ceil(s)),this.lines.push(o),this.height+=o.height,!0}return this.addEllipsis(),!1}},{key:"advance",value:function(o,s){return!!this.push(o)&&this.createLine(s)}},{key:"addEllipsis",value:function(){var o=this.lines[this.lines.length-1],s=Math.ceil(this.context.measureText(e.ellipsis).width);o.append(e.ellipsis),o.width+=s,o.width>this.width&&(this.width=o.width)}},{key:"finish",value:function(o){o?this.push(o):this.addEllipsis()}}],[{key:"parse",value:function(o,s,h,d,g){var _;_=typeof s=="number"?o.split(" "):[o];for(var j=new e(g,h,s),$=j.createLine(d),_t=0;_t<_.length;_t++){for(var _e=_[_t].split(`
`),_r=_t===0,_i=0;_i<_e.length&&$;_i++){var _n=_e[_i];isTextRTL(_n)&&isTextNeutral(_n[_n.length-1])&&(_n+=markRTL);var _s=_r?_n:" "+_n;if(s&&_t>0&&$.exceedsTextwrap(_s)){if(!($=j.advance($,d)))break;$.append(_n),_r=!0}else $.append(_s);_i<_e.length-1&&($=j.advance($,d),_r=!0)}_t===_.length-1&&j.finish($)}return j}}])}();MultiLine.ellipsis="...";var Line=function(){return _createClass(function e(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;_classCallCheck(this,e),this.chars=0,this.text="",this.height=Math.ceil(o),this.text_wrap=s},[{key:"append",value:function(e){this.chars+=e.length,this.text+=e}},{key:"exceedsTextwrap",value:function(e){return e.length+this.chars>this.text_wrap}}])}(),TextLabels={resetText:function(){this.texts={}},freeText:function(e){delete this.texts[e.id]},parseTextFeature:function(e,o,s,h){var d=this.parseTextSource(e,o,s);if(d!=null&&d!==""){var g=TextSettings.compute(e,o,s);if(g){var _=TextSettings.key(g);this.texts[h.id]=this.texts[h.id]||{};var j=this.texts[h.id][_]=this.texts[h.id][_]||{};if(d instanceof Object){var $=[],_t=d.left+"-"+d.right;for(var _e in d){var _r=d[_e];if(_r){var _i=this.computeTextLayout({},e,o,s,h,_r,g,_t,_e);j[_r]||(j[_r]={text_settings:g,ref:0}),$.push({draw:o,text:_r,text_settings_key:_,layout:_i})}}return $.length>0&&$}var _n=this.computeTextLayout({},e,o,s,h,d,g);return j[d]||(j[d]={text_settings:g,ref:0}),{draw:o,text:d,text_settings_key:_,layout:_n}}}},parseTextSource:function(e,o,s){var h,d=o.text_source||"name";if(d!=null&&_typeof(d)==="object")for(var g in h={},d)h[g]=this.parseTextSourceValue(d[g],e,s);else h=this.parseTextSourceValue(d,e,s);return h},parseTextSourceValue:function(e,o,s){var h;if(Array.isArray(e)){for(var d=0;d<e.length;d++)if(typeof e[d]=="string"?h=o.properties[e[d]]:typeof e[d]=="function"&&(h=e[d](s)),h)return h}else typeof e=="string"?h=o.properties[e]:e instanceof Function&&(h=e(s));return h},prepareTextLabels:function(e,o,s){var h=this;return Object.keys(this.texts[e.id]||{}).length===0?Promise.resolve([]):WorkerBroker.postMessage(this.main_thread_target+".calcTextSizes",e.id,this.texts[e.id]).then(function(d){var g=d.texts;return e.canceled?(log("trace","Style ".concat(h.name,": stop tile build because tile was canceled: ").concat(e.key,", post-calcTextSizes()")),[]):(h.texts[e.id]=g||[],g?h.buildTextLabels(e,s):(Collision.abortTile(e.id),[]))})},collideAndRenderTextLabels:function(e,o,s){var h=this;return this.prepareTextLabels(e,o,s).then(function(d){return d.length===0?(Collision.collide([],o,e.id),Promise.resolve({})):Collision.collide(d,o,e.id).then(function(g){if(e.canceled)return log("trace","stop tile build because tile was canceled: ".concat(e.key,", post-collide()")),{};var _=h.texts[e.id];return _==null||g.length===0?{}:(h.cullTextStyles(_,g),g.forEach(function(j){var $=j.text_settings_key,_t=_[$]&&_[$][j.text];_t.text_settings.can_articulate?(_t.type||(_t.type=[]),_t.type.indexOf(j.label.type)===-1&&_t.type.push(j.label.type)):(_t.align=_t.align||{},_t.align[j.label.align]={})}),{labels:g,texts:_,textures:[]})})})},cullTextStyles:function(e,o){for(var s=0;s<o.length;s++){var h=o[s];e[h.text_settings_key][h.text].ref++}for(var d in e)for(var g in e[d])e[d][g].ref<1&&delete e[d][g];for(var _ in e)Object.keys(e[_]).length===0&&delete e[_]},calcTextSizes:function(e,o){return this._canvas_text||(this._canvas_text=new CanvasText,this._canvas_ctx_for_sizes=this._canvas_text.createCanvas().getContext("2d")),this._canvas_text.textSizes(e,o,this._canvas_ctx_for_sizes)},preprocessText:function(e){if(e&&e.font&&_typeof(e.font)==="object")return e.font.fill=StyleParser.createPropertyCache(e.font.fill),e.font.stroke&&(e.font.stroke.color=StyleParser.createPropertyCache(e.font.stroke.color)),e.background&&e.background.color&&(e.background.color=StyleParser.createPropertyCache(e.background.color)),e.outline&&(e.outline.color&&(e.outline.color=StyleParser.createPropertyCache(e.outline.color)),e.outline.width&&(e.outline.width=StyleParser.createPropertyCache(e.outline.width,StyleParser.parsePositiveNumber))),e.padding&&(Array.isArray(e.padding)?e.padding.length===2&&(e.padding=[e.padding[0],e.padding[1],e.padding[0],e.padding[1]]):e.padding=Array(4).fill(e.padding),e.padding=StyleParser.createPropertyCache(e.padding,function(o){return o.map(StyleParser.parsePositiveNumber)})),e.font.px_size=StyleParser.createPropertyCache(e.font.size||TextSettings.defaults.size,CanvasText.fontPixelSize),e.font.stroke&&e.font.stroke.width!=null&&(e.font.stroke.width=StyleParser.createPropertyCache(e.font.stroke.width,StyleParser.parsePositiveNumber)),e.offset=StyleParser.createPropertyCache(e.offset,function(o){return Array.isArray(o)&&o.map(StyleParser.parseNumber)}),e.buffer=StyleParser.createPropertyCache(e.buffer,function(o){return(Array.isArray(o)?o:[o,o]).map(StyleParser.parsePositiveNumber)}),e.repeat_distance=StyleParser.createPropertyCache(e.repeat_distance||Geo$1.tile_size,StyleParser.parsePositiveNumber),e},computeTextLayout:function(e,o,s,h,d,g,_,j,$){var _t=e||{};return(_t=this.computeLayout(_t,o,s,h,d)).repeat_distance&&(j&&(_t.repeat_group+="/"+j),_t.repeat_group+="/"+g),_t.subdiv=d.overzoom2,_t.align=s.align,_t.italic=_.style!=="normal",$==="right"?_t.orientation=1:$==="left"&&(_t.orientation=-1),_t}};function degToRad(e){return e*Math.PI/180}var PI_OVER_180=Math.PI/180,HORIZON_THRESHOLD_MULTIPLIER=.75,ZOOM_FOR_BOUNDS_EPSILON=.001,NEAR_PLANE=1,LookAtManipulator=function(){function e(o,s){_classCallCheck(this,e),this._min_zoom=H.util.constants.DEFAULT_MIN_ZOOM_LEVEL,this._max_zoom=H.util.constants.DEFAULT_MAX_ZOOM_LEVEL,this._viewport=o,this._center_offset=[],this._center_offset_normalized=[],this._viewport_aspect_ratio=1,this._focal_length=[[16,2],[17,2.5],[18,3],[19,4],[20,6]],this._view_matrix=new Float64Array(16),this._projection_matrix=new Float64Array(16),this._heading_matrix=new Float64Array(16),this._tilt_matrix=new Float64Array(16),this._transformation_matrix=new Float64Array(16),this._camera_matrix=new Float64Array(16),this._lookAtData={position:[0,0,0],zoom:0,tile_level:0,tetragon:void 0,bounds:void 0,unpadded_bounds:void 0,distance:void 0,tilt:0,incline:0,heading:180},this._zoom_direction=0,this._horizon=0,this.handleViewportUpdate(!0),s?this.setLookAtData(s):this._updateMatrices(),ShaderProgram.replaceBlock("camera",`
            uniform mat4 u_projection;
            uniform vec3 u_eye;
            uniform vec2 u_center_offset;

            void cameraProjection (inout vec4 position) {
                position = u_projection * position;
            }`)}return _createClass(e,[{key:"getZoomForBounds",value:function(o,s,h,d){var g=this.clone(),_=this._max_zoom,j=this._min_zoom,$=(_-j)/2,_t=_-$,_e=s,_r=MathUtils$1.getBBoxCenter(MathUtils$1.getBBox(o));if(_e===void 0)_e=_r;else{var _i=_r[0]-_e[0];Math.abs(_i)>Geo$1.half_circumference_meters+1e-8&&(_e[0]+=Math.round(_i/Geo$1.circumference_meters)*Geo$1.circumference_meters)}for(var _n=function(){g.setLookAtData({zoom:_t,position:_e,tilt:h,heading:d});var _s=g.getLookAtData().bounds;if(o.every(function(ry){return MathUtils$1.isPointInsidePolygon(ry,_s)}))j=_t;else{var _l=_slicedToArray(MathUtils$1.getBBox(_s),4),Ap=_l[0],_h=_l[1],_p=_l[2],ty=_l[3];_p-Ap+1e-8>=Geo$1.circumference_meters&&ty-_h+1e-8>=Geo$1.circumference_meters?j=_t:_=_t}_t=_-($=(_-j)/2)};$>ZOOM_FOR_BOUNDS_EPSILON;)_n();return j}},{key:"setZoomConstraints",value:function(o,s){this._min_zoom=o,this._max_zoom=s,this.setLookAtData(this.getLookAtData())}},{key:"setLookAtData",value:function(o,s){var h,d,g=o.position,_=o.zoom;if(g===h&&o.bounds!==h&&(g=MathUtils$1.getBBoxCenter(MathUtils$1.getBBox(o.bounds))),_===h&&o.bounds!==h&&(_=this.getZoomForBounds(o.bounds,g,o.tilt,o.heading)),s!==h&&(d=g||this.screenToWorld(s)),_!==h){_=MathUtils$1.clamp(_,this._min_zoom,this._max_zoom);var j=Utils$1.zoomToTileLevel(_),$=this._lookAtData.tile_level;j!==$&&(this._zoom_direction=j>$?1:-1),this._lookAtData.zoom=_,this._lookAtData.tile_level=j}if(o.tilt!==h&&(this._lookAtData.tilt=o.tilt),o.heading!==h&&(this._lookAtData.heading=o.heading),s!==h){this._updateMatrices();var _t=this.screenToWorld(s);this._lookAtData.position[0]-=_t[0]-d[0],this._lookAtData.position[1]-=_t[1]-d[1]}else g&&(this._lookAtData.position=g);this._lookAtData.position[2]=0,this._lookAtData.position[1]=MathUtils$1.clamp(this._lookAtData.position[1],-Geo$1.half_circumference_meters,Geo$1.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"getZoomDirection",value:function(){return this._zoom_direction}},{key:"resetZoomDirection",value:function(){this._zoom_direction=0}},{key:"getLookAtData",value:function(){return this._lookAtData}},{key:"handleViewportUpdate",value:function(){var o=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=this._viewport,h=s.width,d=s.height;this._viewport_aspect_ratio=h/d;var g=this._viewport.center.x-(h/2|0),_=this._viewport.center.y-(d/2|0);this._center_offset[0]=g,this._center_offset[1]=_,this._center_offset_normalized[0]=g/h,this._center_offset_normalized[1]=_/-d,o||(this._updateMatrices(),this._updateVisibleBounds())}},{key:"setupMatrices",value:function(o,s){mat4.multiply(o.model_view32,this._view_matrix,o.model),s.uniform("Matrix4fv","u_modelView",o.model_view32),mat3.normalFromMat4(o.normal32,o.model_view32),mat3.invert(o.inverse_normal32,o.normal32),s.uniform("Matrix3fv","u_normalMatrix",o.normal32),s.uniform("Matrix3fv","u_inverseNormalMatrix",o.inverse_normal32)}},{key:"_updateMatrices",value:function(){var o=this._viewport.height*Geo$1.metersPerPixel(this._lookAtData.zoom),s=Utils$1.interpolate(this._lookAtData.zoom,this._focal_length);this._lookAtData.distance=o/2*s;var h=this._lookAtData.position[0],d=this._lookAtData.position[1];mat4.lookAt(this._view_matrix,vec3.fromValues(h,d,0),vec3.fromValues(h,d,-1),vec3.fromValues(0,1,0)),this._heading_matrix=mat4.identity(this._heading_matrix);var g=180-this._lookAtData.heading;g*=PI_OVER_180,this._heading_matrix[0]=Math.cos(g),this._heading_matrix[1]=-Math.sin(g),this._heading_matrix[4]=Math.sin(g),this._heading_matrix[5]=Math.cos(g),this._tilt_matrix=mat4.identity(this._tilt_matrix),g=(g=this._lookAtData.tilt?this._lookAtData.tilt*PI_OVER_180:0)>0?-g:g,this._tilt_matrix[5]=Math.cos(g),this._tilt_matrix[6]=Math.sin(g),this._tilt_matrix[9]=-Math.sin(g),this._tilt_matrix[10]=Math.cos(g),mat4.multiply(this._transformation_matrix,this._tilt_matrix,this._heading_matrix),mat4.multiply(this._view_matrix,this._transformation_matrix,this._view_matrix);var _=2*Math.atan(1/s),j=2*this._lookAtData.distance;this._depth_buffer_adjustment=2/Math.log(j/NEAR_PLANE),mat4.perspective(this._projection_matrix,_,this._viewport_aspect_ratio,NEAR_PLANE,j),this._projection_matrix[8]=2*-this._center_offset_normalized[0],this._projection_matrix[9]=2*-this._center_offset_normalized[1],mat4.translate(this._projection_matrix,this._projection_matrix,vec3.fromValues(0,0,-this._lookAtData.distance)),this._camera_matrix=mat4.multiply(this._camera_matrix,this._projection_matrix,this._view_matrix)}},{key:"_updateVisibleBounds",value:function(){var o=this._viewport,s=o.width,h=o.height,d=o.padding,g=degToRad(this._lookAtData.tilt);if(this._horizon=Math.max((d.top+h)/2-Math.cos(g)*(d.top*(1-Math.sin(g))+h*HORIZON_THRESHOLD_MULTIPLIER),0),this._lookAtData.tetragon=[this.screenToWorld([0,this._horizon]),this.screenToWorld([s,this._horizon]),this.screenToWorld([s,h]),this.screenToWorld([0,h])],this._lookAtData.unpadded_bounds=this._clipAgainstGeoBounds(this._lookAtData.tetragon),d.left===0&&d.top===0&&d.right===0&&d.bottom===0)this._lookAtData.bounds=this._lookAtData.unpadded_bounds;else{var _=d.left,j=Math.max(this._horizon,d.top),$=s-d.right,_t=h-d.bottom,_e=[this.screenToWorld([_,j]),this.screenToWorld([$,j]),this.screenToWorld([$,_t]),this.screenToWorld([_,_t])];this._lookAtData.bounds=this._clipAgainstGeoBounds(_e)}}},{key:"_clipAgainstGeoBounds",value:function(o){var s=_slicedToArray(MathUtils$1.getBBox(o),4),h=s[0],d=s[1],g=s[2],_=s[3],j=Geo$1.half_circumference_meters,$=[[h-1,+j],[g+1,+j],[g+1,-j],[h-1,-j]],_t=MathUtils$1.clipPolygon($,o)[0],_e=_slicedToArray(MathUtils$1.getBBox(_t),4);if(h=_e[0],d=_e[1],g=_e[2],_=_e[3],g-h>=Geo$1.circumference_meters){var _r=(g-h)/2;_t=[[_r-j,_],[_r+j,_],[_r+j,d],[_r-j,d]]}var _i=[];return _t&&(_i=MathUtils$1.splitLegs(_t,j)),_i}},{key:"applyPxOffset",value:function(o){var s=_slicedToArray(o,2),h=s[0],d=s[1],g=Math.PI-this._lookAtData.heading*PI_OVER_180,_=Geo$1.metersPerPixel(this._lookAtData.zoom);this._lookAtData.position[0]+=(h*Math.cos(g)+d*Math.sin(g))*_,this._lookAtData.position[1]-=(d*Math.cos(g)-h*Math.sin(g))*_,this._lookAtData.position[1]=MathUtils$1.clamp(this._lookAtData.position[1],-Geo$1.half_circumference_meters,Geo$1.half_circumference_meters),this._updateMatrices(),this._updateVisibleBounds()}},{key:"screenToWorld",value:function(o){var s=_slicedToArray(o,2),h=s[0],d=s[1],g=this._viewport,_=g.width,j=g.height;return _===0||j===0?[0,0]:(h-=_/2,d-=j/2,this._clipCoordsToWorldPlaneCoords([2*(h+_/2)/_-1,1-2*(d+j/2)/j,-1,1]))}},{key:"_clipToScreenCoords",value:function(o){var s=this._viewport,h=s.width,d=s.height;return[(.5*o[0]+.5)*h,d-(.5*o[1]+.5)*d]}},{key:"_isScreenPointInViewPort",value:function(o){var s=this._viewport,h=s.width,d=s.height;return o[0]>=0&&o[0]<=h&&o[1]>=0&&o[1]<=d}},{key:"worldToScreen",value:function(o){var s,h=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(o[2]||(o[2]=0),h){var d=this._worldToClipCoords(o);s=this._clipToScreenCoords(d)}else{var g=Math.sign(this._lookAtData.position[0]),_=Math.trunc(this._lookAtData.position[0]/Geo$1.circumference_meters+g/2);o[0]+=Geo$1.circumference_meters*_;var j=this._worldToClipCoords(o),$=s=this._clipToScreenCoords(j);this._isScreenPointInViewPort(s)||(j=this._worldToClipCoords([o[0]+Geo$1.circumference_meters,o[1],o[2]]),s=this._clipToScreenCoords(j),this._isScreenPointInViewPort(s)||(j=this._worldToClipCoords([o[0]-Geo$1.circumference_meters,o[1],o[2]]),s=this._clipToScreenCoords(j)),this._isScreenPointInViewPort(s)||(s=$))}return s}},{key:"getHorizon",value:function(){return this._horizon}},{key:"_clipCoordsToWorldPlaneCoords",value:function(o){var s=[],h=this._lookAtData.distance,d=this._lookAtData.position,g=[0,0,h,0],_=0,j=h*Math.sin(PI_OVER_180*this._lookAtData.tilt)*Math.cos(PI_OVER_180*this._lookAtData.heading),$=h*Math.sin(PI_OVER_180*this._lookAtData.tilt)*Math.sin(PI_OVER_180*this._lookAtData.heading),_t=new Float64Array(16),_e=new Float64Array(16);return mat4.invert(_t,this._projection_matrix),vec4.transformMat4(s,o,_t),s[2]=-1,s[3]=0,mat4.invert(_e,this._view_matrix),vec4.transformMat4(s,s,_e),vec4.normalize(s,s),vec4.transformMat4(g,g,this._transformation_matrix),s[2]!==0&&(_=-g[2]/s[2]),vec4.scale(s,s,_),[d[0]+(s[0]+$),d[1]+(s[1]+j)]}},{key:"_worldToClipCoords",value:function(o){var s=[o[0],o[1],o[2],1];return vec4.transformMat4(s,s,this._view_matrix),vec4.transformMat4(s,s,this._projection_matrix),vec4.scale(s,s,1/s[3]),s}},{key:"setupProgram",value:function(o){o.uniform("Matrix4fv","u_projection",this._projection_matrix),o.uniform("3f","u_eye",[0,0,this._lookAtData.distance]),o.uniform("2fv","u_center_offset",this._center_offset_normalized),o.uniform("1f","u_tilt",this._lookAtData.tilt*PI_OVER_180),o.uniform("1f","u_heading",this._lookAtData.heading*PI_OVER_180),o.uniform("1f","u_near_plane",NEAR_PLANE),o.uniform("1f","u_depth_buffer_adjustment",this._depth_buffer_adjustment)}},{key:"getTransformationMatrix",value:function(){return this._transformation_matrix}},{key:"getCameraMatrix",value:function(){return this._camera_matrix}},{key:"clone",value:function(){var o=new e(this._viewport,this._lookAtData);return o.setZoomConstraints(this._min_zoom,this._max_zoom),o}},{key:"getViewport",value:function(){return this._viewport}}])}();function getX(e){return e.x===void 0?e[0]:e.x}function getY(e){return e.y===void 0?e[1]:e.y}function xAscendingComparator(e,o){return getX(e)-getX(o)}function yAscendingComparator(e,o){return getY(e)-getY(o)}function sortByX(e){return e.sort(xAscendingComparator)}function sortByY(e){return e.sort(yAscendingComparator)}function getMinMax(e,o){for(var s,h=e[0],d=h,g=0;g<e.length;g+=1)o(s=e[g],h)<0?h=s:o(s,d)>0&&(d=s);return[h,d]}function groupByCoord(e,o){return Object.values(o.reduce(function(s,h){var d=h[+e];return s[d]||(s[d]=[]),s[d].push(h),s},{}))}function groupByX(e){return groupByCoord(!1,e)}function groupByY(e){return groupByCoord(!0,e)}function createTileRangeByCoord(e,o,s){var h=+e,d=o[h],g=s[h];if(d>g)return[];var _=[o];if(d>g)return _;for(var j=o[(h+1)%2],$=e?function(_e){return _.push([j,_e])}:function(_e){return _.push([_e,j])},_t=d+1;_t<g;_t+=1)$(_t);return _.push(s),_}function createTileRangeByX(e,o){return createTileRangeByCoord(!1,e,o)}function createTileRangeByY(e,o){return createTileRangeByCoord(!0,e,o)}function deduplicate(e){var o={},s=[];return e.forEach(function(h){var d=h.key||(Array.isArray(h)?"".concat(h[0],"/").concat(h[1]):"".concat(h.x,"/").concat(h.y));o[d]||(o[d]=!0,s.push(h))}),s}function flat(e){return e.reduce(function(o,s){return o.concat(s)})}function applyMargin(e,o){if(o<=0)return e;var s=function(d){var g=_slicedToArray(getMinMax(d,xAscendingComparator),2),_=g[0],j=g[1],$=[_[0]-o,_[1]],_t=[j[0]+o,j[1]];return d.concat(createTileRangeByX($,_),createTileRangeByX(j,_t))},h=function(d){var g=_slicedToArray(getMinMax(d,yAscendingComparator),2),_=g[0],j=g[1],$=[_[0],_[1]-o],_t=[j[0],j[1]+o];return d.concat(createTileRangeByY($,_),createTileRangeByY(j,_t))};return deduplicate(function(d){return flat(d.map(s))}(groupByY(flat(groupByX(e).map(h)))))}function constructTiles(e,o,s){return e.map(function(h){var d=_slicedToArray(h,2),g=d[0],_=d[1];return Tile.coord(Geo$1.wrapTile({x:g,y:_,z:o},{x:!s,y:!0}))})}function getTileGrid(e,o,s){var h=function(d){return Object.values(Geo$1.metersToExactTileCoords(d,e.tile_level))};return deduplicate(constructTiles(applyMargin(rasterizeTetragon(h(e.tetragon[0]),h(e.tetragon[1]),h(e.tetragon[3]),h(e.tetragon[2])),o),e.tile_level,s))}function rasterizeTetragon(e,o,s,h){var d=rasterizeTriangle(o,e,s),g=rasterizeTriangle(s,h,o);return deduplicate(d.concat(g))}function rasterizeTriangle(e,o,s){var h=_slicedToArray(sliceTriangle.apply(void 0,_toConsumableArray(sortByY([e,o,s]))),2),d=h[0],g=h[1];return deduplicate(rasterizeBottomFlatTriangle.apply(void 0,_toConsumableArray(d)).concat(rasterizeTopFlatTriangle.apply(void 0,_toConsumableArray(g))))}function sliceTriangle(e,o,s){var h=_slicedToArray(e,2),d=h[0],g=h[1],_=_slicedToArray(o,2),j=_[0],$=_[1],_t=_slicedToArray(s,2),_e=_t[0],_r=_t[1],_i=d+($-g)/(_r-g)*(_e-d);return[[[d,g]].concat(_toConsumableArray(sortByX([[j,$],[_i,$]]))),[].concat(_toConsumableArray(sortByX([[j,$],[_i,$]])),[[_e,_r]])]}function rasterizeBottomFlatTriangle(e,o,s){var h=_slicedToArray(e,2),d=h[0],g=h[1],_=_slicedToArray(o,2),j=_[0],$=_[1];return scanFlatTriangle(d,j,_slicedToArray(s,1)[0],g,$)}function rasterizeTopFlatTriangle(e,o,s){var h=_slicedToArray(e,2),d=h[0],g=h[1],_=_slicedToArray(o,1)[0],j=_slicedToArray(s,2);return scanFlatTriangle(j[0],d,_,j[1],g)}var scanStepStatic=.125;function getScanStep(e,o){return scanStepStatic*(o-e)/(Math.ceil(o)-Math.floor(e))}function scanFlatTriangle(e,o,s,h,d){var g=Math.min(e,o),_=Math.max(e,s),j=Math.min(h,d),$=Math.max(h,d);if(Math.floor(h)===Math.floor(d))return scanRow(g,_,h);if($-j<scanStepStatic)return scanRectangle([g,j],[_,$]);var _t=getScanStep(j,$),_e=($-j)/_t,_r=(o-e)/_e,_i=(s-e)/_e,_n=[],_s=e,_l=e,Ap=function(ty){_n=_n.concat(scanRow(_s,_l,Math.floor(ty))),_s+=_r,_l+=_i};if(h<d)for(var _h=j;_h<=$;_h+=_t)Ap(_h);else for(var _p=$;_p>=j;_p-=_t)Ap(_p);return deduplicate(_n)}function xCoordsToPoints(e,o){return e.map(function(s){return[s,o]})}function createCoordRange(e,o){var s=Math.floor(e),h=Math.floor(o);if(s>h)return[];if(s===h)return[s];for(var d=[],g=s;g<=h;g+=1)d.push(g);return d}function scanRow(e,o,s){return xCoordsToPoints(createCoordRange(e,o),s)}function scanRectangle(e,o){var s=_slicedToArray(e,2),h=s[0],d=s[1],g=_slicedToArray(o,2),_=g[0],j=g[1],$=createCoordRange(h,_),_t=xCoordsToPoints($,d),_e=xCoordsToPoints($,j);return _t.concat(_e)}var VIEW_PAN_SNAP_TIME=.5,Z_PRECISION=1e5,View=function(){function e(o,s){_classCallCheck(this,e),subscribeMixin(this),this.scene=o,this.createMatrices(),this.bounds=null,this.center_tile=null,this.panning=!1,this.panning_stop_at=0,this.pan_snap_timer=0,this.user_input_at=0,this.user_input_timeout=50,this.user_input_active=!1,this.size={},this.buffer=0,this.wrap=s.wrapView!==!1,this.preserve_tiles_within_zoom=1,this.lookAtManipulator=new LookAtManipulator(s.viewport),this._viewport=s.viewport,this._offset_buffer=[0,0],this.handleViewportUpdate(!0)}return _createClass(e,[{key:"update",value:function(){this.pan_snap_timer=(+new Date-this.panning_stop_at)/1e3,this.user_input_active=+new Date-this.user_input_at<this.user_input_timeout,this.scene.tile_manager.updateTilesVisibilityCounters()}},{key:"handleViewportUpdate",value:function(){var o=arguments.length>0&&arguments[0]!==void 0&&arguments[0],s=this._viewport,h=s.width,d=s.height;this.size.css={width:h,height:d},this.size.device={width:Math.round(h*Utils$1.device_pixel_ratio),height:Math.round(d*Utils$1.device_pixel_ratio)},this.lookAtManipulator.handleViewportUpdate(),o||this.updateBounds()}},{key:"setLookAtData",value:function(o,s){e._setLookAtDataForManipulator(this.lookAtManipulator,o,s),this.updateBounds()}},{key:"getLookAtData",value:function(){var o=arguments.length>0&&arguments[0]!==void 0&&arguments[0];return e._getLookAtDataFromManipulator(this.lookAtManipulator,o)}},{key:"getBestLookAtData",value:function(o,s){var h=arguments.length>2&&arguments[2]!==void 0&&arguments[2],d=this.lookAtManipulator.clone();return e._setLookAtDataForManipulator(d,o,s),e._getLookAtDataFromManipulator(d,h)}},{key:"getTileLevel",value:function(){return this.lookAtManipulator.getLookAtData().tile_level}},{key:"applyPxOffset",value:function(o){var s=this._offset_buffer;s[0]+=o[0],s[1]+=o[1];var h=Math.abs(s[0]),d=Math.abs(s[1]);if(h>=1||d>=1){var g=~~s[0],_=~~s[1];this.lookAtManipulator.applyPxOffset([h<1?0:g,d<1?0:_]),h>=1&&(s[0]-=g),d>=1&&(s[1]-=_),this.updateBounds()}}},{key:"setPanning",value:function(o){this.panning=o,this.panning||(this.panning_stop_at=+new Date)}},{key:"markUserInput",value:function(){this.user_input_at=+new Date}},{key:"ready",value:function(){return typeof this.size.css.width=="number"&&typeof this.size.css.height=="number"}},{key:"updateBounds",value:function(){if(this.markUserInput(),this.ready()){this.center_tile=Geo$1.tileForMeters(this.lookAtManipulator.getLookAtData().position,this.lookAtManipulator.getLookAtData().tile_level);var o=this.lookAtManipulator.screenToWorld([0,this.size.css.height]),s=this.lookAtManipulator.screenToWorld([this.size.css.width,0]);this.bounds={sw:{x:o[0],y:o[1]},ne:{x:s[0],y:s[1]}},this.scene.tile_manager.updateTilesForView(!0),this.trigger("move"),this.scene.requestRedraw()}}},{key:"getTileGridFlatForBBox",value:function(o,s,h,d){var g=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0,_=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5],j=this.lookAtManipulator.getLookAtData().tile_level,$=Geo$1.tileForMeters([s,o],j),_t=Geo$1.tileForMeters([d,h],j);if($.x-=g,$.y-=g,_t.x+=g,_t.y+=g,_===!1){var _e=(1<<j)-1;$.x=Math.min(Math.max(0,$.x),_e),$.y=Math.min(Math.max(0,$.y),_e),_t.x=Math.min(Math.max(0,_t.x),_e),_t.y=Math.min(Math.max(0,_t.y),_e)}for(var _r=[],_i={},_n=$.x;_n<=_t.x;_n++)for(var _s=$.y;_s<=_t.y;_s++){var _l=Tile.coord(Geo$1.wrapTile({x:_n,y:_s,z:j},{x:!_,y:!0}));_i[_l.key]||(_i[_l.key]=!0,_r.push(_l))}return _r}},{key:"getTileGridFlat",value:function(){return this.getTileGridFlatForBBox(this.bounds.ne.y,this.bounds.sw.x,this.bounds.sw.y,this.bounds.ne.x,this.buffer,this.wrap)}},{key:"getTileGridDistorted",value:function(){return getTileGrid(this.lookAtManipulator.getLookAtData(),this.buffer,this.wrap)}},{key:"findVisibleTileCoordinates",value:function(){if(!this.bounds)return[];var o=this.lookAtManipulator.getLookAtData(),s=o.tilt,h=o.heading;return s===0&&h===180?this.getTileGridFlat():this.getTileGridDistorted()}},{key:"createMatrices",value:function(){this.matrices={},this.matrices.model=new Float64Array(16),this.matrices.model32=new Float32Array(16),this.matrices.model_view=new Float64Array(16),this.matrices.model_view32=new Float32Array(16),this.matrices.normal=new Float64Array(9),this.matrices.normal32=new Float32Array(9),this.matrices.inverse_normal32=new Float32Array(9)}},{key:"setupTile",value:function(o,s){o.setupProgram(this.matrices,s),this.lookAtManipulator.setupMatrices(this.matrices,s)}},{key:"setupProgram",value:function(o){var s=this.lookAtManipulator.getLookAtData();o.uniform("2fv","u_resolution",[this.size.device.width,this.size.device.height]),o.uniform("3fv","u_map_position",[s.position[0],s.position[1],Math.trunc(s.zoom*Z_PRECISION)/Z_PRECISION]),o.uniform("1f","u_meters_per_pixel",Geo$1.metersPerPixel(s.zoom)),o.uniform("1f","u_device_pixel_ratio",Utils$1.device_pixel_ratio),o.uniform("1f","u_view_pan_snap_timer",this.pan_snap_timer),o.uniform("1i","u_view_panning",this.panning),o.uniform("1f","u_horizon",this.lookAtManipulator.getHorizon()/(this.size.css.height/2)),this.lookAtManipulator.setupProgram(o)}},{key:"isAnimating",value:function(){return this.pan_snap_timer<=VIEW_PAN_SNAP_TIME}},{key:"xyToGeo",value:function(o,s){var h=this.lookAtManipulator.screenToWorld([o,s]),d=_slicedToArray(Geo$1.metersToLatLng(h),2),g=d[0];return{lat:d[1],lng:g}}},{key:"geoToPixel",value:function(o){var s=Geo$1.latLngToMeters([o.lng,o.lat]);s.push(o.alt||0);var h=this.lookAtManipulator.worldToScreen(s);return{x:Math.floor(h[0]),y:Math.floor(h[1])}}},{key:"geoToMeters",value:function(o){var s=_slicedToArray(Geo$1.latLngToMeters([o.lng,o.lat]),2);return{x:s[0],y:s[1],z:o.alt||0}}},{key:"metersToGeo",value:function(o){var s=_slicedToArray(Geo$1.metersToLatLng([o.x,o.y]),2),h=s[0];return{lat:s[1],lng:h,alt:o.z||0}}},{key:"setZoomConstraints",value:function(o,s){this.lookAtManipulator.setZoomConstraints(o,s)}}],[{key:"_setLookAtDataForManipulator",value:function(o,s,h){var d=s.position,g=s.zoom,_=s.tilt,j=s.heading,$=s.bounds,_t={zoom:g,tilt:_,heading:j};if(d&&typeof d.lng=="number"&&typeof d.lat=="number"&&(_t.position=Geo$1.latLngToMeters([d.lng,d.lat])),$){var _e=$.getExterior().getLatLngAltArray(),_r=_e.length/3,_i=Array(_r);if($.getBoundingBox().isCDB())for(var _n=_e[1],_s=0,_l=0;_l<_r;_l++){var Ap=_e[3*_l+1];if(_l>0){var _h=Ap-_n;Math.abs(_h)>180&&(_s+=Ap>_n?-360:360)}_n=Ap,_i[_l]=Geo$1.latLngToMeters([Ap+_s,_e[3*_l]])}else for(var _p=0;_p<_r;_p++)_i[_p]=Geo$1.latLngToMeters([_e[3*_p+1],_e[3*_p]]);_t.bounds=_i}o.setLookAtData(_t,h)}},{key:"_getLookAtDataFromManipulator",value:function(o){var s=arguments.length>1&&arguments[1]!==void 0&&arguments[1],h=o.getLookAtData(),d=h.heading,g=h.incline,_=h.tilt,j=h.zoom,$=h.position,_t=h.bounds,_e=h.unpadded_bounds,_r=_slicedToArray(Geo$1.metersToLatLng($),2),_i=_r[0],_n=_r[1],_s=new H.geo.LineString;return(s?_e:_t).forEach(function(_l){var Ap=Geo$1.metersToLatLng(_l);_s.pushLatLngAlt(Ap[1],Ap[0],0)}),{heading:d,incline:g,tilt:_,zoom:j,bounds:new H.geo.Polygon(_s),position:{lat:_n,lng:_i,alt:$[2]}}}}])}(),shaderSrc_pointsVertex=`uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_tile_proxy_depth;uniform bool u_tile_fade_in;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform bool u_view_panning;uniform float u_tilt;uniform mat4 u_model;uniform mat4 u_modelView;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform float u_heading;uniform float u_near_plane;uniform float u_depth_buffer_adjustment;attribute vec4 a_position;attribute vec4 a_shape;attribute vec4 a_color;attribute vec2 a_texcoord;attribute vec2 a_offset;uniform float u_point_type;attribute float a_is_flat;
#ifdef TANGRAM_IS_TEXT_STYLE
attribute vec4 a_offsets_alt;attribute vec4 a_pre_angles_alt;attribute vec4 a_angles_alt;attribute vec4 a_offsets;attribute vec4 a_pre_angles;attribute vec4 a_angles;
#endif
#ifdef TANGRAM_POINT_DRAW_STICK
attribute float a_is_stick;attribute float a_stick_height;varying float v_is_stick;
#endif
varying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;
#ifdef TANGRAM_HAS_SHADER_POINTS
attribute float a_outline_edge;attribute vec4 a_outline_color;varying float v_outline_edge;varying vec4 v_outline_color;varying float v_aa_offset;
#endif
#ifdef TANGRAM_SHOW_HIDDEN_LABELS
varying float v_label_hidden;
#endif
#define PI 3.14159265359
#define TANGRAM_NORMAL vec3(0., 0., 1.)
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: raster
#pragma tangram: global
vec2 rotate2D(vec2 _st,float _angle){return mat2(cos(_angle),-sin(_angle),sin(_angle),cos(_angle))*_st;}vec3 rotateX3D(vec3 _st,float _angle){return mat3(1.,0.,0.,0.,cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle))*_st;}vec3 rotateZ3D(vec3 _st,float _angle){return mat3(cos(_angle),sin(_angle),0.,-sin(_angle),cos(_angle),0.,0.,0.,1.)*_st;}
#ifdef TANGRAM_IS_TEXT_STYLE
float mix4linear(float a,float b,float c,float d,float x){return mix(mix(a,b,3.*x),mix(b,mix(c,d,3.*(max(x,.66)-.66)),3.*(clamp(x,.33,.66)-.33)),step(0.33,x));}
#endif
void main(){
#pragma tangram: setup
#ifndef TANGRAM_SHOW_HIDDEN_LABELS
if(a_shape.w==0.){gl_Position=vec4(0.,0.,0.,1.);return;}
#else
if(a_shape.w==0.){v_label_hidden=1.;}else{v_label_hidden=0.;}
#endif
v_alpha_factor=1.0;v_color=a_color;v_texcoord=a_texcoord;
#ifdef TANGRAM_HAS_SHADER_POINTS
v_outline_color=a_outline_color;v_outline_edge=a_outline_edge;if(u_point_type==TANGRAM_POINT_TYPE_SHADER){v_outline_color=a_outline_color;v_outline_edge=a_outline_edge;float size=abs(a_shape.x/128.);v_texcoord=sign(a_shape.xy)*(size+1.0)/size;size+=2.0;v_aa_offset=2.0/size;}
#endif
vec4 position=u_modelView*vec4(a_position.xyz,1.);vec4 shape=vec4(a_shape.xy,0.,0.);vec2 offset=vec2(a_offset.x,-a_offset.y);
#ifdef TANGRAM_POINT_DRAW_STICK
v_is_stick=a_is_stick;float scaled_stick_height=(sin(u_tilt+(1.5*PI))+1.0)*a_stick_height;offset.y+=(1.0-a_is_stick)*scaled_stick_height;
#endif
float zoom=clamp(u_map_position.z-u_tile_origin.z,0.,1.);float theta=a_shape.z/4096.;float heading=u_heading;float delta=(heading-PI);float new_theta=theta-delta;float reversed=abs(new_theta)>PI/2. ? 1. : 0.;if(a_is_flat==1.0){
#ifdef TANGRAM_IS_TEXT_STYLE
if(a_offsets[0]!=0.){vec4 angles_scaled;vec4 pre_angles_scaled;vec4 offsets_scaled;if(reversed==1.){offsets_scaled=a_offsets_alt*4.;angles_scaled=(PI/16384.)*a_angles_alt;pre_angles_scaled=(PI/128.)*a_pre_angles_alt;}else{offsets_scaled=a_offsets*4.;angles_scaled=(PI/16384.)*a_angles;pre_angles_scaled=(PI/128.)*a_pre_angles;}float pre_angle=mix4linear(pre_angles_scaled[0],pre_angles_scaled[1],pre_angles_scaled[2],pre_angles_scaled[3],zoom);float angle=mix4linear(angles_scaled[0],angles_scaled[1],angles_scaled[2],angles_scaled[3],zoom);float offset_curve=mix4linear(offsets_scaled[0],offsets_scaled[1],offsets_scaled[2],offsets_scaled[3],zoom);shape.xy=rotate2D(shape.xy,pre_angle+PI*reversed);shape.x+=offset_curve;shape.xy=rotate2D(shape.xy,angle);shape.xy+=rotate2D(offset,theta);}else{shape.xy=rotate2D(shape.xy+offset*256.,theta+(PI*reversed));}
#else
shape.xy=rotate2D(shape.xy+offset*256.,theta);
#endif
shape.xy/=pow(2.,4.+(u_map_position.z-u_tile_origin.w));shape=u_modelView*shape;position+=shape;}else{shape.xy/=256.;
#ifdef TANGRAM_POINT_DRAW_STICK
shape.y*=1.0+(scaled_stick_height-1.0)*a_is_stick;
#endif
shape.xy=rotate2D(shape.xy+offset,theta);}
#ifdef TANGRAM_FADE_IN_RATE
if(u_tile_fade_in){v_alpha_factor*=clamp(u_visible_time*TANGRAM_FADE_IN_RATE,0.,1.);}
#endif
#ifdef TANGRAM_FADE_ON_ZOOM_OUT
v_alpha_factor*=clamp(1.+TANGRAM_FADE_ON_ZOOM_OUT_RATE*(u_map_position.z-u_tile_origin.z),0.,1.);
#endif
v_world_position=u_model*position;v_world_position.xy+=shape.xy*u_meters_per_pixel;v_world_position=wrapWorldPosition(v_world_position);
#pragma tangram: position
cameraProjection(position);
#ifdef TANGRAM_LAYER_ORDER
applyLayerOrder(a_position.w+u_tile_proxy_depth+1.,position);/***Due to the precision loss on depth buffer,we had a z-fighting of translucent points when the distance to the camera was big.*For more information about the problem see: https:*For more information about the fix see: https:*position.z=(2.0*log(position.w/u_near_plane)/log(u_far_plane/u_near_plane)-1.0)*position.w;*/position.z=(log(position.w/u_near_plane)*u_depth_buffer_adjustment-1.0)*position.w;
#endif
if(a_is_flat!=1.){position.xy+=shape.xy*position.w*2.*u_device_pixel_ratio/u_resolution;}
#ifdef TANGRAM_HAS_SHADER_POINTS
if(u_point_type==TANGRAM_POINT_TYPE_SHADER){position.xy+=sign(shape.xy)*position.w*u_device_pixel_ratio/u_resolution;}
#endif
if(!u_view_panning){snapToPixelGrid(position);}gl_Position=position;}`,shaderSrc_pointsFragment=`uniform vec2 u_resolution;uniform vec3 u_map_position;uniform vec4 u_tile_origin;uniform float u_meters_per_pixel;uniform float u_device_pixel_ratio;uniform float u_visible_time;uniform mat3 u_normalMatrix;uniform mat3 u_inverseNormalMatrix;uniform sampler2D u_texture;uniform float u_point_type;uniform bool u_apply_color_blocks;varying vec4 v_color;varying vec2 v_texcoord;varying vec4 v_world_position;varying float v_alpha_factor;
#ifdef TANGRAM_HAS_SHADER_POINTS
varying vec4 v_outline_color;varying float v_outline_edge;varying float v_aa_offset;
#endif
#ifdef TANGRAM_SHOW_HIDDEN_LABELS
varying float v_label_hidden;
#endif
#ifdef TANGRAM_POINT_DRAW_STICK
varying float v_is_stick;
#endif
#define TANGRAM_NORMAL vec3(0., 0., 1.)
#pragma tangram: camera
#pragma tangram: material
#pragma tangram: lighting
#pragma tangram: raster
#pragma tangram: global
#ifdef TANGRAM_HAS_SHADER_POINTS
float _tangram_antialias(float l,float R){float low=R-v_aa_offset;float high=R+v_aa_offset;return 1.-smoothstep(low,high,l);}
#endif
void mixTextureColor(inout vec4 color){
#ifdef TANGRAM_HAS_SHADER_POINTS
if(u_point_type==TANGRAM_POINT_TYPE_TEXTURE){color*=texture2D(u_texture,v_texcoord);}else if(u_point_type==TANGRAM_POINT_TYPE_LABEL){color=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);}else if(u_point_type==TANGRAM_POINT_TYPE_SHADER){float outline_edge=v_outline_edge;vec4 outlineColor=v_outline_color;float l=length(v_texcoord);float outer_alpha=_tangram_antialias(l,1.);float fill_alpha=_tangram_antialias(l,1.-v_outline_edge*0.5)*color.a;float stroke_alpha=(outer_alpha-_tangram_antialias(l,1.-v_outline_edge))*outlineColor.a;
#ifdef TANGRAM_BLEND_ADD
color.a=stroke_alpha+fill_alpha;color.rgb=color.rgb*fill_alpha+outlineColor.rgb*stroke_alpha;
#else
color.a=stroke_alpha+fill_alpha*(1.-stroke_alpha);color.rgb=mix(color.rgb*fill_alpha,outlineColor.rgb,stroke_alpha)/max(color.a,0.001);
#endif
}
#else
color=texture2D(u_texture,v_texcoord);color.rgb/=max(color.a,0.001);
#endif
if(u_apply_color_blocks){
#pragma tangram: color
#pragma tangram: filter
}color.a*=v_alpha_factor;
#ifdef TANGRAM_SHOW_HIDDEN_LABELS
if(v_label_hidden>0.){color.a*=0.5;color.rgb=vec3(1.,0.,0.);}
#endif
#if !defined(TANGRAM_BLEND_OVERLAY) && !defined(TANGRAM_BLEND_INLAY) && !defined(TANGRAM_BLEND_ADD)
if(color.a<TANGRAM_ALPHA_TEST){discard;}
#endif
}void main(void){
#pragma tangram: setup
vec4 color=v_color;
#ifdef TANGRAM_POINT_DRAW_STICK
if(v_is_stick==0.0){mixTextureColor(color);}
#else
mixTextureColor(color);
#endif
gl_FragColor=color;}`,PLACEMENT=LabelPoint.PLACEMENT,pre_angles_normalize=128/Math.PI,angles_normalize=16384/Math.PI,offsets_normalize=64,texcoord_normalize=65535,Points=Object.create(Style),TANGRAM_POINT_TYPE_TEXTURE=1,TANGRAM_POINT_TYPE_LABEL=2,TANGRAM_POINT_TYPE_SHADER=3,DEFAULT_POINT_SIZE=16;Object.assign(Points,TextLabels),Object.assign(Points,{name:"points",built_in:!0,vertex_shader_src:shaderSrc_pointsVertex,fragment_shader_src:shaderSrc_pointsFragment,selection:!0,collision:!0,blend:"overlay",init:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Style.init.call(this,e),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!0,this.defines.TANGRAM_POINT_TYPE_TEXTURE=TANGRAM_POINT_TYPE_TEXTURE,this.defines.TANGRAM_POINT_TYPE_LABEL=TANGRAM_POINT_TYPE_LABEL,this.defines.TANGRAM_POINT_TYPE_SHADER=TANGRAM_POINT_TYPE_SHADER,this.defines.TANGRAM_POINT_DRAW_STICK=!!this.stick,this.collision_group_points=this.name+"-points",this.collision_group_text=this.name+"-text",this.reset()},setupDefines:function(){this.blend!=="overlay"&&(this.defines.TANGRAM_LAYER_ORDER=!0),this.defines.TANGRAM_FADE_ON_ZOOM_OUT=!0,this.defines.TANGRAM_FADE_ON_ZOOM_OUT_RATE=2,debugSettings$1.suppress_label_fade_in||this.suppress_fade?(this.fade_in_time=0,this.defines.TANGRAM_FADE_IN_RATE=null):(this.fade_in_time=.15,this.defines.TANGRAM_FADE_IN_RATE=1/this.fade_in_time),debugSettings$1.suppress_snap_animation||(this.defines.TANGRAM_VIEW_PAN_SNAP_RATE=1/VIEW_PAN_SNAP_TIME),debugSettings$1.show_hidden_labels&&(this.defines.TANGRAM_SHOW_HIDDEN_LABELS=!0)},reset:function(){this.queues={},this.resetText(),this.texture_missing_sprites={}},addFeature:function(e,o,s){var h=s.tile,d={};if(d.color=this.parseColor(o.color,s),d.texture=o.texture,d.label_texture=null,d.color||d.texture){var g;if(this.hasSprites(d)){if(!(g=this.parseSprite(d,o,s)))return;d.texcoords=g.texcoords}if(d.size=o.size,d.size){if(d.size=StyleParser.evalCachedPointSizeProperty(o.size,g,s),d.size==null)return void log({level:"warn",once:!0},"Layer '".concat(o.layers[o.layers.length-1],"': ")+"'size' includes % and/or ratio-based scaling (".concat(JSON.stringify(o.size.value),"); ")+"these can only applied to sprites, but no sprite was specified, skipping features in layer");typeof d.size=="number"&&(d.size=[d.size,d.size])}else d.size=g&&g.css_size||[DEFAULT_POINT_SIZE,DEFAULT_POINT_SIZE];if(o.outline&&(d.outline_width=StyleParser.evalCachedProperty(o.outline.width,s)||StyleParser.defaults.outline.width,d.outline_color=this.parseColor(o.outline.color,s)),d.outline_edge_pct=0,d.outline_width&&d.outline_color){var _=d.outline_width;d.size[0]+=_,d.size[1]+=_,d.outline_edge_pct=_/Math.min(d.size[0],d.size[1])*2}if(d.size[0]=Math.min(d.size[0],256),d.size[1]=Math.min(d.size[1],256),d.placement=o.placement,d.placement_min_length_ratio=StyleParser.evalCachedProperty(o.placement_min_length_ratio,s),d.placement===PLACEMENT.SPACED&&o.placement_spacing&&(d.placement_spacing=StyleParser.evalCachedProperty(o.placement_spacing,s)),d.angle=StyleParser.evalProperty(o.angle,s)||0,d.elevate_by_altitude=!!o.elevate_by_altitude,d.z=o.z?MathUtils$1.clamp(StyleParser.evalCachedDistanceProperty(o.z,s),0,32767):StyleParser.defaults.z,d.flat=o.flat,d.tile_edges=o.tile_edges,this.computeLayout(d,e,o,s,h),o.stick&&!d.flat){var j=StyleParser.parseNumber(StyleParser.evalProperty(o.stick.height,s));d.stick={color:this.parseColor(o.stick.color,s)||StyleParser.defaults.color,height:j?Math.max(j,0):0}}var $=o.text&&StyleParser.evalProperty(o.text.visible,s)!==!1&&this.parseTextFeature(e,o.text,s,h);Array.isArray($)&&($=null,log({level:"warn",once:!0},"Layer '".concat(o.layers[o.layers.length-1],"': ")+"cannot use boundary labels (e.g. 'text_source: { left: ..., right: ... }') for 'text' labels attached to 'points'; "+"provided 'text_source' value was ".concat(JSON.stringify(o.text.text_source)))),$&&($.layout.parent=d,$.layout.priority=o.text.priority?Math.max($.layout.priority,d.priority+.5):d.priority+.5,$.layout.move_into_tile=!1,Collision.addStyle(this.collision_group_text,h.id)),this.queueFeature({feature:e,draw:o,context:s,style:d,text_feature:$},h),Collision.addStyle(this.collision_group_points,h.id)}},hasSprites:function(e){return e.texture&&this.textureManager.textures[e.texture]&&this.textureManager.textures[e.texture].sprites},getSpriteInfo:function(e,o){var s=this.textureManager.textures[e.texture].sprites[o]&&this.textureManager.getSpriteInfo(e.texture,o);return o&&!s?(this.texture_missing_sprites[e.texture]=this.texture_missing_sprites[e.texture]||{},this.texture_missing_sprites[e.texture][o]||(log("debug","Style: in style '".concat(this.name,"', could not find sprite '").concat(o,"' for texture '").concat(e.texture,"'")),this.texture_missing_sprites[e.texture][o]=!0)):s&&(s.sprite=o),s},parseSprite:function(e,o,s){var h=StyleParser.evalProperty(o.sprite,s);return this.getSpriteInfo(e,h)||this.getSpriteInfo(e,o.sprite_default)},queueFeature:function(e,o){this.tile_data[o.id]&&this.queues[o.id]||this.startData(o),this.queues[o.id]=this.queues[o.id]||[],this.queues[o.id].push(e)},endData:function(e){var o=this;if(e.canceled)return log("trace","Style ".concat(this.name,": stop tile build because tile was canceled: ").concat(e.key)),Promise.resolve();var s=this.queues[e.id];delete this.queues[e.id];var h=[],d=[];return s.forEach(function(g){for(var _=g.style,j=g.feature,$=j.geometry,_t=o.buildLabels(_.size,$,_),_e=0;_e<_t.length;_e++){var _r=_t[_e],_i={feature:j,draw:g.draw,context:g.context,style:_,label:_r};if(d.push(_i),g.text_feature){var _n={feature:j,draw:g.text_feature.draw,context:g.context,text:g.text_feature.text,text_settings_key:g.text_feature.text_settings_key,layout:g.text_feature.layout,point_label:_r,linked:_i};h.push(_n),g.draw.text.optional||(_i.linked=_n)}}}),Promise.all([Collision.collide(d,this.collision_group_points,e.id).then(function(g){g.forEach(function(_){o.feature_style=_.style,o.feature_style.label=_.label,o.feature_style.linked=_.linked,Style.addFeature.call(o,_.feature,_.draw,_.context)})}),this.collideAndRenderTextLabels(e,this.collision_group_text,h)]).then(function(g){var _=_slicedToArray(g,2)[1],j=_.labels,$=_.texts;return j&&$&&j.forEach(function(_t){var _e=_t.text_settings_key,_r=$[_e]&&$[_e][_t.text],_i=o.feature_style;_i.label=_t.label,_i.linked=_t.linked,_i.size=_r.size.logical_size,_i.angle=0,_t.label.text_data={text_info:_r,text_settings_key:_e,text:_t.text},_i.label_texture=o.textureManager.default,Style.addFeature.call(o,_t.feature,_t.draw,_t.context)}),o.freeText(e),Style.endData.call(o,e)})},_preprocess:function(e){e.color=StyleParser.createColorPropertyCache(e.color),e.texture=e.texture!==void 0?e.texture:this.texture,e.outline&&(e.outline.color=StyleParser.createColorPropertyCache(e.outline.color),e.outline.width=StyleParser.createPropertyCache(e.outline.width,StyleParser.parsePositiveNumber)),e.z=StyleParser.createPropertyCache(e.z,StyleParser.parseUnits);try{e.size=StyleParser.createPointSizePropertyCache(e.size)}catch(o){return log({level:"warn",once:!0},"Layer '".concat(e.layers[e.layers.length-1],"': ")+"".concat(o," (").concat(JSON.stringify(e.size),"), skipping features in layer")),null}return e.offset=StyleParser.createPropertyCache(e.offset,function(o){return Array.isArray(o)&&o.map(StyleParser.parseNumber)}),e.buffer=StyleParser.createPropertyCache(e.buffer,function(o){return(Array.isArray(o)?o:[o,o]).map(StyleParser.parsePositiveNumber)}),e.repeat_distance=StyleParser.createPropertyCache(e.repeat_distance,StyleParser.parseNumber),e.repeat_group==null&&(e.repeat_group=e.layers.join("-")),e.placement=PLACEMENT[e.placement&&e.placement.toUpperCase()],e.placement==null&&(e.placement=PLACEMENT.VERTEX),e.placement_spacing=e.placement_spacing!=null?e.placement_spacing:80,e.placement_spacing=StyleParser.createPropertyCache(e.placement_spacing,StyleParser.parsePositiveNumber),e.placement_min_length_ratio=e.placement_min_length_ratio!=null?e.placement_min_length_ratio:1,e.placement_min_length_ratio=StyleParser.createPropertyCache(e.placement_min_length_ratio,StyleParser.parsePositiveNumber),typeof e.angle=="number"?e.angle=e.angle*Math.PI/180:e.angle=e.angle||0,e.text=this.preprocessText(e.text),e.text&&(e.text.variantKey=e.variantKey,e.text.group=e.group,e.text.layers=e.layers,e.text.order=e.order,e.text.repeat_group=e.text.repeat_group||e.repeat_group,e.text.anchor=e.text.anchor||this.default_anchor,e.text.optional=typeof e.text.optional=="boolean"&&e.text.optional,e.text.interactive=e.text.interactive||e.interactive),e.stick&&(e.stick.color=StyleParser.createColorPropertyCache(e.stick.color)),e},default_anchor:["bottom","top","right","left"],computeLayout:function(e,o,s,h,d){var g=e||{};g.id=o,g.units_per_pixel=d.units_per_pixel||1,g.collide=s.collide!==!1,g.anchor=s.anchor,g.offset=StyleParser.evalCachedProperty(s.offset,h)||StyleParser.zeroPair,g.buffer=StyleParser.evalCachedProperty(s.buffer,h)||StyleParser.zeroPair,g.repeat_distance=StyleParser.evalCachedProperty(s.repeat_distance,h),g.repeat_distance&&(g.repeat_distance*=g.units_per_pixel,g.repeat_scale=1,typeof s.repeat_group=="function"?g.repeat_group=s.repeat_group(h):g.repeat_group=s.repeat_group);var _=s.priority;return _!=null?typeof _=="function"&&(_=_(h)):_=4294967295,g.priority=_,g},buildTextLabels:function(e,o){for(var s=[],h=0;h<o.length;h++){var d=o[h],g=this.texts[e.id][d.text_settings_key][d.text].size.collision_size;d.label=new LabelPoint(d.point_label.position,g,d.point_label.isFlat(),d.layout),s.push(d)}return s},buildLabels:function(e,o,s){var h=!!s.flat,d=[];if(o.type==="Point")d.push(new LabelPoint(o.coordinates,e,h,s));else if(o.type==="MultiPoint")for(var g=o.coordinates,_=0;_<g.length;++_){var j=g[_];d.push(new LabelPoint(j,e,h,s))}else if(o.type==="LineString")for(var $=placePointsOnLine(o.coordinates,e,h,s),_t=0;_t<$.length;++_t)d.push($[_t]);else if(o.type==="MultiLineString")for(var _e=o.coordinates,_r=0;_r<_e.length;_r++)for(var _i=placePointsOnLine(_e[_r],e,h,s),_n=0;_n<_i.length;++_n)d.push(_i[_n]);else if(o.type==="Polygon")if(s.placement===PLACEMENT.CENTROID){var _s=Geo$1.centroid(o.coordinates);d.push(new LabelPoint(_s,e,h,s))}else for(var _l=o.coordinates,Ap=0;Ap<_l.length;Ap++)for(var _h=placePointsOnLine(_l[Ap],e,h,s),_p=0;_p<_h.length;++_p)d.push(_h[_p]);else if(o.type==="MultiPolygon")if(s.placement===PLACEMENT.CENTROID){var ty=Geo$1.multiCentroid(o.coordinates);d.push(new LabelPoint(ty,e,h,s))}else for(var ry=o.coordinates,ly=0;ly<ry.length;ly++)for(var uy=ry[ly],py=0;py<uy.length;py++)for(var fy=placePointsOnLine(uy[py],e,h,s),my=0;my<fy.length;++my)d.push(fy[my]);return d},makeVertexTemplate:function(e,o){var s=e.color||StyleParser.defaults.color,h=o.vertex_data.vertex_layout;if(this.fillVertexTemplate(h,"a_position",0,{size:2}),this.fillVertexTemplate(h,"a_position",e.z||0,{size:1,offset:2}),this.fillVertexTemplate(h,"a_position",this.scaleOrder(e.order),{size:1,offset:3}),this.fillVertexTemplate(h,"a_shape",0,{size:4}),this.fillVertexTemplate(h,"a_shape",e.label.layout.collide?0:1,{size:1,offset:3}),this.fillVertexTemplate(h,"a_texcoord",0,{size:2}),this.fillVertexTemplate(h,"a_offset",0,{size:2}),this.fillVertexTemplate(h,"a_color",Vector$1.mult(s,255),{size:4}),this.defines.TANGRAM_HAS_SHADER_POINTS&&o.variant.shader_point){var d=e.outline_color||StyleParser.defaults.outline.color;this.fillVertexTemplate(h,"a_outline_color",Vector$1.mult(d,255),{size:4}),this.fillVertexTemplate(h,"a_outline_edge",e.outline_edge_pct||StyleParser.defaults.outline.width,{size:1})}return this.selection&&this.fillVertexTemplate(h,"a_selection_color",Vector$1.mult(e.selection_color,255),{size:4}),this.fillVertexTemplate(h,"a_is_flat",0,{size:1}),this.defines.TANGRAM_POINT_DRAW_STICK&&e.stick&&(this.fillVertexTemplate(h,"a_is_stick",0,{size:1}),this.fillVertexTemplate(h,"a_stick_height",e.stick.height,{size:1})),this.vertex_template},buildQuad:function(e,o,s,h,d,g,_,j,$,_t,_e,_r,_i,_n,_s,_l,Ap,_h,_p){return o[0]<=0||o[1]<=0?0:buildQuadsForPoints(e,_s,_l,{quad:o,quad_normalize:256,offset:j,offsets:$,offsets_alt:_t,pre_angles:g,pre_angles_alt:_,angle:4096*s,angles:h,angles_alt:d,is_flat:_i,elevate_by_altitude:_n,build_stick_points:Ap,stick_color:Ap&&Vector$1.mult(_h,255),color:Vector$1.mult(_p||StyleParser.defaults.color,255),curve:_r,texcoord_scale:_e,texcoord_normalize,pre_angles_normalize,angles_normalize,offsets_normalize})},build:function(e,o,s){var h=e.label;return h.type==="curved"?this.buildCurvedLabel(h,e,o,s):this.buildStraightLabel(h,e,o,s)},buildStraightLabel:function(e,o,s,h){var d,g,_=this.makeVertexTemplate(o,s),j=e.angle||o.angle;e.type!=="point"?(d=o.size[e.type],g=default_uvs):(d=o.size,g=o.texcoords||default_uvs),s.uniforms=s.uniforms||{},o.label_texture?(s.uniforms.u_texture=o.label_texture,s.uniforms.u_point_type=TANGRAM_POINT_TYPE_LABEL,s.uniforms.u_apply_color_blocks=!1):o.texture?(s.uniforms.u_texture=o.texture,s.uniforms.u_point_type=TANGRAM_POINT_TYPE_TEXTURE,s.uniforms.u_apply_color_blocks=!0):(s.uniforms.u_texture=this.textureManager.default,s.uniforms.u_point_type=TANGRAM_POINT_TYPE_SHADER,s.uniforms.u_apply_color_blocks=!0);var $=e.offset,_t=this.defines.TANGRAM_POINT_DRAW_STICK&&!o.label_texture&&o.stick&&o.stick.height>0,_e=this.buildQuad([e.position],d,j,null,null,null,null,$,null,null,g,!1,e.isFlat(),o.elevate_by_altitude,s.vertex_data,_,_t,_t&&o.stick.color,o.color),_r=o.linked&&o.linked.label.id;return this.trackLabel(e,_r,s,_e,h,_t),_e},buildCurvedLabel:function(e,o,s,h){for(var d=this.makeVertexTemplate(o,s),g=e.angle,_=0,j=!1,$=0;$<2;$++)for(var _t=0;_t<e.num_segments;_t++){var _e=o.size[e.type][_t],_r=default_uvs,_i=this.getTileMesh(h.tile,this.getMeshVariantTypeForDraw(o));_i.uniforms=_i.uniforms||{},_i.uniforms.u_texture=o.label_texture,_i.uniforms.u_point_type=TANGRAM_POINT_TYPE_LABEL,_i.uniforms.u_apply_color_blocks=!1;var _n=e.offset||[0,0],_s=e.position,_l=e.angles[_t],Ap=e.offsets[_t],_h=e.pre_angles[_t],_p=e.num_segments-_t-1,ty=e.alt_angles[_p],ry=e.alt_pre_angles[_p],ly=e.alt_offsets[_p],uy=this.buildQuad([_s],_e,g,_l,ty,_h,ry,_n,Ap,ly,_r,!0,e.isFlat(),o.elevate_by_altitude,_i.vertex_data,d,j,j,o.color);_+=uy;var py=o.linked&&o.linked.label.id;this.trackLabel(e,py,s,uy,h,j)}return _},trackLabel:function(e,o,s,h,d){var g=arguments.length>5&&arguments[5]!==void 0&&arguments[5];s.labels=s.labels||{},s.labels.collision=s.labels.collision||{},s.labels["non-collision"]=s.labels["non-collision"]||{};var _=e.layout.collide?s.labels.collision:s.labels["non-collision"];_[e.id]=_[e.id]||{container:{label:e.text_data?Object.assign(e.toJSON(),{text_data:e.text_data}):e.toJSON(),linked:o},ranges:[]};var j=2*h,$=s.vertex_data.offset-s.vertex_data.stride*j;_[e.id].ranges.push([$,j,g])},buildLines:function(e,o,s,h){return this.build(o,s,h)},buildPoints:function(e,o,s,h){return this.build(o,s,h)},buildPolygons:function(e,o,s,h){return this.build(o,s,h)},vertexLayoutForMeshVariant:function(e){if(!this.vertex_layout){var o=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_shape",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_outline_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0,static:[0,0,0,0]},{name:"a_outline_edge",size:1,type:gl$1.FLOAT,normalized:!1,static:0},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:gl$1.UNSIGNED_BYTE,normalized:!0}];this.defines&&this.defines.TANGRAM_POINT_DRAW_STICK&&o.push({name:"a_is_stick",size:1,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_stick_height",size:1,type:gl$1.FLOAT,normalized:!1}),this.vertex_layout=new VertexLayout(o),(o=o.map(function(s){return Object.assign({},s)})).forEach(function(s){s.name!=="a_outline_color"&&s.name!=="a_outline_edge"||(s.static=null)}),this.vertex_layout_shader_point=new VertexLayout(o)}return e.shader_point?this.vertex_layout_shader_point:this.vertex_layout},computeVariantForDraw:function(e){var o=e.label_texture||e.texture||this.default_mesh_variant.key;return{key:o,shader_point:o===this.default_mesh_variant.key,order:e.label_texture?1:0}},makeMesh:function(e,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return s=Object.assign({},s,{fade_in_time:this.fade_in_time}),Style.makeMesh.call(this,e,o,s)}});var STOPS=[0,.33,.66,.99],LINE_EXCEED_STRAIGHT=1.5,LINE_EXCEED_STRAIGHT_NO_CURVE=1.8,LINE_EXCEED_STAIGHT_LOOSE=2.3,STRAIGHT_ANGLE_TOLERANCE=.1,CURVE_MIN_TOTAL_COST=1.3,CURVE_MIN_AVG_COST=.4,CURVE_MAX_ANGLE=1,ORIENTED_LABEL_OFFSET_FACTOR=1.2,VERTICAL_ANGLE_TOLERANCE=.01,LabelLine={create:function(e,o,s,h,d){for(var g=[{type:"straight",tolerance:d.no_curving?LINE_EXCEED_STRAIGHT_NO_CURVE:LINE_EXCEED_STRAIGHT},{type:"curved"},{type:"straight",tolerance:LINE_EXCEED_STAIGHT_LOOSE}],_=0;_<g.length;_++){var j=g[_],$=void 0;if(j.type==="straight"?$=new LabelLineStraight(o,s,h,d,j.tolerance):j.type==="curved"&&!d.no_curving&&s.length>2&&($=new LabelLineCurved(e,s,h,d)),$&&!$.throw_away)return $}return!1}},LabelLineBase=function(){return _createClass(function e(o,s){_classCallCheck(this,e),this.id=Label.nextLabelId(),this.layout=s,this.position=[],this.angle=0,this.offset=s.offset.slice(),this.unit_scale=this.layout.units_per_pixel,this.type="",this.throw_away=!1,this._is_flat=o,this._circles=void 0,this.placed=null},[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,size:this.size,offset:this.offset,angle:this.angle,breach:this.breach,layout:textLayoutToJSON(this.layout),circles:this.getBoundingCircles()}}},{key:"inTileBounds",value:function(){var e=this.getAABB(),o=e.left,s=e.top,h=e.right,d=e.bottom;return Utils$1.pointInTile([o,s])&&Utils$1.pointInTile([h,d])}},{key:"getAABBForSegment",value:function(e,o,s,h){var d=this.unit_scale,g=o/2,_=s/2,j=_slicedToArray(e,2),$=j[0],_t=j[1];if(this.offset[0]!==0||this.offset[1]!==0){var _e=Vector$1.rot(this.offset,this.angle);$+=_e[0]*d,_t-=_e[1]*d}var _r=[[Math.cos(h),-Math.sin(h)],[Math.sin(h),Math.cos(h)]],_i=Vector$1.multMatrix(_r,[-g,-_]),_n=Vector$1.multMatrix(_r,[g,-_]),_s=Vector$1.multMatrix(_r,[g,_]),_l=Vector$1.multMatrix(_r,[-g,_]);return{left:$+Math.min(_i[0],_n[0],_s[0],_l[0]),top:_t+Math.max(_i[1],_n[1],_s[1],_l[1]),right:$+Math.max(_i[0],_n[0],_s[0],_l[0]),bottom:_t+Math.min(_i[1],_n[1],_s[1],_l[1])}}},{key:"isFlat",value:function(){return this._is_flat}},{key:"getBoundingCircles",value:function(){}},{key:"getAABB",value:function(){}}],[{key:"splitLineByOrientation",value:function(e){for(var o=[e[0]],s=0,h=0,d=0,g=o,_=!1,j=1;j<e.length;j++){var $=e[j],_t=e[j-1],_e=Vector$1.length(Vector$1.sub($,_t));$[0]>_t[0]?d===1?(o.push($),(s+=_e)>h&&(g=o,h=s,_=!1)):(o=[_t,$],(s=_e)>h&&(g=o,h=s,_=!1),d=1):$[0]<_t[0]?d===-1?(o.unshift($),(s+=_e)>h&&(g=o,h=s,_=!0)):(o=[$,_t],(s=_e)>h&&(g=o,h=s,_=!0),d=-1):(d===-1?o.unshift($):(o.push($),d=1),(s+=_e)>h&&(g=o,h=s,_=d===-1))}return[g,_]}}])}(),LabelLineStraight=function(e){function o(s,h,d,g,_){var j;return _classCallCheck(this,o),(j=_callSuper(this,o,[d,g])).type="straight",j.size=s,j.throw_away=!j.fit(s,h,g,_),j}return _inherits(o,e),_createClass(o,[{key:"fit",value:function(s,h,d,g){var _,j=this.unit_scale,$=_slicedToArray(LabelLineBase.splitLineByOrientation(h),2);h=$[0],_=$[1],typeof d.orientation=="number"&&(this.offset[1]+=ORIENTED_LABEL_OFFSET_FACTOR*(s[1]-d.vertical_buffer),_&&(this.offset[1]*=-1),d.orientation===-1&&(this.offset[1]*=-1));for(var _t=getLineLengths(h),_e=s[0]*j,_r=0;_r<h.length-1;_r++)for(var _i=h[_r],_n=0,_s=0,_l=_r+1,Ap=void 0;_l<h.length;){var _h=h[_l-1],_p=h[_l],ty=getAngleForSegment(_h,_p);if(_l!==_r+1&&(_n+=getAbsAngleDiff(ty,Ap)),Math.abs(_n)>STRAIGHT_ANGLE_TOLERANCE)break;if(calcFitness(_s+=_t[_l-1],_e)<g){var ry=Vector$1.mult(Vector$1.add(_i,_p),.5);return this.angle=-ty,Math.abs(this.angle-Math.PI/2)<VERTICAL_ANGLE_TOLERANCE&&(this.angle=-Math.PI/2,typeof d.orientation=="number"&&(this.offset[1]*=-1)),this.position=ry,this.breach=!this.inTileBounds(),!0}Ap=ty,_l++}return!1}},{key:"getBoundingCircles",value:function(){if(!this._circles){var s=this.unit_scale,h=this.size[0]/2*s,d=h*Math.cos(this.angle),g=h*Math.sin(this.angle),_=-d,j=-g,$=this.offset[0]*s,_t=this.offset[1]*s,_e=_slicedToArray(this.position,2),_r=_e[0],_i=_e[1];if(_i*=-1,$){var _n=[d,g];Vector$1.normalize(_n),_n[0]*=$,_n[1]*=$,_r+=_n[0],_i+=_n[1]}if(_t){var _s=[g,-d];Vector$1.normalize(_s),_s[0]*=_t,_s[1]*=_t,_r-=_s[0],_i-=_s[1]}d+=_r,g+=_i,_+=_r,j+=_i;var _l=this.size[1]/2*s;this._circles=encircleLine(d,g,_,j,_l)}return this._circles}},{key:"getAABB",value:function(){if(!this._aabb){var s=this.unit_scale,h=this.size,d=this.layout.buffer,g=(h[0]+2*d[0])*s,_=(h[1]+2*d[1])*s;this._aabb=this.getAABBForSegment(this.position,g,_,this.angle)}return this._aabb}}])}(LabelLineBase),LabelLineCurved=function(e){function o(s,h,d,g){var _;return _classCallCheck(this,o),(_=_callSuper(this,o,[d,g])).type="curved",_.positions=[],_.angles=[],_._aabbs=[],_.pre_angles=[],_.offsets=[],_.num_segments=s.length,_.sizes=s,_.alt_angles=[],_.alt_pre_angles=[],_.alt_offsets=[],_.throw_away=!_.fit(_.sizes,h,g),_}return _inherits(o,e),_createClass(o,[{key:"toJSON",value:function(){return{id:this.id,type:this.type,is_flat:this._is_flat,position:this.position,breach:this.breach,layout:textLayoutToJSON(this.layout),circles:this.getBoundingCircles()}}},{key:"fit",value:function(s,h,d){var g,_=this.unit_scale,j=Math.max.apply(Math,_toConsumableArray(s.map(function(iv){return iv[1]}))),$=j*_,_t=_slicedToArray(LabelLineBase.splitLineByOrientation(h),2);h=_t[0],g=_t[1],typeof d.orientation=="number"&&(this.offset[1]+=ORIENTED_LABEL_OFFSET_FACTOR*(j-d.vertical_buffer),g&&(this.offset[1]*=-1),d.orientation===-1&&(this.offset[1]*=-1));var _e=getLineLengths(h),_r=s.map(function(iv){return iv[0]*_}),_i=_e.reduce(function(iv,Ov){return iv+Ov},0),_n=_r.reduce(function(iv,Ov){return iv+Ov},0);if(_n>_i)return!1;var _s=h.length-1;if(_s-0<2)return!1;var _l=o.curvaturePlacement(h,_i,_e,_n,0,_s),Ap=h[_l];if(_l===-1||_s-_l<2)return!1;this.position=Ap;for(var _h=0;_h<_r.length;_h++){this.positions[_h]=[],this.offsets[_h]=[],this.angles[_h]=[],this.pre_angles[_h]=[];for(var _p=0;_p<STOPS.length;_p++){var ty=STOPS[_p],ry=_slicedToArray(o.scaleLine(ty,h),2),ly=ry[0],uy=ry[1];Ap=ly[_l];var py=o.placeAtIndex(_l,ly,uy,_r),fy=py.positions,my=py.offsets,xy=py.angles,Ly=py.pre_angles,My=my.map(function(iv){return Math.sqrt(iv[0]*iv[0]+iv[1]*iv[1])/_});if(ty===0){this.angle=1/xy.length*xy.reduce(function(iv,Ov){return iv+Ov});for(var Ry=0;Ry<fy.length;Ry++){var Sy=fy[Ry],Zy=Ly[Ry],qy=_r[Ry],_m=Zy+xy[Ry];this._aabbs.push(this.getAABBForSegment(Sy,qy,$,_m))}}this.positions[_h].push(fy[_h]),this.offsets[_h].push(My[_h]),this.angles[_h].push(xy[_h]),this.pre_angles[_h].push(Ly[_h])}}_r=s.slice().reverse().map(function(iv){return iv[0]*_});for(var ky=0;ky<_r.length;ky++){this.alt_offsets[ky]=[],this.alt_angles[ky]=[],this.alt_pre_angles[ky]=[];for(var Dy=0;Dy<STOPS.length;Dy++){var Gy=STOPS[Dy],Ky=_slicedToArray(o.scaleLine(Gy,h),2),sv=Ky[0],Hy=Ky[1];Ap=sv[_l];var vv=o.placeAtIndex(_l,sv,Hy,_r),_v=vv.offsets,Av=vv.angles,Mv=vv.pre_angles,Nv=_v.map(function(iv){return Math.sqrt(iv[0]*iv[0]+iv[1]*iv[1])/_});Gy===0&&(this.alt_angle=1/Av.length*Av.reduce(function(iv,Ov){return iv+Ov})),this.alt_offsets[ky].push(Nv[ky]),this.alt_angles[ky].push(Av[ky]),this.alt_pre_angles[ky].push(Mv[ky])}}return!0}},{key:"getBoundingCircles",value:function(){if(!this._circles){for(var s=[],h=this.unit_scale,d=0;d<this.positions.length;d++){var g=this.sizes[d],_=this.angles[d][0],j=this.positions[d][0],$=g[0]/2*h,_t=$*Math.cos(_),_e=$*Math.sin(_),_r=-_t,_i=-_e,_n=_slicedToArray(j,2),_s=_n[0],_l=_n[1],Ap=encircleLine(_t+=_s,_e+=_l*=-1,_r+=_s,_i+=_l,g[1]/2*h);Array.prototype.push.apply(s,Ap)}this._circles=s}return this._circles}},{key:"getAABB",value:function(){if(!this._aabb){for(var s=1/0,h=-1/0,d=-1/0,g=1/0,_=0;_<this._aabbs.length;_++){var j=this._aabbs[_];s=Math.min(s,j.left),h=Math.max(h,j.top),d=Math.max(d,j.right),g=Math.min(g,j.bottom)}this._aabb={left:s,top:h,right:d,bottom:g}}return this._aabb}}],[{key:"curvaturePlacement",value:function(s,h,d,g,_,j){_=_||0,j=j||s.length-1;for(var $=[],_t=_+1;_t<j;_t++){var _e=s[_t-1],_r=s[_t],_i=s[_t+1],_n=Vector$1.perp(_r,_e),_s=Vector$1.perp(_i,_r),_l=Vector$1.angleBetween(_n,_s);_l>CURVE_MAX_ANGLE&&(_l=1/0),$.push(_l)}$.push(1/0);for(var Ap=[],_h=[],_p=_,ty=0,ry=0;ry<_;ry++)ty+=d[ry];for(;ty+g<h;){for(var ly=ty+g,uy=ty,py=_p,fy=0;py<j&&uy+d[py]<ly&&(fy+=$[py])!==1/0;)uy+=d[py],py++;if(fy===0)return _p;var my=fy/(py-_p);Ap.push(fy),_h.push(my),ty+=d[_p],_p++}if(Ap.length===0)return-1;var xy=Math.min.apply(null,Ap),Ly=_h[Ap.indexOf(xy)];return xy<CURVE_MIN_TOTAL_COST&&Ly<CURVE_MIN_AVG_COST?Ap.indexOf(xy):-1}},{key:"scaleLine",value:function(s,h){var d=[h[0]],g=[];return h.forEach(function(_,j){if(j!==h.length-1){var $=Vector$1.sub(h[j+1],h[j]),_t=Vector$1.mult($,1+s);d.push(Vector$1.add(d[j],_t)),g.push(Vector$1.length(_t))}}),[d,g]}},{key:"placeAtIndex",value:function(s,h,d,g){var _=h[s],j=_slicedToArray(o.getIndicesAndOffsets(s,d,g),2),$=j[0],_t=j[1],_e=o.getPositionsFromIndicesAndOffsets(h,$,_t),_r=_slicedToArray(o.getAnglesFromIndicesAndOffsets(_,$,h,_e),3);return{positions:_e,offsets:_r[0],angles:_r[1],pre_angles:_r[2]}}},{key:"getIndicesAndOffsets",value:function(s,h,d){for(var g=d.length,_=[],j=[],$=0,_t=0,_e=0;$<g;){for(var _r=d[$];$<g&&_t+.5*_r<=_e+h[s];){var _i=_t-_e+.5*_r;j.push(_i),_.push(s),_t+=_r,_r=d[++$]}_e+=h[s],s++}return[_,j]}},{key:"getPositionsFromIndicesAndOffsets",value:function(s,h,d){for(var g=[],_=0;_<h.length;_++){var j=h[_],$=d[_],_t=getAngleForSegment(s[j],s[j+1]),_e=Vector$1.rot([$,0],_t),_r=Vector$1.add(s[j],_e);g.push(_r)}return g}},{key:"getAnglesFromIndicesAndOffsets",value:function(s,h,d,g){for(var _=[],j=[],$=[],_t=0;_t<g.length;_t++){var _e=g[_t],_r=h[_t],_i=Vector$1.sub(_e,s),_n=-Vector$1.angle(_i),_s=getTextAngleForSegment(d[_r],d[_r+1])-_n;if(_t>0){var _l=_[_t-1],Ap=j[_t-1];Math.abs(_n-_l)>Math.PI&&(_n+=_n>_l?-2*Math.PI:2*Math.PI),Math.abs(Ap-_s)>Math.PI&&(_s+=_s>Ap?-2*Math.PI:2*Math.PI)}_.push(_n),j.push(_s),$.push(_i)}return[$,_,j]}}])}(LabelLineBase);function calcFitness(e,o){return o/e}function getAngleForSegment(e,o){var s=Vector$1.sub(o,e);return Vector$1.angle(s)}function getTextAngleForSegment(e,o){return-getAngleForSegment(e,o)}function getLineLengths(e){for(var o=[],s=0;s<e.length-1;s++){var h=e[s],d=e[s+1],g=Math.hypot(h[0]-d[0],h[1]-d[1]);o.push(g)}return o}function getAbsAngleDiff(e,o){var s,h;for(e>o?(s=o,h=e):(s=e,h=o);h-s>Math.PI;)s+=2*Math.PI;return Math.abs(h-s)}var TextStyle=Object.create(Points);Object.assign(TextStyle,{name:"text",super:Points,built_in:!0,init:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Style.init.call(this,e),this.setupDefines(),this.defines.TANGRAM_HAS_SHADER_POINTS=!1,this.defines.TANGRAM_IS_TEXT_STYLE=!0,this.reset()},makeVertexTemplate:function(e,o){this.super.makeVertexTemplate.apply(this,arguments);var s=o.vertex_data.vertex_layout;return this.fillVertexTemplate(s,"a_pre_angles",0,{size:4}),this.fillVertexTemplate(s,"a_offsets",0,{size:4}),this.fillVertexTemplate(s,"a_angles",0,{size:4}),this.fillVertexTemplate(s,"a_offsets_alt",0,{size:4}),this.fillVertexTemplate(s,"a_pre_angles_alt",0,{size:4}),this.fillVertexTemplate(s,"a_angles_alt",0,{size:4}),this.vertex_template},reset:function(){this.queues={},this.resetText()},addFeature:function(e,o,s){var h=this,d=s.tile,g=e.geometry.type;o.can_articulate=g==="LineString"||g==="MultiLineString",o.supersample_text=g==="LineString"||g==="MultiLineString";var _=this.parseTextFeature(e,o,s,d);_&&(_ instanceof Array?_.forEach(function(j){j.feature=e,j.context=s,j.layout.vertex=!1,h.queueFeature(j,d)}):(_.feature=e,_.context=s,_.layout.vertex=!1,this.queueFeature(_,d)),Collision.addStyle(this.name,d.id))},endData:function(e){var o=this,s=this.queues[e.id];return delete this.queues[e.id],this.collideAndRenderTextLabels(e,this.name,s).then(function(h){var d=h.labels,g=h.texts;return d&&g&&(o.texts[e.id]=g,d.forEach(function(_){var j=_.text_settings_key,$=o.texts[e.id][j]&&o.texts[e.id][j][_.text],_t=o.feature_style;_t.label=_.label,_.label.text_data={text_info:$,text_settings_key:j,text:_.text},_t.label_texture=o.textureManager.default,$.text_settings.can_articulate?(_t.size={},_.label.type==="straight"?_t.size.straight=$.size.logical_size:_t.size.curved=$.segment_sizes.map(function(_e){return _e.logical_size})):_t.size=$.size.logical_size,Style.addFeature.call(o,_.feature,_.draw,_.context)})),o.freeText(e),Style.endData.call(o,e).then(function(_){if(_){for(var j in _.meshes)_.meshes[j].uniforms.u_apply_color_blocks=!0;e.mesh_data[o.name]=_}return _})})},_preprocess:function(e){return this.preprocessText(e)},buildTextLabels:function(e,o){for(var s=[],h=0;h<o.length;h++){var d=o[h],g=this.texts[e.id][d.text_settings_key][d.text],_=void 0;if(d.layout.vertical_buffer=g.vertical_buffer,g.text_settings.can_articulate){var j=g.segment_sizes.map(function(_e){return _e.collision_size});d.layout.no_curving=g.no_curving,_=this.buildLabels(j,d.feature.geometry,d.layout,g.size.collision_size)}else _=this.buildLabels(g.size.collision_size,d.feature.geometry,d.layout);for(var $=0;$<_.length;$++){var _t=Object.create(d);_t.label=_[$],s.push(_t)}}return s},buildLabels:function(e,o,s,h){var d=o.type!=="Point",g=[];if(o.type==="LineString")Array.prototype.push.apply(g,this.buildLineLabels(o.coordinates,e,d,s,h));else if(o.type==="MultiLineString")for(var _=o.coordinates,j=0;j<_.length;++j)Array.prototype.push.apply(g,this.buildLineLabels(_[j],e,d,s,h));else if(o.type==="Point")g.push(new LabelPoint(o.coordinates,e,d,s));else if(o.type==="MultiPoint")for(var $=o.coordinates,_t=0;_t<$.length;++_t)g.push(new LabelPoint($[_t],e,d,s));else if(o.type==="Polygon"){var _e=Geo$1.centroid(o.coordinates);g.push(new LabelPoint(_e,e,d,s))}else if(o.type==="MultiPolygon"){var _r=Geo$1.multiCentroid(o.coordinates);g.push(new LabelPoint(_r,e,d,s))}return g},buildLineLabels:function(e,o,s,h,d){var g=[],_=Math.min(h.subdiv,e.length-1);if(_>1)for(var j=(e.length-1)/_,$=0;$<_;$++){var _t=Math.floor($*j),_e=Math.floor(($+1)*j)+1,_r=e.slice(_t,_e),_i=LabelLine.create(o,d,_r,s,h);_i&&g.push(_i)}if(g.length<_){var _n=LabelLine.create(o,d,e,s,h);_n&&g.push(_n)}return g},vertexLayoutForMeshVariant:function(){if(!this.vertex_layout){var e=[{name:"a_position",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_shape",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_texcoord",size:2,type:gl$1.UNSIGNED_SHORT,normalized:!0},{name:"a_offset",size:2,type:gl$1.SHORT,normalized:!1},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_angles",size:4,type:gl$1.SHORT,normalized:!1},{name:"a_offsets",size:4,type:gl$1.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles",size:4,type:gl$1.BYTE,normalized:!1},{name:"a_selection_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_is_flat",size:1,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_offsets_alt",size:4,type:gl$1.UNSIGNED_SHORT,normalized:!1},{name:"a_pre_angles_alt",size:4,type:gl$1.BYTE,normalized:!1},{name:"a_angles_alt",size:4,type:gl$1.SHORT,normalized:!1}];this.vertex_layout=new VertexLayout(e)}return this.vertex_layout},getMeshVariantTypeForDraw:Points.getMeshVariantTypeForDraw}),TextStyle.texture_id=0;var RasterStyle=Object.create(Polygons);Object.assign(RasterStyle,{name:"raster",super:Polygons,built_in:!0,init:function(){this.raster=this.raster||"color",this.super.init.apply(this,arguments),this.selection=!1,this.defines.SNAP_TO_PIXEL_GRID=!0},_preprocess:function(e){return e.color=e.color||StyleParser.defaults.color,this.super._preprocess.apply(this,arguments)}});var CustomIcons=Object.create(Points);Object.assign(CustomIcons,{name:"custom_icons",collision:!1,init:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Points.init.call(this,e)},loadTexture:function(e,o,s){var h,d=e.width,g=e.height,_=e.items,j=document.createElement("canvas"),$=Utils$1.device_pixel_ratio,_t=this.sources[o],_e={sprites:{}};if(j.width=d*$,j.height=g*$,_t){var _r,_i=_.length,_n=j.getContext("2d");for(_n.scale($,$);_r=_[--_i];){var _s=_t.getIconBitmapByObjectId(_r.meta.objectId,_r.meta.id);if(_s){var _l=isTainting(_s);_l?log("error",_l):(_n.drawImage(_s,_r.x,_r.y,_r.width,_r.height),_e.sprites[_r.meta.id]=[_r.x,_r.y,_r.width,_r.height])}}}return _e.element=j,(h=this.textureManager.create(this.gl,s,_e)).retain(),h.loading.then(function(Ap){return Ap.name})},buildRasterTextures:function(e,o){return WorkerBroker.postMessage(this.main_thread_target+".loadTexture",e.rasters,e.source,e.texture_name).then(function(s){return o.textures.push(s),o})},addFeature:function(e,o,s){var h=s.tile.rasters,d={};h.items.forEach(function(j){d[j.meta.id]=[j.x,j.y,j.width,j.height]});var g="".concat(s.tile.source,"_dyn_").concat(s.tile.coords.key,"_").concat(this.generation,"_").concat(s.tile.id);o.texture=s.tile.texture_name=g;var _=Object.assign({},DEFAULT_TEXTURE_INFO,{name:g,width:h.width,height:h.height,sprites:d,manager:this.textureManager});Texture.prototype.calculateSprites.apply(_),this.textureManager.textures[g]=_,Points.addFeature.apply(this,arguments),delete this.textureManager.textures[g]}});var DEFAULT_TEXTURE_INFO={filtering:"linear",density:1,valid:!0,power_of_2:!1,texcoords:{},sizes:{},css_sizes:{},aspects:{}},OverlayStyle=Object.create(Polygons);Object.assign(OverlayStyle,{name:"overlays",super:Polygons,init:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection=e.selection||!0,this.raster=this.raster||"color",this.super.init.apply(this,arguments)},setupRasters:function(){if(!Thread.is_main)return!1;if(this.super.setupRasters.call(this))return!0;var e=!1;for(var o in this.sources)if(this.sources[o]instanceof ObjectSource){e=!0;break}return!!e&&(this.defines.TANGRAM_MODEL_POSITION_BASE_ZOOM_VARYING=!0,this.replaceShaderBlock("raster",shaderSrc_rasters,"Raster"),!0)},loadTextures:function(e,o){var s,h,d,g=this.sources[o],_=e.name;if(e.overlays_config.forEach(function(_t){var _e=_t.texcoords,_r=_t.id,_i=g.getMapObjectById(_r),_n=_i.getBitmap();if(_n){var _s=isTainting(_n=bitmapToCanvas(_n,_n.width,_n.height));_s?log("error",_s):(s||((s=document.createElement("canvas")).width=e.width,s.height=e.height,h=s.getContext("2d")),h.save(),h.globalAlpha=_i.getOpacity(),_e.forEach(function(_l){return h.drawImage(_n,_l[0],_l[1],_l[2],_l[3])}),h.restore(),d=!0)}}),d){e.element=s;var j={};return j[_]=e,this.super.loadTextures.call(this,j)}var $=this.textureManager.textures[this.textureManager.default];return Promise.resolve([{name:$.name,width:$.width,height:$.height,loaded:$.loaded}])},buildRasterTextures:function(e,o){var s=this.sources[e.source].tileTexture(e);return s?WorkerBroker.postMessage(this.main_thread_target+".loadTextures",s,e.source).then(function(h){if(!h||h.length<1)return o;if(h.some(function(g){return!g.loaded}))return null;var d=h[0].name;return o.uniforms=o.uniforms||{},o.textures=o.textures||[],o.uniforms.u_raster=d,o.uniforms.u_raster_offset=[0,0,1],o.textures.push(d),o}):Promise.resolve(o)}});var shaderSrc_Vertex="uniform float u_horizon;uniform float u_tilt;uniform float u_zoom;attribute vec2 a_position;attribute float a_is_sky;attribute float a_is_top;attribute vec4 a_color;varying vec4 v_color;const float SIN_THRESHOLD_ANGLE=0.96126069082;void main(){v_color=a_color;float sin_tilt=sin(u_tilt);float sky_bottom_alpha=1.-max(sin_tilt-SIN_THRESHOLD_ANGLE,0.)*3.;if((a_position.y==1.&&a_is_sky==0.)||(a_position.y==0.&&a_is_sky==1.)){v_color.w=sky_bottom_alpha;}float fog_height=max((22.-u_zoom)*0.04,0.)*(sin_tilt-.7);float position_z=u_zoom<17. ? .942 : .9418;gl_Position=vec4(a_position.x,a_is_sky*(a_position.y+a_is_top)+1.0-u_horizon-(1.0-a_is_sky)*(1.0-a_position.y)*fog_height,position_z,1.0);}",shaderSrc_Fragment="varying vec4 v_color;void main(void){gl_FragColor=v_color;}",STYLE_NAME="skybox",SkyBox=Object.create(Style),positions=[-1,0,1,0,-1,1,-1,1,1,0,1,1,-1,0,1,0,-1,1,-1,1,1,0,1,1];Object.assign(SkyBox,{name:STYLE_NAME,built_in:!0,vertex_shader_src:shaderSrc_Vertex,fragment_shader_src:shaderSrc_Fragment,selection:!1,blend:"inlay",blend_order:1,init:function(){Style.init.apply(this,arguments),this.selection=!1},_preprocess:function(e){return e.color={top:StyleParser.createColorPropertyCache(e.color.zenith),bottom:StyleParser.createColorPropertyCache(e.color.horizon),fog:StyleParser.createColorPropertyCache(e.color.fog)},e},vertexLayoutForMeshVariant:function(e){if(!this.vertex_layout){var o=[{name:"a_position",size:2,type:gl$1.FLOAT,normalized:!1},{name:"a_is_sky",size:1,type:gl$1.FLOAT,normalized:!0},{name:"a_color",size:4,type:gl$1.UNSIGNED_BYTE,normalized:!0},{name:"a_is_top",size:1,type:gl$1.FLOAT,normalized:!0}];this.vertex_layout=new VertexLayout(o)}return this.vertex_layout},makeVertexTemplate:function(e){var o=0;return this.vertex_template[o++]=0,this.vertex_template[o++]=0,this.vertex_template},parseFeature:function(e,o,s){var h=this.feature_style;return o.color&&o.color.top&&o.color.bottom&&(h.color_top=this.parseColor(o.color.top,s),h.color_bottom=this.parseColor(o.color.bottom,s),h.color_fog=this.parseColor(o.color.fog||"white",s),Array.isArray(h.color_fog)&&(h.color_fog=h.color_fog.slice(),h.color_fog[3]=0)),h},buildGeometry:function(e,o,s,h){for(var d=this.makeVertexTemplate(o),g=s.vertex_data,_=s.vertex_data.vertex_layout,j=g.vertex_layout.index.a_position,$={top:o.color_top,bottom:o.color_bottom},_t={top:o.color_bottom,bottom:o.color_fog},_e=0,_r=positions.length-1;_e<_r;_e+=2){d[j+0]=positions[_e],d[j+1]=positions[_e+1];var _i=_e<12,_n=positions[_e+1]>0,_s=_i?$:_t;this.fillVertexTemplate(_,"a_is_sky",_i?1:0,{size:1}),this.fillVertexTemplate(_,"a_is_top",_n?1:0,{size:1}),this.fillVertexTemplate(_,"a_color",Vector$1.mult(_n?_s.top:_s.bottom,255),{size:4}),g.addVertex(d)}return 4}});var shaderSrc_accessors=`#ifdef TANGRAM_VERTEX_SHADER
vec4 modelPosition(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE*exp2(u_tile_origin.z-u_tile_origin.w),1.)+vec4(0.,1.,0.,0.);}vec4 modelPositionBaseZoom(){return vec4(a_position.xyz/TANGRAM_TILE_SCALE,1.)+vec4(0.,1.,0.,0.);}
#endif
vec4 worldPosition(){return v_world_position;}
#ifdef TANGRAM_VERTEX_SHADER
vec4 wrapWorldPosition(vec4 world_position){
#if defined(TANGRAM_WORLD_POSITION_WRAP)
vec2 anchor=u_tile_origin.xy-mod(u_tile_origin.xy,TANGRAM_WORLD_POSITION_WRAP);world_position.xy-=anchor;
#endif
return world_position;}
#endif
#if defined(TANGRAM_VERTEX_SHADER)
vec3 worldNormal(){return TANGRAM_NORMAL;}
#elif defined(TANGRAM_FRAGMENT_SHADER)
vec3 worldNormal(){return u_inverseNormalMatrix*TANGRAM_NORMAL;}
#endif
`,shaderSrc_layerOrder="void applyLayerOrder(float layer,inout vec4 position){position.z-=layer*TANGRAM_LAYER_DELTA*position.w;}",shaderSrc_selectionGlobals=`
#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)
attribute vec4 a_selection_color;varying vec4 v_selection_color;uniform vec4 u_selection_discard0;uniform vec4 u_selection_discard1;uniform vec4 u_selection_discard2;uniform vec4 u_selection_discard3;uniform vec4 u_selection_discard4;uniform vec4 u_selection_discard5;uniform vec4 u_selection_discard6;uniform vec4 u_selection_discard7;uniform vec4 u_selection_discard8;uniform vec4 u_selection_discard9;
#endif
`,shaderSrc_selectionVertex=`
#if defined(TANGRAM_FEATURE_SELECTION) && defined(TANGRAM_VERTEX_SHADER)
if(a_selection_color.rgb==vec3(0.)||a_selection_color==u_selection_discard0||a_selection_color==u_selection_discard1||a_selection_color==u_selection_discard2||a_selection_color==u_selection_discard3||a_selection_color==u_selection_discard4||a_selection_color==u_selection_discard5||a_selection_color==u_selection_discard6||a_selection_color==u_selection_discard7||a_selection_color==u_selection_discard8||a_selection_color==u_selection_discard9){gl_Position=vec4(0.,0.,0.,1.);return;}v_selection_color=a_selection_color;
#endif
`,shaderSrc_utils=`#ifndef UTILS
#define UTILS
bool isLocalSpacePixelOutsideTile(vec4 pixel_local_space_position,float tile_scale){return pixel_local_space_position.x<0.||pixel_local_space_position.x>=tile_scale||pixel_local_space_position.y>0.||pixel_local_space_position.y<=-tile_scale;}
#endif
`,shaderSrc_snapToPixelGrid=`uniform float u_view_pan_snap_timer;void snapToPixelGrid(inout vec4 position){vec2 position_fract=fract((((position.xy/position.w)+1.)*.5)*u_resolution);vec2 position_snap=position.xy+((step(0.5,position_fract)-position_fract)*position.w*2./u_resolution);
#ifdef TANGRAM_VIEW_PAN_SNAP_RATE
position.xy=mix(position.xy,position_snap,clamp(u_view_pan_snap_timer*TANGRAM_VIEW_PAN_SNAP_RATE,0.,1.));
#else
position.xy=position_snap;
#endif
}`,StyleManager=function(){return _createClass(function e(){_classCallCheck(this,e),this.styles={},this.base_styles={},this.register(Object.create(Polygons)),this.register(Object.create(Lines)),this.register(Object.create(PatternLines)),this.register(Object.create(Points)),this.register(Object.create(TextStyle)),this.register(Object.create(RasterStyle)),this.register(Object.create(CustomIcons)),this.register(Object.create(OverlayStyle)),this.register(Object.create(SkyBox))},[{key:"init",value:function(){ShaderProgram.removeBlock("global"),ShaderProgram.removeBlock("setup"),ShaderProgram.addBlock("global",shaderSrc_accessors),ShaderProgram.addBlock("global",shaderSrc_layerOrder),ShaderProgram.addBlock("global",shaderSrc_selectionGlobals),ShaderProgram.addBlock("global",shaderSrc_snapToPixelGrid),ShaderProgram.replaceBlock("utils",shaderSrc_utils),ShaderProgram.replaceBlock("setup",shaderSrc_selectionVertex),ShaderProgram.defines.TANGRAM_EPSILON=1e-5,ShaderProgram.defines.TANGRAM_LAYER_DELTA=1/16384,ShaderProgram.defines.TANGRAM_TILE_SCALE="vec3(".concat(Geo$1.tile_scale,"., ").concat(Geo$1.tile_scale,"., u_meters_per_pixel * ").concat(Geo$1.tile_size,".)"),ShaderProgram.defines.TANGRAM_HEIGHT_SCALE=Geo$1.height_scale,ShaderProgram.defines.TANGRAM_ALPHA_TEST=.1,Lines.dash_textures={}}},{key:"destroy",value:function(e){var o=this;Object.keys(this.styles).forEach(function(s){var h=o.styles[s];h.gl===e&&(log("trace","StyleManager.destroy: destroying render style ".concat(h.name)),h.base&&o.remove(h.name),h.destroy())})}},{key:"register",value:function(e){this.styles[e.name]=e,this.base_styles[e.name]=e}},{key:"remove",value:function(e){delete this.styles[e]}},{key:"mix",value:function(e,o){if(e.mixed)return e;e.mixed={};var s=[];if(e.mix){var h;Array.isArray(e.mix)?(h=s).push.apply(h,_toConsumableArray(e.mix)):s.push(e.mix),(s=s.map(function(g){return o[g]}).filter(function(g){return g&&g!==e})).forEach(function(g){return e.mixed[g.name]=!0})}s.push(e),e.animated=s.some(function(g){return g&&g.animated}),e.texcoords=s.some(function(g){return g&&g.texcoords}),e.base=s.map(function(g){return g.base}).filter(function(g){return g}).pop(),e.lighting=s.map(function(g){return g.lighting}).filter(function(g){return g!=null}).pop(),e.texture=s.map(function(g){return g.texture}).filter(function(g){return g}).pop(),e.raster=s.map(function(g){return g.raster}).filter(function(g){return g!=null}).pop(),e.dash=s.map(function(g){return g.dash}).filter(function(g){return g!=null}).pop(),e.dash_background_color=s.map(function(g){return g.dash_background_color}).filter(function(g){return g!=null}).pop(),s.some(function(g){return g.hasOwnProperty("blend")&&g.blend})&&(e.blend=s.map(function(g){return g.hasOwnProperty("blend")&&g.blend}).filter(function(g){return g}).pop()),e.blend_order=s.map(function(g){return g.blend_order}).filter(function(g){return g!=null}).pop(),e.defines=Object.assign.apply(Object,[{}].concat(_toConsumableArray(s.map(function(g){return g.defines}).filter(function(g){return g})))),e.material=Object.assign.apply(Object,[{}].concat(_toConsumableArray(s.map(function(g){return g.material}).filter(function(g){return g}))));var d=s.map(function(g){return g.draw}).filter(function(g){return g});return d.length>0&&(e.draw=mergeObjects.apply(void 0,[{}].concat(_toConsumableArray(d)))),this.mixShaders(e,o,s),e}},{key:"mixShaders",value:function(e,o,s){var h={},d=s.map(function(_t){return _t.shaders}).filter(function(_t){return _t});if(h.defines=Object.assign.apply(Object,[{}].concat(_toConsumableArray(d.map(function(_t){return _t.defines}).filter(function(_t){return _t})))),h.uniforms={},h._uniforms=e.shaders&&e.shaders.uniforms||{},h._uniform_scopes={},s.filter(function(_t){return _t.shaders&&_t.shaders.uniforms}).forEach(function(_t){var _e=function(_i){h._uniform_scopes[_i]=_t.name,Object.defineProperty(h.uniforms,_i,{enumerable:!0,configurable:!0,get:function(){return h._uniforms[_i]!==void 0?h._uniforms[_i]:o[h._uniform_scopes[_i]].shaders.uniforms!==h.uniforms?o[h._uniform_scopes[_i]].shaders.uniforms[_i]:void 0},set:function(_n){h._uniforms[_i]=_n}})};for(var _r in _t.shaders.uniforms)_e(_r)}),h.extensions=Object.keys(d.map(function(_t){return _t.extensions}).filter(function(_t){return _t}).reduce(function(_t,_e){return typeof _e=="string"?_t[_e]=!0:_e.forEach(function(_r){return _t[_r]=!0}),_t},{})||{}),e.shaders&&e.shaders.blocks)for(var g in e.shaders.block_scopes=e.shaders.block_scopes||{},e.shaders.blocks){var _,j=e.shaders.blocks[g];e.shaders.block_scopes[g]=e.shaders.block_scopes[g]||[],Array.isArray(j)?(_=e.shaders.block_scopes[g]).push.apply(_,_toConsumableArray(j.map(function(){return e.name}))):e.shaders.block_scopes[g].push(e.name)}var $={};return d.forEach(function(_t){if(_t.blocks){h.blocks=h.blocks||{},h.block_scopes=h.block_scopes||{};var _e={};for(var _r in _t.blocks){var _i=_t.blocks[_r],_n=_t.block_scopes[_r];h.blocks[_r]=h.blocks[_r]||[],h.block_scopes[_r]=h.block_scopes[_r]||[],_i=Array.isArray(_i)?_i:[_i],_n=Array.isArray(_n)?_n:[_n];for(var _s=0;_s<_i.length;_s++)$[_n[_s]]||(_e[_n[_s]]=!0,h.blocks[_r].push(_i[_s]),h.block_scopes[_r].push(_n[_s]))}Object.assign($,_e)}}),Object.assign(e.mixed,$),e.shaders=h,e}},{key:"create",value:function(e,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=mergeObjects({},o);return h.name=e,(h=this.mix(h,s)).base&&this.base_styles[h.base]?this.styles[e]=h=Object.assign(Object.create(this.base_styles[h.base]),h):h.base=null,h}},{key:"build",value:function(e){var o=this,s=Object.keys(e).sort(function(g,_){return o.inheritanceDepth(g,e)-o.inheritanceDepth(_,e)});for(var h in this.styles)this.base_styles[h]?this.styles[h].reset():delete this.styles[h];var d={};return s.forEach(function(g){d[g]=o.create(g,e[g],d)}),this.styles}},{key:"initStyles",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(var o in this.styles)this.styles[o].init(e)}},{key:"inheritanceDepth",value:function(e,o){for(var s=this,h=0;;){var d=o[e];if(!d||!d.mix)break;if(h++,Array.isArray(d.mix)){h+=Math.max.apply(Math,_toConsumableArray(d.mix.map(function(g){if(e!==g)return s.inheritanceDepth(g,o)})));break}if(e===d.mix)break;e=d.mix}return h}}])}();/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function isNothing(e){return e==null}function isObject(e){return typeof e=="object"&&e!==null}function toArray(e){return Array.isArray(e)?e:isNothing(e)?[]:[e]}function extend(e,o){var s,h,d,g;if(o)for(s=0,h=(g=Object.keys(o)).length;s<h;s+=1)e[d=g[s]]=o[d];return e}function repeat(e,o){var s,h="";for(s=0;s<o;s+=1)h+=e;return h}function isNegativeZero(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var isNothing_1=isNothing,isObject_1=isObject,toArray_1=toArray,repeat_1=repeat,isNegativeZero_1=isNegativeZero,extend_1=extend,common={isNothing:isNothing_1,isObject:isObject_1,toArray:toArray_1,repeat:repeat_1,isNegativeZero:isNegativeZero_1,extend:extend_1};function formatError(e,o){var s="",h=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(s+='in "'+e.mark.name+'" '),s+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!o&&e.mark.snippet&&(s+=`

`+e.mark.snippet),h+" "+s):h}function YAMLException$1(e,o){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=o,this.message=formatError(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}YAMLException$1.prototype=Object.create(Error.prototype),YAMLException$1.prototype.constructor=YAMLException$1,YAMLException$1.prototype.toString=function(e){return this.name+": "+formatError(this,e)};var exception=YAMLException$1;function getLine(e,o,s,h,d){var g="",_="",j=Math.floor(d/2)-1;return h-o>j&&(o=h-j+(g=" ... ").length),s-h>j&&(s=h+j-(_=" ...").length),{str:g+e.slice(o,s).replace(/\t/g,"")+_,pos:h-o+g.length}}function padStart(e,o){return common.repeat(" ",o-e.length)+e}function makeSnippet(e,o){if(o=Object.create(o||null),!e.buffer)return null;o.maxLength||(o.maxLength=79),typeof o.indent!="number"&&(o.indent=1),typeof o.linesBefore!="number"&&(o.linesBefore=3),typeof o.linesAfter!="number"&&(o.linesAfter=2);for(var s,h=/\r?\n|\r|\0/g,d=[0],g=[],_=-1;s=h.exec(e.buffer);)g.push(s.index),d.push(s.index+s[0].length),e.position<=s.index&&_<0&&(_=d.length-2);_<0&&(_=d.length-1);var j,$,_t="",_e=Math.min(e.line+o.linesAfter,g.length).toString().length,_r=o.maxLength-(o.indent+_e+3);for(j=1;j<=o.linesBefore&&!(_-j<0);j++)$=getLine(e.buffer,d[_-j],g[_-j],e.position-(d[_]-d[_-j]),_r),_t=common.repeat(" ",o.indent)+padStart((e.line-j+1).toString(),_e)+" | "+$.str+`
`+_t;for($=getLine(e.buffer,d[_],g[_],e.position,_r),_t+=common.repeat(" ",o.indent)+padStart((e.line+1).toString(),_e)+" | "+$.str+`
`,_t+=common.repeat("-",o.indent+_e+3+$.pos)+`^
`,j=1;j<=o.linesAfter&&!(_+j>=g.length);j++)$=getLine(e.buffer,d[_+j],g[_+j],e.position-(d[_]-d[_+j]),_r),_t+=common.repeat(" ",o.indent)+padStart((e.line+j+1).toString(),_e)+" | "+$.str+`
`;return _t.replace(/\n$/,"")}var snippet=makeSnippet,TYPE_CONSTRUCTOR_OPTIONS=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],YAML_NODE_KINDS=["scalar","sequence","mapping"];function compileStyleAliases(e){var o={};return e!==null&&Object.keys(e).forEach(function(s){e[s].forEach(function(h){o[String(h)]=s})}),o}function Type$1(e,o){if(o=o||{},Object.keys(o).forEach(function(s){if(TYPE_CONSTRUCTOR_OPTIONS.indexOf(s)===-1)throw new exception('Unknown option "'+s+'" is met in definition of "'+e+'" YAML type.')}),this.options=o,this.tag=e,this.kind=o.kind||null,this.resolve=o.resolve||function(){return!0},this.construct=o.construct||function(s){return s},this.instanceOf=o.instanceOf||null,this.predicate=o.predicate||null,this.represent=o.represent||null,this.representName=o.representName||null,this.defaultStyle=o.defaultStyle||null,this.multi=o.multi||!1,this.styleAliases=compileStyleAliases(o.styleAliases||null),YAML_NODE_KINDS.indexOf(this.kind)===-1)throw new exception('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var type=Type$1;function compileList(e,o){var s=[];return e[o].forEach(function(h){var d=s.length;s.forEach(function(g,_){g.tag===h.tag&&g.kind===h.kind&&g.multi===h.multi&&(d=_)}),s[d]=h}),s}function compileMap(){var e,o,s={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function h(d){d.multi?(s.multi[d.kind].push(d),s.multi.fallback.push(d)):s[d.kind][d.tag]=s.fallback[d.tag]=d}for(e=0,o=arguments.length;e<o;e+=1)arguments[e].forEach(h);return s}function Schema$1(e){return this.extend(e)}Schema$1.prototype.extend=function(e){var o=[],s=[];if(e instanceof type)s.push(e);else if(Array.isArray(e))s=s.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new exception("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(o=o.concat(e.implicit)),e.explicit&&(s=s.concat(e.explicit))}o.forEach(function(d){if(!(d instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(d.loadKind&&d.loadKind!=="scalar")throw new exception("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(d.multi)throw new exception("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),s.forEach(function(d){if(!(d instanceof type))throw new exception("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var h=Object.create(Schema$1.prototype);return h.implicit=(this.implicit||[]).concat(o),h.explicit=(this.explicit||[]).concat(s),h.compiledImplicit=compileList(h,"implicit"),h.compiledExplicit=compileList(h,"explicit"),h.compiledTypeMap=compileMap(h.compiledImplicit,h.compiledExplicit),h};var schema=Schema$1,str=new type("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),seq=new type("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),map=new type("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),failsafe=new schema({explicit:[str,seq,map]});function resolveYamlNull(e){if(e===null)return!0;var o=e.length;return o===1&&e==="~"||o===4&&(e==="null"||e==="Null"||e==="NULL")}function constructYamlNull(){return null}function isNull(e){return e===null}var _null=new type("tag:yaml.org,2002:null",{kind:"scalar",resolve:resolveYamlNull,construct:constructYamlNull,predicate:isNull,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function resolveYamlBoolean(e){if(e===null)return!1;var o=e.length;return o===4&&(e==="true"||e==="True"||e==="TRUE")||o===5&&(e==="false"||e==="False"||e==="FALSE")}function constructYamlBoolean(e){return e==="true"||e==="True"||e==="TRUE"}function isBoolean(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var bool=new type("tag:yaml.org,2002:bool",{kind:"scalar",resolve:resolveYamlBoolean,construct:constructYamlBoolean,predicate:isBoolean,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function isHexCode(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function isOctCode(e){return 48<=e&&e<=55}function isDecCode(e){return 48<=e&&e<=57}function resolveYamlInteger(e){if(e===null)return!1;var o,s=e.length,h=0,d=!1;if(!s)return!1;if((o=e[h])!=="-"&&o!=="+"||(o=e[++h]),o==="0"){if(h+1===s)return!0;if((o=e[++h])==="b"){for(h++;h<s;h++)if((o=e[h])!=="_"){if(o!=="0"&&o!=="1")return!1;d=!0}return d&&o!=="_"}if(o==="x"){for(h++;h<s;h++)if((o=e[h])!=="_"){if(!isHexCode(e.charCodeAt(h)))return!1;d=!0}return d&&o!=="_"}if(o==="o"){for(h++;h<s;h++)if((o=e[h])!=="_"){if(!isOctCode(e.charCodeAt(h)))return!1;d=!0}return d&&o!=="_"}}if(o==="_")return!1;for(;h<s;h++)if((o=e[h])!=="_"){if(!isDecCode(e.charCodeAt(h)))return!1;d=!0}return!(!d||o==="_")}function constructYamlInteger(e){var o,s=e,h=1;if(s.indexOf("_")!==-1&&(s=s.replace(/_/g,"")),(o=s[0])!=="-"&&o!=="+"||(o==="-"&&(h=-1),o=(s=s.slice(1))[0]),s==="0")return 0;if(o==="0"){if(s[1]==="b")return h*parseInt(s.slice(2),2);if(s[1]==="x")return h*parseInt(s.slice(2),16);if(s[1]==="o")return h*parseInt(s.slice(2),8)}return h*parseInt(s,10)}function isInteger(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1==0&&!common.isNegativeZero(e)}var int=new type("tag:yaml.org,2002:int",{kind:"scalar",resolve:resolveYamlInteger,construct:constructYamlInteger,predicate:isInteger,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YAML_FLOAT_PATTERN=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function resolveYamlFloat(e){return e!==null&&!(!YAML_FLOAT_PATTERN.test(e)||e[e.length-1]==="_")}function constructYamlFloat(e){var o,s;return s=(o=e.replace(/_/g,"").toLowerCase())[0]==="-"?-1:1,"+-".indexOf(o[0])>=0&&(o=o.slice(1)),o===".inf"?s===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:o===".nan"?NaN:s*parseFloat(o,10)}var SCIENTIFIC_WITHOUT_DOT=/^[-+]?[0-9]+e/;function representYamlFloat(e,o){var s;if(isNaN(e))switch(o){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(o){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(o){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(common.isNegativeZero(e))return"-0.0";return s=e.toString(10),SCIENTIFIC_WITHOUT_DOT.test(s)?s.replace("e",".e"):s}function isFloat(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!=0||common.isNegativeZero(e))}var float=new type("tag:yaml.org,2002:float",{kind:"scalar",resolve:resolveYamlFloat,construct:constructYamlFloat,predicate:isFloat,represent:representYamlFloat,defaultStyle:"lowercase"}),json=failsafe.extend({implicit:[_null,bool,int,float]}),core=json,YAML_DATE_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),YAML_TIMESTAMP_REGEXP=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function resolveYamlTimestamp(e){return e!==null&&(YAML_DATE_REGEXP.exec(e)!==null||YAML_TIMESTAMP_REGEXP.exec(e)!==null)}function constructYamlTimestamp(e){var o,s,h,d,g,_,j,$,_t=0,_e=null;if((o=YAML_DATE_REGEXP.exec(e))===null&&(o=YAML_TIMESTAMP_REGEXP.exec(e)),o===null)throw new Error("Date resolve error");if(s=+o[1],h=+o[2]-1,d=+o[3],!o[4])return new Date(Date.UTC(s,h,d));if(g=+o[4],_=+o[5],j=+o[6],o[7]){for(_t=o[7].slice(0,3);_t.length<3;)_t+="0";_t=+_t}return o[9]&&(_e=6e4*(60*+o[10]+ +(o[11]||0)),o[9]==="-"&&(_e=-_e)),$=new Date(Date.UTC(s,h,d,g,_,j,_t)),_e&&$.setTime($.getTime()-_e),$}function representYamlTimestamp(e){return e.toISOString()}var timestamp=new type("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:resolveYamlTimestamp,construct:constructYamlTimestamp,instanceOf:Date,represent:representYamlTimestamp});function resolveYamlMerge(e){return e==="<<"||e===null}var merge=new type("tag:yaml.org,2002:merge",{kind:"scalar",resolve:resolveYamlMerge}),BASE64_MAP=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function resolveYamlBinary(e){if(e===null)return!1;var o,s,h=0,d=e.length,g=BASE64_MAP;for(s=0;s<d;s++)if(!((o=g.indexOf(e.charAt(s)))>64)){if(o<0)return!1;h+=6}return h%8==0}function constructYamlBinary(e){var o,s,h=e.replace(/[\r\n=]/g,""),d=h.length,g=BASE64_MAP,_=0,j=[];for(o=0;o<d;o++)o%4==0&&o&&(j.push(_>>16&255),j.push(_>>8&255),j.push(255&_)),_=_<<6|g.indexOf(h.charAt(o));return(s=d%4*6)===0?(j.push(_>>16&255),j.push(_>>8&255),j.push(255&_)):s===18?(j.push(_>>10&255),j.push(_>>2&255)):s===12&&j.push(_>>4&255),new Uint8Array(j)}function representYamlBinary(e){var o,s,h="",d=0,g=e.length,_=BASE64_MAP;for(o=0;o<g;o++)o%3==0&&o&&(h+=_[d>>18&63],h+=_[d>>12&63],h+=_[d>>6&63],h+=_[63&d]),d=(d<<8)+e[o];return(s=g%3)===0?(h+=_[d>>18&63],h+=_[d>>12&63],h+=_[d>>6&63],h+=_[63&d]):s===2?(h+=_[d>>10&63],h+=_[d>>4&63],h+=_[d<<2&63],h+=_[64]):s===1&&(h+=_[d>>2&63],h+=_[d<<4&63],h+=_[64],h+=_[64]),h}function isBinary(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var binary=new type("tag:yaml.org,2002:binary",{kind:"scalar",resolve:resolveYamlBinary,construct:constructYamlBinary,predicate:isBinary,represent:representYamlBinary}),_hasOwnProperty$3=Object.prototype.hasOwnProperty,_toString$2=Object.prototype.toString;function resolveYamlOmap(e){if(e===null)return!0;var o,s,h,d,g,_=[],j=e;for(o=0,s=j.length;o<s;o+=1){if(h=j[o],g=!1,_toString$2.call(h)!=="[object Object]")return!1;for(d in h)if(_hasOwnProperty$3.call(h,d)){if(g)return!1;g=!0}if(!g||_.indexOf(d)!==-1)return!1;_.push(d)}return!0}function constructYamlOmap(e){return e!==null?e:[]}var omap=new type("tag:yaml.org,2002:omap",{kind:"sequence",resolve:resolveYamlOmap,construct:constructYamlOmap}),_toString$1=Object.prototype.toString;function resolveYamlPairs(e){if(e===null)return!0;var o,s,h,d,g,_=e;for(g=new Array(_.length),o=0,s=_.length;o<s;o+=1){if(h=_[o],_toString$1.call(h)!=="[object Object]"||(d=Object.keys(h)).length!==1)return!1;g[o]=[d[0],h[d[0]]]}return!0}function constructYamlPairs(e){if(e===null)return[];var o,s,h,d,g,_=e;for(g=new Array(_.length),o=0,s=_.length;o<s;o+=1)h=_[o],d=Object.keys(h),g[o]=[d[0],h[d[0]]];return g}var pairs=new type("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:resolveYamlPairs,construct:constructYamlPairs}),_hasOwnProperty$2=Object.prototype.hasOwnProperty;function resolveYamlSet(e){if(e===null)return!0;var o,s=e;for(o in s)if(_hasOwnProperty$2.call(s,o)&&s[o]!==null)return!1;return!0}function constructYamlSet(e){return e!==null?e:{}}var set=new type("tag:yaml.org,2002:set",{kind:"mapping",resolve:resolveYamlSet,construct:constructYamlSet}),_default=core.extend({implicit:[timestamp,merge],explicit:[binary,omap,pairs,set]}),_hasOwnProperty$1=Object.prototype.hasOwnProperty,CONTEXT_FLOW_IN=1,CONTEXT_FLOW_OUT=2,CONTEXT_BLOCK_IN=3,CONTEXT_BLOCK_OUT=4,CHOMPING_CLIP=1,CHOMPING_STRIP=2,CHOMPING_KEEP=3,PATTERN_NON_PRINTABLE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PATTERN_NON_ASCII_LINE_BREAKS=/[\x85\u2028\u2029]/,PATTERN_FLOW_INDICATORS=/[,\[\]\{\}]/,PATTERN_TAG_HANDLE=/^(?:!|!!|![a-z\-]+!)$/i,PATTERN_TAG_URI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function _class(e){return Object.prototype.toString.call(e)}function is_EOL(e){return e===10||e===13}function is_WHITE_SPACE(e){return e===9||e===32}function is_WS_OR_EOL(e){return e===9||e===32||e===10||e===13}function is_FLOW_INDICATOR(e){return e===44||e===91||e===93||e===123||e===125}function fromHexCode(e){var o;return 48<=e&&e<=57?e-48:97<=(o=32|e)&&o<=102?o-97+10:-1}function escapedHexLen(e){return e===120?2:e===117?4:e===85?8:0}function fromDecimalCode(e){return 48<=e&&e<=57?e-48:-1}function simpleEscapeSequence(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}function charFromCodepoint(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var simpleEscapeCheck=new Array(256),simpleEscapeMap=new Array(256),i=0;i<256;i++)simpleEscapeCheck[i]=simpleEscapeSequence(i)?1:0,simpleEscapeMap[i]=simpleEscapeSequence(i);function State$1(e,o){this.input=e,this.filename=o.filename||null,this.schema=o.schema||_default,this.onWarning=o.onWarning||null,this.legacy=o.legacy||!1,this.json=o.json||!1,this.listener=o.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function generateError(e,o){var s={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return s.snippet=snippet(s),new exception(o,s)}function throwError(e,o){throw generateError(e,o)}function throwWarning(e,o){e.onWarning&&e.onWarning.call(null,generateError(e,o))}var directiveHandlers={YAML:function(e,o,s){var h,d,g;e.version!==null&&throwError(e,"duplication of %YAML directive"),s.length!==1&&throwError(e,"YAML directive accepts exactly one argument"),(h=/^([0-9]+)\.([0-9]+)$/.exec(s[0]))===null&&throwError(e,"ill-formed argument of the YAML directive"),d=parseInt(h[1],10),g=parseInt(h[2],10),d!==1&&throwError(e,"unacceptable YAML version of the document"),e.version=s[0],e.checkLineBreaks=g<2,g!==1&&g!==2&&throwWarning(e,"unsupported YAML version of the document")},TAG:function(e,o,s){var h,d;s.length!==2&&throwError(e,"TAG directive accepts exactly two arguments"),h=s[0],d=s[1],PATTERN_TAG_HANDLE.test(h)||throwError(e,"ill-formed tag handle (first argument) of the TAG directive"),_hasOwnProperty$1.call(e.tagMap,h)&&throwError(e,'there is a previously declared suffix for "'+h+'" tag handle'),PATTERN_TAG_URI.test(d)||throwError(e,"ill-formed tag prefix (second argument) of the TAG directive");try{d=decodeURIComponent(d)}catch{throwError(e,"tag prefix is malformed: "+d)}e.tagMap[h]=d}};function captureSegment(e,o,s,h){var d,g,_,j;if(o<s){if(j=e.input.slice(o,s),h)for(d=0,g=j.length;d<g;d+=1)(_=j.charCodeAt(d))===9||32<=_&&_<=1114111||throwError(e,"expected valid JSON character");else PATTERN_NON_PRINTABLE.test(j)&&throwError(e,"the stream contains non-printable characters");e.result+=j}}function mergeMappings(e,o,s,h){var d,g,_,j;for(common.isObject(s)||throwError(e,"cannot merge mappings; the provided source object is unacceptable"),_=0,j=(d=Object.keys(s)).length;_<j;_+=1)g=d[_],_hasOwnProperty$1.call(o,g)||(o[g]=s[g],h[g]=!0)}function storeMappingPair(e,o,s,h,d,g,_,j,$){var _t,_e;if(Array.isArray(d))for(_t=0,_e=(d=Array.prototype.slice.call(d)).length;_t<_e;_t+=1)Array.isArray(d[_t])&&throwError(e,"nested arrays are not supported inside keys"),typeof d=="object"&&_class(d[_t])==="[object Object]"&&(d[_t]="[object Object]");if(typeof d=="object"&&_class(d)==="[object Object]"&&(d="[object Object]"),d=String(d),o===null&&(o={}),h==="tag:yaml.org,2002:merge")if(Array.isArray(g))for(_t=0,_e=g.length;_t<_e;_t+=1)mergeMappings(e,o,g[_t],s);else mergeMappings(e,o,g,s);else e.json||_hasOwnProperty$1.call(s,d)||!_hasOwnProperty$1.call(o,d)||(e.line=_||e.line,e.lineStart=j||e.lineStart,e.position=$||e.position,throwError(e,"duplicated mapping key")),d==="__proto__"?Object.defineProperty(o,d,{configurable:!0,enumerable:!0,writable:!0,value:g}):o[d]=g,delete s[d];return o}function readLineBreak(e){var o;(o=e.input.charCodeAt(e.position))===10?e.position++:o===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):throwError(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function skipSeparationSpace(e,o,s){for(var h=0,d=e.input.charCodeAt(e.position);d!==0;){for(;is_WHITE_SPACE(d);)d===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),d=e.input.charCodeAt(++e.position);if(o&&d===35)do d=e.input.charCodeAt(++e.position);while(d!==10&&d!==13&&d!==0);if(!is_EOL(d))break;for(readLineBreak(e),d=e.input.charCodeAt(e.position),h++,e.lineIndent=0;d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position)}return s!==-1&&h!==0&&e.lineIndent<s&&throwWarning(e,"deficient indentation"),h}function testDocumentSeparator(e){var o,s=e.position;return!((o=e.input.charCodeAt(s))!==45&&o!==46||o!==e.input.charCodeAt(s+1)||o!==e.input.charCodeAt(s+2)||(s+=3,(o=e.input.charCodeAt(s))!==0&&!is_WS_OR_EOL(o)))}function writeFoldedLines(e,o){o===1?e.result+=" ":o>1&&(e.result+=common.repeat(`
`,o-1))}function readPlainScalar(e,o,s){var h,d,g,_,j,$,_t,_e,_r=e.kind,_i=e.result;if(is_WS_OR_EOL(_e=e.input.charCodeAt(e.position))||is_FLOW_INDICATOR(_e)||_e===35||_e===38||_e===42||_e===33||_e===124||_e===62||_e===39||_e===34||_e===37||_e===64||_e===96||(_e===63||_e===45)&&(is_WS_OR_EOL(h=e.input.charCodeAt(e.position+1))||s&&is_FLOW_INDICATOR(h)))return!1;for(e.kind="scalar",e.result="",d=g=e.position,_=!1;_e!==0;){if(_e===58){if(is_WS_OR_EOL(h=e.input.charCodeAt(e.position+1))||s&&is_FLOW_INDICATOR(h))break}else if(_e===35){if(is_WS_OR_EOL(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&testDocumentSeparator(e)||s&&is_FLOW_INDICATOR(_e))break;if(is_EOL(_e)){if(j=e.line,$=e.lineStart,_t=e.lineIndent,skipSeparationSpace(e,!1,-1),e.lineIndent>=o){_=!0,_e=e.input.charCodeAt(e.position);continue}e.position=g,e.line=j,e.lineStart=$,e.lineIndent=_t;break}}_&&(captureSegment(e,d,g,!1),writeFoldedLines(e,e.line-j),d=g=e.position,_=!1),is_WHITE_SPACE(_e)||(g=e.position+1),_e=e.input.charCodeAt(++e.position)}return captureSegment(e,d,g,!1),!!e.result||(e.kind=_r,e.result=_i,!1)}function readSingleQuotedScalar(e,o){var s,h,d;if((s=e.input.charCodeAt(e.position))!==39)return!1;for(e.kind="scalar",e.result="",e.position++,h=d=e.position;(s=e.input.charCodeAt(e.position))!==0;)if(s===39){if(captureSegment(e,h,e.position,!0),(s=e.input.charCodeAt(++e.position))!==39)return!0;h=e.position,e.position++,d=e.position}else is_EOL(s)?(captureSegment(e,h,d,!0),writeFoldedLines(e,skipSeparationSpace(e,!1,o)),h=d=e.position):e.position===e.lineStart&&testDocumentSeparator(e)?throwError(e,"unexpected end of the document within a single quoted scalar"):(e.position++,d=e.position);throwError(e,"unexpected end of the stream within a single quoted scalar")}function readDoubleQuotedScalar(e,o){var s,h,d,g,_,j;if((j=e.input.charCodeAt(e.position))!==34)return!1;for(e.kind="scalar",e.result="",e.position++,s=h=e.position;(j=e.input.charCodeAt(e.position))!==0;){if(j===34)return captureSegment(e,s,e.position,!0),e.position++,!0;if(j===92){if(captureSegment(e,s,e.position,!0),is_EOL(j=e.input.charCodeAt(++e.position)))skipSeparationSpace(e,!1,o);else if(j<256&&simpleEscapeCheck[j])e.result+=simpleEscapeMap[j],e.position++;else if((_=escapedHexLen(j))>0){for(d=_,g=0;d>0;d--)(_=fromHexCode(j=e.input.charCodeAt(++e.position)))>=0?g=(g<<4)+_:throwError(e,"expected hexadecimal character");e.result+=charFromCodepoint(g),e.position++}else throwError(e,"unknown escape sequence");s=h=e.position}else is_EOL(j)?(captureSegment(e,s,h,!0),writeFoldedLines(e,skipSeparationSpace(e,!1,o)),s=h=e.position):e.position===e.lineStart&&testDocumentSeparator(e)?throwError(e,"unexpected end of the document within a double quoted scalar"):(e.position++,h=e.position)}throwError(e,"unexpected end of the stream within a double quoted scalar")}function readFlowCollection(e,o){var s,h,d,g,_,j,$,_t,_e,_r,_i,_n,_s=!0,_l=e.tag,Ap=e.anchor,_h=Object.create(null);if((_n=e.input.charCodeAt(e.position))===91)_=93,_t=!1,g=[];else{if(_n!==123)return!1;_=125,_t=!0,g={}}for(e.anchor!==null&&(e.anchorMap[e.anchor]=g),_n=e.input.charCodeAt(++e.position);_n!==0;){if(skipSeparationSpace(e,!0,o),(_n=e.input.charCodeAt(e.position))===_)return e.position++,e.tag=_l,e.anchor=Ap,e.kind=_t?"mapping":"sequence",e.result=g,!0;_s?_n===44&&throwError(e,"expected the node content, but found ','"):throwError(e,"missed comma between flow collection entries"),_i=null,j=$=!1,_n===63&&is_WS_OR_EOL(e.input.charCodeAt(e.position+1))&&(j=$=!0,e.position++,skipSeparationSpace(e,!0,o)),s=e.line,h=e.lineStart,d=e.position,composeNode(e,o,CONTEXT_FLOW_IN,!1,!0),_r=e.tag,_e=e.result,skipSeparationSpace(e,!0,o),_n=e.input.charCodeAt(e.position),!$&&e.line!==s||_n!==58||(j=!0,_n=e.input.charCodeAt(++e.position),skipSeparationSpace(e,!0,o),composeNode(e,o,CONTEXT_FLOW_IN,!1,!0),_i=e.result),_t?storeMappingPair(e,g,_h,_r,_e,_i,s,h,d):j?g.push(storeMappingPair(e,null,_h,_r,_e,_i,s,h,d)):g.push(_e),skipSeparationSpace(e,!0,o),(_n=e.input.charCodeAt(e.position))===44?(_s=!0,_n=e.input.charCodeAt(++e.position)):_s=!1}throwError(e,"unexpected end of the stream within a flow collection")}function readBlockScalar(e,o){var s,h,d,g,_=CHOMPING_CLIP,j=!1,$=!1,_t=o,_e=0,_r=!1;if((g=e.input.charCodeAt(e.position))===124)h=!1;else{if(g!==62)return!1;h=!0}for(e.kind="scalar",e.result="";g!==0;)if((g=e.input.charCodeAt(++e.position))===43||g===45)CHOMPING_CLIP===_?_=g===43?CHOMPING_KEEP:CHOMPING_STRIP:throwError(e,"repeat of a chomping mode identifier");else{if(!((d=fromDecimalCode(g))>=0))break;d===0?throwError(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):$?throwError(e,"repeat of an indentation width identifier"):(_t=o+d-1,$=!0)}if(is_WHITE_SPACE(g)){do g=e.input.charCodeAt(++e.position);while(is_WHITE_SPACE(g));if(g===35)do g=e.input.charCodeAt(++e.position);while(!is_EOL(g)&&g!==0)}for(;g!==0;){for(readLineBreak(e),e.lineIndent=0,g=e.input.charCodeAt(e.position);(!$||e.lineIndent<_t)&&g===32;)e.lineIndent++,g=e.input.charCodeAt(++e.position);if(!$&&e.lineIndent>_t&&(_t=e.lineIndent),is_EOL(g))_e++;else{if(e.lineIndent<_t){_===CHOMPING_KEEP?e.result+=common.repeat(`
`,j?1+_e:_e):_===CHOMPING_CLIP&&j&&(e.result+=`
`);break}for(h?is_WHITE_SPACE(g)?(_r=!0,e.result+=common.repeat(`
`,j?1+_e:_e)):_r?(_r=!1,e.result+=common.repeat(`
`,_e+1)):_e===0?j&&(e.result+=" "):e.result+=common.repeat(`
`,_e):e.result+=common.repeat(`
`,j?1+_e:_e),j=!0,$=!0,_e=0,s=e.position;!is_EOL(g)&&g!==0;)g=e.input.charCodeAt(++e.position);captureSegment(e,s,e.position,!1)}}return!0}function readBlockSequence(e,o){var s,h,d=e.tag,g=e.anchor,_=[],j=!1;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=_),h=e.input.charCodeAt(e.position);h!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,throwError(e,"tab characters must not be used in indentation")),h===45)&&is_WS_OR_EOL(e.input.charCodeAt(e.position+1));)if(j=!0,e.position++,skipSeparationSpace(e,!0,-1)&&e.lineIndent<=o)_.push(null),h=e.input.charCodeAt(e.position);else if(s=e.line,composeNode(e,o,CONTEXT_BLOCK_IN,!1,!0),_.push(e.result),skipSeparationSpace(e,!0,-1),h=e.input.charCodeAt(e.position),(e.line===s||e.lineIndent>o)&&h!==0)throwError(e,"bad indentation of a sequence entry");else if(e.lineIndent<o)break;return!!j&&(e.tag=d,e.anchor=g,e.kind="sequence",e.result=_,!0)}function readBlockMapping(e,o,s){var h,d,g,_,j,$,_t,_e=e.tag,_r=e.anchor,_i={},_n=Object.create(null),_s=null,_l=null,Ap=null,_h=!1,_p=!1;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=_i),_t=e.input.charCodeAt(e.position);_t!==0;){if(_h||e.firstTabInLine===-1||(e.position=e.firstTabInLine,throwError(e,"tab characters must not be used in indentation")),h=e.input.charCodeAt(e.position+1),g=e.line,_t!==63&&_t!==58||!is_WS_OR_EOL(h)){if(_=e.line,j=e.lineStart,$=e.position,!composeNode(e,s,CONTEXT_FLOW_OUT,!1,!0))break;if(e.line===g){for(_t=e.input.charCodeAt(e.position);is_WHITE_SPACE(_t);)_t=e.input.charCodeAt(++e.position);if(_t===58)is_WS_OR_EOL(_t=e.input.charCodeAt(++e.position))||throwError(e,"a whitespace character is expected after the key-value separator within a block mapping"),_h&&(storeMappingPair(e,_i,_n,_s,_l,null,_,j,$),_s=_l=Ap=null),_p=!0,_h=!1,d=!1,_s=e.tag,_l=e.result;else{if(!_p)return e.tag=_e,e.anchor=_r,!0;throwError(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!_p)return e.tag=_e,e.anchor=_r,!0;throwError(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else _t===63?(_h&&(storeMappingPair(e,_i,_n,_s,_l,null,_,j,$),_s=_l=Ap=null),_p=!0,_h=!0,d=!0):_h?(_h=!1,d=!0):throwError(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,_t=h;if((e.line===g||e.lineIndent>o)&&(_h&&(_=e.line,j=e.lineStart,$=e.position),composeNode(e,o,CONTEXT_BLOCK_OUT,!0,d)&&(_h?_l=e.result:Ap=e.result),_h||(storeMappingPair(e,_i,_n,_s,_l,Ap,_,j,$),_s=_l=Ap=null),skipSeparationSpace(e,!0,-1),_t=e.input.charCodeAt(e.position)),(e.line===g||e.lineIndent>o)&&_t!==0)throwError(e,"bad indentation of a mapping entry");else if(e.lineIndent<o)break}return _h&&storeMappingPair(e,_i,_n,_s,_l,null,_,j,$),_p&&(e.tag=_e,e.anchor=_r,e.kind="mapping",e.result=_i),_p}function readTagProperty(e){var o,s,h,d,g=!1,_=!1;if((d=e.input.charCodeAt(e.position))!==33)return!1;if(e.tag!==null&&throwError(e,"duplication of a tag property"),(d=e.input.charCodeAt(++e.position))===60?(g=!0,d=e.input.charCodeAt(++e.position)):d===33?(_=!0,s="!!",d=e.input.charCodeAt(++e.position)):s="!",o=e.position,g){do d=e.input.charCodeAt(++e.position);while(d!==0&&d!==62);e.position<e.length?(h=e.input.slice(o,e.position),d=e.input.charCodeAt(++e.position)):throwError(e,"unexpected end of the stream within a verbatim tag")}else{for(;d!==0&&!is_WS_OR_EOL(d);)d===33&&(_?throwError(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(o-1,e.position+1),PATTERN_TAG_HANDLE.test(s)||throwError(e,"named tag handle cannot contain such characters"),_=!0,o=e.position+1)),d=e.input.charCodeAt(++e.position);h=e.input.slice(o,e.position),PATTERN_FLOW_INDICATORS.test(h)&&throwError(e,"tag suffix cannot contain flow indicator characters")}h&&!PATTERN_TAG_URI.test(h)&&throwError(e,"tag name cannot contain such characters: "+h);try{h=decodeURIComponent(h)}catch{throwError(e,"tag name is malformed: "+h)}return g?e.tag=h:_hasOwnProperty$1.call(e.tagMap,s)?e.tag=e.tagMap[s]+h:s==="!"?e.tag="!"+h:s==="!!"?e.tag="tag:yaml.org,2002:"+h:throwError(e,'undeclared tag handle "'+s+'"'),!0}function readAnchorProperty(e){var o,s;if((s=e.input.charCodeAt(e.position))!==38)return!1;for(e.anchor!==null&&throwError(e,"duplication of an anchor property"),s=e.input.charCodeAt(++e.position),o=e.position;s!==0&&!is_WS_OR_EOL(s)&&!is_FLOW_INDICATOR(s);)s=e.input.charCodeAt(++e.position);return e.position===o&&throwError(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(o,e.position),!0}function readAlias(e){var o,s,h;if((h=e.input.charCodeAt(e.position))!==42)return!1;for(h=e.input.charCodeAt(++e.position),o=e.position;h!==0&&!is_WS_OR_EOL(h)&&!is_FLOW_INDICATOR(h);)h=e.input.charCodeAt(++e.position);return e.position===o&&throwError(e,"name of an alias node must contain at least one character"),s=e.input.slice(o,e.position),_hasOwnProperty$1.call(e.anchorMap,s)||throwError(e,'unidentified alias "'+s+'"'),e.result=e.anchorMap[s],skipSeparationSpace(e,!0,-1),!0}function composeNode(e,o,s,h,d){var g,_,j,$,_t,_e,_r,_i,_n,_s=1,_l=!1,Ap=!1;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,g=_=j=CONTEXT_BLOCK_OUT===s||CONTEXT_BLOCK_IN===s,h&&skipSeparationSpace(e,!0,-1)&&(_l=!0,e.lineIndent>o?_s=1:e.lineIndent===o?_s=0:e.lineIndent<o&&(_s=-1)),_s===1)for(;readTagProperty(e)||readAnchorProperty(e);)skipSeparationSpace(e,!0,-1)?(_l=!0,j=g,e.lineIndent>o?_s=1:e.lineIndent===o?_s=0:e.lineIndent<o&&(_s=-1)):j=!1;if(j&&(j=_l||d),_s!==1&&CONTEXT_BLOCK_OUT!==s||(_i=CONTEXT_FLOW_IN===s||CONTEXT_FLOW_OUT===s?o:o+1,_n=e.position-e.lineStart,_s===1?j&&(readBlockSequence(e,_n)||readBlockMapping(e,_n,_i))||readFlowCollection(e,_i)?Ap=!0:(_&&readBlockScalar(e,_i)||readSingleQuotedScalar(e,_i)||readDoubleQuotedScalar(e,_i)?Ap=!0:readAlias(e)?(Ap=!0,e.tag===null&&e.anchor===null||throwError(e,"alias node should not have any properties")):readPlainScalar(e,_i,CONTEXT_FLOW_IN===s)&&(Ap=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):_s===0&&(Ap=j&&readBlockSequence(e,_n))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&throwError(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),$=0,_t=e.implicitTypes.length;$<_t;$+=1)if((_r=e.implicitTypes[$]).resolve(e.result)){e.result=_r.construct(e.result),e.tag=_r.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(_hasOwnProperty$1.call(e.typeMap[e.kind||"fallback"],e.tag))_r=e.typeMap[e.kind||"fallback"][e.tag];else for(_r=null,$=0,_t=(_e=e.typeMap.multi[e.kind||"fallback"]).length;$<_t;$+=1)if(e.tag.slice(0,_e[$].tag.length)===_e[$].tag){_r=_e[$];break}_r||throwError(e,"unknown tag !<"+e.tag+">"),e.result!==null&&_r.kind!==e.kind&&throwError(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+_r.kind+'", not "'+e.kind+'"'),_r.resolve(e.result,e.tag)?(e.result=_r.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):throwError(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||Ap}function readDocument(e){var o,s,h,d,g=e.position,_=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(d=e.input.charCodeAt(e.position))!==0&&(skipSeparationSpace(e,!0,-1),d=e.input.charCodeAt(e.position),!(e.lineIndent>0||d!==37));){for(_=!0,d=e.input.charCodeAt(++e.position),o=e.position;d!==0&&!is_WS_OR_EOL(d);)d=e.input.charCodeAt(++e.position);for(h=[],(s=e.input.slice(o,e.position)).length<1&&throwError(e,"directive name must not be less than one character in length");d!==0;){for(;is_WHITE_SPACE(d);)d=e.input.charCodeAt(++e.position);if(d===35){do d=e.input.charCodeAt(++e.position);while(d!==0&&!is_EOL(d));break}if(is_EOL(d))break;for(o=e.position;d!==0&&!is_WS_OR_EOL(d);)d=e.input.charCodeAt(++e.position);h.push(e.input.slice(o,e.position))}d!==0&&readLineBreak(e),_hasOwnProperty$1.call(directiveHandlers,s)?directiveHandlers[s](e,s,h):throwWarning(e,'unknown document directive "'+s+'"')}skipSeparationSpace(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,skipSeparationSpace(e,!0,-1)):_&&throwError(e,"directives end mark is expected"),composeNode(e,e.lineIndent-1,CONTEXT_BLOCK_OUT,!1,!0),skipSeparationSpace(e,!0,-1),e.checkLineBreaks&&PATTERN_NON_ASCII_LINE_BREAKS.test(e.input.slice(g,e.position))&&throwWarning(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&testDocumentSeparator(e)?e.input.charCodeAt(e.position)===46&&(e.position+=3,skipSeparationSpace(e,!0,-1)):e.position<e.length-1&&throwError(e,"end of the stream or a document separator is expected")}function loadDocuments(e,o){o=o||{},(e=String(e)).length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var s=new State$1(e,o),h=e.indexOf("\0");for(h!==-1&&(s.position=h,throwError(s,"null byte is not allowed in input")),s.input+="\0";s.input.charCodeAt(s.position)===32;)s.lineIndent+=1,s.position+=1;for(;s.position<s.length-1;)readDocument(s);return s.documents}function loadAll$1(e,o,s){o!==null&&typeof o=="object"&&s===void 0&&(s=o,o=null);var h=loadDocuments(e,s);if(typeof o!="function")return h;for(var d=0,g=h.length;d<g;d+=1)o(h[d])}function load$1(e,o){var s=loadDocuments(e,o);if(s.length!==0){if(s.length===1)return s[0];throw new exception("expected a single document in the stream, but found more")}}var loadAll_1=loadAll$1,load_1=load$1,loader={loadAll:loadAll_1,load:load_1},_toString=Object.prototype.toString,_hasOwnProperty=Object.prototype.hasOwnProperty,CHAR_BOM=65279,CHAR_TAB=9,CHAR_LINE_FEED=10,CHAR_CARRIAGE_RETURN=13,CHAR_SPACE=32,CHAR_EXCLAMATION=33,CHAR_DOUBLE_QUOTE=34,CHAR_SHARP=35,CHAR_PERCENT=37,CHAR_AMPERSAND=38,CHAR_SINGLE_QUOTE=39,CHAR_ASTERISK=42,CHAR_COMMA=44,CHAR_MINUS=45,CHAR_COLON=58,CHAR_EQUALS=61,CHAR_GREATER_THAN=62,CHAR_QUESTION=63,CHAR_COMMERCIAL_AT=64,CHAR_LEFT_SQUARE_BRACKET=91,CHAR_RIGHT_SQUARE_BRACKET=93,CHAR_GRAVE_ACCENT=96,CHAR_LEFT_CURLY_BRACKET=123,CHAR_VERTICAL_LINE=124,CHAR_RIGHT_CURLY_BRACKET=125,ESCAPE_SEQUENCES={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},DEPRECATED_BOOLEANS_SYNTAX=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],DEPRECATED_BASE60_SYNTAX=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function compileStyleMap(e,o){var s,h,d,g,_,j,$;if(o===null)return{};for(s={},d=0,g=(h=Object.keys(o)).length;d<g;d+=1)_=h[d],j=String(o[_]),_.slice(0,2)==="!!"&&(_="tag:yaml.org,2002:"+_.slice(2)),($=e.compiledTypeMap.fallback[_])&&_hasOwnProperty.call($.styleAliases,j)&&(j=$.styleAliases[j]),s[_]=j;return s}function encodeHex(e){var o,s,h;if(o=e.toString(16).toUpperCase(),e<=255)s="x",h=2;else if(e<=65535)s="u",h=4;else{if(!(e<=4294967295))throw new exception("code point within a string may not be greater than 0xFFFFFFFF");s="U",h=8}return"\\"+s+common.repeat("0",h-o.length)+o}var QUOTING_TYPE_SINGLE=1,QUOTING_TYPE_DOUBLE=2;function State(e){this.schema=e.schema||_default,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=common.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=compileStyleMap(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?QUOTING_TYPE_DOUBLE:QUOTING_TYPE_SINGLE,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function indentString(e,o){for(var s,h=common.repeat(" ",o),d=0,g=-1,_="",j=e.length;d<j;)(g=e.indexOf(`
`,d))===-1?(s=e.slice(d),d=j):(s=e.slice(d,g+1),d=g+1),s.length&&s!==`
`&&(_+=h),_+=s;return _}function generateNextLine(e,o){return`
`+common.repeat(" ",e.indent*o)}function testImplicitResolving(e,o){var s,h;for(s=0,h=e.implicitTypes.length;s<h;s+=1)if(e.implicitTypes[s].resolve(o))return!0;return!1}function isWhitespace(e){return e===CHAR_SPACE||e===CHAR_TAB}function isPrintable(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==CHAR_BOM||65536<=e&&e<=1114111}function isNsCharOrWhitespace(e){return isPrintable(e)&&e!==CHAR_BOM&&e!==CHAR_CARRIAGE_RETURN&&e!==CHAR_LINE_FEED}function isPlainSafe(e,o,s){var h=isNsCharOrWhitespace(e),d=h&&!isWhitespace(e);return(s?h:h&&e!==CHAR_COMMA&&e!==CHAR_LEFT_SQUARE_BRACKET&&e!==CHAR_RIGHT_SQUARE_BRACKET&&e!==CHAR_LEFT_CURLY_BRACKET&&e!==CHAR_RIGHT_CURLY_BRACKET)&&e!==CHAR_SHARP&&!(o===CHAR_COLON&&!d)||isNsCharOrWhitespace(o)&&!isWhitespace(o)&&e===CHAR_SHARP||o===CHAR_COLON&&d}function isPlainSafeFirst(e){return isPrintable(e)&&e!==CHAR_BOM&&!isWhitespace(e)&&e!==CHAR_MINUS&&e!==CHAR_QUESTION&&e!==CHAR_COLON&&e!==CHAR_COMMA&&e!==CHAR_LEFT_SQUARE_BRACKET&&e!==CHAR_RIGHT_SQUARE_BRACKET&&e!==CHAR_LEFT_CURLY_BRACKET&&e!==CHAR_RIGHT_CURLY_BRACKET&&e!==CHAR_SHARP&&e!==CHAR_AMPERSAND&&e!==CHAR_ASTERISK&&e!==CHAR_EXCLAMATION&&e!==CHAR_VERTICAL_LINE&&e!==CHAR_EQUALS&&e!==CHAR_GREATER_THAN&&e!==CHAR_SINGLE_QUOTE&&e!==CHAR_DOUBLE_QUOTE&&e!==CHAR_PERCENT&&e!==CHAR_COMMERCIAL_AT&&e!==CHAR_GRAVE_ACCENT}function isPlainSafeLast(e){return!isWhitespace(e)&&e!==CHAR_COLON}function codePointAt(e,o){var s,h=e.charCodeAt(o);return h>=55296&&h<=56319&&o+1<e.length&&(s=e.charCodeAt(o+1))>=56320&&s<=57343?1024*(h-55296)+s-56320+65536:h}function needIndentIndicator(e){return/^\n* /.test(e)}var STYLE_PLAIN=1,STYLE_SINGLE=2,STYLE_LITERAL=3,STYLE_FOLDED=4,STYLE_DOUBLE=5;function chooseScalarStyle(e,o,s,h,d,g,_,j){var $,_t=0,_e=null,_r=!1,_i=!1,_n=h!==-1,_s=-1,_l=isPlainSafeFirst(codePointAt(e,0))&&isPlainSafeLast(codePointAt(e,e.length-1));if(o||_)for($=0;$<e.length;_t>=65536?$+=2:$++){if(!isPrintable(_t=codePointAt(e,$)))return STYLE_DOUBLE;_l=_l&&isPlainSafe(_t,_e,j),_e=_t}else{for($=0;$<e.length;_t>=65536?$+=2:$++){if((_t=codePointAt(e,$))===CHAR_LINE_FEED)_r=!0,_n&&(_i=_i||$-_s-1>h&&e[_s+1]!==" ",_s=$);else if(!isPrintable(_t))return STYLE_DOUBLE;_l=_l&&isPlainSafe(_t,_e,j),_e=_t}_i=_i||_n&&$-_s-1>h&&e[_s+1]!==" "}return _r||_i?s>9&&needIndentIndicator(e)?STYLE_DOUBLE:_?g===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE:_i?STYLE_FOLDED:STYLE_LITERAL:!_l||_||d(e)?g===QUOTING_TYPE_DOUBLE?STYLE_DOUBLE:STYLE_SINGLE:STYLE_PLAIN}function writeScalar(e,o,s,h,d){e.dump=function(){if(o.length===0)return e.quotingType===QUOTING_TYPE_DOUBLE?'""':"''";if(!e.noCompatMode&&(DEPRECATED_BOOLEANS_SYNTAX.indexOf(o)!==-1||DEPRECATED_BASE60_SYNTAX.test(o)))return e.quotingType===QUOTING_TYPE_DOUBLE?'"'+o+'"':"'"+o+"'";var g=e.indent*Math.max(1,s),_=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-g),j=h||e.flowLevel>-1&&s>=e.flowLevel;switch(chooseScalarStyle(o,j,e.indent,_,function($){return testImplicitResolving(e,$)},e.quotingType,e.forceQuotes&&!h,d)){case STYLE_PLAIN:return o;case STYLE_SINGLE:return"'"+o.replace(/'/g,"''")+"'";case STYLE_LITERAL:return"|"+blockHeader(o,e.indent)+dropEndingNewline(indentString(o,g));case STYLE_FOLDED:return">"+blockHeader(o,e.indent)+dropEndingNewline(indentString(foldString(o,_),g));case STYLE_DOUBLE:return'"'+escapeString(o)+'"';default:throw new exception("impossible error: invalid scalar style")}}()}function blockHeader(e,o){var s=needIndentIndicator(e)?String(o):"",h=e[e.length-1]===`
`;return s+(h&&(e[e.length-2]===`
`||e===`
`)?"+":h?"":"-")+`
`}function dropEndingNewline(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function foldString(e,o){for(var s,h,d,g=/(\n+)([^\n]*)/g,_=(s=(s=e.indexOf(`
`))!==-1?s:e.length,g.lastIndex=s,foldLine(e.slice(0,s),o)),j=e[0]===`
`||e[0]===" ";d=g.exec(e);){var $=d[1],_t=d[2];h=_t[0]===" ",_+=$+(j||h||_t===""?"":`
`)+foldLine(_t,o),j=h}return _}function foldLine(e,o){if(e===""||e[0]===" ")return e;for(var s,h,d=/ [^ ]/g,g=0,_=0,j=0,$="";s=d.exec(e);)(j=s.index)-g>o&&(h=_>g?_:j,$+=`
`+e.slice(g,h),g=h+1),_=j;return $+=`
`,e.length-g>o&&_>g?$+=e.slice(g,_)+`
`+e.slice(_+1):$+=e.slice(g),$.slice(1)}function escapeString(e){for(var o,s="",h=0,d=0;d<e.length;h>=65536?d+=2:d++)h=codePointAt(e,d),!(o=ESCAPE_SEQUENCES[h])&&isPrintable(h)?(s+=e[d],h>=65536&&(s+=e[d+1])):s+=o||encodeHex(h);return s}function writeFlowSequence(e,o,s){var h,d,g,_="",j=e.tag;for(h=0,d=s.length;h<d;h+=1)g=s[h],e.replacer&&(g=e.replacer.call(s,String(h),g)),(writeNode(e,o,g,!1,!1)||g===void 0&&writeNode(e,o,null,!1,!1))&&(_!==""&&(_+=","+(e.condenseFlow?"":" ")),_+=e.dump);e.tag=j,e.dump="["+_+"]"}function writeBlockSequence(e,o,s,h){var d,g,_,j="",$=e.tag;for(d=0,g=s.length;d<g;d+=1)_=s[d],e.replacer&&(_=e.replacer.call(s,String(d),_)),(writeNode(e,o+1,_,!0,!0,!1,!0)||_===void 0&&writeNode(e,o+1,null,!0,!0,!1,!0))&&(h&&j===""||(j+=generateNextLine(e,o)),e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?j+="-":j+="- ",j+=e.dump);e.tag=$,e.dump=j||"[]"}function writeFlowMapping(e,o,s){var h,d,g,_,j,$="",_t=e.tag,_e=Object.keys(s);for(h=0,d=_e.length;h<d;h+=1)j="",$!==""&&(j+=", "),e.condenseFlow&&(j+='"'),_=s[g=_e[h]],e.replacer&&(_=e.replacer.call(s,g,_)),writeNode(e,o,g,!1,!1)&&(e.dump.length>1024&&(j+="? "),j+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),writeNode(e,o,_,!1,!1)&&($+=j+=e.dump));e.tag=_t,e.dump="{"+$+"}"}function writeBlockMapping(e,o,s,h){var d,g,_,j,$,_t,_e="",_r=e.tag,_i=Object.keys(s);if(e.sortKeys===!0)_i.sort();else if(typeof e.sortKeys=="function")_i.sort(e.sortKeys);else if(e.sortKeys)throw new exception("sortKeys must be a boolean or a function");for(d=0,g=_i.length;d<g;d+=1)_t="",h&&_e===""||(_t+=generateNextLine(e,o)),j=s[_=_i[d]],e.replacer&&(j=e.replacer.call(s,_,j)),writeNode(e,o+1,_,!0,!0,!0)&&(($=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024)&&(e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?_t+="?":_t+="? "),_t+=e.dump,$&&(_t+=generateNextLine(e,o)),writeNode(e,o+1,j,!0,$)&&(e.dump&&CHAR_LINE_FEED===e.dump.charCodeAt(0)?_t+=":":_t+=": ",_e+=_t+=e.dump));e.tag=_r,e.dump=_e||"{}"}function detectType(e,o,s){var h,d,g,_,j,$;for(g=0,_=(d=s?e.explicitTypes:e.implicitTypes).length;g<_;g+=1)if(((j=d[g]).instanceOf||j.predicate)&&(!j.instanceOf||typeof o=="object"&&o instanceof j.instanceOf)&&(!j.predicate||j.predicate(o))){if(s?j.multi&&j.representName?e.tag=j.representName(o):e.tag=j.tag:e.tag="?",j.represent){if($=e.styleMap[j.tag]||j.defaultStyle,_toString.call(j.represent)==="[object Function]")h=j.represent(o,$);else{if(!_hasOwnProperty.call(j.represent,$))throw new exception("!<"+j.tag+'> tag resolver accepts not "'+$+'" style');h=j.represent[$](o,$)}e.dump=h}return!0}return!1}function writeNode(e,o,s,h,d,g,_){e.tag=null,e.dump=s,detectType(e,s,!1)||detectType(e,s,!0);var j,$=_toString.call(e.dump),_t=h;h&&(h=e.flowLevel<0||e.flowLevel>o);var _e,_r,_i=$==="[object Object]"||$==="[object Array]";if(_i&&(_r=(_e=e.duplicates.indexOf(s))!==-1),(e.tag!==null&&e.tag!=="?"||_r||e.indent!==2&&o>0)&&(d=!1),_r&&e.usedDuplicates[_e])e.dump="*ref_"+_e;else{if(_i&&_r&&!e.usedDuplicates[_e]&&(e.usedDuplicates[_e]=!0),$==="[object Object]")h&&Object.keys(e.dump).length!==0?(writeBlockMapping(e,o,e.dump,d),_r&&(e.dump="&ref_"+_e+e.dump)):(writeFlowMapping(e,o,e.dump),_r&&(e.dump="&ref_"+_e+" "+e.dump));else if($==="[object Array]")h&&e.dump.length!==0?(e.noArrayIndent&&!_&&o>0?writeBlockSequence(e,o-1,e.dump,d):writeBlockSequence(e,o,e.dump,d),_r&&(e.dump="&ref_"+_e+e.dump)):(writeFlowSequence(e,o,e.dump),_r&&(e.dump="&ref_"+_e+" "+e.dump));else{if($!=="[object String]"){if($==="[object Undefined]"||e.skipInvalid)return!1;throw new exception("unacceptable kind of an object to dump "+$)}e.tag!=="?"&&writeScalar(e,e.dump,o,g,_t)}e.tag!==null&&e.tag!=="?"&&(j=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),j=e.tag[0]==="!"?"!"+j:j.slice(0,18)==="tag:yaml.org,2002:"?"!!"+j.slice(18):"!<"+j+">",e.dump=j+" "+e.dump)}return!0}function getDuplicateReferences(e,o){var s,h,d=[],g=[];for(inspectNode(e,d,g),s=0,h=g.length;s<h;s+=1)o.duplicates.push(d[g[s]]);o.usedDuplicates=new Array(h)}function inspectNode(e,o,s){var h,d,g;if(e!==null&&typeof e=="object")if((d=o.indexOf(e))!==-1)s.indexOf(d)===-1&&s.push(d);else if(o.push(e),Array.isArray(e))for(d=0,g=e.length;d<g;d+=1)inspectNode(e[d],o,s);else for(d=0,g=(h=Object.keys(e)).length;d<g;d+=1)inspectNode(e[h[d]],o,s)}function dump$1(e,o){var s=new State(o=o||{});s.noRefs||getDuplicateReferences(e,s);var h=e;return s.replacer&&(h=s.replacer.call({"":h},"",h)),writeNode(s,0,h,!0,!0)?s.dump+`
`:""}var dump_1=dump$1,dumper={dump:dump_1};function renamed(e,o){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+o+" instead, which is now safe by default.")}}var Type=type,Schema=schema,FAILSAFE_SCHEMA=failsafe,JSON_SCHEMA=json,CORE_SCHEMA=core,DEFAULT_SCHEMA=_default,load=loader.load,loadAll=loader.loadAll,dump=dumper.dump,YAMLException=exception,types={binary,float,map,null:_null,pairs,set,timestamp,bool,int,merge,omap,seq,str},safeLoad=renamed("safeLoad","load"),safeLoadAll=renamed("safeLoadAll","loadAll"),safeDump=renamed("safeDump","dump"),jsYaml={Type,Schema,FAILSAFE_SCHEMA,JSON_SCHEMA,CORE_SCHEMA,DEFAULT_SCHEMA,load,loadAll,dump,YAMLException,types,safeLoad,safeLoadAll,safeDump},SceneBundle=function(){return _createClass(function e(o,s){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;_classCallCheck(this,e),this.url=o,!s||isRelativeURL(s)&&!isRelativeURL(this.url)?this.path=pathForURL(this.url):this.path=s,this.path_for_parent=s||this.path,this.parent=h,this.container=null,this.parent&&(this.parent.container?this.container=this.parent.container:this.parent.isContainer()&&(this.container=this.parent))},[{key:"load",value:function(){return loadResource(this.url)}},{key:"resourceFor",value:function(e){return{url:this.urlFor(e),path:this.pathFor(e),type:this.typeFor(e)}}},{key:"urlFor",value:function(e){return isGlobal(e)?e:isRelativeURL(e)&&this.container?this.parent.urlFor(this.path_for_parent+e):addBaseURL(e,this.path)}},{key:"pathFor",value:function(e){return pathForURL(e)}},{key:"typeFor",value:function(e){return extensionForURL(e)}},{key:"isContainer",value:function(){return!1}}])}();function createSceneBundle(e,o,s){return new SceneBundle(e,o,s)}function isGlobal(e){return!(!e||e.slice(0,7)!=="global.")}function parseResource(e){var o;try{o=jsYaml.load(e,{json:!0})}catch(s){throw s}return o}function loadResource(e){return new Promise(function(o,s){typeof e=="string"?Utils$1.io(e).then(function(h){try{var d=parseResource(h);o(d)}catch(g){s(g)}},s):(e=Object.assign({},e),o(e))})}function notNull(e){return e!=null}function wrap(e){return"("+e+")"}function maybeQuote(e){return typeof e=="string"?'"'+e+'"':e}function lookUp(e){return e[0]==="$"?"context['"+e.substring(1)+"']":"context.feature.properties['"+e+"']"}function nullValue(e,o){return" true "}function propertyEqual(e,o){return wrap(maybeQuote(o)+" === "+lookUp(e))}function propertyOr(e,o){return wrap(o.map(function(s){return propertyEqual(e,s)}).join(" || "))}function printNested(e,o){return wrap(e.filter(notNull).map(function(s){return wrap(s.join(" && "))}).join(" "+o+" "))}function any(e,o,s){return o&&o.length>0?printNested(o.map(function(h){return parseFilter(h,s)}),"||"):"true"}function all(e,o,s){return o&&o.length>0?printNested(o.map(function(h){return parseFilter(h,s)}),"&&"):"true"}function not(e,o,s){return"!"+wrap(parseFilter(o,s).join(" && "))}function none(e,o,s){return"!"+wrap(any(null,o,s))}function propertyMatchesBoolean(e,o){return wrap(lookUp(e)+(o?" != ":" == ")+"null")}function rangeMatch(e,o,s){var h=[],d=s&&typeof s.rangeTransform=="function"&&s.rangeTransform;if(o.max){var g=d?d(o.max):o.max;h.push(lookUp(e)+" < "+g)}if(o.min){var _=d?_=d(o.min):o.min;h.push(lookUp(e)+" >= "+_)}return wrap(h.join(" && "))}function parseFilter(e,o){var s=[];if(typeof e=="function")return[wrap(e.toString()+"(context)")];if(Array.isArray(e))return[any(null,e,o)];if(e==null)return["true"];for(var h=Object.keys(e),d=0;d<h.length;d++){var g=h[d],_=e[g],j=_typeof(_);if(j==="string"||j==="number")s.push(propertyEqual(g,_));else if(j==="boolean")s.push(propertyMatchesBoolean(g,_));else if(g==="not")s.push(not(g,_,o));else if(g==="any")s.push(any(g,_,o));else if(g==="all")s.push(all(g,_,o));else if(g==="none")s.push(none(g,_,o));else if(Array.isArray(_))s.push(propertyOr(g,_));else if(j==="object"&&_!=null)(_.max||_.min)&&s.push(rangeMatch(g,_,o));else{if(_!=null)throw new Error("Unknown Query syntax: "+_);s.push(nullValue())}}return h.length===0?["true"]:s}function filterToString(e){return wrap(e.join(" && "))}function buildFilter(e,o){return e==null?function(){return!0}:new Function("context","return "+filterToString(parseFilter(e,o))+";")}var reserved=["filter","draw","visible","enabled","data"],layer_cache={};function cacheKey(e){if(e.length>1){for(var o=e[0],s=1;s<e.length;s++)o+="/"+e[s];return o}return e[0]}function mergeTrees(e,o){for(var s,h=0,d=0;d<e.length;d++)e[d].length>h&&(h=e[d].length);if(h===0)return null;for(var g={visible:!0},_=function($){if(s=[],e.forEach(function(_t){_t[$]&&_t[$][o]&&s.indexOf(_t[$][o])===-1&&s.push(_t[$][o])}),s.length===0)return 1;s.sort(function(_t,_e){return(_t&&_t.layer_name)>(_e&&_e.layer_name)?1:-1}),mergeObjects.apply(void 0,[g].concat(_toConsumableArray(s))),delete g.layer_name},j=0;j<h;j++)_(j);return g.visible===!1?null:g}var blacklist=["any","all","not","none"],Layer=function(){return _createClass(function e(o){var s=o.layer,h=o.name,d=o.parent,g=o.draw,_=o.visible,j=o.enabled,$=o.filter,_t=o.styles;if(_classCallCheck(this,e),this.id=e.id++,this.config_data=s.data,this.parent=d,this.name=h,this.full_name=this.parent?this.parent.full_name+":"+this.name:this.name,this.draw=g,this.filter=$,this.styles=_t,this.is_built=!1,j=j===void 0?_:j,this.parent&&this.parent.visible===!1?this.enabled=!1:this.enabled=j!==!1,this.draw)for(var _e in this.draw)if(this.draw[_e]=this.draw[_e]==null?{}:this.draw[_e],_typeof(this.draw[_e])!=="object"){var _r="Draw group '".concat(_e,"' for layer ").concat(this.full_name," is invalid, must be an object, ");log("warn",_r+="but was set to `".concat(_e,": ").concat(this.draw[_e],"` instead")),delete this.draw[_e]}else this.draw[_e].layer_name=this.full_name},[{key:"build",value:function(){log("trace","Building layer '".concat(this.full_name,"'")),this.buildFilter(),this.buildDraw(),this.is_built=!0}},{key:"buildDraw",value:function(){this.draw=Utils$1.stringsToFunctions(this.draw,StyleParser.wrapFunction),this.calculatedDraw=calculateDraw(this)}},{key:"buildFilter",value:function(){this.filter_original=this.filter,this.filter=Utils$1.stringsToFunctions(this.filter,StyleParser.wrapFunction);var e=_typeof(this.filter);if(this.filter==null||e==="object"||e==="function")try{this.buildZooms(),this.buildPropMatches(),this.filter!=null&&(typeof this.filter=="function"||Object.keys(this.filter).length>0)?this.filter=buildFilter(this.filter,FilterOptions):this.filter=null}catch(h){var o="Filter for layer ".concat(this.full_name," is invalid, `filter: ").concat(JSON.stringify(this.filter),"` ");log("warn",o+="failed with error '".concat(h.message,"', stack trace: ").concat(h.stack))}else{var s="Filter for layer ".concat(this.full_name," is invalid, filter value must be an object or function, ");log("warn",s+="but was set to `filter: ".concat(this.filter,"` instead"))}}},{key:"buildZooms",value:function(){var e=this.filter&&this.filter.$zoom,o=_typeof(e);if(e!=null&&o!=="function"){if(this.zooms={},o==="number")this.zooms[e]=!0;else if(Array.isArray(e))for(var s=0;s<e.length;s++)this.zooms[e[s]]=!0;else if(o==="object"&&(e.min!=null||e.max!=null))for(var h=e.min||0,d=e.max||25,g=h;g<d;g++)this.zooms[g]=!0;delete this.filter.$zoom}}},{key:"buildPropMatches",value:function(){var e=this;this.filter&&!Array.isArray(this.filter)&&typeof this.filter!="function"&&Object.keys(this.filter).forEach(function(o){if(blacklist.indexOf(o)===-1){var s=e.filter[o],h=_typeof(s),d=Array.isArray(s);if(!d&&h!=="string"&&h!=="number")return;o[0]==="$"?(e.context_prop_matches=e.context_prop_matches||[],e.context_prop_matches.push([o.substring(1),d?s:[s]])):(e.feature_prop_matches=e.feature_prop_matches||[],e.feature_prop_matches.push([o,d?s:[s]])),delete e.filter[o]}})}},{key:"doPropMatches",value:function(e){if(this.feature_prop_matches)for(var o=0;o<this.feature_prop_matches.length;o++){var s=this.feature_prop_matches[o],h=e.feature.properties[s[0]];if(h==null||s[1].indexOf(h)===-1)return!1}if(this.context_prop_matches)for(var d=0;d<this.context_prop_matches.length;d++){var g=this.context_prop_matches[d],_=e[g[0]];if(_==null||g[1].indexOf(_)===-1)return!1}return!0}},{key:"doesMatch",value:function(e){if(!this.enabled||(this.is_built||this.build(),this.zooms!=null&&!this.zooms[e.zoom])||!this.doPropMatches(e))return!1;var o;if(this.filter instanceof Function)try{o=this.filter(e)}catch(h){var s="Filter for this ".concat(this.full_name,": `filter: ").concat(this.filter_original,"` ");log("error",s+="failed with error '".concat(h.message,"', stack trace: ").concat(h.stack),e.feature)}else o=this.filter==null;return!!o&&(this.children_to_parse&&(parseLayerChildren(this,this.children_to_parse,this.styles),delete this.children_to_parse),!0)}}])}();Layer.id=0;var LayerLeaf=function(e){function o(s){var h;return _classCallCheck(this,o),(h=_callSuper(this,o,[s])).is_leaf=!0,h}return _inherits(o,e),_createClass(o)}(Layer),LayerTree=function(e){function o(s){var h;return _classCallCheck(this,o),(h=_callSuper(this,o,[s])).is_tree=!0,h.layers=s.layers||[],h}return _inherits(o,e),_createClass(o,[{key:"addLayer",value:function(s){this.layers.push(s)}},{key:"buildDrawGroups",value:function(s){var h=[],d=[];if(matchFeature(s,[this],h,d),h.length>0){var g=cacheKey(d);if(layer_cache[g]===void 0){for(var _=h.map(function(_s){return _s&&_s.visible!==!1&&_s.calculatedDraw}),j={},$=0;$<_.length;$++){var _t=_[$];if(_t)for(var _e=0;_e<_t.length;_e++){var _r=_t[_e];for(var _i in _r)j[_i]=!0}}for(var _n in j)layer_cache[g]=layer_cache[g]||{},layer_cache[g][_n]=mergeTrees(_,_n),layer_cache[g][_n]?(layer_cache[g][_n].key=g+"/"+_n,layer_cache[g][_n].layers=h.map(function(_s){return _s&&_s.full_name}),layer_cache[g][_n].group=_n):delete layer_cache[g][_n];layer_cache[g]&&Object.keys(layer_cache[g]).length===0&&(layer_cache[g]=null)}return layer_cache[g]}}}])}(Layer),FilterOptions={rangeTransform:function(e){return typeof e=="string"&&e.trim().slice(-3)==="px2"?"".concat(parseFloat(e)," * context.meters_per_pixel_sq"):e}},SceneLoader;function isReserved(e){return reserved.indexOf(e)>-1}function isEmpty(e){return Object.keys(e).length===0}function groupProps(e){var o={},s={};for(var h in e)isReserved(h)?o[h]=e[h]:s[h]=e[h];return[o,s]}function calculateDraw(e){var o=[];if(e.parent){var s=e.parent.calculatedDraw||[];o.push.apply(o,_toConsumableArray(s))}return o.push(e.draw),o}function parseLayerNode(e,o,s,h){var d={name:e,layer:o=o??{},parent:s,styles:h},g=_slicedToArray(groupProps(o),2),_=g[0],j=g[1],$=isEmpty(j),_t=new($&&s!=null?LayerLeaf:LayerTree)(Object.assign(d,_));return _t.enabled&&(s&&s.addLayer(_t),_t.children_to_parse=$?null:j),_t}function parseLayerChildren(e,o,s){for(var h in o){var d=o[h];if(_typeof(d)!=="object"||Array.isArray(d)){var g="Layer value must be an object: cannot create layer '".concat(h,": ").concat(JSON.stringify(d),"'");g+=", under parent layer '".concat(e.full_name,"'."),s[e.name]&&(g+=" The parent name '".concat(e.name,"' is also the name of a style, did you mean to create a 'draw' group"),e.parent&&(g+=" under '".concat(e.parent.name,"'")),g+=" instead?"),log("warn",g)}else parseLayerNode(h,d,e,s)}}function parseLayers(e,o){layer_cache={};var s={};for(var h in e){var d=e[h];d&&(s[h]=parseLayerNode(h,d,null,o))}return s}function matchFeature(e,o,s,h){var d=!1;if(o.length!==0){for(var g=0;g<o.length;g++){var _=o[g];_.is_leaf?_.doesMatch(e)&&(d=!0,s.push(_),h.push(_.id)):_.is_tree&&_.doesMatch(e)&&(d=!0,matchFeature(e,_.layers,s,h)||(s.push(_),h.push(_.id)))}return d}}var GLOBAL_PROP_RGX=/^global\.(.+)$/,SceneLoader$1=SceneLoader={loadScene:function(e){var o=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=s.path,d=s.type,g=[];return this.loadSceneRecursive({url:e,path:h,type:d},null,g).then(function(_){return o.finalize(_)}).then(function(_){var j=_.config,$=_.bundle;return j?(g.length>0&&g.forEach(function(_t){var _e="Failed to import scene: ".concat(_t.url);log("error",_e,_t),o.trigger("error",{type:"scene_import",message:_e,error:_t,url:_t.url})}),{config:j,bundle:$}):Promise.reject(g[0])})},loadSceneRecursive:function(e,o){var s=this,h=e.url,d=e.path;e.type;var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(!h)return Promise.resolve({});var _=createSceneBundle(h,d,o);return _.load().then(function(j){if(j.import==null)return s.normalize(j,_),{config:j,bundle:_};Array.isArray(j.import)||(j.import=[j.import]);var $=[];return j.import.forEach(function(_t){_typeof(_t)==="object"&&(_t=createObjectURL(new Blob([JSON.stringify(_t)]))),$.push(_.resourceFor(_t))}),delete j.import,Promise.all($.map(function(_t){return s.loadSceneRecursive(_t,_,g)})).then(function(_t){_t.forEach(function(_r){return s.normalize(_r.config,_r.bundle)});var _e=_t.map(function(_r){return _r.config});return j=mergeObjects.apply(void 0,_toConsumableArray(_e).concat([j])),s.normalize(j,_),{config:j,bundle:_}})}).catch(function(j){return j.url=h,g.push(j),{}})},normalize:function(e,o){return this.normalizeDataSources(e,o),this.normalizeFonts(e,o),this.normalizeTextures(e,o),this.hoistTextures(e,o),{config:e,bundle:o}},normalizeDataSources:function(e,o){for(var s in e.sources=e.sources||{},e.sources)this.normalizeDataSource(e.sources[s],o);return e},normalizeDataSource:function(e,o){if(e.url&&(e.url=o.urlFor(e.url)),e.scripts)for(var s in Array.isArray(e.scripts)&&(e.scripts=e.scripts.reduce(function(h,d){return h[d]=d,h},{})),e.scripts)e.scripts[s]=o.urlFor(e.scripts[s]);return e},normalizeFonts:function(e,o){for(var s in e.fonts=e.fonts||{},e.fonts)if(Array.isArray(e.fonts[s]))e.fonts[s].forEach(function(d){d.url=d.url&&o.urlFor(d.url)});else{var h=e.fonts[s];h.url=h.url&&o.urlFor(h.url)}return e},normalizeTextures:function(e,o){if(e.textures=e.textures||{},e.textures)for(var s in e.textures){var h=e.textures[s];h.url&&(h.url=o.urlFor(h.url))}},hoistTextures:function(e,o){var s=this;if(e.styles){var h=function(){var _i=e.styles[d],_n=_i.texture;typeof _n!="string"||e.textures[_n]||(_i.texture=s.hoistTexture(_n,e,o)),_i.material&&["emission","ambient","diffuse","specular","normal"].forEach(function(_s){var _l=_i.material[_s]!=null&&_i.material[_s].texture;typeof _l!="string"||e.textures[_l]||(_i.material[_s].texture=s.hoistTexture(_l,e,o))})};for(var d in e.styles)h()}if(this.hoistStyleShaderUniformTextures(e,o,{include_globals:!1}),e.layers)for(var g=[e.layers];g.length>0;){var _=g.pop();if(_typeof(_)==="object"&&!Array.isArray(_))for(var j in _)if(j==="draw"){var $=_[j];for(var _t in $){if($[_t].texture){var _e=$[_t].texture;typeof _e!="string"||e.textures[_e]||($[_t].texture=this.hoistTexture(_e,e,o))}if($[_t].outline&&$[_t].outline.texture){var _r=$[_t].outline.texture;typeof _r!="string"||e.textures[_r]||($[_t].outline.texture=this.hoistTexture(_r,e,o))}}}else{if(isReserved(j))continue;g.push(_[j])}}},hoistStyleShaderUniformTextures:function(e,o,s){var h=this,d=s.include_globals;if(e.styles)for(var g in e.styles){var _=e.styles[g];_.shaders&&_.shaders.uniforms&&GLSL.parseUniforms(_.shaders.uniforms).forEach(function(j){var $=j.type,_t=j.value,_e=j.key,_r=j.uniforms;$!=="sampler2D"||typeof _t!="string"||e.textures[_t]||!d&&isGlobal(_t)||(_r[_e]=h.hoistTexture(_t,e,o))})}},hoistTexture:function(e,o,s){var h=isGlobal(e),d=h?e:s.urlFor(e),g=h?"texture-".concat(d):d;return o.textures[g]={url:d},g},applyGlobalProperties:function(e){if(!e.global||Object.keys(e.global).length===0)return e;var o=flattenProperties(e.global);function s(h,d){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(g.indexOf(h)>-1)log({level:"warn",once:!0},"Global properties: cyclical reference detected",g);else{g.push(h);var _=GLOBAL_PROP_RGX.exec(h);if(_){var j=_[1];if(j){var $=d[j];if($!==void 0)return typeof $=="string"&&GLOBAL_PROP_RGX.exec($)?s($,d,g):$;log({level:"warn",once:!0},"Global property not found: "+h)}else log({level:"warn",once:!0},"Invalid global property reference: "+h)}}}return function h(d,g,_){if(typeof d=="string"){var j=s(d,o);j!==void 0&&(d=j)}else if(Array.isArray(d))for(var $=0;$<d.length;$++)d[$]=h(d[$]);else if(_typeof(d)==="object")for(var _t in d)d[_t]=h(d[_t]);return d}(e)},finalize:function(e){var o=e.config,s=e.bundle;return o?(o.global=o.global||{},o.scene=o.scene||{},o.cameras=o.cameras||{},o.lights=o.lights||{},o.styles=o.styles||{},o.layers=o.layers||{},o.camera&&(o.cameras.default=o.camera),Object.keys(o.cameras).length===0&&(o.cameras.default={}),(Object.keys(o.lights).length===0||Object.keys(o.lights).every(function(h){return o.lights[h].visible===!1}))&&(o.lights.default_light={type:"directional"}),{config:o,bundle:s}):{}}};function flattenProperties(e){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:".",s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};for(var d in s=s?s+o:"",e){var g=s+d,_=e[d];h[g]=_,_typeof(_)!=="object"||Array.isArray(_)||flattenProperties(_,o,g,h)}return h}subscribeMixin(SceneLoader);var TilePyramid=function(){return _createClass(function e(){_classCallCheck(this,e),this.coords={},this.max_proxy_descendant_depth=6,this.max_proxy_ancestor_depth=10},[{key:"sourceTiles",value:function(e,o){return this.coords[e.key]&&this.coords[e.key].sources&&this.coords[e.key].sources[o.name]}},{key:"addTile",value:function(e){var o=e.coords.key,s=this.coords[o];s||(s=this.coords[o]={descendants:0}),s.sources||(s.sources={}),s.sources[e.source.name]||(s.sources[e.source.name]={}),s.sources[e.source.name][e.style_zoom]=e;for(var h=e.coords.z-1;h>=0;h--){var d=Tile.coordinateAtZoom(e.coords,h);this.coords[d.key]||(this.coords[d.key]={descendants:0}),this.coords[d.key].descendants++}}},{key:"removeTile",value:function(e){var o=this.sourceTiles(e.coords,e.source),s=e.coords.key;o&&(delete o[e.style_zoom],Object.keys(o).length===0&&(delete this.coords[s].sources[e.source.name],Object.keys(this.coords[s].sources).length===0&&(delete this.coords[s].sources,this.coords[s].descendants===0&&delete this.coords[s])));for(var h=e.coords.z-1;h>=0;h--){var d=Tile.coordinateAtZoom(e.coords,h);this.coords[d.key]&&this.coords[d.key].descendants>0&&(this.coords[d.key].descendants--,this.coords[d.key].descendants!==0||this.coords[d.key].sources||delete this.coords[d.key])}}},{key:"getAncestor",value:function(e){var o=e.coords,s=e.style_zoom,h=e.source,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(!(d>this.max_proxy_ancestor_depth)){if(s>h.max_coord_zoom){var g=this.sourceTiles(o,h);if(g){for(var _=s-1;_>=h.max_coord_zoom;_--)if(g[_]&&g[_].loaded)return g[_]}s=h.max_coord_zoom}s--;var j=Tile.coordinateAtZoom(o,o.z-1),$=this.sourceTiles(j,h);return $&&$[s]&&$[s].loaded?$[s]:j.z>0?this.getAncestor({coords:j,style_zoom:s,source:h},d+1):void 0}}},{key:"getDescendants",value:function(e){var o=e.coords,s=e.style_zoom,h=e.source,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,g=[];if(s>=h.max_coord_zoom){var _=this.sourceTiles(o,h);if(_){for(var j=Math.max(Geo$1.default_view_max_zoom,s+this.max_proxy_descendant_depth),$=s+1;$<=j;$++)if(_[$]&&_[$].loaded)return g.push(_[$]),g}return g}if(this.coords[o.key]&&this.coords[o.key].descendants>0){s++;for(var _t=Tile.childrenForCoordinate(o),_e=0;_e<_t.length;_e++){var _r=_t[_e],_i=this.sourceTiles(_r,h);_i&&_i[s]&&_i[s].loaded?g.push(_i[s]):d<=this.max_proxy_descendant_depth&&_r.z<=h.max_coord_zoom&&g.push.apply(g,_toConsumableArray(this.getDescendants({coords:_r,source:h,style_zoom:s},d+1)))}}return g}}])}(),LabelMainPass=function(){return _createClass(function e(o,s,h,d){_classCallCheck(this,e),Object.assign(this,o),this.placed=null,this._tile=d;var g=Geo$1.unitsPerMeter(d.coords.z)*Math.pow(2,h-d.style_zoom);this.layout=Object.assign({},o.layout),this.layout.repeat_scale=.75,this.layout.repeat_distance=this.layout.repeat_distance||0,this.layout.repeat_distance/=g,this.position=Geo$1.tileSpaceToMeters(this.position,d.coords.z,d.min),this._worldToScreen=s,this._screenSpaceBoundingBox=void 0,this._boundingCircles=void 0},[{key:"getTile",value:function(){return this._tile}},{key:"isFlat",value:function(){return this.is_flat}},{key:"getScreenSpaceBoundingBox",value:function(){if(!this._screenSpaceBoundingBox){var e=this._worldToScreen(this.position,!0);e[0]+=this.offset[0],e[1]+=this.offset[1];var o=this.size[0]/2+this.layout.buffer[0],s=this.size[1]/2+this.layout.buffer[1],h=e[0]-o,d=e[0]+o,g=e[1]-s,_=e[1]+s;this._screenSpaceBoundingBox={left:h,bottom:_,right:d,top:g}}return this._screenSpaceBoundingBox}},{key:"getBoundingCircles",value:function(){return this._boundingCircles||(this._boundingCircles=this.type==="point"?this._convertSidesToScreenSpaceCircles():this._convertCirclesToScreenSpace()),this._boundingCircles}},{key:"_convertSidesToScreenSpaceCircles",value:function(){var e=this._tile.coords.z,o=this._tile.min,s=Geo$1.tileSpaceToMeters([this.sides[0],this.sides[1]],e,o),h=Geo$1.tileSpaceToMeters([this.sides[2],this.sides[3]],e,o),d=_slicedToArray(this._worldToScreen(s,!0),2),g=d[0],_=d[1],j=_slicedToArray(this._worldToScreen(h,!0),2);return encircleLine(g,_,j[0],j[1],this.size[1]/2+this.layout.buffer[1])}},{key:"_convertCirclesToScreenSpace",value:function(){for(var e=[],o=this.circles,s=this._tile.coords.z,h=this._tile.min,d=0;d<o.length-2;d+=3){var g=Geo$1.tileSpaceToMeters([o[d],-o[d+1]],s,h),_=o[d+2]/Geo$1.unitsPerMeter(s),j=[g[0]+_,g[1]],$=this._worldToScreen(g,!0),_t=this._worldToScreen(j,!0),_e=MathUtils$1.getLineLength($[0],$[1],_t[0],_t[1]);e.push($[0],$[1],_e)}return e}}])}(),labelsMainPass={mainThreadLabelCollisionPass},visible={},prev_visible={},IS_LITTLE_ENDIAN=new Uint8Array(new Uint32Array([305419896]).buffer)[0]===120;function _createContainer(e,o,s,h,d){var g=e.container,_=g.label,j=g.linked,$=e.ranges;return{label:new LabelMainPass(_,s,h,d),linked:j,ranges:$,mesh:o}}function mainThreadLabelCollisionPass(e,o,s,h,d,g){prev_visible=visible,visible={};var _={},j={},$=[],_t=s.worldToScreen.bind(s),_e=new TextMeshHelper(g);for(var _r in e.forEach(function(Ap){for(var _h in Ap.meshes)Ap.meshes[_h].forEach(function(_p){if(_p.labels){for(var ty in _e.trackMesh(_p),_p.labels["non-collision"]){var ry=_createContainer(_p.labels["non-collision"][ty],_p,_t,o,Ap);ry.label.text_data&&_e.insertLabel(ry,Ap)}for(var ly in _p.labels.collision)if(!_[ly]){var uy=_createContainer(_p.labels.collision[ly],_p,_t,o,Ap);_[ly]=uy.label,j[ly]=uy}}})}),j){var _i=j[_r];_i.linked&&(_i.linked=j[_i.linked]),$.push(_i)}var _n=s.getViewport(),_s=_n.width,_l=_n.height;return Collision.startTile("main",{apply_repeat_groups:!0,return_hidden:!0,grid_index:new GridIndex(_s,_l,30)}),Collision.addStyle("main","main"),Collision.collide($,"main","main").then(function(Ap){return Ap.forEach(function(_h){var _p=_h.mesh,ty=_h.label.getTile();if(_p.valid){var ry=0;_h.show!==!0||h&&_h.label.breach&&!prev_visible[_h.label.id]||(ry=1),ry&&(visible[_h.label.id]=!0),_h.label.text_data&&_e.insertLabel(_h,ty);var ly=_p.vertex_layout.offset.a_shape,uy=_p.vertex_layout.stride,py=_p.vertex_layout.attribs.find(function(xy){return xy.name==="a_shape"}),fy=py.byte_size/py.size;ly+=3*fy;var my=!0;_h.ranges.forEach(function(xy){if(my){for(var Ly=0;Ly<xy[1];Ly++){if(_p.vertex_data[xy[0]+Ly*uy+ly]===ry)return void(my=!1);_p.vertex_data[xy[0]+Ly*uy+ly]=ry}_e.trackMesh(_p)}})}}),_e.createTextures(d).then(function(){return _e.updateMeshes()})}).then(function(Ap){Ap.forEach(function(_h){return _h.valid&&_h.upload()}),e.forEach(function(_h){_h.labeled=!0}),$=[],j={},_={}})}var TextMeshHelper=function(){return _createClass(function e(o){_classCallCheck(this,e),this.textureManager=getTextureManager(o),this.tiles={},this.meshes=[],this.containers=[]},[{key:"insertLabel",value:function(e,o){var s=e.label.text_data,h=s.text_settings_key,d=s.text,g=s.text_info;this.containers.push(e);var _=this._ensureTextSection(o,h);_[d]?e.label.text_data.text_info=_[d]:_[d]=g}},{key:"trackMesh",value:function(e){this.meshes.indexOf(e)===-1&&this.meshes.push(e)}},{key:"updateMeshes",value:function(){var e=this;return this.containers.forEach(function(o){if(o.label.text_data){var s=o.label.getTile(),h=o.mesh;if(h.valid){var d=o.label.type,g=o.label.text_data.text_info;if(e.tiles[s.id]&&e.tiles[s.id].textures){var _=e.tiles[s.id].textures[0];if(h.uniforms.u_texture=_,h.textures.indexOf(_)===-1&&h.textures.push(_),d==="point"||d==="straight"){var j=d==="point"?g.align[o.label.align].texcoords:g.texcoords[d].texcoord;e.setTexCoords(h,o,j)}else if(d==="curved"){var $=g.segments.length,_t=g.texcoords_stroke,_e=g.texcoords.curved;e.setTexCoords(h,o,function(_i){return _i<$?_t[_i]:_e[_i-$].texcoord})}}}else if(e.tiles[s.id]&&e.tiles[s.id].textures){var _r=e.tiles[s.id].textures[0];e.textureManager.release(_r)}}}),this.meshes}},{key:"setTexCoords",value:function(e,o,s){var h,d=s instanceof Function;if(!d){var g=_slicedToArray(s,4),_=g[0],j=g[1],$=g[2],_t=g[3];h=[[_,j],[$,j],[$,_t],[_,_t]]}var _e=e.vertex_layout.stride,_r=new DataView(e.vertex_data.buffer),_i=e.vertex_layout.offset.a_texcoord;o.ranges.forEach(function(_n,_s){var _l=_slicedToArray(_n,3),Ap=_l[0],_h=_l[1],_p=_l[2];if(d){var ty=_slicedToArray(s(_s),4),ry=ty[0],ly=ty[1],uy=ty[2],py=ty[3];h=[[ry,ly],[uy,ly],[uy,py],[ry,py]]}for(var fy=_p?_h/2:0;fy<_h;fy++){var my=h[fy%4],xy=Ap+fy*_e;_r.setUint16(xy+_i,my[0]*texcoord_normalize,IS_LITTLE_ENDIAN),_r.setUint16(xy+_i+2,my[1]*texcoord_normalize,IS_LITTLE_ENDIAN)}})}},{key:"createTextures",value:function(e){var o=this;return Promise.all(Object.values(this.tiles).map(function(s){var h=s.id,d=s.key,g=s.texts;return o._createTexturesForTile(e,g,"labels-".concat(d,"-").concat(h),h,o.textureManager).then(function(_){_.length&&(_.forEach(function(j){o.textureManager.retain(j),o.textureManager.getRetainCount(j)>1&&o.textureManager.release(j)}),o.tiles[h].textures=_)})}))}},{key:"_createTexturesForTile",value:function(e,o,s,h,d){var g=new CanvasText,_=g.setTextureTextPositions(o);return g.rasterize(o,_,h,s,e,d)}},{key:"_ensureTile",value:function(e){var o=e.id,s=e.key;return this.tiles[o]||(this.tiles[o]={id:o,key:s,texts:{}}),this.tiles[o]}},{key:"_ensureTextSection",value:function(e,o){var s=this._ensureTile(e).texts;return s[o]||(s[o]={}),s[o]}}])}(),TILE_VISIBILITY_COUNTER_THRESHOLD=30,TileManager=function(){return _createClass(function e(o){var s=this,h=o.scene,d=o.view;_classCallCheck(this,e),this._scene=h,this._view=d,this._visible_tiles={},this._pyramid=new TilePyramid,this._visible_coords={},this._building_tiles=null,this._renderable_tiles=[],this._active_styles=[],this._tile_visibility_counters={},this._update_labels_on_queue_check=!1,this._all_visible_tiles_are_cached=!1,this._debouncedUpdateLabels=debounce(this._updateLabels.bind(this),100,200),this._main_thread_target=["TileManager",this._scene.id].join("_"),WorkerBroker.addTarget(this._main_thread_target,this),this._keepCoordinate=this._keepCoordinate.bind(this),this._removeTilesFilter=this._removeTilesFilter.bind(this),this._removeCachedTilesFilter=this._removeCachedTilesFilter.bind(this),this._is_labeled=!1,this._tile_cache=new H.util.Cache(getMaxTileCacheSize(),function(g,_,j){s._visible_tiles[g]&&s._visible_tiles[g]===_||_.destroy()})},[{key:"destroy",value:function(){this._tile_cache.removeAll(),this.forEachVisibleTile(function(e){return e.destroy()}),this._visible_tiles={},this._pyramid=null,this._visible_coords={},this._scene=null,this._view=null}},{key:"keepTile",value:function(e){this._visible_tiles[e.key]=e,this._pyramid.addTile(e)}},{key:"hasTile",value:function(e){return this._visible_tiles[e]!==void 0}},{key:"_forgetTile",value:function(e){if(this.hasTile(e)){var o=this._visible_tiles[e];if(this._pyramid.removeTile(o),delete this._visible_tiles[e],o.loaded)this._tile_cache.add(o.key,o,getTileByteLength(o));else{var s=this._tile_cache.get(o.key);s?this._tile_cache.drop(s.key):o.destroy()}this._tileBuildStop(o)}}},{key:"removeTile",value:function(e){this._forgetTile(e),this._scene.requestRedraw()}},{key:"forEachVisibleTile",value:function(e){for(var o in this._visible_tiles)e(this._visible_tiles[o])}},{key:"removeTiles",value:function(e){for(var o in this._visible_tiles)e(this._visible_tiles[o])&&this.removeTile(o)}},{key:"removeCachedTiles",value:function(e){var o=this;this._tile_cache.forEach(function(s,h){e(h)&&o._tile_cache.drop(s)})}},{key:"updateTilesForView",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this._visible_coords={};for(var o=this._view.findVisibleTileCoordinates(),s=0;s<o.length;s++){var h=o[s];this._visible_coords[h.key]=h}this.updateTileStates(e)}},{key:"updateTileStates",value:function(){var e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];for(var o in this._all_visible_tiles_are_cached=!0,this._visible_coords)this._keepCoordinate(o,e);this._all_visible_tiles_are_cached&&(this._is_labeled=!1,this._debouncedUpdateLabels()),this._tile_cache.removeAll(this._removeCachedTilesFilter),this._updateProxyTiles(),this.removeTiles(this._removeTilesFilter),this._updateRenderableTiles(),this._updateActiveStyles()}},{key:"_removeTilesFilter",value:function(e){if(e.style_zoom===this._view.lookAtManipulator.getLookAtData().tile_level){if(this._visible_coords[e.coords.key])return!1;for(var o in this._visible_coords)if(Tile.isDescendant(e.coords,this._visible_coords[o]))return!1}return!e.isProxy()}},{key:"_updateLabels",value:function(){var e=this;if(!this._building_tiles||Object.keys(this._building_tiles).length===0){CanvasText.pruneTextCache();var o=this._renderable_tiles.sort(compareTileCoords);labelsMainPass.mainThreadLabelCollisionPass(o,roundPrecision(this._view.lookAtManipulator.getLookAtData().zoom,2),this._view.lookAtManipulator,this.isLoadingVisibleTiles(),this._scene.gl,this._scene.id).then(function(){e._is_labeled=!Task.hasPendingTasks(),e._scene&&e._scene.immediateRedraw(),e._update_labels_on_queue_check=!1})}}},{key:"_updateProxyTiles",value:function(){var e=this,o=this._view.lookAtManipulator.getZoomDirection();if(o!==0){var s=!1;this.forEachVisibleTile(function(h){if(h.setProxyFor(null),o===1){if(!h.built){var d=e._pyramid.getAncestor(h);d&&(d.setProxyFor(h),s=!0)}}else if(o===-1&&!h.built)for(var g=e._pyramid.getDescendants(h),_=0;_<g.length;_++)g[_].setProxyFor(h),s=!0}),s||this._view.lookAtManipulator.resetZoomDirection()}}},{key:"getRenderableTiles",value:function(){return this._renderable_tiles}},{key:"_updateRenderableTiles",value:function(){for(var e in this._renderable_tiles=[],this._visible_tiles){var o=this._visible_tiles[e],s=this._tile_cache.get(e);o.loaded?(this._renderable_tiles.push(o),s&&s!==o&&this._tile_cache.drop(e)):s&&(s.generation===this._scene.generation?this._renderable_tiles.push(s):this._tile_cache.drop(e))}return this._renderable_tiles}},{key:"getWorkerForTile",value:function(e,o){return o.has_volatile_data?this._scene.getWorkers(WorkerType.FAKE)[0]:o.tiled?this._scene.getWorkers(WorkerType.NATIVE)[Math.abs(e.x+e.y+e.z)%this._scene.num_workers]:this._scene.getWorkers(WorkerType.NATIVE)[o.id%this._scene.num_workers]}},{key:"getActiveStyles",value:function(){return this._active_styles}},{key:"_updateActiveStyles",value:function(){for(var e=this._renderable_tiles,o={},s=0;s<e.length;s++){var h=e[s];Object.keys(h.meshes).forEach(function(d){return o[d]=!0})}return this._active_styles=Object.keys(o),this._active_styles}},{key:"isLoadingVisibleTiles",value:function(){var e=!1;for(var o in this._visible_tiles)if(!this._visible_tiles[o].built){e=!0;break}return e}},{key:"updateTilesVisibilityCounters",value:function(){var e=this;Object.keys(this._visible_coords).forEach(function(h){h in e._tile_visibility_counters||(e._tile_visibility_counters[h]=0)});var o=Object.keys(this._tile_visibility_counters),s=[];o.forEach(function(h){h in e._visible_coords?(e._tile_visibility_counters[h]++,e._tile_visibility_counters[h]>=TILE_VISIBILITY_COUNTER_THRESHOLD&&s.push(e._visible_coords[h])):(e._tile_visibility_counters[h]--,e._tile_visibility_counters[h]<=0&&delete e._tile_visibility_counters[h])}),s.length&&this.loadCoordinates(s)}},{key:"loadCoordinates",value:function(e){var o=this;e.sort(function(s,h){var d=o._view.lookAtManipulator.getLookAtData().position,g=Geo$1.metersPerTile(s.z)/2,_=Geo$1.metersForTile(s);_.x+=g,_.y-=g;var j=Geo$1.metersForTile(h);j.x+=g,j.y-=g;var $=Math.abs(d[0]-_.x)+Math.abs(d[1]-_.y),_t=Math.abs(d[0]-j.x)+Math.abs(d[1]-j.y);return s.center_dist=$,h.center_dist=_t,_t>$?-1:_t===$?0:1}),e.forEach(function(s){return o.loadCoordinate(s)})}},{key:"_keepCoordinate",value:function(e){var o=arguments.length>1&&arguments[1]!==void 0&&arguments[1],s=this._visible_coords[e];if(s.z===this._view.center_tile.z)for(var h in this._scene.sources){var d=this._scene.sources[h];if(d.builds_geometry_tiles&&d.includesTile(s,this._view.lookAtManipulator.getLookAtData().tile_level)){var g=Tile.normalizedKey(s,d,this._view.lookAtManipulator.getLookAtData().tile_level);if(g&&!this.hasTile(g)){var _=o&&this._tile_cache.get(g);_||(this._all_visible_tiles_are_cached=!1);var j=_||new Tile({source:d,coords:s,worker:this.getWorkerForTile(s,d),style_zoom:Utils$1.zoomToTileLevel(s.z),view:this._view,sceneId:this._scene.id});d.config.type==="ObjectSource"&&(j.syncedAt=d.getSyncedAt()),this.keepTile(j)}}}}},{key:"loadCoordinate",value:function(e){if(e.z===this._view.center_tile.z)for(var o in this._scene.sources){var s=this._scene.sources[o];if(s.builds_geometry_tiles&&s.includesTile(e,this._view.lookAtManipulator.getLookAtData().tile_level)){var h=Tile.normalizedKey(e,s,this._view.lookAtManipulator.getLookAtData().tile_level);this.hasTile(h)&&this.buildTile(this._visible_tiles[h])}}}},{key:"buildTile",value:function(e,o){this._building_tiles&&this._building_tiles[e.key]||e.built&&e.generation===this._scene.generation||(this._tileBuildStart(e.key),e.build(this._scene.generation,o))}},{key:"buildTileStylesCompleted",value:function(e){var o=e.tile,s=e.progress;if(this._visible_tiles[o.key]==null)Tile.abortBuild(o,this._scene.id);else if(o.generation!==this._scene.generation)Tile.abortBuild(o,this._scene.id);else{if(o.id<this._visible_tiles[o.key].id)return void Tile.abortBuild(o,this._scene.id);o=this._visible_tiles[o.key].merge(o),s.done&&(o.built=!0),o.buildMeshes(this._scene.styles,s),this.updateTileStates(),this._scene.requestRedraw()}s.done&&this._tileBuildStop(o)}},{key:"buildTileError",value:function(e){this._forgetTile(e.key),Tile.abortBuild(e,this._scene.id)}},{key:"_tileBuildStart",value:function(e){this._is_labeled=!1,this._building_tiles=this._building_tiles||{},this._building_tiles[e]=!0}},{key:"_tileBuildStop",value:function(e){this._building_tiles&&(e.source&&e.source.hasLabeledData()&&(this._update_labels_on_queue_check=!0),delete this._building_tiles[e.key],Task.removeForTile(e.id),this.checkBuildQueue())}},{key:"isReady",value:function(){return this._is_labeled&&!this.isLoadingVisibleTiles()}},{key:"checkBuildQueue",value:function(){this._building_tiles&&Object.keys(this._building_tiles).length!==0||(this._building_tiles=null,this._update_labels_on_queue_check?this._updateLabels():(this._is_labeled=!Task.hasPendingTasks(),this._scene.immediateRedraw()))}},{key:"_removeCachedTilesFilter",value:function(e,o,s){var h=o.source;return!this._visible_tiles[e]&&(o.generation!==this._scene.generation||h.config.type==="ObjectSource"&&h.getSyncedAt()>o.syncedAt)}}])}();function compareTileCoords(e,o){var s=e.coords,h=o.coords;return s.z-h.z||s.x-h.x||s.y-h.y}function roundPrecision(e,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:2,h=Math.pow(10,s);return Math.round(Math.floor(e*o)/o*h)/h}function getTileByteLength(e){var o=0;for(var s in e.meshes)for(var h=e.meshes[s],d=0;d<h.length;d++){var g=h[d];o+=g.buffer_size;for(var _=0;_<g.textures.length;_++)o+=e.textureManager.getByteLength(g.textures[_])}return o}function getMaxTileCacheSize(){var e=.1;return navigator&&navigator.deviceMemory?e=5*navigator.deviceMemory/100:window&&window.screen&&(e=window.screen.width/512*window.screen.height/512*.03*3,e=Math.min(e,1)),1024*e*1024*1024}var RenderState=function(){return _createClass(function e(o,s){_classCallCheck(this,e),s(o),this.value=o,this.setup=s},[{key:"get",value:function(){return this.value}},{key:"set",value:function(e){JSON.stringify(this.value)!==JSON.stringify(e)&&(this.setup(e),this.value=e)}}])}(),RenderStateManager=_createClass(function e(o){_classCallCheck(this,e),this.defaults={},this.defaults.culling=!0,this.defaults.culling_face=o.BACK,this.defaults.blending=!1,this.defaults.blending_src=o.ONE_MINUS_SRC_ALPHA,this.defaults.blending_dst=o.ONE_MINUS_SRC_ALPHA,this.defaults.blending_src_alpha=o.ONE,this.defaults.blending_dst_alpha=o.ONE_MINUS_SRC_ALPHA,this.defaults.depth_write=!0,this.defaults.depth_test=!0,o.depthFunc(o.LESS),this.culling=new RenderState({cull:this.defaults.culling,face:this.defaults.culling_face},function(s){s.cull?(o.enable(o.CULL_FACE),o.cullFace(s.face)):o.disable(o.CULL_FACE)}),this.blending=new RenderState({blend:this.defaults.blending,src:this.defaults.blending_src,dst:this.defaults.blending_dst,src_alpha:this.defaults.blending_src_alpha,dst_alpha:this.defaults.blending_dst_alpha},function(s){s.blend?(o.enable(o.BLEND),s.src_alpha&&s.dst_alpha?o.blendFuncSeparate(s.src,s.dst,s.src_alpha,s.dst_alpha):o.blendFunc(s.src,s.dst)):o.disable(o.BLEND)}),this.depth_write=new RenderState({depth_write:this.defaults.depth_write},function(s){o.depthMask(s.depth_write)}),this.depth_test=new RenderState({depth_test:this.defaults.depth_test},function(s){s.depth_test?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST)})}),MediaCapture=function(){return _createClass(function e(){_classCallCheck(this,e),this.canvas=null,this.gl=null,this.screenshot_canvas=null,this.screenshot_context=null,this.queue_screenshot=null,this.video_capture=null},[{key:"setCanvas",value:function(e,o){this.canvas=e,this.gl=o}},{key:"screenshot",value:function(){var e=this,o=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).background;return this.queue_screenshot!=null||(this.queue_screenshot={background:o},this.queue_screenshot.promise=new Promise(function(s,h){e.queue_screenshot.resolve=s,e.queue_screenshot.reject=h})),this.queue_screenshot.promise}},{key:"completeScreenshot",value:function(){if(this.queue_screenshot!=null){var e=this.canvas.width,o=this.canvas.height,s=new Uint8Array(e*o*4);this.gl.readPixels(0,0,e,o,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s);var h=this.queue_screenshot.background;h=h&&h!=="transparent"?StyleParser.parseColor(h).slice(0,3).map(function(_p){return 255*_p}):null;for(var d=new Uint8ClampedArray(e*o*4),g=0;g<o;g++)for(var _=0;_<e;_++){var j=4*((o-g-1)*e+_),$=4*(g*e+_),_t=s[j+3];d[$+0]=255*s[j+0]/_t,d[$+1]=255*s[j+1]/_t,d[$+2]=255*s[j+2]/_t,d[$+3]=_t,h&&(_t/=255,d[$+0]=d[$+0]*_t+h[0]*(1-_t),d[$+1]=d[$+1]*_t+h[1]*(1-_t),d[$+2]=d[$+2]*_t+h[2]*(1-_t),d[$+3]=255)}this.screenshot_canvas=this.screenshot_canvas||document.createElement("canvas");var _e=this.screenshot_canvas;_e.width=e,_e.height=o,this.screenshot_context=this.screenshot_context||_e.getContext("2d");var _r=this.screenshot_context,_i=new ImageData(d,e,o);_r.putImageData(_i,0,0);for(var _n=_e.toDataURL("image/png"),_s=atob(_n.slice(22)),_l=new Uint8Array(_s.length),Ap=0;Ap<_s.length;++Ap)_l[Ap]=_s.charCodeAt(Ap);var _h=new Blob([_l],{type:"image/png"});this.queue_screenshot.resolve({url:_n,blob:_h,type:"png"}),this.queue_screenshot=null}}},{key:"startVideoCapture",value:function(){var e=this;if(typeof window.MediaRecorder!="function"||!this.canvas||typeof this.canvas.captureStream!="function")return log("warn","Video capture (Canvas.captureStream and/or MediaRecorder APIs) not supported by browser"),!1;if(this.video_capture)return log("warn","Video capture already in progress, call Scene.stopVideoCapture() first"),!1;try{var o=this.video_capture={};o.chunks=[],o.stream=this.canvas.captureStream(),o.options={mimeType:"video/webm"},o.media_recorder=new MediaRecorder(o.stream,o.options),o.media_recorder.ondataavailable=function(s){if(s.data.size>0&&o.chunks.push(s.data),o.resolve){var h=new Blob(o.chunks,{type:o.options.mimeType}),d=createObjectURL(h);o.stream&&(o.stream.getTracks()||[]).forEach(function(g){g.stop(),o.stream.removeTrack(g)}),o.stream=null,o.media_recorder=null,e.video_capture=null,o.resolve({url:d,blob:h,type:"webm"})}},o.media_recorder.start()}catch(s){return this.video_capture=null,log("error","Scene video capture failed",s),!1}return!0}},{key:"stopVideoCapture",value:function(){var e=this;return this.video_capture?(this.video_capture.promise=new Promise(function(o,s){e.video_capture.resolve=o,e.video_capture.reject=s}),this.video_capture.media_recorder.stop(),this.video_capture.promise):(log("warn","No scene video capture in progress, call Scene.startVideoCapture() first"),Promise.resolve({}))}}])}(),SceneWorker=function(){return _createClass(function e(){_classCallCheck(this,e),this.sources={},this.styles={},this.layers={},this.tiles={},this._isConfigured=!1},[{key:"init",value:function(e,o,s,h,d,g,_){return this.setMeshVariantMaxLife(_),this.scene_id=e,this.textureManager=getTextureManager(e),this._worker_id=o,log.setLevel(s),Utils$1.device_pixel_ratio=h,VertexElements.setElementIndexUint(d),FeatureSelection.setPrefix(this._worker_id),this._style_manager=new StyleManager,this._importExternalScripts(g),Label.id_prefix=o,this._isConfigured=!1,o}},{key:"dispose",value:function(){this._last_config_sources=null,this._config_sources=null,this.sources=null,this._style_manager=null,this.styles=null,this.layers=null,this.tiles=null}},{key:"_importExternalScripts",value:function(e){if(e.length!==0){log("debug","loading custom data source scripts in worker:",e);var o=Object.getOwnPropertyNames(window);importScripts.apply(void 0,_toConsumableArray(e)),Object.getOwnPropertyNames(window).forEach(function(s){o.indexOf(s)===-1&&(self[s]=window[s])})}}},{key:"updateConfig",value:function(e,o){var s=e.config,h=e.generation,d=e.introspection;for(var g in s=JSON.parse(s),mergeDebugSettings(o),this._generation=h,this._isConfigured=!1,s.layers)s.layers[g]&&(s.layers[g].data=Utils$1.stringsToFunctions(s.layers[g].data));this.global=Utils$1.stringsToFunctions(s.global),this._createDataSources(s),s.styles=Utils$1.stringsToFunctions(s.styles,StyleParser.wrapFunction),this.styles=this._style_manager.build(s.styles),self.is_fake_worker=Thread.is_main,this._style_manager.initStyles({generation:this._generation,styles:this.styles,sources:this.sources,introspection:d,id:this.scene_id}),delete self.is_fake_worker,this.layers=parseLayers(s.layers,this._style_manager.styles),this._configuring=this._syncTextures(s.textures)}},{key:"setMeshVariantMaxLife",value:function(e){this.meshVariantMaxLife=e}},{key:"_createDataSources",value:function(e){var o=this;this._last_config_sources=this._config_sources||{},this._config_sources=e.sources;var s=this.sources,h=[];for(var d in e.sources=Utils$1.stringsToFunctions(e.sources),this.sources={},self.is_fake_worker=Thread.is_main,e.sources)if(JSON.stringify(this._last_config_sources[d])!==JSON.stringify(e.sources[d])){var g=void 0;try{g=DataSource.create(Object.assign({},e.sources[d],{name:d}),this.sources)}catch(_){log("error","Error creating source.",_.message,e.sources[d]);continue}g&&(this.sources[d]=g,h.push(d))}else this.sources[d]=s[d];delete self.is_fake_worker,h.forEach(function(_){for(var j in o.tiles)o.tiles[j].source===_&&delete o.tiles[j]})}},{key:"awaitConfiguration",value:function(){return this._configuring}},{key:"_onConfig",value:function(e){var o=this;if(this._isConfigured=!0,e.loaded!==!0)e.loading=!0,e.loaded=!1,e.error=null,this._loadTileSourceData(e).then(function(){if(o.getTile(e.id)){e.loading=!1,e.loaded=!0;try{Tile.buildGeometry(e,o)}catch(s){e.error=s.toString(),WorkerBroker.postMessage("TileManager_".concat(o.scene_id,".buildTileError"),Tile.slice(e))}}else log("trace","stop tile build after data source load because tile was removed. Key: ".concat(e.key,", id: ").concat(e.id))},function(s){e.loading=!1,e.loaded=!1,e.error=s.stack,log("error","tile load error for tile with key ".concat(e.key," and id ").concat(e.id,": ").concat(e.error)),WorkerBroker.postMessage("TileManager_".concat(o.scene_id,".buildTileError"),Tile.slice(e))});else{log("trace","used worker cache for tile with key ".concat(e.key," and id ").concat(e.id));try{Tile.buildGeometry(e,this)}catch(s){e.error=s.toString(),WorkerBroker.postMessage("TileManager_".concat(this.scene_id,".buildTileError"),Tile.slice(e))}}}},{key:"buildTile",value:function(e){var o=e.tile,s=this.getTile(o.id);if(!s||!s.loading)if(o=this.tiles[o.id]=Object.assign(s||{},o),this._isConfigured)this._onConfig(o);else{var h=this;this.awaitConfiguration().then(function(){return h._onConfig(o)})}}},{key:"_loadTileSourceData",value:function(e){return this.sources[e.source]?this.sources[e.source].load(e):(e.source_data={},Promise.resolve(e))}},{key:"getTile",value:function(e){return this.tiles[e]}},{key:"removeTile",value:function(e){var o=this.tiles[e];o!=null&&(o.loading===!0&&(log("trace","cancel tile load for tile id ".concat(e)),o.loading=!1,Tile.cancel(o)),delete this.tiles[e],log("trace","remove tile from cache, tile id: ".concat(e)))}},{key:"queryFeatures",value:function(e){var o=this,s=e.filter,h=e.visible,d=e.geometry,g=e.tile_ids,_=[],j=g.map(function($){return o.tiles[$]}).filter(function($){return $});return s!=null&&(s=["{","["].indexOf(s[0])>-1?JSON.parse(s):s,s=Utils$1.stringsToFunctions(s,StyleParser.wrapFunction)),s=buildFilter(s,FilterOptions),j.forEach(function($){var _t=function(_r){$.source_data.layers[_r].features.forEach(function(_i){if(!(h===!0&&_i.generation!==o._generation||h===!1&&_i.generation===o._generation)){var _n=StyleParser.getFeatureParseContext(_i,$,o.global);if(_n.source=$.source,_n.layer=_r,s(_n)){var _s={type:_i.type,properties:_i.properties};d===!0&&(_s.geometry=Geo$1.copyGeometry(_i.geometry),Geo$1.tileSpaceToLatlng(_s.geometry,$.coords.z,$.min)),_.push(_s)}}})};for(var _e in $.source_data.layers)_t(_e)}),_}},{key:"resetFeatureSelection",value:function(){FeatureSelection.reset()}},{key:"_syncTextures",value:function(e){var o=[];return e&&o.push.apply(o,_toConsumableArray(Object.keys(e))),log("trace","sync textures to worker:",o),o.length>0?this.textureManager.syncTexturesToWorker(o):Promise.resolve()}},{key:"profile",value:function(e){console.profile("worker ".concat(this._worker_id,": ").concat(e))}},{key:"profileEnd",value:function(e){console.profileEnd("worker ".concat(this._worker_id,": ").concat(e))}},{key:"terminate",value:function(){this.dispose()}}])}();(Thread.is_worker||self.H&&self.H.DEBUG)&&WorkerBroker.addTarget("self",new SceneWorker);var Scene=function(){function e(o,s){_classCallCheck(this,e),s=s||{},subscribeMixin(this),this.id=e.id++,this.textureManager=getTextureManager(this.id),this.initialized=!1,this.initializing=null,this.sources={},this.view=new View(this,s),this.tile_manager=new TileManager({scene:this,view:this.view}),this.num_workers=s.numWorkers||2,s.disableVertexArrayObjects===!0&&(VertexArrayObject.disabled=!0),Utils$1.device_pixel_ratio=s.devicePixelRatio,this.config=null,this.config_source=o,this.config_bundle=null,this.last_valid_config_source=null,this.styles=null,this.style_manager=new StyleManager,this.building=null,this.dirty=!0,s.preUpdate&&this.subscribe({pre_update:s.preUpdate}),s.postUpdate&&this.subscribe({post_update:s.postUpdate}),this.render_loop=!s.disableRenderLoop,this.render_loop_active=!1,this.render_loop_stop=!1,this.render_count=0,this.last_render_count=0,this.render_count_changed=!1,this.frame=0,this.last_main_render=-1,this.last_selection_render=-1,this.media_capture=new MediaCapture,this.selection=null,this.introspection=s.introspection===!0,this.viewport=s.viewport,this.adjustMeshVariantMaxLife(),this.container=s.container,this.canvas=null,this.contextOptions=s.webGLContextOptions,this.lights=null,this.background=null,this.createListeners(),this.updating=0,this.generation=e.generation,this.last_complete_generation=e.generation,this.log_level=s.logLevel||"warn",log.setLevel(this.log_level),log.reset()}return _createClass(e,[{key:"load",value:function(){var o=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.initializing||(log.reset(),this.updating++,this.initialized=!1,this.initial_build_time=null,(h=typeof h=="string"?{base_path:h}:h).blocking=h.blocking===void 0||h.blocking,this.render_loop!==!1?this.setupRenderLoop():document.hidden&&document.addEventListener("visibilitychange",function(){document.hidden||(o.setupRenderLoop(),setTimeout(function(){o.render_loop_stop=!0},1e3))}),this.createCanvas(),this.textureManager.destroy(this.gl),this.initializing=this.loadScene(s,h).then(function(){return o.createWorkers()}).then(function(){o.resetFeatureSelection();var d=_typeof(o.config_source)==="object"||o.hasSubscribersFor("load"),g=o.updateConfig({serialize_funcs:d,normalize:!1,load_event:!0,fade_in:!0});if(h.blocking===!0)return g}).then(function(){o.updating--,o.initializing=null,o.initialized=!0,o.last_valid_config_source=o.config_source,o.last_valid_options={base_path:h.base_path,file_type:h.file_type},o.requestRedraw()}).catch(function(d){var g,_;if(o.initializing=null,o.updating=0,d.name==="YAMLException"?(g="yaml",_="Error parsing scene YAML"):_="Error initializing scene",o.trigger("error",{type:g,message:_,error:d,url:o.config_source}),_="Scene.load() failed to load ".concat(o.config_source,": ").concat(d.message),o.last_valid_config_source)return log("warn",_,d),log("info","Scene.load() reverting to last valid configuration"),o.load(o.last_valid_config_source,o.last_valid_base_path);throw log("error",_,d),d})),this.initializing}},{key:"destroy",value:function(){if(this.initialized=!1,this.render_loop_stop=!0,this.destroyListeners(),this.canvas&&this.canvas.parentNode&&(this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),this.container=null,this.selection&&this.selection.destroy(),this.gl){this.textureManager.destroy(this.gl),this.style_manager.destroy(this.gl),this.styles={},ShaderProgram.reset();var o=this.gl.getExtension("WEBGL_lose_context");o&&o.loseContext(),this.gl=null}this.sources={},this.tile_manager.destroy(),this.tile_manager=null,this.destroyWorkers(),log.reset()}},{key:"createCanvas",value:function(){if(!this.canvas){this.container=this.container||document.body,this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.top=0,this.canvas.style.left=0,this.container.style.backgroundColor="transparent",this.container.appendChild(this.canvas);try{this.gl=Context$1.getContext(this.canvas,Object.assign({alpha:!0,premultipliedAlpha:!1,stencil:!0,device_pixel_ratio:Utils$1.device_pixel_ratio},this.contextOptions))}catch{throw new Error("Couldn't create WebGL context. Your browser may not support WebGL, or it's turned off? Visit http://webglreport.com/ for more info.")}this.handleViewportUpdate(),VertexArrayObject.init(this.gl),this.render_states=new RenderStateManager(this.gl),this.media_capture.setCanvas(this.canvas,this.gl)}}},{key:"getWorkerUrl",value:function(){var o;if(__worker_src__!==void 0){var s="("+__worker_src__+")()";__worker_src_origin__&&__worker_src_map__!==""&&(s+=`
//# sourceMappingURL=`+__worker_src_origin__.slice(0,__worker_src_origin__.lastIndexOf("/")+1)+__worker_src_map__),o=createObjectURL(new Blob([s],{type:"application/javascript"}))}if(!o)throw new Error("Couldn't find internal Tangram source variable (may indicate the library did not build correctly)");return o}},{key:"updateExternalScripts",value:function(){var o=_toConsumableArray(this.external_scripts||[]),s=[];if(this.config.scene.scripts)for(var h in this.config.scene.scripts)s.indexOf(this.config.scene.scripts[h])===-1&&s.push(this.config.scene.scripts[h]);for(var d in this.config.sources){var g=this.config.sources[d];if(g.scripts)for(var _ in g.scripts)s.indexOf(g.scripts[_])===-1&&s.push(g.scripts[_])}return this.external_scripts=s,!(this.external_scripts.length===o.length&&this.external_scripts.every(function(j,$){return j===o[$]}))}},{key:"createWorkers",value:function(){return this.updateExternalScripts()&&this.destroyWorkers(),this._workers?Promise.resolve():this.makeWorkers(this.getWorkerUrl())}},{key:"makeWorkers",value:function(o){var s=this,h=!!this.gl.getExtension("OES_element_index_uint"),d=[];this._workers=[];for(var g=0,_=function(){var $=new Worker(o);s._workers[g]=$,WorkerBroker.addWorker($),log("debug","Scene.makeWorkers: initializing worker ".concat(g));var _t=g;d.push(WorkerBroker.postMessage($,"self.init",s.id,g,s.log_level,Utils$1.device_pixel_ratio,h,s.external_scripts,s.meshVariantMaxLife).then(function(_e){return log("debug","Scene.makeWorkers: initialized worker ".concat(_e)),_e},function(_e){return log("error","Scene.makeWorkers: failed to initialize worker ".concat(_t,":"),_e),Promise.reject(_e)}))};g<this.num_workers;g++)_();var j=new SceneWorker;return this._workers.push(j),d.push(j.init(this.id,g,this.log_level,Utils$1.device_pixel_ratio,h,[],this.meshVariantMaxLife)),this.next_worker=0,Promise.all(d).then(function(){log.setWorkers(s._workers.slice(0,s.num_workers)),revokeObjectURL(o)})}},{key:"getWorkers",value:function(o){return this._workers.filter(function(s){switch(o){case WorkerType.NATIVE:return s instanceof Worker;case WorkerType.FAKE:return s instanceof SceneWorker;default:return!0}})}},{key:"destroyWorkers",value:function(){this.selection=null,Array.isArray(this._workers)&&(log.setWorkers(null),this._workers.forEach(function(o){o.terminate()}),this._workers=null)}},{key:"ready",value:function(){return!(!this.view.ready()||Object.keys(this.sources).length===0)}},{key:"handleViewportUpdate",value:function(){var o=this.viewport,s=o.width,h=o.height;s>0&&h>0&&(this.dirty=!0,this.view.handleViewportUpdate(),this.gl&&Context$1.resize(this.gl,s,h,Utils$1.device_pixel_ratio)),this.adjustMeshVariantMaxLife()&&this.syncMeshVariantMaxLife()}},{key:"adjustMeshVariantMaxLife",value:function(){var o=this.viewport,s=o.width,h=o.height,d=Utils$1.device_pixel_ratio,g=s/d/256*(h/d/256),_=Math.max(Math.ceil(2*g),8);if(this.meshVariantMaxLife!==_)return this.meshVariantMaxLife=_,!0}},{key:"syncMeshVariantMaxLife",value:function(){this._workers&&WorkerBroker.postMessage(this._workers,"self.setMeshVariantMaxLife",this.meshVariantMaxLife)}},{key:"requestRedraw",value:function(){this.dirty=!0}},{key:"immediateRedraw",value:function(){this.dirty=!0,this.update()}},{key:"renderLoop",value:function(){this.render_loop_active=!0,this.initialized&&this.update(),Task.setState({user_moving_view:this.view.user_input_active}),Task.processAll(),this.render_loop_stop?(this.render_loop_stop=!1,this.render_loop_active=!1):window.requestAnimationFrame(this.renderLoop.bind(this))}},{key:"setupRenderLoop",value:function(){var o=this;this.render_loop_active||setTimeout(function(){o.renderLoop()},0)}},{key:"update",value:function(){var o=this.dirty,s=!!this.selection&&this.selection.hasPendingRequests(),h=!(o===!1&&s===!1||this.initialized===!1||this.updating>0||this.ready()===!1);return this.trigger("pre_update",h),this.view.update(),!!h&&(this.dirty=!1,this.render({main:o,selection:s}),this.updateViewComplete(),this.media_capture.completeScreenshot(),this.trigger("post_update",h),(this.animated===!0||this.view.isAnimating())&&(this.dirty=!0),this.frame++,log("trace","Scene.render()"),!0)}},{key:"render",value:function(o){var s=this,h=o.main,d=o.selection,g=this.gl;if(Object.keys(this.lights).forEach(function(_){return s.lights[_].update()}),h&&(this.render_count=this.renderPass(),this.last_main_render=this.frame),d){if(this.view.panning||this.view.user_input_active)return void this.selection.clearPendingRequests();(this.last_selection_render<this.last_main_render||this.selection.has_dirty_buffer)&&(this.selection.bind(),this.renderPass("selection_program",{allow_blend:!1}),g.bindFramebuffer(g.FRAMEBUFFER,null),g.viewport(0,0,this.canvas.width,this.canvas.height),g.clearColor.apply(g,_toConsumableArray(this.background.color)),this.last_selection_render=this.frame,this.selection.has_dirty_buffer=!1),this.selection.read(this.tile_manager.getRenderableTiles()),this.selection.has_dirty_buffer&&this.render({main:!1,selection:d})}return this.render_count_changed=!1,this.render_count!==this.last_render_count&&(this.render_count_changed=!0),this.last_render_count=this.render_count,!0}},{key:"renderPass",value:function(){var o=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"program",h=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).allow_blend,d=this.gl;h=h==null||h,this.clearFrame();for(var g,_,j=Style.sortByBlendOrderWithinLayers(this.tile_manager.getActiveStyles().map(function(_l){return o.styles[_l]}).filter(function(_l){return _l})),$=0,_t=0,_e=0;_e<j.length;_e++){var _r=j[_e],_i=_t-(_=parseInt(_r.name));if((_r.clean_depth||_i)&&(this.render_states.depth_write.value.depth_write?d.clear(d.DEPTH_BUFFER_BIT):(d.depthMask(!0),d.clear(d.DEPTH_BUFFER_BIT),d.depthMask(!1)),_i&&(_t=_)),_r.blend!==g){var _n=Object.assign({},Style.render_states[_r.blend],{blend:h&&_r.blend});this.setRenderState(_n)}var _s=_r.blend==="translucent"&&s==="program";_s&&(this.gl.colorMask(!1,!1,!1,!1),this.renderStyle(_r.name,s),this.gl.colorMask(!0,!0,!0,!0),this.gl.depthFunc(this.gl.EQUAL),this.gl.enable(this.gl.STENCIL_TEST),this.gl.clear(this.gl.STENCIL_BUFFER_BIT),this.gl.stencilFunc(this.gl.EQUAL,this.gl.ZERO,255),this.gl.stencilOp(this.gl.KEEP,this.gl.KEEP,this.gl.INCR)),$+=this.renderStyle(_r.name,s),_s&&(this.gl.disable(this.gl.STENCIL_TEST),this.gl.depthFunc(this.gl.LESS)),g=_r.blend}return $}},{key:"renderStyle",value:function(o,s){for(var h,d,g=this,_=this.styles[o],j=!0,$=0,_t=this.tile_manager.getRenderableTiles(),_e=Math.max.apply(Math,_toConsumableArray(_t.map(function(_n){return _n.meshes[o]?Math.max.apply(Math,_toConsumableArray(_n.meshes[o].map(function(_s){return _s.variant.order}))):-1}))),_r=function(_n){for(var _s=0;_s<_t.length;_s++){var _l=_t[_s];if(_l.meshes[o]!=null&&_l.shouldProxyForStyle(o))for(var Ap=_l.meshes[o].filter(function(ry){return ry.variant.order===_n}),_h=0,_p=Ap.length;_h<_p;_h+=1){var ty=Ap[_h];if(j===!0&&(j=!1,!(h=g.setupStyle(_,s))))return{v:0};g.view.setupTile(_l,h),g.selection.setupDiscards(h),_.render(ty)&&g.requestRedraw(),$+=ty.geometry_count}}},_i=0;_i<_e+1;_i++)if(d=_r(_i))return d.v;return $}},{key:"setupStyle",value:function(o,s){var h;try{if(!(h=o.getProgram(s)))return}catch{return void this.trigger("warning",{type:"styles",message:"Error compiling style ".concat(o.name),style:o,shader_errors:o.program&&o.program.shader_errors})}for(var d in h.use(),o.setup(),this.view.setupProgram(h),this.lights)this.lights[d].setupProgram(h);return h}},{key:"clearFrame",value:function(){this.initialized&&(this.render_states.depth_write.set({depth_write:!0}),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT))}},{key:"setRenderState",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=o.depth_test,h=o.depth_write,d=o.cull_face,g=o.blend;if(this.initialized){var _=this.render_states;s=s!==!1&&_.defaults.depth_test,h=h!==!1&&_.defaults.depth_write,d=d!==!1&&_.defaults.culling,g=g??_.defaults.blending;var j=this.gl;_.depth_test.set({depth_test:s}),_.depth_write.set({depth_write:h}),_.culling.set({cull:d,face:_.defaults.culling_face}),g?g==="opaque"?_.blending.set({blend:!1}):g==="overlay"||g==="inlay"||g==="translucent"?_.blending.set({blend:!0,src:j.SRC_ALPHA,dst:j.ONE_MINUS_SRC_ALPHA,src_alpha:j.ONE,dst_alpha:j.ONE_MINUS_SRC_ALPHA}):g==="add"?_.blending.set({blend:!0,src:j.ONE,dst:j.ONE}):g==="multiply"&&_.blending.set({blend:!0,src:j.ZERO,dst:j.SRC_COLOR}):_.blending.set({blend:!1})}}},{key:"getFeatureAt",value:function(o,s,h){var d=s.radius,g=s.top_most_only;if(this.initialized){var _={x:o.x/this.view.size.css.width,y:o.y/this.view.size.css.height};d=d>0?{x:d/this.view.size.css.width,y:d/this.view.size.css.height}:null,this.selection.getFeatureAt(_,{radius:d,top_most_only:g},h)}else log("debug","Scene.getFeatureAt() called before scene was initialized")}},{key:"queryFeatures",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=o.filter,h=o.unique,d=h===void 0||h,g=o.group_by,_=g===void 0?null:g,j=o.visible,$=j===void 0?null:j,_t=o.geometry,_e=_t!==void 0&&_t;s=Utils$1.serializeWithFunctions(s);var _r=this.tile_manager.getRenderableTiles().map(function(_i){return _i.id});return WorkerBroker.postMessage(this._workers,"self.queryFeatures",{filter:s,visible:$,geometry:_e,tile_ids:_r}).then(function(_i){var _n=[],_s={},_l={},Ap=(d=typeof d=="string"?[d]:d)&&function(_p){return JSON.stringify(Array.isArray(d)?sliceObject(_p,d):_p)},_h=(_=(typeof _=="string"||Array.isArray(_))&&_)&&function(_p){return Array.isArray(_)?JSON.stringify(sliceObject(_p,_)):_p[_]};return _i.forEach(function(_p){return _p.forEach(function(ty){if(Ap){var ry=Ap(ty);if(_s[ry])return;_s[ry]=!0}if(_h){var ly=_h(ty.properties);_l[ly]=_l[ly]||[],_l[ly].push(ty)}else _n.push(ty)})}),_h?_l:_n})}},{key:"loadScene",value:function(){var o=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=h.base_path,g=h.file_type;return this.config_source=s||this.config_source,typeof this.config_source=="string"?this.base_path=pathForURL(d||this.config_source):this.base_path=pathForURL(d),this.config_path=this.base_path,SceneLoader$1.loadScene(this.config_source,{path:this.base_path,type:g}).then(function(_){var j=_.config,$=_.bundle;return o.config=j,o.config_bundle=$,o.config})}},{key:"createDataSources",value:function(){var o=this,s=[],h=Object.keys(this.sources),d=0;for(var g in this.config.sources){var _=this.config.sources[g],j=this.sources[g];try{var $=Object.assign({},_,{name:g,id:d++});if(this.sources[g]=DataSource.create($,this.sources),!this.sources[g])throw{}}catch(_i){delete this.sources[g];var _t="Could not create data source: ".concat(_i.message);log("warn","Scene: ".concat(_t),_),this.trigger("warning",{type:"sources",source:_,message:_t})}DataSource.sameConfig(this.sources[g],j)||s.push(g)}for(var _e in h.forEach(function(_i){o.config.sources[_i]||(delete o.sources[_i],s.push(_i))}),s.length>0&&this.tile_manager.removeTiles(function(_i){return s.indexOf(_i.source.name)>-1}),this.config.layers){var _r=this.config.layers[_e];_r.enabled!==!1&&_r.data&&this.sources[_r.data.source]&&(this.sources[_r.data.source].builds_geometry_tiles=!0)}}},{key:"loadTextures",value:function(){var o=this;return this.textureManager.createFromObject(this.gl,this.config.textures).then(function(){return o.textureManager.createDefault(o.gl)})}},{key:"updateStyles",value:function(){if(!this.initialized&&!this.initializing)throw new Error("Scene.updateStyles() called before scene was initialized");for(var o in this.styles=this.style_manager.build(this.config.styles),this.style_manager.initStyles(this),this.styles)this.styles[o].setGL(this.gl);this.dirty=!0}},{key:"animated",get:function(){var o=this;return this.config.scene.animated!==void 0?this.config.scene.animated:this.tile_manager.getActiveStyles().some(function(s){return o.styles[s]&&o.styles[s].animated})}},{key:"createLights",value:function(){for(var o in this.lights={},this.config.lights)if(this.config.lights[o]&&_typeof(this.config.lights[o])==="object"){var s=this.config.lights[o];s.name=o.replace("-","_"),s.visible=s.visible!==!1,s.visible&&(this.lights[s.name]=Light.create(this.view,s))}Light.inject(this.lights)}},{key:"setBackground",value:function(){var o,s=this.config.scene.background;this.background={},s&&s.color&&(this.background.color=StyleParser.parseColor(s.color)),this.background.color||(this.background.color=[0,0,0,0]),this.background.color[3]===1?this.canvas.style.backgroundColor="rgba(".concat(this.background.color.map(function(h){return Math.floor(255*h)}).join(", "),")"):this.canvas.style.backgroundColor="transparent",(o=this.gl).clearColor.apply(o,_toConsumableArray(this.background.color))}},{key:"setIntrospection",value:function(o){var s=this;return o!==this.introspection?(this.introspection=o||!1,this.updating++,this.updateConfig({normalize:!1}).then(function(){return s.updating--})):Promise.resolve()}},{key:"updateConfig",value:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=o.load_event,h=s!==void 0&&s,d=o.serialize_funcs,g=o.normalize,_=g===void 0||g;o.fade_in,this.generation=++e.generation,this.updating++,this.config=SceneLoader$1.applyGlobalProperties(this.config),_?SceneLoader$1.normalize(this.config,this.config_bundle):(SceneLoader$1.hoistStyleShaderUniformTextures(this.config,this.config_bundle,{include_globals:!0}),SceneLoader$1.normalizeTextures(this.config,this.config_bundle)),this.trigger(h?"load":"update",{config:this.config}),this.style_manager.init(),this.createLights(),this.createDataSources(),this.loadTextures(),this.setBackground(),FontManager.loadFonts(this.config.fonts),this.updateStyles();var j=this.syncConfigToWorker({serialize_funcs:d});return this.updating--,this.view.updateBounds(),this.requestRedraw(),j}},{key:"syncConfigToWorker",value:function(){var o=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).serialize_funcs,s=o===void 0||o?Utils$1.serializeWithFunctions(this.config):JSON.stringify(this.config);return WorkerBroker.postMessage(this._workers,"self.updateConfig",{config:s,generation:this.generation,introspection:this.introspection},debugSettings$1)}},{key:"createListeners",value:function(){var o=this;this.listeners={},this.listeners.view={move:function(){return o.trigger("move")}},this.view.subscribe(this.listeners.view),this.listeners.texture={update:function(){return o.dirty=!0},warning:function(s){return o.trigger("warning",Object.assign({type:"textures"},s))}},this.textureManager.subscribe(this.listeners.texture),this.listeners.scene_loader={error:function(s){return o.trigger("error",Object.assign({type:"scene"},s))}},SceneLoader$1.subscribe(this.listeners.scene_loader)}},{key:"destroyListeners",value:function(){this.unsubscribeAll(),this.view.unsubscribe(this.listeners.view),this.textureManager.unsubscribe(this.listeners.texture),SceneLoader$1.unsubscribe(this.listeners.scene_loader),this.listeners=null}},{key:"resetFeatureSelection",value:function(){this.selection?this._workers&&WorkerBroker.postMessage(this._workers,"self.resetFeatureSelection"):this.selection=new FeatureSelection(this.gl,this.id)}},{key:"updateViewComplete",value:function(){(this.render_count_changed||this.generation!==this.last_complete_generation)&&this.tile_manager.isReady()&&(this.last_complete_generation=this.generation,this.trigger("view_complete"))}},{key:"resetViewComplete",value:function(){this.last_complete_generation=null}},{key:"screenshot",value:function(){var o=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}).background,s=o===void 0?"white":o;return this.requestRedraw(),this.media_capture.screenshot({background:s})}},{key:"pixelRatio",value:function(){return Utils$1.device_pixel_ratio}},{key:"startVideoCapture",value:function(){return this.requestRedraw(),this.media_capture.startVideoCapture()}},{key:"stopVideoCapture",value:function(){return this.media_capture.stopVideoCapture()}},{key:"_profile",value:function(o){console.profile("main thread: ".concat(o)),WorkerBroker.postMessage(this._workers,"self.profile",o)}},{key:"_profileEnd",value:function(o){console.profileEnd("main thread: ".concat(o)),WorkerBroker.postMessage(this._workers,"self.profileEnd",o)}},{key:"getCameraMatrix",value:function(){return this.view.lookAtManipulator.getCameraMatrix()}}],[{key:"create",value:function(o){return new e(o,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{})}}])}();Scene.id=0,Scene.generation=0;var RemoteTexture=function(e){function o(s,h,d){var g=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};_classCallCheck(this,o);var _,j=Math.pow(2,g.coords.z),$=Math.abs(Math.floor(g.coords.x/j));_=Math.abs(j*$-Math.abs(g.coords.x));var _t=g.coords;return g.coords={x:_,y:_t.y,z:_t.z},_callSuper(this,o,[s,h,d,g])}return _inherits(o,e),_createClass(o,[{key:"load",value:function(s){var h=this;if(!s||!s.uid)return _get(_getPrototypeOf(o.prototype),"load",this).call(this,s);var d=s.coords,g=new Uint8Array([0,0,0,0]);return this.loading=new Promise(function(_,j){var $=H.map.DataModel.invoke(s.uid,"requestTileAsPromise",[d.x,d.y,d.z])||null;$?$.then(function(_t){var _e=_t.data;h.loaded=!0,!_e||_e instanceof ArrayBuffer?h.setData(1,1,g,{filtering:"nearest"}):_e.tagName.toUpperCase()==="IMG"||_e.tagName.toUpperCase()==="CANVAS"?h.setElement(_e,s):h.setData(1,1,g,{filtering:"nearest"})},function(){h.loaded=!1}).then(_,function(_t){return j(_t)}):j(new Error("Unable to invoke on target "+s.uid))}),this.loading}}])}(Texture);TextureManager.register(RemoteTexture,function(e){return e&&e.uid}),self.H=self.H||{},self.H.gl={DataSource,Geo:Geo$1,MathUtils:MathUtils$1,Scene,Task,Tile,WorkerBroker,log,SceneLoader:SceneLoader$1,yaml:jsYaml}})()};f()}(),this.H=this.H||{},this.H.venues=function(e){function o(_a,_o){_o===void 0&&(_o={});var ga=_o.insertAt;if(_a&&typeof document<"u"){var ba=document.head||document.getElementsByTagName("head")[0],_c=document.createElement("style");_c.type="text/css",ga==="top"&&ba.firstChild?ba.insertBefore(_c,ba.firstChild):ba.appendChild(_c),_c.styleSheet?_c.styleSheet.cssText=_a:_c.appendChild(document.createTextNode(_a))}}function s(_a,_o,ga){return _o=Ap(_o),function(ba,_c){if(_c&&(typeof _c=="object"||typeof _c=="function"))return _c;if(_c!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(_d){if(_d===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _d}(ba)}(_a,d()?Reflect.construct(_o,ga||[],Ap(_a).constructor):_o.apply(_a,ga))}function h(_a,_o,ga){if(d())return Reflect.construct.apply(null,arguments);var ba=[null];ba.push.apply(ba,_o);var _c=new(_a.bind.apply(_a,ba));return _c}function d(){try{var _a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(d=function(){return!!_a})()}function g(_a,_o){var ga=Object.keys(_a);if(Object.getOwnPropertySymbols){var ba=Object.getOwnPropertySymbols(_a);_o&&(ba=ba.filter(function(_c){return Object.getOwnPropertyDescriptor(_a,_c).enumerable})),ga.push.apply(ga,ba)}return ga}function _(_a){for(var _o=1;_o<arguments.length;_o++){var ga=arguments[_o]!=null?arguments[_o]:{};_o%2?g(Object(ga),!0).forEach(function(ba){_s(_a,ba,ga[ba])}):Object.getOwnPropertyDescriptors?Object.defineProperties(_a,Object.getOwnPropertyDescriptors(ga)):g(Object(ga)).forEach(function(ba){Object.defineProperty(_a,ba,Object.getOwnPropertyDescriptor(ga,ba))})}return _a}function j(){j=function(){return _o};var _a,_o={},ga=Object.prototype,ba=ga.hasOwnProperty,_c=Object.defineProperty||function(Oy,Py,jy){Oy[Py]=jy.value},_d=typeof Symbol=="function"?Symbol:{},ey=_d.iterator||"@@iterator",ny=_d.asyncIterator||"@@asyncIterator",oy=_d.toStringTag||"@@toStringTag";function ay(Oy,Py,jy){return Object.defineProperty(Oy,Py,{value:jy,enumerable:!0,configurable:!0,writable:!0}),Oy[Py]}try{ay({},"")}catch{ay=function(Py,jy,Jy){return Py[jy]=Jy}}function dy(Oy,Py,jy,Jy){var zy=Py&&Py.prototype instanceof Ny?Py:Ny,tv=Object.create(zy.prototype),rv=new Lv(Jy||[]);return _c(tv,"_invoke",{value:ov(Oy,jy,rv)}),tv}function gy(Oy,Py,jy){try{return{type:"normal",arg:Oy.call(Py,jy)}}catch(Jy){return{type:"throw",arg:Jy}}}_o.wrap=dy;var yy="suspendedStart",_y="suspendedYield",by="executing",wy="completed",Ty={};function Ny(){}function By(){}function $y(){}var Xy={};ay(Xy,ey,function(){return this});var Yy=Object.getPrototypeOf,Qy=Yy&&Yy(Yy(Yv([])));Qy&&Qy!==ga&&ba.call(Qy,ey)&&(Xy=Qy);var Uy=$y.prototype=Ny.prototype=Object.create(Xy);function Wy(Oy){["next","throw","return"].forEach(function(Py){ay(Oy,Py,function(jy){return this._invoke(Py,jy)})})}function Vy(Oy,Py){function jy(zy,tv,rv,Ev){var mv=gy(Oy[zy],Oy,tv);if(mv.type!=="throw"){var Tv=mv.arg,yv=Tv.value;return yv&&typeof yv=="object"&&ba.call(yv,"__await")?Py.resolve(yv.__await).then(function(Rv){jy("next",Rv,rv,Ev)},function(Rv){jy("throw",Rv,rv,Ev)}):Py.resolve(yv).then(function(Rv){Tv.value=Rv,rv(Tv)},function(Rv){return jy("throw",Rv,rv,Ev)})}Ev(mv.arg)}var Jy;_c(this,"_invoke",{value:function(zy,tv){function rv(){return new Py(function(Ev,mv){jy(zy,tv,Ev,mv)})}return Jy=Jy?Jy.then(rv,rv):rv()}})}function ov(Oy,Py,jy){var Jy=yy;return function(zy,tv){if(Jy===by)throw Error("Generator is already running");if(Jy===wy){if(zy==="throw")throw tv;return{value:_a,done:!0}}for(jy.method=zy,jy.arg=tv;;){var rv=jy.delegate;if(rv){var Ev=hv(rv,jy);if(Ev){if(Ev===Ty)continue;return Ev}}if(jy.method==="next")jy.sent=jy._sent=jy.arg;else if(jy.method==="throw"){if(Jy===yy)throw Jy=wy,jy.arg;jy.dispatchException(jy.arg)}else jy.method==="return"&&jy.abrupt("return",jy.arg);Jy=by;var mv=gy(Oy,Py,jy);if(mv.type==="normal"){if(Jy=jy.done?wy:_y,mv.arg===Ty)continue;return{value:mv.arg,done:jy.done}}mv.type==="throw"&&(Jy=wy,jy.method="throw",jy.arg=mv.arg)}}}function hv(Oy,Py){var jy=Py.method,Jy=Oy.iterator[jy];if(Jy===_a)return Py.delegate=null,jy==="throw"&&Oy.iterator.return&&(Py.method="return",Py.arg=_a,hv(Oy,Py),Py.method==="throw")||jy!=="return"&&(Py.method="throw",Py.arg=new TypeError("The iterator does not provide a '"+jy+"' method")),Ty;var zy=gy(Jy,Oy.iterator,Py.arg);if(zy.type==="throw")return Py.method="throw",Py.arg=zy.arg,Py.delegate=null,Ty;var tv=zy.arg;return tv?tv.done?(Py[Oy.resultName]=tv.value,Py.next=Oy.nextLoc,Py.method!=="return"&&(Py.method="next",Py.arg=_a),Py.delegate=null,Ty):tv:(Py.method="throw",Py.arg=new TypeError("iterator result is not an object"),Py.delegate=null,Ty)}function Iv(Oy){var Py={tryLoc:Oy[0]};1 in Oy&&(Py.catchLoc=Oy[1]),2 in Oy&&(Py.finallyLoc=Oy[2],Py.afterLoc=Oy[3]),this.tryEntries.push(Py)}function gv(Oy){var Py=Oy.completion||{};Py.type="normal",delete Py.arg,Oy.completion=Py}function Lv(Oy){this.tryEntries=[{tryLoc:"root"}],Oy.forEach(Iv,this),this.reset(!0)}function Yv(Oy){if(Oy||Oy===""){var Py=Oy[ey];if(Py)return Py.call(Oy);if(typeof Oy.next=="function")return Oy;if(!isNaN(Oy.length)){var jy=-1,Jy=function zy(){for(;++jy<Oy.length;)if(ba.call(Oy,jy))return zy.value=Oy[jy],zy.done=!1,zy;return zy.value=_a,zy.done=!0,zy};return Jy.next=Jy}}throw new TypeError(typeof Oy+" is not iterable")}return By.prototype=$y,_c(Uy,"constructor",{value:$y,configurable:!0}),_c($y,"constructor",{value:By,configurable:!0}),By.displayName=ay($y,oy,"GeneratorFunction"),_o.isGeneratorFunction=function(Oy){var Py=typeof Oy=="function"&&Oy.constructor;return!!Py&&(Py===By||(Py.displayName||Py.name)==="GeneratorFunction")},_o.mark=function(Oy){return Object.setPrototypeOf?Object.setPrototypeOf(Oy,$y):(Oy.__proto__=$y,ay(Oy,oy,"GeneratorFunction")),Oy.prototype=Object.create(Uy),Oy},_o.awrap=function(Oy){return{__await:Oy}},Wy(Vy.prototype),ay(Vy.prototype,ny,function(){return this}),_o.AsyncIterator=Vy,_o.async=function(Oy,Py,jy,Jy,zy){zy===void 0&&(zy=Promise);var tv=new Vy(dy(Oy,Py,jy,Jy),zy);return _o.isGeneratorFunction(Py)?tv:tv.next().then(function(rv){return rv.done?rv.value:tv.next()})},Wy(Uy),ay(Uy,oy,"Generator"),ay(Uy,ey,function(){return this}),ay(Uy,"toString",function(){return"[object Generator]"}),_o.keys=function(Oy){var Py=Object(Oy),jy=[];for(var Jy in Py)jy.push(Jy);return jy.reverse(),function zy(){for(;jy.length;){var tv=jy.pop();if(tv in Py)return zy.value=tv,zy.done=!1,zy}return zy.done=!0,zy}},_o.values=Yv,Lv.prototype={constructor:Lv,reset:function(Oy){if(this.prev=0,this.next=0,this.sent=this._sent=_a,this.done=!1,this.delegate=null,this.method="next",this.arg=_a,this.tryEntries.forEach(gv),!Oy)for(var Py in this)Py.charAt(0)==="t"&&ba.call(this,Py)&&!isNaN(+Py.slice(1))&&(this[Py]=_a)},stop:function(){this.done=!0;var Oy=this.tryEntries[0].completion;if(Oy.type==="throw")throw Oy.arg;return this.rval},dispatchException:function(Oy){if(this.done)throw Oy;var Py=this;function jy(mv,Tv){return tv.type="throw",tv.arg=Oy,Py.next=mv,Tv&&(Py.method="next",Py.arg=_a),!!Tv}for(var Jy=this.tryEntries.length-1;Jy>=0;--Jy){var zy=this.tryEntries[Jy],tv=zy.completion;if(zy.tryLoc==="root")return jy("end");if(zy.tryLoc<=this.prev){var rv=ba.call(zy,"catchLoc"),Ev=ba.call(zy,"finallyLoc");if(rv&&Ev){if(this.prev<zy.catchLoc)return jy(zy.catchLoc,!0);if(this.prev<zy.finallyLoc)return jy(zy.finallyLoc)}else if(rv){if(this.prev<zy.catchLoc)return jy(zy.catchLoc,!0)}else{if(!Ev)throw Error("try statement without catch or finally");if(this.prev<zy.finallyLoc)return jy(zy.finallyLoc)}}}},abrupt:function(Oy,Py){for(var jy=this.tryEntries.length-1;jy>=0;--jy){var Jy=this.tryEntries[jy];if(Jy.tryLoc<=this.prev&&ba.call(Jy,"finallyLoc")&&this.prev<Jy.finallyLoc){var zy=Jy;break}}zy&&(Oy==="break"||Oy==="continue")&&zy.tryLoc<=Py&&Py<=zy.finallyLoc&&(zy=null);var tv=zy?zy.completion:{};return tv.type=Oy,tv.arg=Py,zy?(this.method="next",this.next=zy.finallyLoc,Ty):this.complete(tv)},complete:function(Oy,Py){if(Oy.type==="throw")throw Oy.arg;return Oy.type==="break"||Oy.type==="continue"?this.next=Oy.arg:Oy.type==="return"?(this.rval=this.arg=Oy.arg,this.method="return",this.next="end"):Oy.type==="normal"&&Py&&(this.next=Py),Ty},finish:function(Oy){for(var Py=this.tryEntries.length-1;Py>=0;--Py){var jy=this.tryEntries[Py];if(jy.finallyLoc===Oy)return this.complete(jy.completion,jy.afterLoc),gv(jy),Ty}},catch:function(Oy){for(var Py=this.tryEntries.length-1;Py>=0;--Py){var jy=this.tryEntries[Py];if(jy.tryLoc===Oy){var Jy=jy.completion;if(Jy.type==="throw"){var zy=Jy.arg;gv(jy)}return zy}}throw Error("illegal catch attempt")},delegateYield:function(Oy,Py,jy){return this.delegate={iterator:Yv(Oy),resultName:Py,nextLoc:jy},this.method==="next"&&(this.arg=_a),Ty}},_o}function $(_a){var _o=function(ga,ba){if(typeof ga!="object"||!ga)return ga;var _c=ga[Symbol.toPrimitive];if(_c!==void 0){var _d=_c.call(ga,ba||"default");if(typeof _d!="object")return _d;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ba==="string"?String:Number)(ga)}(_a,"string");return typeof _o=="symbol"?_o:_o+""}function _t(_a){return _t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(_o){return typeof _o}:function(_o){return _o&&typeof Symbol=="function"&&_o.constructor===Symbol&&_o!==Symbol.prototype?"symbol":typeof _o},_t(_a)}function _e(_a,_o,ga,ba,_c,_d,ey){try{var ny=_a[_d](ey),oy=ny.value}catch(ay){return void ga(ay)}ny.done?_o(oy):Promise.resolve(oy).then(ba,_c)}function _r(_a,_o){if(!(_a instanceof _o))throw new TypeError("Cannot call a class as a function")}function _i(_a,_o){for(var ga=0;ga<_o.length;ga++){var ba=_o[ga];ba.enumerable=ba.enumerable||!1,ba.configurable=!0,"value"in ba&&(ba.writable=!0),Object.defineProperty(_a,$(ba.key),ba)}}function _n(_a,_o,ga){return _o&&_i(_a.prototype,_o),ga&&_i(_a,ga),Object.defineProperty(_a,"prototype",{writable:!1}),_a}function _s(_a,_o,ga){return(_o=$(_o))in _a?Object.defineProperty(_a,_o,{value:ga,enumerable:!0,configurable:!0,writable:!0}):_a[_o]=ga,_a}function _l(_a,_o){if(typeof _o!="function"&&_o!==null)throw new TypeError("Super expression must either be null or a function");_a.prototype=Object.create(_o&&_o.prototype,{constructor:{value:_a,writable:!0,configurable:!0}}),Object.defineProperty(_a,"prototype",{writable:!1}),_o&&_h(_a,_o)}function Ap(_a){return Ap=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(_o){return _o.__proto__||Object.getPrototypeOf(_o)},Ap(_a)}function _h(_a,_o){return _h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ga,ba){return ga.__proto__=ba,ga},_h(_a,_o)}function _p(_a,_o){if(_a==null)return{};var ga,ba,_c=function(ey,ny){if(ey==null)return{};var oy,ay,dy={},gy=Object.keys(ey);for(ay=0;ay<gy.length;ay++)oy=gy[ay],ny.indexOf(oy)>=0||(dy[oy]=ey[oy]);return dy}(_a,_o);if(Object.getOwnPropertySymbols){var _d=Object.getOwnPropertySymbols(_a);for(ba=0;ba<_d.length;ba++)ga=_d[ba],_o.indexOf(ga)>=0||Object.prototype.propertyIsEnumerable.call(_a,ga)&&(_c[ga]=_a[ga])}return _c}function ty(){return ty=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(_a,_o,ga){var ba=function(_d,ey){for(;!Object.prototype.hasOwnProperty.call(_d,ey)&&(_d=Ap(_d))!==null;);return _d}(_a,_o);if(ba){var _c=Object.getOwnPropertyDescriptor(ba,_o);return _c.get?_c.get.call(arguments.length<3?_a:ga):_c.value}},ty.apply(this,arguments)}function ry(_a,_o){return function(ga){if(Array.isArray(ga))return ga}(_a)||function(ga,ba){var _c=ga==null?null:typeof Symbol<"u"&&ga[Symbol.iterator]||ga["@@iterator"];if(_c!=null){var _d,ey,ny,oy,ay=[],dy=!0,gy=!1;try{if(ny=(_c=_c.call(ga)).next,ba===0){if(Object(_c)!==_c)return;dy=!1}else for(;!(dy=(_d=ny.call(_c)).done)&&(ay.push(_d.value),ay.length!==ba);dy=!0);}catch(yy){gy=!0,ey=yy}finally{try{if(!dy&&_c.return!=null&&(oy=_c.return(),Object(oy)!==oy))return}finally{if(gy)throw ey}}return ay}}(_a,_o)||uy(_a,_o)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function ly(_a){return function(_o){if(Array.isArray(_o))return py(_o)}(_a)||function(_o){if(typeof Symbol<"u"&&_o[Symbol.iterator]!=null||_o["@@iterator"]!=null)return Array.from(_o)}(_a)||uy(_a)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function uy(_a,_o){if(_a){if(typeof _a=="string")return py(_a,_o);var ga=Object.prototype.toString.call(_a).slice(8,-1);return ga==="Object"&&_a.constructor&&(ga=_a.constructor.name),ga==="Map"||ga==="Set"?Array.from(_a):ga==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(ga)?py(_a,_o):void 0}}function py(_a,_o){(_o==null||_o>_a.length)&&(_o=_a.length);for(var ga=0,ba=new Array(_o);ga<_o;ga++)ba[ga]=_a[ga];return ba}o(`.H_l_right .venues-ui__drawings .trigger.button--active .arrow {
  transform: rotate(90deg);
}
.H_l_right .venues-ui__drawings .drawings {
  right: 45px;
  left: initial;
}`);var fy=function(_a){function _o(ga){var ba;return _r(this,_o),(ba=s(this,_o)).id=ga.id,ba.model=ga,ba}return _l(_o,H.map.Feature),_n(_o,[{key:"getData",value:function(){return this.model}},{key:"getAddress",value:function(){return this.model.getInternalAddress()}},{key:"getCenter",value:function(){var ga=ry(this.model.getCenter(),2),ba=ga[0],_c=ga[1];return new H.geo.Point(_c,ba)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"toGeoJSON",value:function(){return this.model.toJSON()}},{key:"getLevel",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getLevel().getDrawing().getParentEventTarget()}}])}(),my=function(_a){function _o(ga){var ba;return _r(this,_o),(ba=s(this,_o)).id=ga.id,ba.model=ga,ba}return _l(_o,H.map.Feature),_n(_o,[{key:"getData",value:function(){return this.model}},{key:"getBoundingBox",value:function(){return h(H.geo.Rect,ly(this.model.getBoundingBox()))}},{key:"getCenter",value:function(){var ga=ry(this.model.getCenter(),2),ba=ga[0],_c=ga[1];return new H.geo.Point(_c,ba)}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getLevel",value:function(ga){return this.getLevels().find(function(ba){return ba.getIdentifier()===ga})}},{key:"getLevels",value:function(){var ga=this.getData().getLevels().map(function(ba){return ba.getIdentifier()});return this.getVenue().getLevels().filter(function(ba){return ga.indexOf(ba.id)!==-1})}},{key:"getMainLevel",value:function(){return this.getLevel(this.model.getMainLevel().getIdentifier())}},{key:"getVenue",value:function(){return this.getParentEventTarget()}}])}(),xy=function(_a){function _o(ga){var ba;return _r(this,_o),(ba=s(this,_o)).id=ga.id,ba.model=ga,ba}return _l(_o,H.map.Feature),_n(_o,[{key:"getGeometry",value:function(ga){return this.getGeometries().find(function(ba){return ba.getIdentifier()===ga})}},{key:"getGeometries",value:function(){var ga=this.getData().getGeometries().map(function(ba){return ba.getIdentifier()});return this.getDrawing().getVenue().getGeometries().filter(function(ba){return ga.indexOf(ba.id)!==-1})}},{key:"getData",value:function(){return this.model}},{key:"getId",value:function(){return this.model.getId()}},{key:"getIdentifier",value:function(){return this.model.getIdentifier()}},{key:"getName",value:function(){return this.model.getDisplayName()}},{key:"getShortName",value:function(){return this.model.getShortName()}},{key:"getZIndex",value:function(){return this.model.getZIndex()}},{key:"isMain",value:function(){return this.model.isMain()}},{key:"getDrawing",value:function(){return this.getParentEventTarget()}},{key:"getVenue",value:function(){return this.getDrawing().getParentEventTarget()}}])}();function Ly(_a,_o,ga,ba){for(var _c,_d=ba,ey=ga-_o>>1,ny=ga-_o,oy=_a[_o],ay=_a[_o+1],dy=_a[ga],gy=_a[ga+1],yy=_o+3;yy<ga;yy+=3){var _y=My(_a[yy],_a[yy+1],oy,ay,dy,gy);if(_y>_d)_c=yy,_d=_y;else if(_y===_d){var by=Math.abs(yy-ey);by<ny&&(_c=yy,ny=by)}}_d>ba&&(_c-_o>3&&Ly(_a,_o,_c,ba),_a[_c+2]=_d,ga-_c>3&&Ly(_a,_c,ga,ba))}function My(_a,_o,ga,ba,_c,_d){var ey=_c-ga,ny=_d-ba;if(ey!==0||ny!==0){var oy=((_a-ga)*ey+(_o-ba)*ny)/(ey*ey+ny*ny);oy>1?(ga=_c,ba=_d):oy>0&&(ga+=ey*oy,ba+=ny*oy)}return(ey=_a-ga)*ey+(ny=_o-ba)*ny}function Ry(_a,_o,ga,ba){var _c={id:_a===void 0?null:_a,type:_o,geometry:ga,tags:ba,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(_d){var ey=_d.geometry,ny=_d.type;if(ny==="Point"||ny==="MultiPoint"||ny==="LineString")Sy(_d,ey);else if(ny==="Polygon"||ny==="MultiLineString")for(var oy=0;oy<ey.length;oy++)Sy(_d,ey[oy]);else if(ny==="MultiPolygon")for(oy=0;oy<ey.length;oy++)for(var ay=0;ay<ey[oy].length;ay++)Sy(_d,ey[oy][ay])}(_c),_c}function Sy(_a,_o){for(var ga=0;ga<_o.length;ga+=3)_a.minX=Math.min(_a.minX,_o[ga]),_a.minY=Math.min(_a.minY,_o[ga+1]),_a.maxX=Math.max(_a.maxX,_o[ga]),_a.maxY=Math.max(_a.maxY,_o[ga+1])}function Zy(_a,_o,ga,ba){if(_o.geometry){var _c=_o.geometry.coordinates,_d=_o.geometry.type,ey=Math.pow(ga.tolerance/((1<<ga.maxZoom)*ga.extent),2),ny=[],oy=_o.id;if(ga.promoteId?oy=_o.properties[ga.promoteId]:ga.generateId&&(oy=ba||0),_d==="Point")qy(_c,ny);else if(_d==="MultiPoint")for(var ay=0;ay<_c.length;ay++)qy(_c[ay],ny);else if(_d==="LineString")_m(_c,ny,ey,!1);else if(_d==="MultiLineString"){if(ga.lineMetrics){for(ay=0;ay<_c.length;ay++)ny=[],_m(_c[ay],ny,ey,!1),_a.push(Ry(oy,"LineString",ny,_o.properties));return}ky(_c,ny,ey,!1)}else if(_d==="Polygon")ky(_c,ny,ey,!0);else{if(_d!=="MultiPolygon"){if(_d==="GeometryCollection"){for(ay=0;ay<_o.geometry.geometries.length;ay++)Zy(_a,{id:oy,geometry:_o.geometry.geometries[ay],properties:_o.properties},ga,ba);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ay=0;ay<_c.length;ay++){var dy=[];ky(_c[ay],dy,ey,!0),ny.push(dy)}}_a.push(Ry(oy,_d,ny,_o.properties))}}function qy(_a,_o){_o.push(Dy(_a[0])),_o.push(Gy(_a[1])),_o.push(0)}function _m(_a,_o,ga,ba){for(var _c,_d,ey=0,ny=0;ny<_a.length;ny++){var oy=Dy(_a[ny][0]),ay=Gy(_a[ny][1]);_o.push(oy),_o.push(ay),_o.push(0),ny>0&&(ey+=ba?(_c*ay-oy*_d)/2:Math.sqrt(Math.pow(oy-_c,2)+Math.pow(ay-_d,2))),_c=oy,_d=ay}var dy=_o.length-3;_o[2]=1,Ly(_o,0,dy,ga),_o[dy+2]=1,_o.size=Math.abs(ey),_o.start=0,_o.end=_o.size}function ky(_a,_o,ga,ba){for(var _c=0;_c<_a.length;_c++){var _d=[];_m(_a[_c],_d,ga,ba),_o.push(_d)}}function Dy(_a){return _a/360+.5}function Gy(_a){var _o=Math.sin(_a*Math.PI/180),ga=.5-.25*Math.log((1+_o)/(1-_o))/Math.PI;return ga<0?0:ga>1?1:ga}function Ky(_a,_o,ga,ba,_c,_d,ey,ny){if(ba/=_o,_d>=(ga/=_o)&&ey<ba)return _a;if(ey<ga||_d>=ba)return null;for(var oy=[],ay=0;ay<_a.length;ay++){var dy=_a[ay],gy=dy.geometry,yy=dy.type,_y=_c===0?dy.minX:dy.minY,by=_c===0?dy.maxX:dy.maxY;if(_y>=ga&&by<ba)oy.push(dy);else if(!(by<ga||_y>=ba)){var wy=[];if(yy==="Point"||yy==="MultiPoint")sv(gy,wy,ga,ba,_c);else if(yy==="LineString")Hy(gy,wy,ga,ba,_c,!1,ny.lineMetrics);else if(yy==="MultiLineString")_v(gy,wy,ga,ba,_c,!1);else if(yy==="Polygon")_v(gy,wy,ga,ba,_c,!0);else if(yy==="MultiPolygon")for(var Ty=0;Ty<gy.length;Ty++){var Ny=[];_v(gy[Ty],Ny,ga,ba,_c,!0),Ny.length&&wy.push(Ny)}if(wy.length){if(ny.lineMetrics&&yy==="LineString"){for(Ty=0;Ty<wy.length;Ty++)oy.push(Ry(dy.id,yy,wy[Ty],dy.tags));continue}yy!=="LineString"&&yy!=="MultiLineString"||(wy.length===1?(yy="LineString",wy=wy[0]):yy="MultiLineString"),yy!=="Point"&&yy!=="MultiPoint"||(yy=wy.length===3?"Point":"MultiPoint"),oy.push(Ry(dy.id,yy,wy,dy.tags))}}}return oy.length?oy:null}function sv(_a,_o,ga,ba,_c){for(var _d=0;_d<_a.length;_d+=3){var ey=_a[_d+_c];ey>=ga&&ey<=ba&&(_o.push(_a[_d]),_o.push(_a[_d+1]),_o.push(_a[_d+2]))}}function Hy(_a,_o,ga,ba,_c,_d,ey){for(var ny,oy,ay=vv(_a),dy=_c===0?Mv:Nv,gy=_a.start,yy=0;yy<_a.length-3;yy+=3){var _y=_a[yy],by=_a[yy+1],wy=_a[yy+2],Ty=_a[yy+3],Ny=_a[yy+4],By=_c===0?_y:by,$y=_c===0?Ty:Ny,Xy=!1;ey&&(ny=Math.sqrt(Math.pow(_y-Ty,2)+Math.pow(by-Ny,2))),By<ga?$y>ga&&(oy=dy(ay,_y,by,Ty,Ny,ga),ey&&(ay.start=gy+ny*oy)):By>ba?$y<ba&&(oy=dy(ay,_y,by,Ty,Ny,ba),ey&&(ay.start=gy+ny*oy)):Av(ay,_y,by,wy),$y<ga&&By>=ga&&(oy=dy(ay,_y,by,Ty,Ny,ga),Xy=!0),$y>ba&&By<=ba&&(oy=dy(ay,_y,by,Ty,Ny,ba),Xy=!0),!_d&&Xy&&(ey&&(ay.end=gy+ny*oy),_o.push(ay),ay=vv(_a)),ey&&(gy+=ny)}var Yy=_a.length-3;_y=_a[Yy],by=_a[Yy+1],wy=_a[Yy+2],(By=_c===0?_y:by)>=ga&&By<=ba&&Av(ay,_y,by,wy),Yy=ay.length-3,_d&&Yy>=3&&(ay[Yy]!==ay[0]||ay[Yy+1]!==ay[1])&&Av(ay,ay[0],ay[1],ay[2]),ay.length&&_o.push(ay)}function vv(_a){var _o=[];return _o.size=_a.size,_o.start=_a.start,_o.end=_a.end,_o}function _v(_a,_o,ga,ba,_c,_d){for(var ey=0;ey<_a.length;ey++)Hy(_a[ey],_o,ga,ba,_c,_d,!1)}function Av(_a,_o,ga,ba){_a.push(_o),_a.push(ga),_a.push(ba)}function Mv(_a,_o,ga,ba,_c,_d){var ey=(_d-_o)/(ba-_o);return _a.push(_d),_a.push(ga+(_c-ga)*ey),_a.push(1),ey}function Nv(_a,_o,ga,ba,_c,_d){var ey=(_d-ga)/(_c-ga);return _a.push(_o+(ba-_o)*ey),_a.push(_d),_a.push(1),ey}function iv(_a,_o){for(var ga=[],ba=0;ba<_a.length;ba++){var _c,_d=_a[ba],ey=_d.type;if(ey==="Point"||ey==="MultiPoint"||ey==="LineString")_c=Ov(_d.geometry,_o);else if(ey==="MultiLineString"||ey==="Polygon"){_c=[];for(var ny=0;ny<_d.geometry.length;ny++)_c.push(Ov(_d.geometry[ny],_o))}else if(ey==="MultiPolygon")for(_c=[],ny=0;ny<_d.geometry.length;ny++){for(var oy=[],ay=0;ay<_d.geometry[ny].length;ay++)oy.push(Ov(_d.geometry[ny][ay],_o));_c.push(oy)}ga.push(Ry(_d.id,ey,_c,_d.tags))}return ga}function Ov(_a,_o){var ga=[];ga.size=_a.size,_a.start!==void 0&&(ga.start=_a.start,ga.end=_a.end);for(var ba=0;ba<_a.length;ba+=3)ga.push(_a[ba]+_o,_a[ba+1],_a[ba+2]);return ga}function Qv(_a,_o){if(_a.transformed)return _a;var ga,ba,_c,_d=1<<_a.z,ey=_a.x,ny=_a.y;for(ga=0;ga<_a.features.length;ga++){var oy=_a.features[ga],ay=oy.geometry,dy=oy.type;if(oy.geometry=[],dy===1)for(ba=0;ba<ay.length;ba+=2)oy.geometry.push(t0(ay[ba],ay[ba+1],_o,_d,ey,ny));else for(ba=0;ba<ay.length;ba++){var gy=[];for(_c=0;_c<ay[ba].length;_c+=2)gy.push(t0(ay[ba][_c],ay[ba][_c+1],_o,_d,ey,ny));oy.geometry.push(gy)}}return _a.transformed=!0,_a}function t0(_a,_o,ga,ba,_c,_d){return[Math.round(ga*(_a*ba-_c)),Math.round(ga*(_o*ba-_d))]}function s0(_a,_o,ga,ba,_c){for(var _d=_o===_c.maxZoom?0:_c.tolerance/((1<<_o)*_c.extent),ey={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ga,y:ba,z:_o,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ny=0;ny<_a.length;ny++){ey.numFeatures++,Gv(ey,_a[ny],_d,_c);var oy=_a[ny].minX,ay=_a[ny].minY,dy=_a[ny].maxX,gy=_a[ny].maxY;oy<ey.minX&&(ey.minX=oy),ay<ey.minY&&(ey.minY=ay),dy>ey.maxX&&(ey.maxX=dy),gy>ey.maxY&&(ey.maxY=gy)}return ey}function Gv(_a,_o,ga,ba){var _c=_o.geometry,_d=_o.type,ey=[];if(_d==="Point"||_d==="MultiPoint")for(var ny=0;ny<_c.length;ny+=3)ey.push(_c[ny]),ey.push(_c[ny+1]),_a.numPoints++,_a.numSimplified++;else if(_d==="LineString")Zv(ey,_c,_a,ga,!1,!1);else if(_d==="MultiLineString"||_d==="Polygon")for(ny=0;ny<_c.length;ny++)Zv(ey,_c[ny],_a,ga,_d==="Polygon",ny===0);else if(_d==="MultiPolygon")for(var oy=0;oy<_c.length;oy++){var ay=_c[oy];for(ny=0;ny<ay.length;ny++)Zv(ey,ay[ny],_a,ga,!0,ny===0)}if(ey.length){var dy=_o.tags||null;if(_d==="LineString"&&ba.lineMetrics){for(var gy in dy={},_o.tags)dy[gy]=_o.tags[gy];dy.mapbox_clip_start=_c.start/_c.size,dy.mapbox_clip_end=_c.end/_c.size}var yy={geometry:ey,type:_d==="Polygon"||_d==="MultiPolygon"?3:_d==="LineString"||_d==="MultiLineString"?2:1,tags:dy};_o.id!==null&&(yy.id=_o.id),_a.features.push(yy)}}function Zv(_a,_o,ga,ba,_c,_d){var ey=ba*ba;if(ba>0&&_o.size<(_c?ey:ba))ga.numPoints+=_o.length/3;else{for(var ny=[],oy=0;oy<_o.length;oy+=3)(ba===0||_o[oy+2]>ey)&&(ga.numSimplified++,ny.push(_o[oy]),ny.push(_o[oy+1])),ga.numPoints++;_c&&function(ay,dy){for(var gy=0,yy=0,_y=ay.length,by=_y-2;yy<_y;by=yy,yy+=2)gy+=(ay[yy]-ay[by])*(ay[yy+1]+ay[by+1]);if(gy>0===dy)for(yy=0,_y=ay.length;yy<_y/2;yy+=2){var wy=ay[yy],Ty=ay[yy+1];ay[yy]=ay[_y-2-yy],ay[yy+1]=ay[_y-1-yy],ay[_y-2-yy]=wy,ay[_y-1-yy]=Ty}}(ny,_d),_a.push(ny)}}function Wv(_a,_o){var ga=(_o=this.options=function(_c,_d){for(var ey in _d)_c[ey]=_d[ey];return _c}(Object.create(this.options),_o)).debug;if(ga&&console.time("preprocess data"),_o.maxZoom<0||_o.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(_o.promoteId&&_o.generateId)throw new Error("promoteId and generateId cannot be used together.");var ba=function(_c,_d){var ey=[];if(_c.type==="FeatureCollection")for(var ny=0;ny<_c.features.length;ny++)Zy(ey,_c.features[ny],_d,ny);else _c.type==="Feature"?Zy(ey,_c,_d):Zy(ey,{geometry:_c},_d);return ey}(_a,_o);this.tiles={},this.tileCoords=[],ga&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",_o.indexMaxZoom,_o.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ba=function(_c,_d){var ey=_d.buffer/_d.extent,ny=_c,oy=Ky(_c,1,-1-ey,ey,0,-1,2,_d),ay=Ky(_c,1,1-ey,2+ey,0,-1,2,_d);return(oy||ay)&&(ny=Ky(_c,1,-ey,1+ey,0,-1,2,_d)||[],oy&&(ny=iv(oy,1).concat(ny)),ay&&(ny=ny.concat(iv(ay,-1)))),ny}(ba,_o),ba.length&&this.splitTile(ba,0,0,0),ga&&(ba.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Dv(_a,_o,ga){return 32*((1<<_a)*ga+_o)+_a}Wv.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Wv.prototype.splitTile=function(_a,_o,ga,ba,_c,_d,ey){for(var ny=[_a,_o,ga,ba],oy=this.options,ay=oy.debug;ny.length;){ba=ny.pop(),ga=ny.pop(),_o=ny.pop(),_a=ny.pop();var dy=1<<_o,gy=Dv(_o,ga,ba),yy=this.tiles[gy];if(!yy&&(ay>1&&console.time("creation"),yy=this.tiles[gy]=s0(_a,_o,ga,ba,oy),this.tileCoords.push({z:_o,x:ga,y:ba}),ay)){ay>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",_o,ga,ba,yy.numFeatures,yy.numPoints,yy.numSimplified),console.timeEnd("creation"));var _y="z"+_o;this.stats[_y]=(this.stats[_y]||0)+1,this.total++}if(yy.source=_a,_c){if(_o===oy.maxZoom||_o===_c)continue;var by=1<<_c-_o;if(ga!==Math.floor(_d/by)||ba!==Math.floor(ey/by))continue}else if(_o===oy.indexMaxZoom||yy.numPoints<=oy.indexMaxPoints)continue;if(yy.source=null,_a.length!==0){ay>1&&console.time("clipping");var wy,Ty,Ny,By,$y,Xy,Yy=.5*oy.buffer/oy.extent,Qy=.5-Yy,Uy=.5+Yy,Wy=1+Yy;wy=Ty=Ny=By=null,$y=Ky(_a,dy,ga-Yy,ga+Uy,0,yy.minX,yy.maxX,oy),Xy=Ky(_a,dy,ga+Qy,ga+Wy,0,yy.minX,yy.maxX,oy),_a=null,$y&&(wy=Ky($y,dy,ba-Yy,ba+Uy,1,yy.minY,yy.maxY,oy),Ty=Ky($y,dy,ba+Qy,ba+Wy,1,yy.minY,yy.maxY,oy),$y=null),Xy&&(Ny=Ky(Xy,dy,ba-Yy,ba+Uy,1,yy.minY,yy.maxY,oy),By=Ky(Xy,dy,ba+Qy,ba+Wy,1,yy.minY,yy.maxY,oy),Xy=null),ay>1&&console.timeEnd("clipping"),ny.push(wy||[],_o+1,2*ga,2*ba),ny.push(Ty||[],_o+1,2*ga,2*ba+1),ny.push(Ny||[],_o+1,2*ga+1,2*ba),ny.push(By||[],_o+1,2*ga+1,2*ba+1)}}},Wv.prototype.getTile=function(_a,_o,ga){var ba=this.options,_c=ba.extent,_d=ba.debug;if(_a<0||_a>24)return null;var ey=1<<_a,ny=Dv(_a,_o=(_o%ey+ey)%ey,ga);if(this.tiles[ny])return Qv(this.tiles[ny],_c);_d>1&&console.log("drilling down to z%d-%d-%d",_a,_o,ga);for(var oy,ay=_a,dy=_o,gy=ga;!oy&&ay>0;)ay--,dy=Math.floor(dy/2),gy=Math.floor(gy/2),oy=this.tiles[Dv(ay,dy,gy)];return oy&&oy.source?(_d>1&&console.log("found parent tile z%d-%d-%d",ay,dy,gy),_d>1&&console.time("drilling down"),this.splitTile(oy.source,ay,dy,gy,_a,_o,ga),_d>1&&console.timeEnd("drilling down"),this.tiles[ny]?Qv(this.tiles[ny],_c):null):null};var Pv="Point",a0="Polygon",Fv="MultiPoint",$v="MultiLineString",kv="MultiPolygon",z0={fillColor:"#e0e0e0",outlineColor:"#829DB4",outlineWidth:1},k0={fill:"#333333",size:13},l0={fillColor:"#F2F285",outlineColor:"#0088BF",outlineWidth:1.2},g0=16,Z0=18,B0=24,fv={FOOTPRINT:"FOOTPRINT",ICON:"ICON",TEXT:"TEXT",VECTOR:"VECTOR"},X0=Object.freeze({v1:1,v2:2}),dv=1,Kv=2,Hv=3,F0="CW",xv="CCW",nv=function(_a){var _o=function(ga){for(var ba=0,_c=ga.length,_d=0;_d<_c-1;_d+=1){var ey=ga[_d],ny=ga[_d+1];ba+=ey[0]*ny[1]-ny[0]*ey[1]}return ba+(ga[_c-1][0]*ga[0][1]-ga[0][0]*ga[_c-1][1])}(_a);return _o>0?F0:_o<0?xv:void 0},e0=function(_a){for(var _o,ga=[],ba=[],_c=0,_d=_a.coordinates.length;_c<_d;_c+=1){var ey=_a.coordinates[_c],ny=nv(ey);ny!==null&&(ny===(_o=_o||ny)&&ba.length&&(ga.push(ba),ba=[]),ba.push(ey))}return ba.length>0&&ga.push(ba),ga.length===1?(_a.type=a0,_a.coordinates=ga[0]):ga.length>1?(_a.type=kv,_a.coordinates=ga):_a=null,_a},Cy=function(_a,_o,ga,ba,_c){var _d,ey,ny,oy,ay,dy,gy=function(yy,_y,by,wy,Ty){var Ny=1<<_y,By=[];return By[0]=(yy[0]/Ty+by)/Ny,By[1]=(yy[1]/Ty+wy)/Ny,{x:By[0],y:By[1]}}(_a,_o,ga,ba,_c);return ey=(_d=gy).x,ny=_d.y,oy=360*(ey-.5),ay=Math.exp(Math.PI*(.5-ny)/.25)-1,dy=Math.exp(Math.PI*(.5-ny)/.25)+1,[oy,180*Math.asin(ay/dy)/Math.PI]},m0,u0,Xv,c0=(m0=function(_a,_o){_a.exports=function(ga){var ba={};function _c(_d){if(ba[_d])return ba[_d].exports;var ey=ba[_d]={i:_d,l:!1,exports:{}};return ga[_d].call(ey.exports,ey,ey.exports,_c),ey.l=!0,ey.exports}return _c.m=ga,_c.c=ba,_c.d=function(_d,ey,ny){_c.o(_d,ey)||Object.defineProperty(_d,ey,{enumerable:!0,get:ny})},_c.r=function(_d){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_d,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_d,"__esModule",{value:!0})},_c.t=function(_d,ey){if(1&ey&&(_d=_c(_d)),8&ey||4&ey&&_t(_d)=="object"&&_d&&_d.__esModule)return _d;var ny=Object.create(null);if(_c.r(ny),Object.defineProperty(ny,"default",{enumerable:!0,value:_d}),2&ey&&typeof _d!="string")for(var oy in _d)_c.d(ny,oy,(function(ay){return _d[ay]}).bind(null,oy));return ny},_c.n=function(_d){var ey=_d&&_d.__esModule?function(){return _d.default}:function(){return _d};return _c.d(ey,"a",ey),ey},_c.o=function(_d,ey){return Object.prototype.hasOwnProperty.call(_d,ey)},_c.p="",_c(_c.s=0)}([function(ga,ba,_c){function _d(yy){return(_d=typeof Symbol=="function"&&_t(Symbol.iterator)=="symbol"?function(_y){return _t(_y)}:function(_y){return _y&&typeof Symbol=="function"&&_y.constructor===Symbol&&_y!==Symbol.prototype?"symbol":_t(_y)})(yy)}function ey(yy,_y){for(var by=0;by<_y.length;by++){var wy=_y[by];wy.enumerable=wy.enumerable||!1,wy.configurable=!0,"value"in wy&&(wy.writable=!0),Object.defineProperty(yy,wy.key,wy)}}var ny=_c(1),oy=_c(7),ay=oy.get,dy=(oy.deepValue,oy.isArray),gy=function(){function yy(by,wy){var Ty=wy.location,Ny=Ty===void 0?0:Ty,By=wy.distance,$y=By===void 0?100:By,Xy=wy.threshold,Yy=Xy===void 0?.6:Xy,Qy=wy.maxPatternLength,Uy=Qy===void 0?32:Qy,Wy=wy.caseSensitive,Vy=Wy!==void 0&&Wy,ov=wy.tokenSeparator,hv=ov===void 0?/ +/g:ov,Iv=wy.findAllMatches,gv=Iv!==void 0&&Iv,Lv=wy.minMatchCharLength,Yv=Lv===void 0?1:Lv,Oy=wy.id,Py=Oy===void 0?null:Oy,jy=wy.keys,Jy=jy===void 0?[]:jy,zy=wy.shouldSort,tv=zy===void 0||zy,rv=wy.getFn,Ev=rv===void 0?ay:rv,mv=wy.sortFn,Tv=mv===void 0?function(o0,S0){return o0.score-S0.score}:mv,yv=wy.tokenize,Rv=yv!==void 0&&yv,n0=wy.matchAllTokens,d0=n0!==void 0&&n0,T0=wy.includeMatches,y0=T0!==void 0&&T0,A0=wy.includeScore,N0=A0!==void 0&&A0,j0=wy.verbose,D0=j0!==void 0&&j0;(function(o0,S0){if(!(o0 instanceof S0))throw new TypeError("Cannot call a class as a function")})(this,yy),this.options={location:Ny,distance:$y,threshold:Yy,maxPatternLength:Uy,isCaseSensitive:Vy,tokenSeparator:hv,findAllMatches:gv,minMatchCharLength:Yv,id:Py,keys:Jy,includeMatches:y0,includeScore:N0,shouldSort:tv,getFn:Ev,sortFn:Tv,verbose:D0,tokenize:Rv,matchAllTokens:d0},this.setCollection(by),this._processKeys(Jy)}var _y;return(_y=[{key:"setCollection",value:function(by){return this.list=by,by}},{key:"_processKeys",value:function(by){if(this._keyWeights={},this._keyNames=[],by.length&&typeof by[0]=="string")for(var wy=0,Ty=by.length;wy<Ty;wy+=1){var Ny=by[wy];this._keyWeights[Ny]=1,this._keyNames.push(Ny)}else{for(var By=null,$y=null,Xy=0,Yy=0,Qy=by.length;Yy<Qy;Yy+=1){var Uy=by[Yy];if(!Uy.hasOwnProperty("name"))throw new Error('Missing "name" property in key object');var Wy=Uy.name;if(this._keyNames.push(Wy),!Uy.hasOwnProperty("weight"))throw new Error('Missing "weight" property in key object');var Vy=Uy.weight;if(Vy<0||Vy>1)throw new Error('"weight" property in key must bein the range of [0, 1)');$y=$y==null?Vy:Math.max($y,Vy),By=By==null?Vy:Math.min(By,Vy),this._keyWeights[Wy]=Vy,Xy+=Vy}if(Xy>1)throw new Error("Total of weights cannot exceed 1")}}},{key:"search",value:function(by){var wy=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{limit:!1};this._log(`---------
Search pattern: "`.concat(by,'"'));var Ty=this._prepareSearchers(by),Ny=Ty.tokenSearchers,By=Ty.fullSearcher,$y=this._search(Ny,By);return this._computeScore($y),this.options.shouldSort&&this._sort($y),wy.limit&&typeof wy.limit=="number"&&($y=$y.slice(0,wy.limit)),this._format($y)}},{key:"_prepareSearchers",value:function(){var by=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",wy=[];if(this.options.tokenize)for(var Ty=by.split(this.options.tokenSeparator),Ny=0,By=Ty.length;Ny<By;Ny+=1)wy.push(new ny(Ty[Ny],this.options));return{tokenSearchers:wy,fullSearcher:new ny(by,this.options)}}},{key:"_search",value:function(){var by=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],wy=arguments.length>1?arguments[1]:void 0,Ty=this.list,Ny={},By=[];if(typeof Ty[0]=="string"){for(var $y=0,Xy=Ty.length;$y<Xy;$y+=1)this._analyze({key:"",value:Ty[$y],record:$y,index:$y},{resultMap:Ny,results:By,tokenSearchers:by,fullSearcher:wy});return By}for(var Yy=0,Qy=Ty.length;Yy<Qy;Yy+=1)for(var Uy=Ty[Yy],Wy=0,Vy=this._keyNames.length;Wy<Vy;Wy+=1){var ov=this._keyNames[Wy];this._analyze({key:ov,value:this.options.getFn(Uy,ov),record:Uy,index:Yy},{resultMap:Ny,results:By,tokenSearchers:by,fullSearcher:wy})}return By}},{key:"_analyze",value:function(by,wy){var Ty=this,Ny=by.key,By=by.arrayIndex,$y=By===void 0?-1:By,Xy=by.value,Yy=by.record,Qy=by.index,Uy=wy.tokenSearchers,Wy=Uy===void 0?[]:Uy,Vy=wy.fullSearcher,ov=wy.resultMap,hv=ov===void 0?{}:ov,Iv=wy.results,gv=Iv===void 0?[]:Iv;(function Lv(Yv,Oy,Py,jy){if(Oy!=null){if(typeof Oy=="string"){var Jy=!1,zy=-1,tv=0;Ty._log(`
Key: `.concat(Ny===""?"--":Ny));var rv=Vy.search(Oy);if(Ty._log('Full text: "'.concat(Oy,'", score: ').concat(rv.score)),Ty.options.tokenize){for(var Ev=Oy.split(Ty.options.tokenSeparator),mv=Ev.length,Tv=[],yv=0,Rv=Wy.length;yv<Rv;yv+=1){var n0=Wy[yv];Ty._log(`
Pattern: "`.concat(n0.pattern,'"'));for(var d0=!1,T0=0;T0<mv;T0+=1){var y0=Ev[T0],A0=n0.search(y0),N0={};A0.isMatch?(N0[y0]=A0.score,Jy=!0,d0=!0,Tv.push(A0.score)):(N0[y0]=1,Ty.options.matchAllTokens||Tv.push(1)),Ty._log('Token: "'.concat(y0,'", score: ').concat(N0[y0]))}d0&&(tv+=1)}zy=Tv[0];for(var j0=Tv.length,D0=1;D0<j0;D0+=1)zy+=Tv[D0];zy/=j0,Ty._log("Token score average:",zy)}var o0=rv.score;zy>-1&&(o0=(o0+zy)/2),Ty._log("Score average:",o0);var S0=!Ty.options.tokenize||!Ty.options.matchAllTokens||tv>=Wy.length;if(Ty._log(`
Check Matches: `.concat(S0)),(Jy||rv.isMatch)&&S0){var e1={key:Ny,arrayIndex:Yv,value:Oy,score:o0};Ty.options.includeMatches&&(e1.matchedIndices=rv.matchedIndices);var h1=hv[jy];h1?h1.output.push(e1):(hv[jy]={item:Py,output:[e1]},gv.push(hv[jy]))}}else if(dy(Oy))for(var K0=0,M1=Oy.length;K0<M1;K0+=1)Lv(K0,Oy[K0],Py,jy)}})($y,Xy,Yy,Qy)}},{key:"_computeScore",value:function(by){this._log(`

Computing score:
`);for(var wy=this._keyWeights,Ty=!!Object.keys(wy).length,Ny=0,By=by.length;Ny<By;Ny+=1){for(var $y=by[Ny],Xy=$y.output,Yy=Xy.length,Qy=1,Uy=0;Uy<Yy;Uy+=1){var Wy=Xy[Uy],Vy=Wy.key,ov=Ty?wy[Vy]:1,hv=Wy.score===0&&wy&&wy[Vy]>0?Number.EPSILON:Wy.score;Qy*=Math.pow(hv,ov)}$y.score=Qy,this._log($y)}}},{key:"_sort",value:function(by){this._log(`

Sorting....`),by.sort(this.options.sortFn)}},{key:"_format",value:function(by){var wy=[];if(this.options.verbose){var Ty=[];this._log(`

Output:

`,JSON.stringify(by,function(Wy,Vy){if(_d(Vy)==="object"&&Vy!==null){if(Ty.indexOf(Vy)!==-1)return;Ty.push(Vy)}return Vy},2)),Ty=null}var Ny=[];this.options.includeMatches&&Ny.push(function(Wy,Vy){var ov=Wy.output;Vy.matches=[];for(var hv=0,Iv=ov.length;hv<Iv;hv+=1){var gv=ov[hv];if(gv.matchedIndices.length!==0){var Lv={indices:gv.matchedIndices,value:gv.value};gv.key&&(Lv.key=gv.key),gv.hasOwnProperty("arrayIndex")&&gv.arrayIndex>-1&&(Lv.arrayIndex=gv.arrayIndex),Vy.matches.push(Lv)}}}),this.options.includeScore&&Ny.push(function(Wy,Vy){Vy.score=Wy.score});for(var By=0,$y=by.length;By<$y;By+=1){var Xy=by[By];if(this.options.id&&(Xy.item=this.options.getFn(Xy.item,this.options.id)[0]),Ny.length){for(var Yy={item:Xy.item},Qy=0,Uy=Ny.length;Qy<Uy;Qy+=1)Ny[Qy](Xy,Yy);wy.push(Yy)}else wy.push(Xy.item)}return wy}},{key:"_log",value:function(){var by;this.options.verbose&&(by=console).log.apply(by,arguments)}}])&&ey(yy.prototype,_y),yy}();ga.exports=gy},function(ga,ba,_c){function _d(dy,gy){for(var yy=0;yy<gy.length;yy++){var _y=gy[yy];_y.enumerable=_y.enumerable||!1,_y.configurable=!0,"value"in _y&&(_y.writable=!0),Object.defineProperty(dy,_y.key,_y)}}var ey=_c(2),ny=_c(3),oy=_c(6),ay=function(){function dy(yy,_y){var by=_y.location,wy=by===void 0?0:by,Ty=_y.distance,Ny=Ty===void 0?100:Ty,By=_y.threshold,$y=By===void 0?.6:By,Xy=_y.maxPatternLength,Yy=Xy===void 0?32:Xy,Qy=_y.isCaseSensitive,Uy=Qy!==void 0&&Qy,Wy=_y.tokenSeparator,Vy=Wy===void 0?/ +/g:Wy,ov=_y.findAllMatches,hv=ov!==void 0&&ov,Iv=_y.minMatchCharLength,gv=Iv===void 0?1:Iv,Lv=_y.includeMatches,Yv=Lv!==void 0&&Lv;(function(Oy,Py){if(!(Oy instanceof Py))throw new TypeError("Cannot call a class as a function")})(this,dy),this.options={location:wy,distance:Ny,threshold:$y,maxPatternLength:Yy,isCaseSensitive:Uy,tokenSeparator:Vy,findAllMatches:hv,includeMatches:Yv,minMatchCharLength:gv},this.pattern=Uy?yy:yy.toLowerCase(),this.pattern.length<=Yy&&(this.patternAlphabet=oy(this.pattern))}var gy;return(gy=[{key:"search",value:function(yy){var _y=this.options,by=_y.isCaseSensitive,wy=_y.includeMatches;if(by||(yy=yy.toLowerCase()),this.pattern===yy){var Ty={isMatch:!0,score:0};return wy&&(Ty.matchedIndices=[[0,yy.length-1]]),Ty}var Ny=this.options,By=Ny.maxPatternLength,$y=Ny.tokenSeparator;if(this.pattern.length>By)return ey(yy,this.pattern,$y);var Xy=this.options,Yy=Xy.location,Qy=Xy.distance,Uy=Xy.threshold,Wy=Xy.findAllMatches,Vy=Xy.minMatchCharLength;return ny(yy,this.pattern,this.patternAlphabet,{location:Yy,distance:Qy,threshold:Uy,findAllMatches:Wy,minMatchCharLength:Vy,includeMatches:wy})}}])&&_d(dy.prototype,gy),dy}();ga.exports=ay},function(ga,ba){var _c=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;ga.exports=function(_d,ey){var ny=arguments.length>2&&arguments[2]!==void 0?arguments[2]:/ +/g,oy=new RegExp(ey.replace(_c,"\\$&").replace(ny,"|")),ay=_d.match(oy),dy=!!ay,gy=[];if(dy)for(var yy=0,_y=ay.length;yy<_y;yy+=1){var by=ay[yy];gy.push([_d.indexOf(by),by.length-1])}return{score:dy?.5:1,isMatch:dy,matchedIndices:gy}}},function(ga,ba,_c){var _d=_c(4),ey=_c(5);ga.exports=function(ny,oy,ay,dy){for(var gy=dy.location,yy=gy===void 0?0:gy,_y=dy.distance,by=_y===void 0?100:_y,wy=dy.threshold,Ty=wy===void 0?.6:wy,Ny=dy.findAllMatches,By=Ny!==void 0&&Ny,$y=dy.minMatchCharLength,Xy=$y===void 0?1:$y,Yy=dy.includeMatches,Qy=Yy!==void 0&&Yy,Uy=yy,Wy=ny.length,Vy=Ty,ov=ny.indexOf(oy,Uy),hv=oy.length,Iv=[],gv=0;gv<Wy;gv+=1)Iv[gv]=0;if(ov!==-1){var Lv=_d(oy,{errors:0,currentLocation:ov,expectedLocation:Uy,distance:by});if(Vy=Math.min(Lv,Vy),(ov=ny.lastIndexOf(oy,Uy+hv))!==-1){var Yv=_d(oy,{errors:0,currentLocation:ov,expectedLocation:Uy,distance:by});Vy=Math.min(Yv,Vy)}}ov=-1;for(var Oy=[],Py=1,jy=hv+Wy,Jy=1<<(hv<=31?hv-1:30),zy=0;zy<hv;zy+=1){for(var tv=0,rv=jy;tv<rv;)_d(oy,{errors:zy,currentLocation:Uy+rv,expectedLocation:Uy,distance:by})<=Vy?tv=rv:jy=rv,rv=Math.floor((jy-tv)/2+tv);jy=rv;var Ev=Math.max(1,Uy-rv+1),mv=By?Wy:Math.min(Uy+rv,Wy)+hv,Tv=Array(mv+2);Tv[mv+1]=(1<<zy)-1;for(var yv=mv;yv>=Ev;yv-=1){var Rv=yv-1,n0=ay[ny.charAt(Rv)];if(n0&&(Iv[Rv]=1),Tv[yv]=(Tv[yv+1]<<1|1)&n0,zy!==0&&(Tv[yv]|=(Oy[yv+1]|Oy[yv])<<1|1|Oy[yv+1]),Tv[yv]&Jy&&(Py=_d(oy,{errors:zy,currentLocation:Rv,expectedLocation:Uy,distance:by}))<=Vy){if(Vy=Py,(ov=Rv)<=Uy)break;Ev=Math.max(1,2*Uy-ov)}}if(_d(oy,{errors:zy+1,currentLocation:Uy,expectedLocation:Uy,distance:by})>Vy)break;Oy=Tv}var d0={isMatch:ov>=0,score:Py===0?.001:Py};return Qy&&(d0.matchedIndices=ey(Iv,Xy)),d0}},function(ga,ba){ga.exports=function(_c,_d){var ey=_d.errors,ny=ey===void 0?0:ey,oy=_d.currentLocation,ay=oy===void 0?0:oy,dy=_d.expectedLocation,gy=dy===void 0?0:dy,yy=_d.distance,_y=yy===void 0?100:yy,by=ny/_c.length,wy=Math.abs(gy-ay);return _y?by+wy/_y:wy?1:by}},function(ga,ba){ga.exports=function(){for(var _c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,ey=[],ny=-1,oy=-1,ay=0,dy=_c.length;ay<dy;ay+=1){var gy=_c[ay];gy&&ny===-1?ny=ay:gy||ny===-1||((oy=ay-1)-ny+1>=_d&&ey.push([ny,oy]),ny=-1)}return _c[ay-1]&&ay-ny>=_d&&ey.push([ny,ay-1]),ey}},function(ga,ba){ga.exports=function(_c){for(var _d={},ey=_c.length,ny=0;ny<ey;ny+=1)_d[_c.charAt(ny)]=0;for(var oy=0;oy<ey;oy+=1)_d[_c.charAt(oy)]|=1<<ey-oy-1;return _d}},function(ga,ba){var _c=function(oy){return Array.isArray?Array.isArray(oy):Object.prototype.toString.call(oy)==="[object Array]"},_d=function(oy){return oy==null?"":function(ay){if(typeof ay=="string")return ay;var dy=ay+"";return dy=="0"&&1/ay==-1/0?"-0":dy}(oy)},ey=function(oy){return typeof oy=="string"},ny=function(oy){return typeof oy=="number"};ga.exports={get:function(oy,ay){var dy=[];return function gy(yy,_y){if(_y){var by=_y.indexOf("."),wy=_y,Ty=null;by!==-1&&(wy=_y.slice(0,by),Ty=_y.slice(by+1));var Ny=yy[wy];if(Ny!=null)if(Ty||!ey(Ny)&&!ny(Ny))if(_c(Ny))for(var By=0,$y=Ny.length;By<$y;By+=1)gy(Ny[By],Ty);else Ty&&gy(Ny,Ty);else dy.push(_d(Ny))}else dy.push(yy)}(oy,ay),dy},isArray:_c,isString:ey,isNum:ny,toString:_d}}])},m0(u0={exports:{}},u0.exports),u0.exports),v0=(Xv=c0)&&Xv.__esModule&&Object.prototype.hasOwnProperty.call(Xv,"default")?Xv.default:Xv;c0.Fuse;var r0,O0=_n(function _a(_o){var ga=_o.addressList,ba=ga===void 0?[]:ga,_c=_o.geometries,_d=_c===void 0?[]:_c,ey=_o.entity,ny=ey===void 0?null:ey,oy=_o.name,ay=oy===void 0?"":oy,dy=_o.icon,gy=dy===void 0?"":dy;_r(this,_a),this.addressList=ba,this.geometries=_d,this.icon=gy,this.entity=ny,this.name=ay}),$0={keys:[{name:"name",weight:.6},{name:"addressList",weight:.4}],threshold:.2},U0=function(){return _n(function _a(_o){_r(this,_a),this.fuseSearch=null,this.levels_=null,this.searchListEntities_=[],this.searchListIcons_=[],this.searchList_=[],this.venueModel=_o,this.init()},[{key:"init",value:function(){var _a=this.venueModel.getGeometries().reduce(function(ga,ba){var _c=ga;return _c[ba.getId()]=ba,_c},{});this.initEntityList(this.venueModel.getOccupant()),this.initIconList(_a),this.levels_=this.venueModel.getLevels().map(function(ga){return{levelId:ga.getId(),levelName:ga.getName(),drawingId:ga.getDrawing().getId(),drawingName:ga.getDrawing().getName()}});var _o=[].concat(ly(this.searchListEntities_),ly(this.searchListIcons_));this.searchList_=_o.sort(function(ga,ba){return ga.name.localeCompare(ba.name)}),this.fuseSearch_=new v0(this.searchList_,$0)}},{key:"initEntityList",value:function(){var _a=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).map(function(_o){return _o.spaceIds?new O0({geometries:_o.space,addressList:_o.spaceIds||[],name:_o.properties.name||"",entity:_o}):null}).filter(function(_o){return _o!==null});this.searchListEntities_=_a}},{key:"initIconList",value:function(){var _a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.searchListIcons_=Object.values(_a).filter(function(_o){return _o.isIcon()}).map(function(_o){var ga=_o.getIcon();return new O0({geometries:[_o],icon:ga,name:_o.properties.name||""})})}},{key:"all",value:function(){return this.searchList_}},{key:"allIconTypes",value:function(){var _a=this.searchListIcons_.reduce(function(_o,ga){var ba=_o;return ba[ga.name]=ga.name,ba},{});return Object.keys(_a)}},{key:"find",value:function(){var _a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return _a===""?this.searchList_:this.fuseSearch_.search(_a)}}])}(),zv=Object.freeze({SITE:"SITE",IMAGES:"IMAGES",THEME:"THEME"}),Sv={SITE:"indoor.Site",STRUCTURE:"indoor.Structure",OCCUPANT:"indoor.Occupant",SPACE:"indoor.Space",SPACEGROUPS:"indoor.SpaceGroups",TOPOLOGY:"Topology",ADDRESS:"Address",LEVEL:"indoor.Level",LEVELCONNECTOR:"indoor.LevelConnector",ENTRANCE:"indoor.Entrance"},P0="OCCUPANT_NAMES",L0="SPACE_NAME",G0="INTERNAL_ADDRESS_SHORT",H0="INTERNAL_ADDRESS",jv="INTERNAL_ADDRESS_LONG",_0="SPACE_TYPE_NAME",C0="SPACE_CATEGORY_NAME",b0="Point",h0="LineString",cv="Polygon",ev="MultiPoint",x0="MultiLineString",w0="MultiPolygon",i0=Object.freeze({STANDARD:"STANDARD",FLATTEN:"FLATTEN",OUTDOOR_MAIN:"OUTDOOR_MAIN",INDOOR_MAIN:"INDOOR_MAIN",NO_OUTDOORS:"NO_OUTDOORS",FLATTEN_INDOOR_MAIN:"FLATTEN_INDOOR_MAIN",FLATTEN_OUTDOOR_COPY:"FLATTEN_OUTDOOR_COPY"}),p0="9999999999999",V0="icons",_u="config",_f="https://interactive.data.api.platform.here.com/interactive/v1/catalogs",iy=Object.freeze({THEME:"THEME",THEME_MAP:"THEME_MAP",PRESETS:"PRESETS",SDK_STRINGS:"SDK_STRINGS",ICON_FILE:"ICON_FILE",INPUT_COLORS:"INPUT_COLORS",BASE_MAP_INFO:"BASE_MAP_INFO",CONFIG_PROFILE:"CONFIG_PROFILE",NAV_THEME:"NAV_THEME",NAV_NAME_THEME:"NAV_NAME_THEME",NAV_PROP_MAP:"NAV_PROP_MAP",NAV_STRINGS:"NAV_STRINGS",NAV_THEME_MAP:"NAV_THEME_MAP",NAV_NAME_THEME_MAP:"NAV_NAME_THEME_MAP",V4_THEME_FAMILY:"V4_THEME_FAMILY",V4_MAPTYPE_THEME:"V4_MAPTYPE_THEME",ICON:"ICON",MARKER:"MARKER",PERMISSIONS:"PERMISSIONS",NAICS_ARRAY:"NAICS_ARRAY",NAICS_MAP:"NAICS_MAP"});Object.freeze(_s(_s(_s(_s({},iy.THEME,"themeUrls"),iy.THEME_MAP,"themeMapUrl"),iy.PRESETS,"presetsUrl"),iy.SDK_STRINGS,"stringsUrl")),Object.freeze(_s(_s(_s(_s(_s({},iy.THEME,"themeOverrides"),iy.THEME_MAP,"themeMapOverrides"),iy.PRESETS,"presetOverrides"),iy.SDK_STRINGS,"stringsOverrides"),iy.INPUT_COLORS,"inputColorOverrides")),Object.freeze(_s(_s(_s(_s(_s(_s({},iy.THEME,["Modern","Standard","Factory","Navteq","TheBase","Westfield_noLabels","Westfield","TDM_noLabel"]),iy.SDK_STRINGS,["Standard","SDK","sdk/standard"]),iy.V4_THEME_FAMILY,["modern","standard"]),iy.V4_MAPTYPE_THEME,["Airport Terminal","Airport","Casino","College Building","College Campus","Convention","General","Hospital","Outdoor","Retail","School Building","School Campus","Shopping Mall","Traffic","Train Station"]),iy.NAV_THEME,["Factory","MapEditor"]),iy.ICON,["Multicolor","Standard","TheBase","Factory"])),Object.freeze((_s(_s(_s(_s(_s(_s(_s(_s(_s(_s(r0={},iy.THEME,"Modern"),iy.THEME_MAP,"Standard"),iy.PRESETS,"Standard"),iy.SDK_STRINGS,"Standard"),iy.ICON_FILE,"Standard"),iy.INPUT_COLORS,"Standard"),iy.BASE_MAP_INFO,"Standard"),iy.CONFIG_PROFILE,"factory"),iy.NAV_THEME,"Factory"),iy.NAV_NAME_THEME,"FactoryName"),_s(_s(_s(_s(_s(_s(_s(_s(r0,iy.NAV_PROP_MAP,"Standard"),iy.NAV_STRINGS,"Standard"),iy.NAV_THEME_MAP,"Standard"),iy.NAV_NAME_THEME_MAP,"StandardName"),iy.V4_THEME_FAMILY,"Standard"),iy.V4_MAPTYPE_THEME,"Standard"),iy.ICON,"Multicolor"),iy.MARKER,"Standard")));var sy=Object.freeze({GEO_JSON:"GEO_JSON",V5_MAP:"V5_MAP",V5_NAV:"V5_NAV",V5_INFO:"V5_INFO",KML:"KML",SVG:"SVG",PNG:"PNG"});Object.freeze(_s({},sy.GEO_JSON,{COMMUNITY_MAP:"COMMUNITY_MAP",COMMUNITY_ENTITY:"COMMUNITY_ENTITY",PATH_LEVEL_GEOMETRY:"PATH_LEVEL_GEOMETRY",GEOJSON_LEVEL_GEOMETRY:"GEOJSON_LEVEL_GEOMETRY"}));var cy=Object.freeze({ACCOUNT_API:"ACCOUNT_API",DEFAULT_COLLECTION:"DEFAULT_COLLECTION",CATALOG_LAYER:"CATALOG_LAYER"}),hy=Object.freeze(_s(_s(_s({},cy.ACCOUNT_API,{BASE_URL:"https://account.api.here.com/authorization/v1.1/projects/me"}),cy.DEFAULT_COLLECTION,{BASE_URL:"https://config.data.api.platform.here.com/config/v1/catalogs",PARAMS:{CREATED_BY:"created",COLLECTION:"-collection"}}),cy.CATALOG_LAYER,{BASE_URL:"https://interactive.data.api.platform.here.com/interactive/v1/catalogs",MOMDATA_LAYER:"9999999999999",ICON_LAYER:"icons",THEMERULE_LAYER:"config",COLLECTION_LAYER:"layers/9999999999999/search",PARAMS:{FEATURE_TYPE:{KEY:"p.featureType",VALUE:"indoor.Site"}}})),vy=Object.freeze({isIconsEnabled:!0,isMetaEnabled:!0,metaOptions:{},iconOptions:{}}),Ey=Object.freeze({GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE",PATCH:"PATCH",OPTIONS:"OPTIONS",HEAD:"HEAD"});function Ay(){}function Iy(){Iy.init.call(this)}function Fy(_a){return _a._maxListeners===void 0?Iy.defaultMaxListeners:_a._maxListeners}function _g(_a,_o,ga,ba){var _c,_d,ey,ny;if(typeof ga!="function")throw new TypeError('"listener" argument must be a function');if((_d=_a._events)?(_d.newListener&&(_a.emit("newListener",_o,ga.listener?ga.listener:ga),_d=_a._events),ey=_d[_o]):(_d=_a._events=new Ay,_a._eventsCount=0),ey){if(typeof ey=="function"?ey=_d[_o]=ba?[ga,ey]:[ey,ga]:ba?ey.unshift(ga):ey.push(ga),!ey.warned&&(_c=Fy(_a))&&_c>0&&ey.length>_c){ey.warned=!0;var oy=new Error("Possible EventEmitter memory leak detected. "+ey.length+" "+_o+" listeners added. Use emitter.setMaxListeners() to increase limit");oy.name="MaxListenersExceededWarning",oy.emitter=_a,oy.type=_o,oy.count=ey.length,ny=oy,typeof console.warn=="function"?console.warn(ny):console.log(ny)}}else ey=_d[_o]=ga,++_a._eventsCount;return _a}function pv(_a,_o,ga){var ba=!1;function _c(){_a.removeListener(_o,_c),ba||(ba=!0,ga.apply(_a,arguments))}return _c.listener=ga,_c}function lv(_a){var _o=this._events;if(_o){var ga=_o[_a];if(typeof ga=="function")return 1;if(ga)return ga.length}return 0}function wv(_a,_o){for(var ga=new Array(_o);_o--;)ga[_o]=_a[_o];return ga}Ay.prototype=Object.create(null),Iy.EventEmitter=Iy,Iy.usingDomains=!1,Iy.prototype.domain=void 0,Iy.prototype._events=void 0,Iy.prototype._maxListeners=void 0,Iy.defaultMaxListeners=10,Iy.init=function(){this.domain=null,Iy.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Ay,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Iy.prototype.setMaxListeners=function(_a){if(typeof _a!="number"||_a<0||isNaN(_a))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=_a,this},Iy.prototype.getMaxListeners=function(){return Fy(this)},Iy.prototype.emit=function(_a){var _o,ga,ba,_c,_d,ey,ny,oy=_a==="error";if(ey=this._events)oy=oy&&ey.error==null;else if(!oy)return!1;if(ny=this.domain,oy){if(_o=arguments[1],!ny){if(_o instanceof Error)throw _o;var ay=new Error('Uncaught, unspecified "error" event. ('+_o+")");throw ay.context=_o,ay}return _o||(_o=new Error('Uncaught, unspecified "error" event')),_o.domainEmitter=this,_o.domain=ny,_o.domainThrown=!1,ny.emit("error",_o),!1}if(!(ga=ey[_a]))return!1;var dy=typeof ga=="function";switch(ba=arguments.length){case 1:(function(gy,yy,_y){if(yy)gy.call(_y);else for(var by=gy.length,wy=wv(gy,by),Ty=0;Ty<by;++Ty)wy[Ty].call(_y)})(ga,dy,this);break;case 2:(function(gy,yy,_y,by){if(yy)gy.call(_y,by);else for(var wy=gy.length,Ty=wv(gy,wy),Ny=0;Ny<wy;++Ny)Ty[Ny].call(_y,by)})(ga,dy,this,arguments[1]);break;case 3:(function(gy,yy,_y,by,wy){if(yy)gy.call(_y,by,wy);else for(var Ty=gy.length,Ny=wv(gy,Ty),By=0;By<Ty;++By)Ny[By].call(_y,by,wy)})(ga,dy,this,arguments[1],arguments[2]);break;case 4:(function(gy,yy,_y,by,wy,Ty){if(yy)gy.call(_y,by,wy,Ty);else for(var Ny=gy.length,By=wv(gy,Ny),$y=0;$y<Ny;++$y)By[$y].call(_y,by,wy,Ty)})(ga,dy,this,arguments[1],arguments[2],arguments[3]);break;default:for(_c=new Array(ba-1),_d=1;_d<ba;_d++)_c[_d-1]=arguments[_d];(function(gy,yy,_y,by){if(yy)gy.apply(_y,by);else for(var wy=gy.length,Ty=wv(gy,wy),Ny=0;Ny<wy;++Ny)Ty[Ny].apply(_y,by)})(ga,dy,this,_c)}return!0},Iy.prototype.addListener=function(_a,_o){return _g(this,_a,_o,!1)},Iy.prototype.on=Iy.prototype.addListener,Iy.prototype.prependListener=function(_a,_o){return _g(this,_a,_o,!0)},Iy.prototype.once=function(_a,_o){if(typeof _o!="function")throw new TypeError('"listener" argument must be a function');return this.on(_a,pv(this,_a,_o)),this},Iy.prototype.prependOnceListener=function(_a,_o){if(typeof _o!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(_a,pv(this,_a,_o)),this},Iy.prototype.removeListener=function(_a,_o){var ga,ba,_c,_d,ey;if(typeof _o!="function")throw new TypeError('"listener" argument must be a function');if(!(ba=this._events))return this;if(!(ga=ba[_a]))return this;if(ga===_o||ga.listener&&ga.listener===_o)--this._eventsCount==0?this._events=new Ay:(delete ba[_a],ba.removeListener&&this.emit("removeListener",_a,ga.listener||_o));else if(typeof ga!="function"){for(_c=-1,_d=ga.length;_d-- >0;)if(ga[_d]===_o||ga[_d].listener&&ga[_d].listener===_o){ey=ga[_d].listener,_c=_d;break}if(_c<0)return this;if(ga.length===1){if(ga[0]=void 0,--this._eventsCount==0)return this._events=new Ay,this;delete ba[_a]}else(function(ny,oy){for(var ay=oy,dy=ay+1,gy=ny.length;dy<gy;ay+=1,dy+=1)ny[ay]=ny[dy];ny.pop()})(ga,_c);ba.removeListener&&this.emit("removeListener",_a,ey||_o)}return this},Iy.prototype.removeAllListeners=function(_a){var _o,ga;if(!(ga=this._events))return this;if(!ga.removeListener)return arguments.length===0?(this._events=new Ay,this._eventsCount=0):ga[_a]&&(--this._eventsCount==0?this._events=new Ay:delete ga[_a]),this;if(arguments.length===0){for(var ba,_c=Object.keys(ga),_d=0;_d<_c.length;++_d)(ba=_c[_d])!=="removeListener"&&this.removeAllListeners(ba);return this.removeAllListeners("removeListener"),this._events=new Ay,this._eventsCount=0,this}if(typeof(_o=ga[_a])=="function")this.removeListener(_a,_o);else if(_o)do this.removeListener(_a,_o[_o.length-1]);while(_o[0]);return this},Iy.prototype.listeners=function(_a){var _o,ga=this._events;return ga&&(_o=ga[_a])?typeof _o=="function"?[_o.listener||_o]:function(ba){for(var _c=new Array(ba.length),_d=0;_d<_c.length;++_d)_c[_d]=ba[_d].listener||ba[_d];return _c}(_o):[]},Iy.listenerCount=function(_a,_o){return typeof _a.listenerCount=="function"?_a.listenerCount(_o):lv.call(_a,_o)},Iy.prototype.listenerCount=lv,Iy.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var Cv="venues-ui-button--active",Uv="venues-ui-button",f0="venues-ui__drawings",r1="data-drawing",p1=function(){return _n(function _a(_o,ga,ba){var _c=this;_r(this,_a),this.clickHandler=ba,this.containerDiv=document.createElement("div"),this.containerDiv.setAttribute("class",f0);var _d=document.createElement("div");_d.setAttribute("class","trigger ".concat(Uv));var ey=document.createElement("div");ey.setAttribute("class","arrow arrow--down"),_d.appendChild(ey),_d.addEventListener("click",function(){_d.classList.toggle(Cv),_c.containerButtons.classList.toggle("drawings--open")}),this.containerDiv.appendChild(_d),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","drawings"),this.containerDiv.appendChild(this.containerButtons),ga&&this.update(ga),_o.appendChild(this.containerDiv)},[{key:"drawButton",value:function(_a,_o,ga){var ba=this,_c=document.createElement("div"),_d=Number(ga)===Number(_a);_c.setAttribute("class",_d?"".concat(Uv," ").concat(Cv):Uv),_c.innerHTML=_o,_c.setAttribute(r1,_a),_c.addEventListener("click",function(){ba.switch(_a),ba.clickHandler(_a)}),this.containerButtons.appendChild(_c)}},{key:"switch",value:function(_a){this.containerButtons.querySelectorAll(".".concat(f0," .").concat(Cv)).forEach(function(ga){return ga.setAttribute("class",Uv)});var _o=this.containerButtons.querySelector("[".concat(r1,"='").concat(_a,"']"));_o&&_o.setAttribute("class","".concat(Uv," ").concat(Cv))}},{key:"update",value:function(_a){var _o=this;this.containerButtons.innerHTML="";var ga=function(ba){var _c=ba.getDrawings();return new Map(_c.map(function(_d){var ey=_d.getDisplayName()||_d.getName();return[_d.getId(),ey]}))}(_a);ga.size>0&&ga.forEach(function(ba,_c){return _o.drawButton(_c,ba,_a.getRootDrawing().getId())})}}])}(),i1="venues-ui-button--active",Jv="venues-ui-button",n1="data-level",o1="venues-ui__levels",f1=function(){return _n(function _a(_o,ga,ba,_c){var _d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:4;_r(this,_a),this.clickHandler=_c,this.levelButtonCount=_d,this.currentScrollIndex=0,this.containerUI=document.createElement("div"),this.containerUI.setAttribute("class","".concat(o1)),this.containerButtons=document.createElement("div"),this.containerButtons.setAttribute("class","levels"),this.containerUI.appendChild(this.containerButtons),ga&&this.update(ga,ba),_o.appendChild(this.containerUI)},[{key:"clear",value:function(){this.containerButtons.innerHTML="",this.buttonScrollUp&&(this.containerUI.removeChild(this.buttonScrollUp),this.buttonScrollUp=null),this.buttonScrollDown&&(this.containerUI.removeChild(this.buttonScrollDown),this.buttonScrollDown=null)}},{key:"drawLevelButton",value:function(_a,_o){var ga=this,ba=document.createElement("div");ba.innerHTML=_o,ba.style.fontSize="".concat(Math.max(Math.min(28.8/_o.length,11.52),10),"px"),ba.style.display="block",ba.setAttribute("class",Jv),ba.setAttribute(n1,_a),ba.addEventListener("click",function(){ga.switch(_a),ga.clickHandler(_a)}),this.containerButtons.appendChild(ba)}},{key:"drawScrollButtons",value:function(){var _a=this;this.buttonScrollUp=document.createElement("div"),this.buttonScrollUp.setAttribute("class","".concat(Jv," ").concat(Jv,"--up"));var _o=document.createElement("div");_o.setAttribute("class","arrow arrow--up"),this.buttonScrollUp.appendChild(_o),this.buttonScrollUp.addEventListener("click",function(){return _a.scroll(1)}),this.containerUI.insertBefore(this.buttonScrollUp,this.containerButtons),this.buttonScrollDown=document.createElement("div"),this.buttonScrollDown.setAttribute("class","".concat(Jv," ").concat(Jv,"--down"));var ga=document.createElement("div");ga.setAttribute("class","arrow arrow--down"),this.buttonScrollDown.appendChild(ga),this.buttonScrollDown.addEventListener("click",function(){return _a.scroll(-1)}),this.containerUI.appendChild(this.buttonScrollDown)}},{key:"scroll",value:function(){var _a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,_o=Array.from(this.containerButtons.querySelectorAll(".".concat(Jv))).reverse(),ga=[];if(_a>=0){this.currentScrollIndex=Math.min(this.currentScrollIndex+_a,_o.length-this.levelButtonCount);var ba=Math.min(this.currentScrollIndex,_o.length-this.levelButtonCount),_c=Math.min(this.currentScrollIndex+this.levelButtonCount,_o.length);ga=_o.slice(ba,_c)}else if(_a<0){this.currentScrollIndex=Math.max(this.currentScrollIndex+_a,0);var _d=Math.max(0,this.currentScrollIndex),ey=Math.min(_o.length,this.currentScrollIndex+this.levelButtonCount);ga=_o.slice(_d,ey)}_o.forEach(function(ny){ga.indexOf(ny)!==-1?ny.style.display="block":ny.style.display="none"}),this.buttonScrollDown&&(this.currentScrollIndex===0?this.buttonScrollDown.setAttribute("disabled","disabled"):this.buttonScrollDown.removeAttribute("disabled")),this.buttonScrollUp&&(this.currentScrollIndex===_o.length-this.levelButtonCount?this.buttonScrollUp.setAttribute("disabled","disabled"):this.buttonScrollUp.removeAttribute("disabled"))}},{key:"switch",value:function(_a){this.containerButtons.querySelectorAll(".".concat(i1)).forEach(function(_c){return _c.setAttribute("class",Jv)});var _o=this.containerButtons.querySelector(".".concat(o1," [").concat(n1,"='").concat(_a,"']"));if(_o){var ga=Array.from(this.containerButtons.querySelectorAll(".".concat(Jv))).reverse();_o.setAttribute("class","".concat(Jv," ").concat(i1));var ba=ga.indexOf(_o);(ba<this.currentScrollIndex||ba>=this.currentScrollIndex+4)&&this.scroll(ba-this.currentScrollIndex)}}},{key:"update",value:function(_a,_o){var ga=this,ba=function(){return new Map((arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).map(function(_d){return[_d.getZIndex(),_d.getShortName()||_d.getDisplayName()||_d.getName()]}))}(function(_d,ey){if(ey===i0.FLATTEN){var ny=_d.getVenueModel().getLevelMapFlattenedByZIndex_();return Object.values(ny).map(function(oy){return oy[0]})}return _d.getLevels()}(_a,_o).sort(function(_d,ey){return ey.getZIndex()-_d.getZIndex()})),_c=_a.getMainLevel().getZIndex();this.clear(),ba.forEach(function(_d,ey){return ga.drawLevelButton(ey,_d)}),ba.size>this.levelButtonCount&&(ba.size>this.levelButtonCount+1?this.currentScrollIndex=Math.min(Array.from(ba).reverse().findIndex(function(_d){return _d[0]===_c}),ba.size-this.levelButtonCount):this.currentScrollIndex=0,this.drawScrollButtons(),this.scroll(0)),this.switch(_c)}}])}(),J0=function(){return _n(function _a(_o,ga){_r(this,_a),this.baseTheme=_o,this.metaInformation=ga,this.labelStyleMap={},this.styleMap={},this.setStyleMap()},[{key:"setStyleMap",value:function(){this.styleMap.ENTRANCE=this.baseTheme.entranceRules.default.styleProperties,this.labelStyleMap.ENTRANCE=this.baseTheme.entranceRules.default.textLabelStyleProperties;for(var _a=0,_o=Object.entries(this.baseTheme.spaceRules);_a<_o.length;_a++){var ga=ry(_o[_a],2),ba=ga[0],_c=ga[1],_d=_c.properties.behavioralAppearance.default.styleProperties,ey=_c.properties.behavioralAppearance.default.textLabelStyleProperties;if(this.styleMap[ba]=_d,this.labelStyleMap[ba]=ey,_c.spaceTypes)for(var ny=0,oy=Object.entries(_c.spaceTypes);ny<oy.length;ny++){var ay=ry(oy[ny],2),dy=ay[0],gy=ay[1],yy=gy.behavioralAppearance.default.styleProperties,_y=gy.behavioralAppearance.default.textLabelStyleProperties;this.styleMap["".concat(ba,"_").concat(dy)]=yy&&Object.keys(yy)!==0?yy:_d,this.labelStyleMap["".concat(ba,"_").concat(dy)]=_y&&Object.keys(_y)!==0?_y:ey}}}},{key:"getBaseTheme",value:function(){return this.baseTheme}},{key:"getStyleMap",value:function(){return this.styleMap}},{key:"getGeometryStyle",value:function(_a){return this.styleMap&&Object.getOwnPropertyNames(this.styleMap)?this.styleMap[_a]:null}},{key:"getLabelStyle",value:function(_a){return this.labelStyleMap&&Object.getOwnPropertyNames(this.labelStyleMap)?this.labelStyleMap[_a]:null}}],[{key:"getGeometryDefaultStyle",value:function(){return{fill:"#e5e5e5",fillOpacity:1,stroke:"#6c7a89",strokeOpacity:1,strokeWidth:2}}},{key:"getLabelDefaultStyle",value:function(){return{stroke:"#6c7a89",zmin:15}}}])}(),s1=function(){return _n(function _a(){_r(this,_a),this.config=Object.seal({emitEventOnOverrideUpdate:!0}),this.imageCache={},this.releaseSettings_={displayOptions:{},mom:[]},this.theme={}},[{key:"getMomData",value:function(){return this.releaseSettings_.mom}},{key:"getTheme",value:function(){return this.theme||{}}},{key:"getStyle",value:function(_a){var _o,ga=arguments.length>1&&arguments[1]!==void 0&&arguments[1],ba=this.getTheme(),_c=J0.getGeometryDefaultStyle(),_d=_a.properties.spaceType,ey=_a.properties.spaceCategory,ny=ey;return _d&&(ny="".concat(ey,"_").concat(_d)),(_o=ba.getGeometryStyle(ny))&&!ga||(_o=_c),{m:_o.fill&&_o.fill.toLowerCase()||"#fff",w:_o.strokeWidth/10||.1,o:_o.stroke&&_o.stroke.toLowerCase()||"#fff",l:"Dark"}}},{key:"getLabelStyle",value:function(_a){this.getTheme();var _o=J0.getLabelDefaultStyle();return{fill:_o.stroke,zmin:_o.zmin}}}])}(),E0=Math.PI/180,d1=180/Math.PI,Vv=function(){function _a(){_r(this,_a)}return _n(_a,null,[{key:"toRadians",value:function(_o){return _o*E0}},{key:"toDegrees",value:function(_o){return _o*d1}},{key:"getBoundingBox",value:function(_o,ga){var ba=[];switch(_o){case b0:ba=[ga,ga];break;case ev:case h0:ba=ga;break;case x0:case cv:ba=ga.reduce(function(_c,_d){return _c.concat(_d)},[]);break;case w0:ba=ga.reduce(function(_c,_d){return _c.concat(_d)},[]).reduce(function(_c,_d){return _c.concat(_d)},[])}return _a.getBoundingBoxVertices(ba)}},{key:"getInverseTransform",value:function(_o){var ga=_o[0]*_o[3]-_o[1]*_o[2],ba=[_o[3]/ga,-_o[1]/ga,-_o[2]/ga,_o[0]/ga,0,0];return ba[4]=-(ba[0]*_o[4]+ba[2]*_o[5]),ba[5]=-(ba[1]*_o[4]+ba[3]*_o[5]),ba}},{key:"applyTransformToPoint",value:function(_o,ga){return[ga[0]*_o[0]+ga[1]*_o[2]+_o[4],ga[0]*_o[1]+ga[1]*_o[3]+_o[5]]}},{key:"transformProduct",value:function(_o,ga){var ba=[0,0,0,0,0,0];return ba[0]=ga[0]*_o[0]+ga[2]*_o[1],ba[1]=ga[1]*_o[0]+ga[3]*_o[1],ba[2]=ga[0]*_o[2]+ga[2]*_o[3],ba[3]=ga[1]*_o[2]+ga[3]*_o[3],ba[4]=ga[0]*_o[4]+ga[2]*_o[5]+ga[4],ba[5]=ga[1]*_o[4]+ga[3]*_o[5]+ga[5],ba}},{key:"convertLonLatToMerc",value:function(_o){var ga=_o[0]*E0,ba=_o[1]*E0,_c=Math.sin(ba);return[.5+ga/(2*Math.PI),.5-Math.log((1+_c)/(1-_c))/(4*Math.PI)]}},{key:"convertMercToLatLon",value:function(_o){var ga=2*Math.PI*(_o[0]-.5),ba=Math.atan(Math.sinh(2*Math.PI*(.5-_o[1])));return[ga/E0,ba/E0]}},{key:"getTransformScale",value:function(_o){return Math.sqrt(_o[0]*_o[3]-_o[1]*_o[2])}},{key:"getLonLatToMercTransform",value:function(_o){var ga=[.002777777777777778,0,0,-1/(360*Math.cos(_o[1]*E0)),0,0],ba=_a.applyTransformToPoint(ga,_o),_c=_a.convertLonLatToMerc(_o);return ga[4]=_c[0]-ba[0],ga[5]=_c[1]-ba[1],ga}},{key:"getNatToMercTransform",value:function(_o){var ga=[_o[4],_o[5]],ba=_a.getLonLatToMercTransform(ga);return _a.transformProduct(_o,ba)}},{key:"convertMxMy2LonLat",value:function(_o,ga){return _o.length&&ga.length?_a.applyTransformToPoint(_o,ga):[]}},{key:"convertLonLat2MxMy",value:function(_o,ga){if(!_o.length||!ga.length)return[];var ba=_a.getInverseTransform(_o);return _a.applyTransformToPoint(ba,ga)}},{key:"getFlattenedQuadraticBezierCurve",value:function(_o,ga,ba){var _c=[],_d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10;_d<1&&(_d=6);for(var ey=0;ey<=_d;ey+=1){var ny=ey/_d,oy=(1-ny)*(1-ny),ay=2*ny*(1-ny),dy=ny*ny,gy=oy*_o[0]+ay*ga[0]+dy*ba[0],yy=oy*_o[1]+ay*ga[1]+dy*ba[1];_c.push([gy,yy])}return _c}},{key:"getFlattenedCubicBezierCurve",value:function(_o,ga,ba,_c){var _d=[],ey=arguments.length>4&&arguments[4]!==void 0?arguments[4]:10;ey<1&&(ey=6);for(var ny=0;ny<=ey;ny+=1){var oy=ny/ey,ay=(1-oy)*(1-oy)*(1-oy),dy=3*oy*(1-oy)*(1-oy),gy=3*oy*oy*(1-oy),yy=oy*oy*oy,_y=ay*_o[0]+dy*ga[0]+gy*ba[0]+yy*_c[0],by=ay*_o[1]+dy*ga[1]+gy*ba[1]+yy*_c[1];_d.push([_y,by])}return _d}},{key:"getRectangularCoordinatesOfLabelArea",value:function(_o,ga){var ba=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],_c=ry(_o,6),_d=_c[0],ey=_c[1],ny=_c[2],oy=_c[3],ay=_c[5],dy=_a.getDeltaLonLatForMeterAtGivenLonLat(_d,ey),gy=_o[4];return ba?(ay&&(gy*=-1),ga!=null&&(gy=(gy+=ga<0?2*Math.PI+ga:ga)<0?2*Math.PI+gy:gy)):gy=0,_a.getRectVerticesFromSignatureRectRepresentation([_d,ey],{xLength:ny,yLength:oy},gy,dy)}},{key:"getRotatedPoint",value:function(_o,ga){var ba=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],_c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[0,0],_d=Math.cos(ga),ey=Math.sin(ga),ny=_o[0]-_c[0],oy=_o[1]-_c[1],ay=[];return[(ay=ba?[ny*_d+oy*ey,oy*_d-ny*ey]:[ny*_d-oy*ey,oy*_d+ny*ey])[0]+_c[0],ay[1]+_c[1]]}},{key:"getRectVerticesFromSignatureRectRepresentation",value:function(_o,ga,ba,_c){var _d=ga.xLength,ey=ga.yLength,ny=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],oy=ry(_o,2),ay=oy[0],dy=oy[1],gy=_d/2,yy=ey/2,_y=ry(_c,2),by=_y[0],wy=_y[1];return[[1,1],[-1,1],[-1,-1],[1,-1]].map(function(Ty){return[Ty[0]*gy,Ty[1]*yy]}).map(function(Ty){return _a.getRotatedPoint(Ty,ba,ny)}).map(function(Ty){return[Ty[0]*by,Ty[1]*wy]}).map(function(Ty){return[Ty[0]+ay,Ty[1]+dy]})}},{key:"getScaleFactorForRectInSpace",value:function(_o,ga,ba,_c){var _d=_o/ba,ey=ga/_c;return _d>ey?ey:_d}},{key:"getDeltaLonLatForMeterAtGivenLonLat",value:function(_o,ga){var ba=6371e3;return[1/ba*(180/Math.PI)/Math.cos(ga*Math.PI/180),1/ba*(180/Math.PI)]}},{key:"getBoundingBoxVertices",value:function(){var _o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ga=[[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY]];return _o.reduce(function(ba,_c){return[[Math.min(_c[0],ba[0][0]),Math.min(_c[1],ba[0][1])],[Math.max(_c[0],ba[1][0]),Math.max(_c[1],ba[1][1])]]},ga)}},{key:"isPointInBoundingBox",value:function(_o,ga){if(_o&&ga){var ba=ry(_o,2),_c=ba[0],_d=ba[1],ey=ry(ga,2),ny=ry(ey[0],2),oy=ny[0],ay=ny[1],dy=ry(ey[1],2),gy=dy[0],yy=dy[1];return _c<=gy&&_c>=oy&&_d<=yy&&_d>=ay}}},{key:"isPointOnLineSegment",value:function(_o,ga,ba){var _c=ry(_o,2),_d=_c[0],ey=_c[1],ny=ry(ga,2),oy=ny[0],ay=ny[1],dy=ry(ba,2),gy=dy[0],yy=dy[1],_y=(ay-ey)*(yy-ey)<=0;return oy===gy?oy===_d&&_y:!(ey-yy!=(yy-ay)/(gy-oy)*(_d-gy)||!_y)}},{key:"rayIntersectLineSegment",value:function(_o,ga,ba){var _c=ry(_o,2),_d=_c[0],ey=_c[1],ny=ry(ga,2),oy=ny[0],ay=ny[1],dy=ry(ba,2),gy=dy[0],yy=dy[1];if(oy===gy)return!1;var _y=(_d-oy)/(gy-oy);return _y>=0&&_y<1&&(yy-ay)*_y+ay>ey}},{key:"isPointInPolygon",value:function(_o,ga){var ba=ry(_o,2),_c=ba[0],_d=ba[1],ey=ga.length;if(ey<3)return!1;var ny=0,oy=ga[ey-1];return ga.forEach(function(ay){_a.rayIntersectLineSegment([_c,_d],oy,ay)&&(ny+=1),oy=ay}),ny%2!=0}},{key:"isPointOnLineString",value:function(_o,ga){var ba=ry(_o,2),_c=ba[0],_d=ba[1],ey=ga.length;if(ey<2)return!1;for(var ny=ga[ey-1],oy=0;oy<ey;oy+=1){var ay=ga[oy];if(_a.isPointOnLineSegment([_c,_d],ny,ay))return!0;ny=ga[oy]}return!1}},{key:"getAreaOfPolygon",value:function(_o){var ga=_o.length;if(ga<3)return null;var ba=0,_c=_o[ga-1];return _o.forEach(function(_d){var ey,ny,oy,ay,dy,gy;ba+=.5*(ey=_d,ny=ry(_c,2),oy=ny[0],ay=ny[1],dy=ry(ey,2),gy=dy[0],oy*dy[1]-ay*gy),_c=_d}),ba}},{key:"getDistanceBetweenPoints",value:function(_o,ga){var ba=ry(_o,2),_c=ba[0],_d=ba[1],ey=ry(ga,2),ny=_c-ey[0],oy=_d-ey[1];return Math.sqrt(ny*ny+oy*oy)}}])}(),a1=function(){return _n(function _a(){_r(this,_a),this.spaceRules={}},null,[{key:"getDataEntriesOne",value:function(_a,_o){var ga=[_a,""];if(_o!==null&&Array.isArray(_o))ga[1]=_o.toString();else if(_o!==null&&_t(_o)==="object"){var ba=Object.entries(_o);if(ba.length>0){var _c=this.getDataEntriesOne(ba[0][0],ba[0][1]);ga[0]="".concat(ga[0],".").concat(_c[0]),ga[1]=_c[1]}}else ga[1]=_o;return ga}},{key:"getDataEntriesAll",value:function(_a){for(var _o=[],ga=0,ba=Object.entries(_a);ga<ba.length;ga++){var _c=ry(ba[ga],2),_d=_c[0],ey=_c[1],ny=this.getDataEntriesOne(_d,ey);_o.push(ny)}return _o}},{key:"doFindComboMatch",value:function(_a,_o){var ga="";if(_a&&_a.configuration&&_a.configuration.combinations)for(var ba=this.getDataEntriesAll(_o),_c=Object.entries(_a.configuration.combinations),_d=0,ey=function(){var ay=oy[ny],dy=Object.keys(ay[1]).filter(function(gy){return ba.some(function(yy){return gy===yy[0]&&ay[1][gy]===yy[1]})});dy.length===Object.keys(ay[1]).length&&dy.length>_d&&(ga=ay[0],_d=dy.length)},ny=0,oy=_c;ny<oy.length;ny++)ey();return ga}},{key:"getIconFromCombinations",value:function(_a,_o){if(_a&&_a.configuration.combinations&&_o&&Object.keys(_o).length>0&&_a.behavioralAppearance.combinations&&Object.keys(_a.behavioralAppearance.combinations).length>0){var ga=this.doFindComboMatch(_a,_o);if(ga===""||!_a.behavioralAppearance.combinations[ga].labelIcon)return"";if(_a.behavioralAppearance.combinations&&_a.behavioralAppearance.combinations[ga]&&_a.behavioralAppearance.combinations[ga].labelIcon)return _a.behavioralAppearance.combinations[ga].labelIcon.referenceUri}return""}},{key:"findSpace",value:function(_a,_o){if(_o.spaceTypes&&_o.spaceTypes[_a])return _o.spaceTypes[_a]}},{key:"findCategory",value:function(_a){if(this.spaceRules[_a])return this.spaceRules[_a]}},{key:"setSpaceRules",value:function(_a){this.spaceRules=_a}},{key:"getSpaceIcon",value:function(_a,_o,ga){var ba="",_c=this.findCategory(_o);if(_c){var _d=this.findSpace(_a,_c);if(_d){var ey="";ga&&(ey=this.getIconFromCombinations(_d,ga)),ey&&ey!==""?ba=ey:_d.behavioralAppearance.default.labelIcon?ba=_d.behavioralAppearance.default.labelIcon.referenceUri:_c.properties.behavioralAppearance.default.labelIcon&&(ba=_c.properties.behavioralAppearance.default.labelIcon.referenceUri)}}return ba}}])}(),I0=function(){return _n(function _a(){_r(this,_a)},null,[{key:"getFormattedIndoorMapId",value:function(_a){var _o="";return new RegExp("(^\\d{5}$)").test(_a)?_o="indoormap-00000000-0000-4000-a000-".concat(_a.toString().padStart(12,"0")):_o}},{key:"validateIsMicelloId",value:function(_a){return new RegExp(/^indoormap-00000000-0000-4000-[a-f]000-[0-9]{12}$/).test(_a)}}])}(),Bv=function(){return _n(function _a(){_r(this,_a),this.themeRule={},this.svgList={},this.defaultLang="ENG"},null,[{key:"getNumberFromAlphaNumeric",value:function(_a){try{var _o=_a.split("").reverse().join("").replace(/[^0-9]/g,"").substr(0,6);return parseInt(_o,10)}catch{return null}}},{key:"extractNumFromSting",value:function(_a){try{var _o=_a.replace(/[^0-9]/g,"");return parseInt(_o,10)}catch{return console.warn("Exception in converting string to Id"),this.getNumberFromAlphaNumeric(_a)}}},{key:"getVenueId",value:function(_a){if(typeof _a!="number"){var _o=_a.substr(_a.length-6);return parseInt(_o,10)}return _a}},{key:"setSite",value:function(_a,_o){var ga=this.getName(_a),ba={id:I0.getFormattedIndoorMapId(_o),location:_a.referencePoint,properties:_a.properties,geometry:_a.geometry,identifier:this.getVenueId(_o),obj_type:"CommunityMap"};return I0.validateIsMicelloId(_o)&&(ba.map_version=_a.properties.indoorSiteMetadata.legacyVersion.mapVersion),ba.properties.name=ga,ba.properties.display_name=ga,ba}},{key:"setEntrance",value:function(_a){var _o=this.themeRule.entranceRules.default.labelIcon.referenceUri,ga=this.extractNumFromSting(_a.id),ba=this.getName(_a),_c=_a.properties;return _c.icon=!0,_c.svg=this.svgList[_o.toLowerCase()],_c.name=ba||"entrance",_c.display_name=ba||"entrance",_c.level={id:_a.properties.level.id},{id:_a.id,levelId:_a.properties.level.id,momType:Sv.ENTRANCE,geometry:_a.geometry,location:_a.geometry,properties:_c,identifier:ga,label_area:[_a.referencePoint.coordinates[0],_a.referencePoint.coordinates[1],50,50,180]}}},{key:"setStructure",value:function(_a){var _o=this.extractNumFromSting(_a.id),ga=this.getName(_a),ba=_a.properties;return ba.is_root=_a.properties.drawOrder===0,ba.display_name=ga,ba.map_type=_a.properties.structureType,ba.name=ga,{id:_a.id,obj_type:"Drawing",identifier:_o,properties:ba}}},{key:"getNameByPriority",value:function(_a,_o){for(var ga=this,ba="",_c=function(ny){return ny.nameType==="OFFICIAL"&&ny.languageCode&&ny.languageCode===ga.defaultLang||ny.nameType==="OFFICIAL"},_d=0;_d<_a.length;_d++){var ey=_a[_d];if(_c(ey)&&(_o&&_o===ey.nameType||!_o)){ba=ey.name;break}if(ey.nameType==="ABBREVIATION"&&(_o&&_o===ey.nameType||!_o)){ba=ey.name;break}if(ey.nameType==="UNCLASSIFIED"&&(_o&&_o===ey.nameType||!_o)){ba=ey.name;break}if(!ey.nameType&&ey.name){ba=ey.name;break}}return ba}},{key:"getName",value:function(_a,_o){return _a.properties&&_a.properties.names?this.getNameByPriority(_a.properties.names,_o):_a.properties.placeProperties&&_a.properties.placeProperties&&_a.properties.placeProperties.names?this.getNameByPriority(_a.properties.placeProperties.names,_o):_a.properties.locationDetails&&_a.properties.locationDetails[0]&&_a.properties.locationDetails[0].names?this.getNameByPriority(_a.properties.locationDetails[0].names,_o):""}},{key:"setLevel",value:function(_a){var _o=this.extractNumFromSting(_a.id),ga=_a.properties.names,ba=_a.properties,_c=_a.geometry;return ba["short name"]=this.getNameByPriority(ga,ga&&ga.length!==1?"ABBREVIATION":""),ba.name=this.getNameByPriority(ga,ga&&ga.length!==1?"ABBREVIATION":""),{id:_a.id,obj_type:"Level",identifier:_o,properties:ba,geometry:_c}}},{key:"setLevelConnector",value:function(_a){var _o=this.extractNumFromSting(_a.id);return{id:_a.id,obj_type:"LevelConnector",properties:_a.properties,geometry:_a.geometry,identifier:_o,location:_a.geometry}}},{key:"setOccupant",value:function(_a){var _o=this.getName(_a),ga=this.extractNumFromSting(_a.id),ba=_a.properties;return ba.occupantName=_o,ba.email=_a.properties.placeProperties&&_a.properties.placeProperties.contacts&&_a.properties.placeProperties.contacts.find(function(_c){return _c.contactType==="EMAIL"})&&_a.properties.placeProperties.contacts.find(function(_c){return _c.contactType==="EMAIL"}).value,ba.name=_o,ba.tags=_a.properties.attributes&&_a.properties.attributes.tags,{geometry:_a.geometry,id:_a.id,obj_type:"Geometry",properties:ba,identifier:ga,spaceIds:_a.properties.spaces?_a.properties.spaces:[],type:"Feature",momType:Sv.OCCUPANT}}},{key:"getIcon",value:function(_a){var _o=!1,ga="";return this.svgList[_a]&&(_o=!0,ga=this.svgList[_a]),{icon:_o,svg:ga}}},{key:"setSpace",value:function(_a){var _o=a1.getSpaceIcon(_a.properties.spaceType,_a.properties.spaceCategory,_a.properties.spaceTypeProperties),ga=this.getName(_a),ba=this.getIcon(_o),_c=ba.icon,_d=ba.svg,ey=this.extractNumFromSting(_a.id),ny=_a.properties.level.id,oy=_a.properties;oy.spaceName=ga,oy[_a.properties.spaceCategory]=_a.properties.spaceType,oy.spaceType=_a.properties.spaceType,oy.spaceCategory=_a.properties.spaceCategory,oy.icon=_c,oy.svg=_d;var ay={geometry:_a.geometry,id:_a.id,levelId:ny,label_area:[_a.referencePoint.coordinates[0],_a.referencePoint.coordinates[1],50,50,180],location:_a.referencePoint,obj_type:"Geometry",identifier:ey,properties:oy,momType:Sv.SPACE,type:"Feature"};return _a.properties.spaceAddress&&_a.properties.spaceAddress.id&&(ay.addressId=_a.properties.spaceAddress.id),ay}},{key:"setSpaceGroups",value:function(_a){var _o=this.extractNumFromSting(_a.id);return{id:_a.id,obj_type:"SpaceGroups",properties:_a.properties,geometry:_a.geometry,location:_a.referencePoint,identifier:_o}}},{key:"setTopology",value:function(_a){var _o=this.extractNumFromSting(_a.id);return{id:_a.id,obj_type:"Topology",properties:_a.properties,geometry:_a.geometry,identifier:_o}}},{key:"setAddress",value:function(_a){var _o=this.extractNumFromSting(_a.id),ga=this.getName(_a),ba=_a.properties;return ba.addressName=ga,ba.name=ga,{id:_a.id,properties:ba,obj_type:"Address",identifier:_o}}},{key:"manageSvgDimensions",value:function(_a){for(var _o={},ga=0,ba=Object.entries(_a);ga<ba.length;ga++){var _c=ry(ba[ga],2),_d=_c[0],ey=_c[1];if(typeof ey=="string"){var ny=ey.indexOf("<g")!==-1&&ey.indexOf("<g")||ey.indexOf("<p"),oy=ey.indexOf("</s");if(ny&&oy){var ay=ey.substring(ny-1,oy-1);_o[_d]="<svg width='64' height='64' viewBox='0 0 24 32' fill='none' xmlns='http://www.w3.org/2000/svg'>".concat(ay,"</svg>")}}}return _o}},{key:"getSiteBoundingBox",value:function(_a){if(_a){var _o=ry(Vv.getBoundingBox(_a.geometry.type,_a.geometry.coordinates),2),ga=_o[0],ba=_o[1];if(ga)return"".concat(ga[0],",").concat(ga[1],",").concat(ba[0],",").concat(ba[1])}return"null, null, null, null"}}])}(),R0=function(){return _n(function _a(){_r(this,_a)},null,[{key:"get",value:function(_a){return fetch(_a,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{method:"GET"}).then(function(_o){return _o.ok?_o.json():Promise.reject(new Error("Call failed for ".concat(_a," : ").concat(_o.status," ").concat(_o.statusText)))})}},{key:"getConfigUrl",value:function(_a,_o,ga){var ba=ga.apiKey,_c=ga.url,_d=ga.token,ey=ga.hrn,ny={method:"GET",mode:"cors",cache:"default"},oy="".concat(_c||_f,"/").concat(ey),ay="";return _o===zv.SITE&&(ay="".concat(oy,"/layers/").concat(p0,"/search?p.featureType=indoor.Site&p.indoorMapId='").concat(I0.getFormattedIndoorMapId(_a),"'")),_o===zv.IMAGES&&(ay="".concat(oy,"/layers/").concat(V0,"/features/svg")),_o===zv.Theme&&(ay="".concat(oy,"/layers/").concat(_u,"/features/indoorMapRules")),_d?ny.headers={Authorization:"Bearer ".concat(_d)}:ay=ay.concat("".concat(_o===zv.SITE?"&":"?","apiKey=").concat(ba)),this.get(ay,ny)}},{key:"getMomData",value:function(_a,_o){var ga=_o.apiKey,ba=_o.url,_c=_o.token,_d=_o.hrn,ey={method:"GET",mode:"cors",cache:"default"},ny="".concat(ba||_f,"/").concat(_d),oy=_a&&_a.features&&_a.features.find(function(_y){return _y.momType===Sv.SITE}),ay=Bv.getSiteBoundingBox(oy),dy=[Sv.TOPOLOGY,Sv.LEVELCONNECTOR],gy=Object.values(Sv).filter(function(_y){return!dy.includes(_y)}).join(),yy="".concat(ny,"/layers/").concat(p0,"/bbox?bbox=").concat(ay,"&limit=100000&f.momType=").concat(gy);return _c?ey.headers={Authorization:"Bearer ".concat(_c)}:yy=yy.concat("&apiKey=".concat(ga)),{mom:this.get(yy,ey),site:oy}}},{key:"getDefaultCollection",value:function(_a){var _o=_a.token,ga=hy[cy.DEFAULT_COLLECTION],ba=ga.PARAMS,_c=ga.BASE_URL,_d=encodeURI("".concat(_c,"?sortBy=").concat(ba.CREATED_BY,"&q=").concat(ba.COLLECTION));if(_o){var ey={method:"GET",headers:{Authorization:"Bearer ".concat(_o)}};return this.get(_d,ey)}return Promise.reject(new Error("Please provide valid token"))}},{key:"getProjectAccountDetails",value:function(_a){var _o=_a.token,ga=hy[cy.ACCOUNT_API].BASE_URL;if(_o){var ba={method:"GET",mode:"cors",headers:{Authorization:"Bearer ".concat(_o)}};return this.get(ga,ba)}return Promise.reject(new Error("Please provide valid token"))}},{key:"fetchIndoorMapList",value:function(){var _a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_o=_a.hrn,ga=_a.url,ba=hy[cy.CATALOG_LAYER],_c=ba.PARAMS,_d=ba.COLLECTION_LAYER;if(_o){var ey=encodeURI("".concat(ga||_f,"/").concat(_o,"/").concat(_d,"?").concat(_c.FEATURE_TYPE.KEY,"=").concat(_c.FEATURE_TYPE.VALUE)),ny=this.createBaseUrl(ey,Ey.GET,{},_a),oy=ny.URL,ay=ny.options;return this.get(oy,ay)}return Promise.reject(new Error("Please provide valid hrn"))}},{key:"createBaseUrl",value:function(){var _a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",_o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ey.GET,ga=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ba=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},_c=ba.token,_d=ba.apiKey,ey=_a,ny={method:_o,mode:"cors"};return _c?ny.headers=_({Authorization:"Bearer ".concat(_c)},ga):ey=_a.concat("&apiKey=".concat(_d)),{URL:ey,options:ny}}}])}(),M0=function(){function _a(){_r(this,_a)}return _n(_a,null,[{key:"isPointOnGeoJSONLineString",value:function(_o,ga){var ba=!1;if(ga&&ga.length>1){for(var _c=0,_d=0,ey=1;ey<ga.length;ey+=1)if(_c=ga[ey-1],_d=ga[ey],Vv.isPointOnLineSegment(_o,_c,_d)){ba=!0;break}}return ba}},{key:"isPointOnGeoJSONMultiLineString",value:function(_o,ga){for(var ba=!1,_c=0;_c<ga.length;_c+=1)if(_a.isPointOnGeoJSONLineString(_o,ga[_c])){ba=!0;break}return ba}},{key:"isPointInsideGeoJSONPolygon",value:function(_o,ga){var ba=!1;if(Vv.isPointInPolygon(_o,ga[0])&&(ba=!0),ba){for(var _c=1;_c<ga.length;_c+=1)if(Vv.isPointInPolygon(_o,ga[_c])){ba=!1;break}}return ba}},{key:"isPointInsideGeoJSONMultiPolygon",value:function(_o,ga){for(var ba=ga.length,_c=0;_c<ba;_c+=1)if(_a.isPointInsideGeoJSONPolygon(_o,ga[_c]))return!0;return!1}},{key:"getGeometriesByLonLat",value:function(_o,ga){for(var ba=arguments.length>2&&arguments[2]!==void 0&&arguments[2],_c=[],_d=ga.filter(function(oy){return Vv.isPointInBoundingBox(_o,oy.getBoundingBox())}),ey=0;ey<_d.length;ey+=1){var ny=_d[ey];if(ny.isPointInsideGeometry(_o,!0)&&(_c.push(ny),!ba))break}return _c.sort(function(oy,ay){return ay.getZIndex()-oy.getZIndex()})}}])}(),y1=function(){return _n(function _a(){var _o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ga=arguments.length>1?arguments[1]:void 0,ba=arguments.length>2?arguments[2]:void 0;_r(this,_a),this.id=_o.id,this.properties=_o.properties||{},this.labelArea=_o.label_area||[],this.geometry=_o.geometry||{},this.location=_o.location||{},this.address=_o.address||{},this.level=ga,this.zIndex=ba,this.spaceId=_o.spaceId,this.state_={isHighlighted:!1,highlightedStyle:{}},this.geometryData=_o},[{key:"getId",value:function(){return this.geometryData&&this.geometryData.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getInternalAddress",value:function(){return this.address?this.address.properties&&this.address.properties.name:null}},{key:"getCenter",value:function(){return this.location.coordinates||[]}},{key:"getCoordinates",value:function(){return this.geometry.coordinates||[]}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getStyle",value:function(){return this.getMetaInformation_().getStyle(this)}},{key:"getIcon",value:function(){return this.properties.svg}},{key:"getLabelArea",value:function(){return this.labelArea||[]}},{key:"getLabelStyle",value:function(){return this.getMetaInformation_().getLabelStyle(this)||null}},{key:"getLevel",value:function(){return this.level}},{key:"getType",value:function(){return this.geometry.type}},{key:"getZIndex",value:function(){return this.zIndex}},{key:"getBoundingBox",value:function(){var _a=this.getType(),_o=this.getCoordinates(),ga=[];switch(_a){case b0:ga=[_o,_o];break;case ev:case h0:ga=_o;break;case x0:case cv:ga=_o.reduce(function(ba,_c){return ba.concat(_c)},[]);break;case w0:ga=_o.reduce(function(ba,_c){return ba.concat(_c)},[]).reduce(function(ba,_c){return ba.concat(_c)},[])}return Vv.getBoundingBoxVertices(ga)}},{key:"isIcon",value:function(){return!!this.properties.icon}},{key:"isPointInsideGeometry",value:function(_a){var _o,ga=arguments.length>1&&arguments[1]!==void 0&&arguments[1],ba=!1;switch(this.getType()){case b0:_o=this.getLabelArea()&&Vv.getRectangularCoordinatesOfLabelArea(this.getLabelArea()),ba=Vv.isPointInPolygon(_a,_o);break;case ev:break;case h0:ba=ga&&M0.isPointOnGeoJSONLineString(_a,this.getCoordinates());break;case x0:ba=ga&&M0.isPointOnGeoJSONMultiLineString(_a,this.getCoordinates());break;case cv:ba=M0.isPointInsideGeoJSONPolygon(_a,this.getCoordinates());break;case w0:ba=M0.isPointInsideGeoJSONMultiPolygon(_a,this.getCoordinates())}return ba}},{key:"highlight",value:function(){var _a=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],_o=arguments.length>1?arguments[1]:void 0;this.state_.isHighlighted=_a,this.state_.highlightedStyle=_a?_o:{}}},{key:"isHighlighted",value:function(){return!!this.state_.isHighlighted}},{key:"getHighlightedStyle",value:function(){return this.state_.highlightedStyle||{}}},{key:"toJSON",value:function(){return _({},this.geometry)}},{key:"getMetaInformation_",value:function(){return this.getLevel()?this.getLevel().getDrawing().getVenueModel().metaInformation_:null}}])}(),g1=function(){return _n(function _a(_o,ga){var ba=this;_r(this,_a),this.id=_o&&_o.id,this.properties=_o&&_o.properties,this.zIndexCount=0,this.geometries=_o&&_o.features&&Object.values(_o.features).reduce(function(_c,_d){return _c[[_d.id]]=new y1(_d,ba,_d.properties.drawOrder),_c},{}),this.drawing=ga,this.levelData=_o},[{key:"getId",value:function(){return this.levelData&&this.levelData.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"getName",value:function(){return this.properties&&this.properties.name||""}},{key:"getDisplayName",value:function(){return this.properties&&this.properties.display_name||""}},{key:"getDrawing",value:function(){return this.drawing}},{key:"getShortName",value:function(){return this.properties&&this.properties["short name"]||""}},{key:"getZIndex",value:function(){return this.properties&&this.properties.zLevel}},{key:"getFeatureCollectionArray",value:function(){return this.getGeometries().map(function(_a){return _a.toJSON()})}},{key:"getGeometryById",value:function(_a){return this.geometries[_a]}},{key:"getGeometries",value:function(){return arguments.length>0&&arguments[0]!==void 0&&arguments[0]?this.geometries&&Object.values(this.geometries).sort(function(_a,_o){return _o.getZIndex()-_a.getZIndex()}):this.geometries&&Object.values(this.geometries).sort(function(_a,_o){return _a.getZIndex()-_o.getZIndex()})}},{key:"getGeometriesByAddress",value:function(_a){return Object.values(this.geometries).filter(function(_o){return _o.address&&_o.address.properties&&_o.address.properties.name&&_o.address.properties.name===_a})}},{key:"isMain",value:function(){return!!this.properties.isMain}}])}(),m1=function(){return _n(function _a(_o){var ga=this,ba=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],_d=arguments.length>3?arguments[3]:void 0;_r(this,_a),this.venueModel=_d,this.levels=_c.map(function(ey){return new g1(ey,ga)}),this.structure=_o,this.id=_o&&_o.id,this.properties=ba},[{key:"getId",value:function(){return this.structure&&this.structure&&this.structure.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getProperties",value:function(){return this.properties}},{key:"isRoot",value:function(){return!!this.properties.is_root}},{key:"getDisplayName",value:function(){return this.properties.display_name||""}},{key:"getName",value:function(){return this.properties.name||""}},{key:"getBoundingBox",value:function(){if(this.structure&&this.structure.geometry){var _a=ry(Vv.getBoundingBox(this.structure.geometry.type,this.structure.geometry.coordinates),2),_o=_a[0],ga=_a[1];if(_o)return[ga[1],_o[0],_o[1],ga[0]]}return[null,null,null,null]}},{key:"getCenter",value:function(){return this.structure&&this.structure.location&&this.structure.location.coordinates}},{key:"getGeometryById",value:function(_a){return this.getGeometries().find(function(_o){return _o.getId()===_a||_o.getIdentifier()===_a})}},{key:"getGeometries",value:function(){return this.levels.flatMap(function(_a){return _a.getGeometries()})}},{key:"getLevelById",value:function(_a){return this.levels.find(function(_o){return _o.getId()===_a||_o.getIdentifier()===_a})}},{key:"getLevelByZIndex",value:function(_a){return this.levels.find(function(_o){return _o.getZIndex()===_a})}},{key:"getLevels",value:function(){return this.levels}},{key:"getMainLevel",value:function(){return this.levels.find(function(_a){return _a.isMain()})}},{key:"getVenueModel",value:function(){return this.venueModel}}])}(),v1=i0.STANDARD,l1=function(){return _n(function _a(_o){var ga=this,ba=arguments.length>1&&arguments[1]!==void 0?arguments[1]:new s1;_r(this,_a),this.metaInformation_=ba,this.momStructure=_o,this.id=_o&&_o.site&&_o.site.id,this.location=_o&&_o.site&&_o.site.location||{},this.properties=_o&&_o.site&&_({},_o.site.properties),this.drawings=_o&&_o.structure&&Object.values(_o.structure).map(function(_c){var _d=_o.getStructureWiseGeometry(_c.id);return new m1(_c,_c.properties,Object.values(_d),ga)})},[{key:"getDisplaySettings",value:function(){return(this.metaInformation_.releaseSettings_?this.metaInformation_.releaseSettings_.displayOptions:"").display||v1}},{key:"getId",value:function(){return this.momStructure&&this.momStructure.site&&this.momStructure.site.identifier}},{key:"getIdentifier",value:function(){return this.id}},{key:"getName",value:function(){return this.properties.name}},{key:"getBoundingBox",value:function(){if(this.momStructure){var _a=ry(Vv.getBoundingBox(this.momStructure.site.geometry.type,this.momStructure.site.geometry.coordinates),2),_o=_a[0],ga=_a[1];if(_o)return[ga[1],_o[0],_o[1],ga[0]]}return[null,null,null,null]}},{key:"getCenter",value:function(){return this.location.coordinates}},{key:"getGeometryById",value:function(_a){return this.getGeometries().find(function(_o){return _o.getId()===_a||_o.getIdentifier()===_a})}},{key:"getGeometries",value:function(){return this.getLevels().sort(function(_a,_o){return _a.getZIndex()-_o.getZIndex()}).flatMap(function(_a){return _a.getGeometries()})}},{key:"getGeometriesByLonLat",value:function(_a){var _o=this,ga=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2],ba=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).map(function(_c){return _o.getLevelById(_c)});return ba.length===0&&(ba=this.drawings.filter(function(_c){var _d=_c.getBoundingBox();return Vv.isPointInBoundingBox(_a,_d)}).flatMap(function(_c){return _c.getLevels()})),M0.getGeometriesByLonLat(_a,ba.flatMap(function(_c){return _c.getGeometries(!0)}),ga)}},{key:"getDrawingById",value:function(_a){return this.drawings.find(function(_o){return _o.getId()===_a||_o.getIdentifier()===_a})}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getRootDrawing",value:function(){return this.drawings.find(function(_a){return _a.isRoot()})}},{key:"getLevelById",value:function(_a){return this.getLevels().find(function(_o){return _o.getId()===_a||_o.getIdentifier()===_a})}},{key:"getLevelsByZIndex",value:function(){var _a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getLevels().filter(function(_o){return Number(_o.getZIndex())===Number(_a)})}},{key:"getLevels",value:function(){return this.drawings.flatMap(function(_a){return _a.getLevels()})}},{key:"getMomStructure",value:function(){return this.momStructure}},{key:"getLevelMapFlattenedByZIndex_",value:function(){var _a=this.getLevels().reduce(function(_o,ga){var ba=ga.getZIndex(),_c=_o;return _c[ba]||(_c[ba]=[]),_c[ba].push(ga),_c},{});return _a}},{key:"getOccupant",value:function(){var _a=this.momStructure.occupant;return Object.values(_a)}}])}(),_1=function(){return _n(function _a(_o){_r(this,_a),this.theme=_o&&_o.theme,this.level=_o&&_o.level,this.site=_o&&_o.site,this.spaces=_o&&_o.spaces,this.address=_o&&_o.address,this.levelConnector=_o&&_o.levelConnector,this.topology=_o&&_o.topology,this.entrance=_o&&_o.entrance,this.occupant=_o&&_o.occupant,this.structure=_o&&_o.structure,this.spaceGroups=_o&&_o.spaceGroups,this.levelWiseGeometry={},this.levelStructureMapping=_o&&_o.levelStructureMapping,this.outdoorLevelMapping=_o&&_o.outdoorLevelMapping||{},this.labelTextPreference=_o&&_o.labelTextPreference||null},[{key:"setSpaceWithLevel",value:function(){var _a=this;this.spaces&&Object.values(this.spaces).forEach(function(_o){var ga="";_o.addressId&&(ga=_a.address&&_a.address[_o.addressId]&&_a.address[_o.addressId].properties.addressName);var ba=_o.properties;ba.addressName=ga;var _c=_a.getLabelAsPerPreference(_(_({},_o),{},{properties:ba})),_d=_o.properties;_d.name=_c,_d.display_name=_c,_o.properties.icon&&(_d.name=_o.id,_d.display_name=_o.id);var ey=_o;ey.properties=_d,ey.address=_a.address[_o.addressId],_a.spaces[_o.id]=_o;var ny=_o.levelId;_a.outdoorLevelMapping[ny]&&(ny=_a.outdoorLevelMapping[ny]),_a.levelWiseGeometry[ny]||(_a.levelWiseGeometry[ny]={}),_a.levelWiseGeometry[ny][ey.id]=ey})}},{key:"setOccupantWithLevel",value:function(){var _a=this;this.occupant&&Object.values(this.occupant).forEach(function(_o){if(_o.spaceIds&&_o.properties.occupantName){var ga=[],ba=[];_o.spaceIds.forEach(function(_c){var _d=_c.id,ey=_a.spaces[_d],ny=null;_a.spaceGroups&&Object.values(_a.spaceGroups).forEach(function(ay){ay.properties.spaceGroups&&ay.properties.spaceGroups&&ay.properties.spaceGroups.forEach(function(dy){dy.mainSpace&&dy.mainSpace.id===_c.id&&(ny=dy.spaces.map(function(gy){return gy.id}))})});var oy=function(ay){var dy=!1;_a.labelTextPreference&&_a.labelTextPreference.length&&(dy=_a.labelTextPreference.indexOf("OCCUPANT_NAMES")!==-1);var gy=_a.labelTextPreference===null||dy,yy=ay,_y=ay.properties;_y.name=ay.properties.icon||!gy?ay.properties.name:_o.properties.occupantName,_y.display_name=ay.properties.icon||!gy?ay.properties.display_name:_o.properties.occupantName,_y.address=ay.address,_y.occupantName=_o.properties.occupantName;var by=ay.levelId;_a.outdoorLevelMapping[by]&&(by=_a.outdoorLevelMapping[by]),_a.levelWiseGeometry[by]||(_a.levelWiseGeometry[by]={}),_a.levelWiseGeometry[by][ay.id]=yy,ga.push(yy),ba.push(ay.id)};ny&&ny.length>0&&ny.forEach(function(ay){oy(_a.spaces[ay])}),ey&&oy(ey)}),_a.occupant[_o.id]=_o,_a.occupant[_o.id].space=ga,_a.occupant[_o.id].spaceIds=ba}})}},{key:"setEntrance",value:function(){var _a=this;this.entrance&&Object.values(this.entrance).forEach(function(_o){var ga=_o.properties.level.id;_a.levelWiseGeometry[ga]||(_a.levelWiseGeometry[_o.properties.level.id]={}),_a.outdoorLevelMapping[ga]&&(ga=_a.outdoorLevelMapping[ga]),_a.levelWiseGeometry[ga][_o.id]=_o})}},{key:"setLevelWiseGeometry",value:function(){var _a=this;this.level&&Object.keys(this.level).forEach(function(_o){_a.levelWiseGeometry[_o]={}}),this.setSpaceWithLevel(),this.setOccupantWithLevel(),this.setEntrance()}},{key:"getStructureWiseGeometry",value:function(_a){for(var _o={},ga=0,ba=Object.entries(this.levelWiseGeometry);ga<ba.length;ga++){var _c=ry(ba[ga],2),_d=_c[0],ey=_c[1];_a===this.levelStructureMapping[_d]&&(_o[_d]=this.level[_d],_o[_d].features=ey)}return _o}},{key:"getLabelAsPerPreference",value:function(_a){var _o=_a.properties,ga=_o.spaceType,ba=_o.occupantName,_c=_o.spaceName,_d=_o.addressName,ey=_o.spaceCategory,ny=_s(_s(_s(_s(_s(_s(_s({},P0,ba),L0,_c),_0,ga?ga.charAt(0).toUpperCase()+ga.slice(1).toLowerCase():""),C0,ey?ey.charAt(0).toUpperCase()+ey.slice(1).toLowerCase():""),G0,_d),H0,_d),jv,_d),oy=this.theme.spaceRules,ay="",dy=ey&&ga&&oy[ey]&&oy[ey].spaceTypes&&oy[ey].spaceTypes[ga].behavioralAppearance.default.labelType;if(dy==="NONE"){if(!this.labelTextPreference)return"";ny[_0]=""}var gy=ey&&ga&&oy[ey]&&oy[ey].properties&&oy[ey].properties.behavioralAppearance&&oy[ey].properties.behavioralAppearance.default&&oy[ey].properties.behavioralAppearance.default.labelType;if((gy==="NONE"||gy===void 0)&&dy===void 0){if(!this.labelTextPreference)return"";ny[_0]="",ny[C0]=""}var yy=ey&&ga&&oy[ey]&&oy[ey].properties&&oy[ey].properties.behavioralAppearance&&oy[ey].properties.behavioralAppearance.default&&oy[ey].properties.behavioralAppearance.default.labelTextPreference,_y=yy&&this.labelTextPreference?this.labelTextPreference:yy;if(_y){for(var by=0;by<_y.length;by++)if(ny[_y[by]]){ay=ny[_y[by]];break}}return ay}}])}(),u1=function(){return _n(function _o(ga){var ba=ga.apiKey,_c=ga.baseUrl,_d=ga.token,ey=ga.hrn;_r(this,_o);var ny={apiKey:ba,url:_c,token:_d,hrn:ey};this.hostOptions_=ny,this.momData=[],this.theme={},this.loadOptions={}},[{key:"setHostOptions",value:function(_o){Object.keys(_o).length===0||(this.hostOptions_=_(_({},this.hostOptions_),_o))}},{key:"getToken",value:function(){return this.hostOptions_.token}},{key:"getHrn",value:function(){return this.hostOptions_.hrn}},{key:"load",value:function(_o){var ga=this,ba=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.loadOptions=_(_(_({},vy),ba),{},{venueId:_o}),this.hostOptions_.mapData=ba.mapData,this.hostOptions_.themeRule=ba.themeRule,this.hostOptions_.svgList=ba.svgList,this.hostOptions_.labelTextPreference=ba.labelTextPreferenceOverride,this.getHrn()?this.getVenueModalInstance():this.getToken()?this.getDefaultCollectionWithToken().then(function(){return ga.getVenueModalInstance()}).catch(function(){return Promise.reject(new Error("Unable to find indoor map collection. Please contact your administrator"))}):Promise.reject(new Error("In order to load indoor map, Please provide either hrn or token"))}},{key:"getVenueModalInstance",value:function(){var _o=this;return Promise.resolve().then(function(){return _o.loadOptions.isMetaEnabled?_o.getMeta_(_o.loadOptions.isIconsEnabled).catch(function(ga){return console.warn(ga),Promise.resolve()}):Promise.reject()}).then(function(ga){return _o.getVenue_(ga)}).then(function(ga){return ga}).catch(function(ga){console.debug("Captured event VENUE_ERROR_STATE",ga)})}},{key:"createMomStructure",value:function(){var _o=this,ga={site:{},structure:{},level:{},levelConnector:{},occupant:{},spaces:{},spaceGroups:{},topology:{},address:{},outdoorLevelMapping:{},entrance:{},levelStructureMapping:{}};return this.momData.forEach(function(ba){var _c=I0.getFormattedIndoorMapId(_o.loadOptions.venueId),_d=ba.id;(ba.momType===Sv.ADDRESS||_o.hostOptions_.mapData||ba.properties.indoorMapId==_o.loadOptions.venueId||ba.properties.indoorMapId===_c)&&(ba.momType===Sv.SITE?ga.site=Bv.setSite(ba,_o.loadOptions.venueId):ba.momType===Sv.STRUCTURE?ga.structure[_d]=Bv.setStructure(ba):ba.momType!==Sv.LEVEL||ba.properties.isOutdoor&&(!ba.properties.isOutdoor||ba.properties.parentIndoorLevel)?ba.momType===Sv.LEVEL&&ba.properties.isOutdoor&&ba.properties.parentIndoorLevel?ga.outdoorLevelMapping[ba.id]=ba.properties.parentIndoorLevel.id:ba.momType===Sv.ENTRANCE?ga.entrance[_d]=Bv.setEntrance(ba):ba.momType===Sv.OCCUPANT?ga.occupant[_d]=Bv.setOccupant(ba):ba.momType===Sv.SPACE?ga.spaces[_d]=Bv.setSpace(ba):ba.momType===Sv.SPACEGROUPS?ga.spaceGroups[_d]=Bv.setSpaceGroups(ba):ba.momType===Sv.ADDRESS&&(ga.address[_d]=Bv.setAddress(ba)):(ga.level[_d]=Bv.setLevel(ba),ga.levelStructureMapping[_d]=ba.properties.structure.id))}),ga.theme=this.theme,ga.labelTextPreference=this.hostOptions_.labelTextPreference,new _1(ga)}},{key:"getVenue_",value:function(_o){this.momData=_o.getMomData();var ga=this.createMomStructure();return ga.setLevelWiseGeometry(),new l1(ga,_o)}},{key:"setConfigData",value:function(_o){var ga=_o.themeRule,ba=_o.svgList,_c=_o.defaultLang;a1.setSpaceRules(ga.spaceRules),Bv.svgList=ba,Bv.themeRule=ga,Bv.defaultLang=_c,this.theme=ga}},{key:"getMeta_",value:function(){var _o=this,ga=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],ba=new s1,_c=this.hostOptions_.mapData?{}:this.getMetaConfig_(this.loadOptions.venueId,zv.SITE),_d=this.hostOptions_.themeRule||this.getMetaConfig_(this.loadOptions.venueId,zv.Theme),ey=[];return ga&&(ey=this.hostOptions_.svgList||this.getMetaConfig_(this.loadOptions.venueId,zv.IMAGES)),new Promise(function(ny){Promise.all([_c,_d,ey]).then(function(oy){var ay=ry(oy,3),dy=ay[0],gy=ay[1],yy=ay[2],_y=_o.hostOptions_.mapData?{mom:new Promise(function(by){return by(_o.hostOptions_.mapData)}),site:_o.hostOptions_.mapData.features.find(function(by){return by.momType===Sv.SITE})}:R0.getMomData(dy,_o.hostOptions_);_y.mom.then(function(by){var wy=gy.properties;ba.imageCache=ga?Bv.manageSvgDimensions(yy.properties):[],_o.setConfigData({themeRule:wy,svgList:ba.imageCache,defaultLang:_y&&_y.site&&_y.site.properties.defaultLanguageCode}),ba.releaseSettings_={displayOptions:{display:wy.entranceRules.default.displayName||i0.STANDARD},mom:by.features},ba.theme=new J0(wy,ba),ny(ba)})})})}},{key:"getMetaConfig_",value:function(_o,ga){return R0.getConfigUrl(_o,ga,this.hostOptions_)}},{key:"fetchCollections",value:function(){return R0.getDefaultCollection(this.hostOptions_)}},{key:"fetchUserProjects",value:function(){return R0.getProjectAccountDetails(this.hostOptions_)}},{key:"getDefaultCollectionWithToken",value:(_a=function(_o){return function(){var ga=this,ba=arguments;return new Promise(function(_c,_d){var ey=_o.apply(ga,ba);function ny(ay){_e(ey,_c,_d,ny,oy,"next",ay)}function oy(ay){_e(ey,_c,_d,ny,oy,"throw",ay)}ny(void 0)})}}(j().mark(function _o(){var ga=this;return j().wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:return ba.abrupt("return",Promise.all([this.fetchCollections(),this.fetchUserProjects()]).then(function(_c){var _d=ry(_c,2),ey=_d[0],ny=_d[1],oy=ga.getHrnFromDefaultCollection(ey,ny);if(oy.hrn){var ay={hrn:oy.hrn};return ga.setHostOptions(ay),Promise.resolve()}return Promise.reject()}).catch(function(_c){return Promise.reject(_c)}));case 1:case"end":return ba.stop()}},_o,this)})),function(){return _a.apply(this,arguments)})},{key:"getHrnFromDefaultCollection",value:function(_o,ga){var ba=_o.results.items;if(Array.isArray(ba)&&ba.length){var _c=this.getProjectRealm(ga);return ba.find(function(_d){return _d.hrn.includes(_c)})}return Promise.reject(new Error("Error while accessing default collection"))}},{key:"getProjectRealm",value:function(_o){if(Array.isArray(_o.items)&&_o.items.length&&_o.items[0].id.includes("indoor-")){var ga=_o.items[0].hrn;return this.getRealmNameFromHrn(ga)}return""}},{key:"getRealmNameFromHrn",value:function(_o){if(_o){var ga=_o.split(":");return ga.length&&ga[4]}return""}},{key:"getSupportedMapList",value:function(){var _o=this,ga=this.hostOptions_,ba=ga.hrn,_c=ga.token;return ba?this.fetchMapInfoList():_c?this.getDefaultCollectionWithToken().then(function(){return _o.fetchMapInfoList()}).catch(function(){return Promise.reject(new Error("Unable to find indoor map collection. Please contact your administrator"))}):Promise.reject(new Error("In order to load map list, Please provide either hrn or token"))}},{key:"fetchMapInfoList",value:function(){var _o=this;return R0.fetchIndoorMapList(this.hostOptions_).then(function(ga){var ba=ga.features;return ba.length>0?ba.map(function(_c){var _d=_c.properties,ey=_d.placeProperties,ny=_d.indoorMapId,oy=ny;if(I0.validateIsMicelloId(ny)){var ay=ny.split("-").pop();oy=ay.substring(ay.length-5)}return{mapIdentifier:ny,mapName:_o.getMapName(ey.names).name,mapId:oy}}):[]}).catch(function(ga){Promise.reject(new Error("".concat(ga,": Error while fetching map list")))})}},{key:"getMapName",value:function(_o){return Array.isArray(_o)&&_o.length>0?_o.find(function(ga){return ga.nameType==="OFFICIAL"}):{}}}]);var _a}(),b1=["origin","destination"],x1=function(){return _n(function _a(){var _o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(_r(this,_a),!_o.apiKey&&!_o.token)throw new Error("API key or Token is missing");this.config_=_({baseUrl:"https://meta-indoor-routing.api-gateway.ls.hereapi.com"},_o)},[{key:"calculateRoute",value:function(_a){var _o=_a.origin,ga=_o===void 0?{}:_o,ba=_a.destination,_c=ba===void 0?{}:ba,_d=_p(_a,b1);if(!ga.coordinates||!_c.coordinates)throw new Error("Waypoint coordinates are missing");var ey=function(ay){var dy=ay.coordinates,gy=ay.venueId,yy=ay.levelId,_y=dy.join(",");return gy&&yy?_y.concat(";indoorMapId=",gy,";levelId=",yy):_y},ny=new URL("".concat(this.config_.baseUrl,"/v1/routes")),oy=new URLSearchParams({origin:ey(ga),destination:ey(_c),apiKey:this.config_.apiKey});return Object.entries(_d).forEach(function(ay){var dy=ry(ay,2),gy=dy[0],yy=dy[1];oy.append(gy,_t(yy)==="object"?JSON.stringify(yy):yy)}),ny.search=oy,fetch(ny,{headers:{"X-Api-Key":this.config_.apiKey}}).then(function(ay){return ay.json()})}}])}(),qv={VENUE_DATA_LOADED:"VENUE_DATA_LOADED",VENUE_THEME_LOADED:"VENUE_THEME_LOADED",VENUE_ICONS_LOADED:"VENUE_ICONS_LOADED",VENUE_MOM_DATA_LOADED:"VENUE_MOM_DATA_LOADED",VENUE_ERROR_STATE:"VENUE_ERROR_STATE",VENUE_MAP_DATA_LOADED:"VENUE_MAP_DATA_LOADED",VENUE_ENTITY_DATA_LOADED:"VENUE_ENTITY_DATA_LOADED",VENUE_DATA_MODEL_LOADED:"VENUE_DATA_MODEL_LOADED",VENUE_NAV_DATA_LOADED:"VENUE_NAV_DATA_LOADED",META_DATA_LOADED:"META_DATA_LOADED",META_DATA_MODEL_LOADED:"META_DATA_MODEL_LOADED",META_DATA_MODEL_UPDATED:"META_DATA_MODEL_UPDATED"};Object.freeze(_s(_s(_s(_s(_s(_s(_s(_s(_s({},qv.VENUE_DATA_LOADED,{description:"event fired when all requested files along with metadata & overrides are loaded",emitTemplate:{}}),qv.VENUE_MAP_DATA_LOADED,{description:"event fired when requested levels, drawings & community files are loaded",emitTemplate:{}}),qv.VENUE_ENTITY_DATA_LOADED,{description:"event fired when requested entity data is loaded",emitTemplate:{}}),qv.VENUE_DATA_MODEL_LOADED,{description:"event fired when a map file is loaded",emitTemplate:{}}),qv.VENUE_NAV_DATA_LOADED,{description:"event fired when requested navigation product is loaded",emitTemplate:{}}),qv.META_DATA_LOADED,{description:"event fired when all requested meta files are loaded except icon & marker",emitTemplate:{}}),qv.META_DATA_MODEL_LOADED,{description:"event fired when a specific model is loaded except icon & marker",emitTemplate:{}}),qv.META_DATA_MODEL_UPDATED,{description:"event fired when a specific meta override is added or removed",emitTemplate:{}}),qv.VENUE_ICONS_LOADED,{description:"event fired when all icons of venue are loaded",emitTemplate:{}}));var c1=new Iy;c1.EVENT_NAME=qv,c1.on("newListener",function(_a){qv[_a]||console.warn("subscribing for un-registered/documented event")});var uv=function(_a){function _o(ga){var ba;if(_r(this,_o),ba=s(this,_o),!(ga instanceof l1))throw new Error("It is mandatory to provide valid instance of venueModel");return ba.venueModel=ga,ba.search_=new U0(ga),ba.status_={activeDrawingId:ga.getRootDrawing().getIdentifier(),activeLevelIndex:ga.getRootDrawing().getMainLevel().getZIndex()},ba.mapObjectStore_=ba.getDefaultMapObjectsStore_(),ba.drawings=ga.getDrawings().map(function(_c){var _d=new my(_c);return _d.setParentEventTarget(ba),_d}),ba.levels=ga.getLevels().map(function(_c){var _d=new xy(_c);return _d.setParentEventTarget(ba.drawings.find(function(ey){return ey.getIdentifier()===_d.getData().getDrawing().getIdentifier()})),_d}),ba.geometries=ga.getGeometries().map(function(_c){var _d=new fy(_c);return _d.setParentEventTarget(ba.levels.find(function(ey){return ey.getIdentifier()===_d.getData().getLevel().getIdentifier()})),_d}),ba.mutualExclusiveHighlight_=!1,ba}return _l(_o,H.map.Feature),_n(_o,[{key:"getData",value:function(){return this.venueModel}},{key:"getBoundingBox",value:function(){return h(H.geo.Rect,ly(this.venueModel.getBoundingBox()))}},{key:"getCenter",value:function(){var ga=ry(this.venueModel.getCenter(),2),ba=ga[0],_c=ga[1];return new H.geo.Point(_c,ba)}},{key:"getId",value:function(){return this.venueModel.getId()}},{key:"getIdentifier",value:function(){return this.venueModel.getIdentifier()}},{key:"getName",value:function(){return this.venueModel.getName()}},{key:"getDrawing",value:function(ga){return this.drawings.find(function(ba){return ba.getIdentifier()===ga})}},{key:"getDrawings",value:function(){return this.drawings}},{key:"getLevel",value:function(ga){return this.levels.find(function(ba){return ba.getIdentifier()===ga})}},{key:"getLevels",value:function(){return this.levels}},{key:"getGeometry",value:function(ga){return this.getGeometries().find(function(ba){return ba.getIdentifier()===ga})}},{key:"getGeometries",value:function(){return this.geometries}},{key:"getActiveLevels",value:function(){var ga=this;return this.getData().getDisplaySettings()===i0.FLATTEN?this.venueModel.getLevelsByZIndex(this.status_.activeLevelIndex).map(function(ba){return ga.getLevel(ba.getIdentifier())}):[this.venueModel.getDrawingById(this.status_.activeDrawingId).getLevelByZIndex(this.status_.activeLevelIndex)].map(function(ba){return ga.getLevel(ba.getIdentifier())})}},{key:"getActiveDrawing",value:function(){return this.getDrawing(this.status_.activeDrawingId)}},{key:"setActiveDrawing",value:function(ga){if(this.status_.activeDrawingId!==ga){var ba=this.venueModel.getDrawingById(ga);if(!ba)throw new Error("Drawing ".concat(ga," was not found"));var _c=this.status_.activeDrawingId;this.status_.activeDrawingId=ba.id,this.setActiveLevelIndex(ba.getMainLevel().getZIndex()),this.dispatchEvent(new H.util.ChangeEvent(_o.EVENTS.DRAWING_CHANGE,ga,_c))}}},{key:"getActiveLevelIndex",value:function(){return this.status_.activeLevelIndex}},{key:"setActiveLevelIndex",value:function(ga){if(this.venueModel.getLevelsByZIndex(ga)){var ba=this.status_.activeLevelIndex;this.status_.activeLevelIndex=ga,this.dispatchEvent(new H.util.ChangeEvent(_o.EVENTS.LEVEL_CHANGE,ga,ba))}}},{key:"isActive",value:function(){var ga=this.getParentEventTarget();return!!ga&&this===ga.activeVenue}},{key:"getHighlightedGeometries",value:function(){var ga=this;return this.venueModel.getGeometries().filter(function(ba){return ba.isHighlighted()}).map(function(ba){return ga.getGeometry(ba.getIdentifier())})}},{key:"setHighlightedGeometries",value:function(){var ga=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0],ba=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],_c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},_d=arguments.length>3&&arguments[3]!==void 0&&arguments[3],ey=_(_({},l0),_c),ny=ey.fillColor,oy=ey.outlineColor,ay=ey.outlineWidth;this.mutualExclusiveHighlight_=!!_d,this.mutualExclusiveHighlight_&&this.getHighlightedGeometries().forEach(function(dy){dy.getData().highlight(!1)}),ba.forEach(function(dy){dy.getData().highlight(ga,{m:ny,o:oy,w:ay})}),this.dispatchEvent(_o.EVENTS.GEOMETRY_HIGHLIGHT)}},{key:"getMapObjects",value:function(){var ga=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveLevelIndex(),ba=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getActiveDrawing();return this.mapObjectStore_[ga][ba.getIdentifier()]}},{key:"setMapObjects",value:function(){var ga=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ba=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getActiveLevelIndex(),_c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getActiveDrawing();this.mapObjectStore_[ba]&&this.mapObjectStore_[ba][_c.getIdentifier()]&&(this.mapObjectStore_[ba][_c.getIdentifier()]=ly(ga)),this.updateMapObjectsVisibility_()}},{key:"search",value:function(){var ga=this,ba=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return this.search_.find(ba).flatMap(function(_c){return _c.geometries.map(function(_d){return ga.getGeometry(_d.id)})})}},{key:"updateMapObjectsVisibility_",value:function(){Object.values(this.mapObjectStore_).forEach(function(ga){Object.values(ga).forEach(function(ba){return ba.forEach(function(_c){return _c.setVisibility(!1)})})}),this.isActive()&&this.mapObjectStore_[this.getActiveLevelIndex()][this.getActiveDrawing().getIdentifier()].forEach(function(ga){return ga.setVisibility(!0)})}},{key:"getDefaultMapObjectsStore_",value:function(){var ga=this,ba=this.getData().getDisplaySettings()===i0.FLATTEN;return this.venueModel.getLevels().reduce(function(_c,_d){var ey=_d.getZIndex(),ny=_({},_c);return ny[ey]||(ny[ey]={}),ny[ey][_d.getDrawing().getIdentifier()]=[],ba&&(ny[ey][ga.venueModel.getRootDrawing().getIdentifier()]=[]),ny},{})}}])}();uv.EVENTS={ACTIVE_VENUE_CHANGE:"activevenuechange",DRAWING_CHANGE:"drawingchange",LEVEL_CHANGE:"levelchange",GEOMETRY_HIGHLIGHT:"geometryhighlight"};var q0=function(){return _n(function _a(){_r(this,_a)},null,[{key:"getIconLayer",value:function(){return{type:"FeatureCollection",features:(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).flatMap(function(_a){return _a.getData().getGeometries()}).filter(function(_a){return _a.isIcon()&&_a.getIcon()}).map(function(_a){var _o=ry(_a.getLabelArea(),2),ga=_o[0],ba=_o[1],_c=_a.getLevel(),_d=_a.getIcon(),ey=_a.properties.spaceType||_a.properties.spaceCategory||_a.getDisplayName();return{type:"Feature",properties:{id:_a.getIdentifier(),geometryId:_a.getIdentifier(),levelId:_c.getIdentifier(),name:ey,venueId:_c.getDrawing().getVenueModel().getIdentifier(),url:_d?"data:image/svg+xml;utf8,".concat(encodeURIComponent(_d)):""},geometry:{type:Pv,coordinates:[ga,ba]}}})}}},{key:"getLabelLayer",value:function(){return{type:"FeatureCollection",features:(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).flatMap(function(_a){return _a.getData().getGeometries()}).filter(function(_a){return _a.getDisplayName()&&!_a.isIcon()}).map(function(_a){var _o=ry(_a.getLabelArea(),2),ga=_o[0],ba=_o[1],_c=_a.getLabelStyle(),_d=_c.fill,ey=_c.zmin,ny=_a.getLevel();return{type:"Feature",properties:{id:_a.getIdentifier(),geometryId:_a.getIdentifier(),levelId:ny.getIdentifier(),venueId:ny.getDrawing().getVenueModel().getIdentifier(),name:_a.getDisplayName(),minZoom:ey||15,textFillColor:_d.toLowerCase()},geometry:{type:Pv,coordinates:[ga,ba]}}})}}},{key:"getGeometryLayer",value:function(){return{type:"FeatureCollection",features:(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).flatMap(function(_a){return _a.getData().getGeometries()}).filter(function(_a){return _a.getType()!==Pv}).map(function(_a){var _o=_a.getHighlightedStyle()||{},ga=_o.m,ba=_o.o,_c=_o.w,_d=_({},_a.getStyle()),ey=_d.m,ny=_d.o,oy=_d.w,ay=z0,dy=ay.fillColor,gy=ay.outlineColor,yy=ay.outlineWidth,_y=_a.getLevel();return{type:"Feature",properties:{id:_a.getIdentifier(),fillColor:(ga||ey||dy).toLowerCase(),geometryId:_a.getIdentifier(),levelId:_y.getIdentifier(),venueId:_y.getDrawing().getVenueModel().getIdentifier(),outlineColor:(ba||ny||gy).toLowerCase(),outlineWidth:Number(((_c||oy||yy)/3).toFixed(2)),zIndex:_a.getZIndex()},geometry:{type:_a.getType(),coordinates:_a.getCoordinates()}}})}}},{key:"getFootprintLayer",value:function(_a){return{type:"FeatureCollection",features:_a.flatMap(function(_o){return _o.getData().getLevels().map(function(ga){var ba=ga.getIdentifier(),_c=_o.getLevel(ba).getData().levelData.geometry;return{type:"Feature",properties:{isFootprint:!0,levelId:ba,venueId:_o.getIdentifier(),zIndex:1},geometry:{type:"MultiPolygon",coordinates:_c.coordinates}}})})}}}])}(),w1=function(){return _n(function _a(){_r(this,_a)},null,[{key:"getStyle",value:function(){var _a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],_o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],ga={styles:[{dataLayer:fv.FOOTPRINT,when:["==",["geometry-type"],"Polygon"],technique:"solid-line",color:"#4E5663",width:["interpolate",["linear"],["zoom"],0,"1px",6,"1px",7,"2px",18,"2px",19,"4px",24,"4px"],renderOrder:1},{dataLayer:fv.FOOTPRINT,when:["==",["geometry-type"],"Point"],technique:"text",color:"black",size:16,text:["get","venueName"],priority:61},{dataLayer:fv.VECTOR,when:["==",["geometry-type"],"Polygon"],technique:"polygon",color:["get","fillColor"],renderOrder:["get","zIndex"]},{dataLayer:fv.VECTOR,technique:"solid-line",color:["get","outlineColor"],width:["get","outlineWidth"],renderOrder:["get","zIndex"]},{dataLayer:fv.TEXT,minZoomLevel:["get","minZoom"],technique:"text",color:["get","textFillColor"],size:k0.size,text:["get","name"],priority:60},{dataLayer:fv.ICON,minZoomLevel:g0,when:["==",["geometry-type"],"Point"],technique:"labeled-icon",textIsOptional:!0,size:0,text:["get","name"],imageTexture:["concat","texture",["get","name"]],screenWidth:["interpolate",["linear"],["zoom"],15,3,21,70],screenHeight:["interpolate",["linear"],["zoom"],15,3,21,70],priority:61}],images:{},imageTextures:[]};return _a.forEach(function(ba){var _c="texture"+ba.properties.name;ga.images[_c]||(ga.images[_c]={url:ba.properties.url,preload:!0},ga.imageTextures.push({name:_c,image:_c}))}),_o.forEach(function(ba){var _c,_d=ba.getData().getHighlightedStyle(),ey=_d.m,ny=_d.o,oy=_d.w;(_c=ga.styles).push.apply(_c,[{dataLayer:fv.VECTOR,when:["==",["get","id"],ba.id],technique:"polygon",color:ey,renderOrder:["get","zIndex"]},{dataLayer:fv.VECTOR,when:["==",["get","id"],ba.id],technique:"solid-line",color:ny,width:oy,renderOrder:["get","zIndex"]}])}),new H.map.render.harp.Style(ga)}}])}(),E1=function(){function _a(){_r(this,_a)}return _n(_a,null,[{key:"getIconsTextures",value:function(){var _o={},ga={},ba=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).reduce(function(_c,_d){var ey=_d.properties.name;return _c[ey]||(_c[ey]=[]),_c[ey].push(_d),_c},{});return Object.keys(ba).forEach(function(_c){var _d="texture".concat(_c),ey="sprite".concat(_c),ny=ba[_c][0].properties.url;_o[_d]={url:ny,sprites:_s({},ey,[0,0,50,50])},ba[_c].forEach(function(oy){var ay=oy.properties;ga["icon".concat(ay.name)]={filter:{name:ay.name,$zoom:{min:g0}},draw:{points:{interactive:!0,priority:1,size:[[15,"50%"],[16,"55%"],[17,"60%"],[18,"65%"],[19,"75%"],[20,"80%"],[21,"100%"]],texture:_d,sprite:ey}}}})}),{textures:_o,iconLayers:ga}}},{key:"getFootprintLayer",value:function(){return{data:{source:"venues",layer:fv.FOOTPRINT},draw:{lines:{color:"#4E5663",width:[[0,"1px"],[6,"1px"],[7,"2px"],[18,"2px"],[19,"4px"],[24,"4px"]],order:1},points:{color:"[0, 0, 0, 0]",size:"0px",order:3,priority:1,text:{anchor:"center",collide:!1,font:{fill:"black",size:"16px"},text_source:"function() { return feature.venueName }"}}}}}},{key:"getGeometryLayer",value:function(){var _o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ga={};if(_o.length){var ba=_o[0].getData().getHighlightedStyle(),_c=ba.m,_d=ba.o,ey=ba.w;ga={filter:{id:_o.map(function(ny){return ny.id})},draw:{polygons:{interactive:!0,color:_c},lines:{color:_d,width:ey}}}}return{data:{source:"venues",layer:fv.VECTOR},draw:{polygons:{interactive:!0,color:"function() { return feature.fillColor }",order:"function() { return feature.zIndex }"},lines:{color:"function() { return feature.outlineColor }",order:"function() { return feature.zIndex }",width:"function() { return feature.outlineWidth }"}},highlighted:ga}}},{key:"getTextLayer",value:function(){return{filter:{$zoom:{min:Z0}},data:{source:"venues",layer:fv.TEXT},draw:{points:{filter:"function() { return $zoom > feature.minZoom }",color:"[0, 0, 0, 0]",size:"0px",offset:["0px","-10px"],priority:2,text:{font:{fill:"function() { return feature.textFillColor }",size:k0.size},text_source:"function() { return feature.name }"}}}}}},{key:"getIconLayer",value:function(_o){return _({data:{source:"venues",layer:fv.ICON}},_o)}},{key:"getStyle",value:function(){var _o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],ga=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],ba=_a.getIconsTextures(_o),_c=ba.textures,_d=ba.iconLayers,ey={venue_footprints:_a.getFootprintLayer(),venue_geometries:_a.getGeometryLayer(ga),venue_labels:_a.getTextLayer(),venue_icons:_a.getIconLayer(_d)},ny=H.gl.yaml.dump({sources:{venues:{max_zoom:B0,type:"GeoJSONTileSource"}},layers:ey,textures:_c});return new H.map.render.webgl.Style(ny)}}])}(),T1={type:"FeatureCollection",features:[]},Q0={extent:4096,indexMaxZoom:0,maxZoom:24,tolerance:3},A1=function(_a){function _o(ga){var ba;return _r(this,_o),(ba=s(this,_o,[ga])).venues=[],ba.activeVenue=null,ba.dataLayers_={},ba.tileIndexes_={},ba.addEventListener(uv.EVENTS.ACTIVE_VENUE_CHANGE,ba.activeVenueChangeHandler_,void 0,ba),ba}return _l(_o,H.map.provider.RemoteTileProvider),_n(_o,[{key:"setStyle",value:function(ga){return this.setStyleInternal(ga)}},{key:"getStyle",value:function(){return this.getStyleInternal()}},{key:"isFeatureVisible_",value:function(ga){var ba=ga.properties;return!!this.activeVenue.getActiveLevels().some(function(_c){return _c.id===ba.levelId})}},{key:"requestInternal",value:function(ga,ba,_c,_d){var ey=this,ny=function(ay){for(var dy=0;dy<ay.length;dy+=1)ay[dy]=ay[dy].map(function(gy){return Cy(gy,_c,ga,ba,Q0.extent)})},oy={};return Object.keys(this.tileIndexes_).forEach(function(ay){var dy=ey.tileIndexes_[ay].getTile(_c,ga,ba);oy[ay]=dy?function(Ty){var Ny=[],By=Ty&&Ty.features;if(By)for(var $y=0,Xy=By.length;$y<Xy;$y+=1){var Yy=By[$y],Qy=Yy.type,Uy=void 0,Wy=!1;switch(Qy){case dv:Uy={type:Fv,coordinates:Yy.geometry.map(function(Vy){return Vy.slice()})};break;case Kv:case Hv:Uy={type:$v,coordinates:Yy.geometry.map(function(Vy){return Vy.map(function(ov){return ov.slice()})})},Qy===Hv&&(Uy=e0(Uy))==null&&(Wy=!0);break;default:Wy=!0}Wy||Ny.push({geometry:Uy,id:Yy.id,properties:Yy.tags,type:"Feature"})}return{type:"FeatureCollection",features:Ny}}(dy):T1,oy[ay].features=oy[ay].features.filter(function(Ty){return ey.isFeatureVisible_(Ty)});for(var gy=0;gy<oy[ay].features.length;gy+=1){var yy=oy[ay].features[gy],_y=yy.geometry.type;if(_y===a0||_y===$v)ny(yy.geometry.coordinates);else if(_y===kv)yy.geometry.coordinates.map(ny);else for(var by=yy.geometry.coordinates,wy=0;wy<by.length;wy+=1)by[wy]=Cy(by[wy],_c,ga,ba,Q0.extent)}}),_d(oy),{cancel:function(){}}}},{key:"getActiveVenue",value:function(){return this.activeVenue}},{key:"getVenue",value:function(ga){return ga?this.venues.find(function(ba){return ba.getIdentifier()===ga}):this.activeVenue}},{key:"setActiveVenue",value:function(ga){var ba=this.activeVenue;this.activeVenue=ga,this.dispatchEvent(new H.util.ChangeEvent(uv.EVENTS.ACTIVE_VENUE_CHANGE,ga,ba)),this.reload()}},{key:"addVenue",value:function(ga){var ba=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!(ga instanceof uv))throw new Error("Invalid argument");var _c=ga.getIdentifier();if(this.getVenue(_c))throw new Error("Please invoke provider.removeVenue to remove old instance of venue ".concat(_c," before adding new"));ga.setParentEventTarget(this),this.venues.push(ga),ba||(this.reloadData_(),this.reloadStyle_())}},{key:"addVenues",value:function(){var ga=this,ba=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];ba.length>0&&(ba.forEach(function(_c){_c instanceof uv&&ga.addVenue(_c,!0)}),this.reloadData_(),this.reloadStyle_())}},{key:"removeVenue",value:function(ga){if(ga instanceof uv&&this.venues.indexOf(ga)>-1){var ba=ga.getIdentifier();this.activeVenue&&this.activeVenue.getIdentifier()===ba&&this.setActiveVenue(null),this.venues.splice(this.venues.indexOf(ga),1),this.reloadData_(),this.reloadStyle_(),this.reload()}}},{key:"getFeatureProxy",value:function(ga,ba,_c){var _d=ga.geometryId,ey=ga.venueId,ny=this.getVenue(ey);return _d?_c(ny.getGeometries().find(function(oy){return oy.id===_d})):ny&&_c(ny),!0}},{key:"addVenueEventListeners_",value:function(ga){ga&&(ga.addEventListener(uv.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),ga.addEventListener(uv.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),ga.addEventListener(uv.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"removeVenueEventListeners_",value:function(ga){ga&&(ga.removeEventListener(uv.EVENTS.GEOMETRY_HIGHLIGHT,this.geometryHighlightHandler_,void 0,this),ga.removeEventListener(uv.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),ga.removeEventListener(uv.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this))}},{key:"activeVenueChangeHandler_",value:function(ga){var ba=ga.oldValue,_c=ga.newValue;ba&&(this.removeVenueEventListeners_(ba),ba.updateMapObjectsVisibility_()),_c&&(this.addVenueEventListeners_(_c),_c.updateMapObjectsVisibility_())}},{key:"drawingChangeHandler_",value:function(){this.reload()}},{key:"levelChangeHandler_",value:function(){this.activeVenue&&(this.activeVenue.updateMapObjectsVisibility_(),this.reload())}},{key:"geometryHighlightHandler_",value:function(){this.reloadStyle_(this.activeVenue.getHighlightedGeometries())}},{key:"createDataLayers_",value:function(){var ga=this,ba=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Object.keys(fv),_c=fv.FOOTPRINT,_d=fv.ICON,ey=fv.TEXT,ny=fv.VECTOR;ba.forEach(function(oy){switch(oy){case ny:ga.dataLayers_[ny]=q0.getGeometryLayer(ga.venues);break;case _c:ga.dataLayers_[_c]=q0.getFootprintLayer(ga.venues);break;case _d:ga.dataLayers_[_d]=q0.getIconLayer(ga.venues);break;case ey:ga.dataLayers_[ey]=q0.getLabelLayer(ga.venues);break;default:throw new Error("Unsupported Layer ".concat(oy))}})}},{key:"createTileIndexes_",value:function(){var ga=this;(arguments.length>0&&arguments[0]!==void 0?arguments[0]:Object.keys(fv)).forEach(function(ba){ga.tileIndexes_[ba]=new Wv(ga.dataLayers_[ba],Q0)})}},{key:"reloadData_",value:function(){var ga=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Object.keys(fv);this.createDataLayers_(ga),this.createTileIndexes_(ga)}},{key:"reloadStyle_",value:function(ga){var ba=this.dataLayers_[fv.ICON]?this.dataLayers_[fv.ICON].features:[];this.getEngineType()===H.Map.EngineType.WEBGL?this.setStyle(E1.getStyle(ba,ga)):this.getEngineType()===H.Map.EngineType.HARP&&this.setStyle(w1.getStyle(ba,ga))}},{key:"providesGeoJSON",value:function(){return!0}}])}(),S1=new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3}),k1=new H.map.SpatialStyle({strokeColor:"#1ab4bf",lineWidth:3}),O1=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImIiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzNC4yNSAzMS42NTJ6Ii8+PG1hc2sgaWQ9ImMiIHdpZHRoPSIzOCIgaGVpZ2h0PSI0NiIgeD0iMCIgeT0iMCIgZmlsbD0iI2ZmZiI+PHVzZSB4bGluazpocmVmPSIjYSIvPjwvbWFzaz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZWxsaXBzZSBjeD0iMjAiIGN5PSI0NS4xNiIgZmlsbD0iI0ZGRiIgc3Ryb2tlPSIjOTc5Nzk3IiBzdHJva2Utd2lkdGg9Ii4yNSIgcng9IjMuNSIgcnk9IjMuNSIvPjx1c2UgZmlsbD0iIzAxQjZCMiIgeGxpbms6aHJlZj0iI2IiLz48cGF0aCBmaWxsPSIjMzIzMjMyIiBmaWxsLW9wYWNpdHk9Ii41IiBkPSJNMTEuODEgMzcuNjZoMTYuMzhsLTguMiA4eiIvPjx1c2Ugc3Ryb2tlPSIjNDE2QTg2IiBzdHJva2Utd2lkdGg9Ii41IiBtYXNrPSJ1cmwoI2MpIiB4bGluazpocmVmPSIjYSIvPjxlbGxpcHNlIGN4PSIxOS44MSIgY3k9IjE5LjE5IiBmaWxsPSIjRkZGIiByeD0iNC44MSIgcnk9IjQuODEiLz48L2c+PC9zdmc+"),P1=new H.map.Icon("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI1MCIgdmlld0JveD0iMCAwIDQwIDUwIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGRlZnM+PHBhdGggaWQ9ImEiIGQ9Ik0zNC4yNSAzMS42NTJBMTkuMDE1IDE5LjAxNSAwIDAgMCAzOSAxOS4wNkMzOSA4LjU0OSAzMC40NzggMCAyMCAwUzEgOC41NSAxIDE5LjA1OWMwIDQuODIzIDEuNzk1IDkuMjMzIDQuNzUgMTIuNTkzTDE5Ljk3NSA0NiAzMi44MyAzMy4xMDRjLjQwNy0uMzc0IDEuNDE5LTEuNDUyIDEuNDE5LTEuNDUyeiIvPjxtYXNrIGlkPSJjIiB3aWR0aD0iMzgiIGhlaWdodD0iNDYiIHg9IjAiIHk9IjAiIGZpbGw9IiNmZmYiPjx1c2UgeGxpbms6aHJlZj0iI2EiLz48L21hc2s+PGVsbGlwc2UgaWQ9ImIiIGN4PSIxOS44MDciIGN5PSIxOS4xNjgiIHJ4PSIxMi4zNjMiIHJ5PSIxMi4xOTciLz48bWFzayBpZD0iZCIgd2lkdGg9IjI1LjcyNSIgaGVpZ2h0PSIyNS4zOTQiIHg9Ii0uNSIgeT0iLS41Ij48cGF0aCBmaWxsPSIjZmZmIiBkPSJNNi45NDQgNi40NzFoMjUuNzI1djI1LjM5NEg2Ljk0NHoiLz48dXNlIHhsaW5rOmhyZWY9IiNiIi8+PC9tYXNrPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxlbGxpcHNlIGN4PSIyMCIgY3k9IjQ1LjE2IiBmaWxsPSIjRkZGIiBzdHJva2U9IiM5Nzk3OTciIHN0cm9rZS13aWR0aD0iLjI1IiByeD0iMy41IiByeT0iMy41Ii8+PHVzZSBmaWxsPSIjMzIzMjMyIiB4bGluazpocmVmPSIjYSIvPjxwYXRoIGZpbGw9IiM3RDdEN0QiIGQ9Ik0xMi4wMTEgMzcuODA1aDE1Ljk3OGwtNy45MTYgOHoiLz48dXNlIHN0cm9rZT0iIzdDN0M3QyIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNlKSIgeGxpbms6aHJlZj0iI2EiLz48dXNlIHN0cm9rZT0iI0ZGRiIgc3Ryb2tlLXdpZHRoPSIuNSIgbWFzaz0idXJsKCNjKSIgeGxpbms6aHJlZj0iI2EiLz48ZWxsaXBzZSBmaWxsPSIjRkZGIiBjeD0iMTkuODA3IiBjeT0iMTkuMTY4IiByeD0iMTIuMzYzIiByeT0iMTIuMTk3Ii8+PHBhdGggZmlsbD0iIzMyMzIzMiIgZD0iTTYuODEyIDYuOTQ4aDYuNDV2Ni4zNjRoLTYuNDV6bTAgMTIuNzI3aDYuNDV2Ni4zNjRoLTYuNDV6bTYuNDUtNi4zNjNoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS0xOS4wOTFoNi40NXY2LjM2NGgtNi40NXptMCAxMi43MjdoNi40NXY2LjM2NGgtNi40NXptNi40NS02LjM2M2g2LjQ1djYuMzY0aC02LjQ1em0wIDEyLjcyN2g2LjQ1djYuMzY0aC02LjQ1eiIvPjx1c2Ugc3Ryb2tlPSIjRkZGIiBtYXNrPSJ1cmwoI2QpIiB4bGluazpocmVmPSIjYiIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIvPjwvZz48L3N2Zz4="),L1=function(_a,_o,ga){return ga===Y0.ObjectType.SEGMENT_START_MARKER?_a===0?O1:null:ga===Y0.ObjectType.SEGMENT_FINISH_MARKER?_o.length===1||_a===_o.length-1?P1:null:_o[_a].departure.place.type==="indoor"?S1:k1},Y0=function(){function _a(_o,ga){_r(this,_a),this.indoorMapObjects_=null,this.outdoorMapObjects_=null,this.createRouteObjects_(_o,ga)}return _n(_a,[{key:"createRouteObjects_",value:function(_o){var ga=this,ba=_o.sections,_c=ba===void 0?[]:ba,_d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:L1;this.indoorMapObjects_={},this.outdoorMapObjects_=new H.map.Group;for(var ey=function(){var oy,ay,dy=_c[ny],gy=dy.departure.place,yy=gy.id,_y=gy.type,by=H.util.flexiblePolyline.decode(dy.polyline).polyline,wy=_d(ny,_c,_a.ObjectType.SEGMENT_START_MARKER);wy&&(oy=new H.map.Marker(dy.departure.place.location,{icon:wy}));var Ty=_d(ny,_c,_a.ObjectType.SEGMENT_FINISH_MARKER);Ty&&(ay=new H.map.Marker(dy.arrival.place.location,{icon:Ty}));var Ny=_d(ny,_c,_a.ObjectType.SEGMENT_POLYLINE);if(_y==="indoor"){var By=function(){var Qy=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Uy=new Map,Wy=new H.geo.LineString,Vy=ry(Qy[0],3)[2];return Uy.set(Vy,[Wy]),Qy.forEach(function(ov){var hv;ov[2]!==Vy&&(Vy=ov[2],Wy=new H.geo.LineString,Uy.has(Vy)?Uy.get(Vy).push(Wy):Uy.set(Vy,[Wy])),(hv=Wy).pushLatLngAlt.apply(hv,ly(ov))}),Uy}(by),$y=Array.from(By.keys()).reduce(function(Qy,Uy){return Qy[Uy]||(Qy[Uy]=new H.map.Group),Qy},{});Ny&&By.forEach(function(Qy,Uy){Qy.forEach(function(Wy){if(Wy.getPointCount()>1){var Vy=new H.map.Polyline(Wy,{style:Ny});$y[Uy].addObject(Vy)}})}),oy&&$y[dy.departure.place.location.lvl].addObject(oy),ay&&$y[dy.arrival.place.location.lvl].addObject(ay),ga.indoorMapObjects_[yy]=_(_({},ga.indoorMapObjects_[yy]||{}),$y)}else{if(Ny){var Xy=new H.geo.LineString(by.flatMap(function(Qy){return[Qy[0],Qy[1],0]})),Yy=new H.map.Polyline(Xy,{style:Ny});ga.outdoorMapObjects_.addObject(Yy)}oy&&ga.outdoorMapObjects_.addObject(oy),ay&&ga.outdoorMapObjects_.addObject(ay)}},ny=0;ny<_c.length;ny++)ey()}},{key:"getIndoorObjects",value:function(){return this.indoorMapObjects_}},{key:"getOutdoorObjects",value:function(){return this.outdoorMapObjects_}}])}();Y0.ObjectType={SEGMENT_START_MARKER:1,SEGMENT_FINISH_MARKER:2,SEGMENT_POLYLINE:3};var t1=function(_a){function _o(ga){var ba;_r(this,_o),ba=s(this,_o,[_o,_(_({},ga),{},{baseUrl:void 0})]);var _c={apiKey:ga.apikey,baseUrl:ga.baseUrl,token:ga.token},_d={apiKey:_c.apiKey,token:_c.token};_c.apiKey||(_c.apiKey=ba.getUrl().getQuery().apikey);var ey=ga.useLegacy||!1;return ba.venueService_=new u1(_c,ey),_d.apiKey||(_d.apiKey=ba.getUrl().getQuery().apikey),ga.routingBaseUrl&&(_d.baseUrl=ga.routingBaseUrl),ba.routingService_=new x1(_d),ba}return _l(_o,H.service.Service),_n(_o,[{key:"loadVenue",value:function(ga){return console.warn("Venue service version 1 is no longer supported hence "+ga+" could not be loaded"),Promise.resolve()}},{key:"calculateRoute",value:function(ga){return console.warn("HERE Indoor Routing is deprecated and will be removed soon."),this.routingService_.calculateRoute(ga)}}])}();t1.CONFIG_KEY="venues";var W0=function(_a){function _o(ga){var ba;_r(this,_o),ba=s(this,_o,[_o,_(_({},ga),{},{baseUrl:void 0})]);var _c={apiKey:ga.apikey,baseUrl:ga.baseUrl,token:ga.token,hrn:ga.hrn};_c.apiKey||(_c.apiKey=ba.getUrl().getQuery().apikey);var _d=ga.useLegacy||!1;return ba.venueService_=new u1(_c,_d),ba}return _l(_o,H.service.Service),_n(_o,[{key:"loadVenue",value:function(ga){var ba=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.venueService_.load(ga,ba).then(function(_c){return new uv(_c)})}},{key:"getMapInfoList",value:function(){return this.venueService_.getSupportedMapList()}}])}();W0.CONFIG_KEY="indoorMaps",H.service.Platform.prototype.getVenuesService=function(_a,_o){var ga=W0;return _o!==1&&_o?_o!==X0.v2||_a.token||(_a.hrn?_a.apikey||console.error("Venue Service version 2 requires either apikey or token"):console.error("Token is mandatory when Hrn is not provided in Venue Service version 2")):(console.warn("Venue service version 1 is no longer supported"),ga=t1),this.createService(ga,_a)},W0.LABEL_TEXT_PREFERENCE_OVERRIDE={OCCUPANT_NAMES:"OCCUPANT_NAMES",SPACE_NAME:"SPACE_NAME",SPACE_TYPE_NAME:"SPACE_TYPE_NAME",SPACE_CATEGORY_NAME:"SPACE_CATEGORY_NAME",INTERNAL_ADDRESS:"INTERNAL_ADDRESS"};var C1=function(_a){function _o(ga){var ba,_c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _r(this,_o),(ba=s(this,_o)).provider_=null,ba.levelSelectorUI_=null,ba.setAlignment(_c&&_c.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),ba.addClass("venues-ui"),ga instanceof uv&&ba.setVenue(ga),ba}return _l(_o,H.ui.Control),_n(_o,[{key:"renderInternal",value:function(ga,ba){ty(Ap(_o.prototype),"renderInternal",this).call(this,ga,ba),this.createLevelSelectorUI_(ga),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(ga){ga instanceof uv&&(this.removeEventListeners_(),this.venue=ga,this.provider_=ga.getParentEventTarget(),this.update_(),this.addEventListeners_())}},{key:"createLevelSelectorUI_",value:function(ga){var ba=this;ga.innerHTML="",this.levelSelectorUI_=null,this.levelSelectorUI_=new f1(ga,null,null,function(_c){return ba.venue.setActiveLevelIndex(_c)})}},{key:"update_",value:function(){if(this.levelSelectorUI_){var ga=this.venue.getActiveDrawing().getData(),ba=this.venue.getData().getDisplaySettings();this.levelSelectorUI_.update(ga,ba),this.levelChangeHandler_()}}},{key:"addEventListeners_",value:function(){this.venue&&(this.venue.addEventListener(uv.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.addEventListener(uv.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.addEventListener(uv.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&(this.venue.removeEventListener(uv.EVENTS.LEVEL_CHANGE,this.levelChangeHandler_,void 0,this),this.venue.removeEventListener(uv.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this)),this.provider_&&this.provider_.removeEventListener(uv.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"levelChangeHandler_",value:function(){this.levelSelectorUI_.switch(this.venue.getActiveLevelIndex())}},{key:"drawingChangeHandler_",value:function(){this.update_()}},{key:"activeVenueChangeHandler_",value:function(ga){this.setVenue(ga.newValue)}}])}(),I1=function(_a){function _o(ga){var ba,_c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return _r(this,_o),(ba=s(this,_o)).provider_=null,ba.drawingSelectorUI_=null,ba.addClass("venues-ui"),ba.setAlignment(_c&&_c.alignment||H.ui.LayoutAlignment.RIGHT_BOTTOM),ga instanceof uv&&ba.setVenue(ga),ba}return _l(_o,H.ui.Control),_n(_o,[{key:"renderInternal",value:function(ga,ba){ty(Ap(_o.prototype),"renderInternal",this).call(this,ga,ba),this.createDrawingSelectorUI_(ga),this.venue&&this.setVenue(this.venue)}},{key:"setVenue",value:function(ga){ga instanceof uv&&(this.removeEventListeners_(),this.venue=ga,this.provider_=ga.getParentEventTarget(),this.drawingSelectorUI_&&this.drawingSelectorUI_.update(ga.getData()),this.addEventListeners_())}},{key:"createDrawingSelectorUI_",value:function(ga){var ba=this;ga.innerHTML="",this.drawingSelectorUI_=null,this.drawingSelectorUI_=new p1(ga,null,function(_c){return ba.venue.setActiveDrawing(_c)})}},{key:"addEventListeners_",value:function(){this.venue&&this.venue.addEventListener(uv.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.addEventListener(uv.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"removeEventListeners_",value:function(){this.venue&&this.venue.removeEventListener(uv.EVENTS.DRAWING_CHANGE,this.drawingChangeHandler_,void 0,this),this.provider_&&this.provider_.removeEventListener(uv.EVENTS.ACTIVE_VENUE_CHANGE,this.activeVenueChangeHandler_,void 0,this)}},{key:"drawingChangeHandler_",value:function(){this.drawingSelectorUI_.switch(this.venue.getActiveDrawing().id)}},{key:"activeVenueChangeHandler_",value:function(ga){this.setVenue(ga.newValue)}}])}(),R1=Object.freeze({__proto__:null,DrawingControl:I1,LevelControl:C1});return o(`.venues-ui * {
  font-family: "Fira Sans", "Helvetica Neue", Helvetica, sans-serif;
  color: #0F1621;
}
.venues-ui .arrow {
  display: block;
  width: 100%;
  height: 100%;
  background-repeat: no-repeat;
  background-position: center;
}
.venues-ui .arrow--up {
  background-image: url("data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-426.000000, -584.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls-Copy' transform='translate(417.753906, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(15.000000, 16.499023) rotate(-180.000000) translate(-15.000000, -16.499023) translate(9.000000, 12.749023)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}
.venues-ui .arrow--down {
  background-image: url("data:image/svg+xml,%0A%3Csvg width='13px' height='9px' viewBox='0 0 13 9' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3E%3Cg id='VenueMap_Facilities_Detail' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3E%3Cg id='Floorplan-Switcher' transform='translate(-347.000000, -704.000000)' fill='%23383C45'%3E%3Cg id='Map-Controls' transform='translate(338.251953, 572.000000)'%3E%3Cg id='Chevron,-Dark' transform='translate(9.000000, 132.746094)'%3E%3Cpath d='M6.0105,7.5 L4.1895,5.76404817 L0.1695,1.90510321 C0.057,1.79759174 0,1.68291284 0,1.56106651 C0,1.44065367 0.057,1.32597477 0.1695,1.2184633 L1.2465,0.16771789 C1.347,0.0587729358 1.47,0.00430045872 1.617,0.00430045872 C1.764,0.00430045872 1.887,0.0587729358 1.986,0.166284404 L6.009,3.98365826 L10.023,0.161983945 C10.122,0.0530389908 10.236,0 10.3695,0 C10.503,0 10.62,0.0530389908 10.7205,0.161983945 L11.841,1.21129587 C12.0525,1.43922018 12.0525,1.67144495 11.8425,1.89793578 L7.827,5.76118119 L6.0105,7.5 Z' id='Fill-3'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
}
.venues-ui .venues-ui-button {
  display: block;
  width: 40px;
  height: 40px;
  line-height: 40px;
  font-size: 16px;
  font-weight: 600;
  background-color: #fff;
  border: none;
  border-bottom: 1px solid #9FA2A6;
  cursor: pointer;
  overflow: hidden;
  color: #6e737a;
  text-align: center;
  text-overflow: ellipsis;
  white-space: nowrap;
}
.venues-ui .venues-ui-button:hover, .venues-ui .venues-ui-button--active {
  background-color: #f0f0f0;
  color: #0F1621;
}
@keyframes fade {
  0% {
    opacity: 0;
  }
  100% {
    opacity: 1;
  }
}
.venues-ui__drawings .drawings {
  position: absolute;
  top: 0;
  right: 45px;
  display: none;
  opacity: 0;
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__drawings .drawings--open {
  display: block;
  opacity: 1;
  animation: fade 1s;
  overflow-y: auto;
  max-height: 250px;
}
.venues-ui__drawings .drawings .venues-ui-button {
  width: auto;
  padding: 0 10px;
}
.venues-ui__drawings .drawings .venues-ui-button:first-of-type {
  border-top-left-radius: 5px;
  border-top-right-radius: 5px;
}
.venues-ui__drawings .drawings .venues-ui-button:last-of-type {
  border-bottom-left-radius: 5px;
  border-bottom-right-radius: 5px;
}
.venues-ui__drawings .trigger {
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__drawings .trigger .arrow {
  transform: rotate(0);
  transition: 0.4s;
}
.venues-ui__drawings .trigger.venues-ui-button--active .arrow {
  transform: rotate(90deg);
  transition: 0.4s;
}
.venues-ui__levels {
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__levels .levels {
  overflow: hidden;
}
.venues-ui__levels .venues-ui-button--up + .levels .venues-ui-button {
  border-radius: 0;
}
.venues-ui__levels .venues-ui-button:first-of-type {
  border-top-left-radius: 5px;
  border-top-right-radius: 5px;
}
.venues-ui__levels .venues-ui-button:last-of-type {
  border-bottom-left-radius: 5px;
  border-bottom-right-radius: 5px;
}
.venues-ui__levels .venues-ui-button[disabled=disabled] .arrow {
  opacity: 0.5;
}
.venues-ui__directory {
  position: absolute;
  top: 10px;
  right: 60px;
  bottom: calc(100% - 45px);
  width: 350px;
  overflow: hidden;
  background: white;
  border-radius: 5px;
  box-shadow: 0 0 0.4em 0 rgba(15, 22, 33, 0.6);
}
.venues-ui__directory.active {
  bottom: 10px;
}
.venues-ui__directory .directory__list {
  top: 80px;
  bottom: 20px;
  position: absolute;
  overflow-y: scroll;
  right: 10px;
  left: 10px;
  font-size: 12px;
}
.venues-ui__directory .directory__list svg {
  width: 25px;
  height: 25px;
}
.venues-ui__directory .directory__heading {
  margin: 8px;
  font-size: 15px;
  font-weight: normal;
  cursor: pointer;
}
.venues-ui__directory .directory__input {
  margin: 10px;
}
.venues-ui__directory .directory__input input {
  width: 100%;
  padding: 5px 0;
}
.venues-ui__directory .directory__trigger {
  position: absolute;
  right: 10px;
  top: 15px;
  width: 10px;
  height: 10px;
}
.venues-ui__directory .directory__trigger .arrow {
  transform: rotate(0);
  transition: 0.4s;
}
.venues-ui__directory .directory__trigger--active .arrow {
  transform: rotate(-180deg);
  transition: 0.4s;
}`),e.Drawing=my,e.Geometry=fy,e.Level=xy,e.Provider=A1,e.Route=Y0,e.Service=t1,e.Service2=W0,e.Venue=uv,e.ui=R1,Object.defineProperty(e,"__esModule",{value:!0}),e}({})}).call(self);const H$1=H,Map$1=reactExports.forwardRef(({apiKey:e,userCoord:o,finishLoading:s,isMobile:h},d)=>{const g=reactExports.useRef(null),_=reactExports.useRef(null),j=reactExports.useRef(null);reactExports.useRef(null);let $=null;reactExports.useEffect(()=>{if(!_.current){j.current=new H$1.service.Platform({apiKey:e});const _n=j.current.createDefaultLayers({pois:!0});$=new H$1.Map(g.current,_n.vector.normal.map,{zoom:3.5,center:{...o}}),new H$1.mapevents.Behavior(new H$1.mapevents.MapEvents($)),_.current=$,window.addEventListener("resize",()=>_.current.getViewPort().resize());const _s=H$1.ui.UI.createDefault(_.current,_n);_e(_s)}},[e]),reactExports.useImperativeHandle(d,()=>({addRestaurantMarkers:_t,handleRoutes:_r}));const _t=_n=>{_.current.removeObjects(_.current.getObjects());const _s='<svg width="50" height="24" xmlns="http://www.w3.org/2000/svg"><rect stroke="white" fill="#1b468d" x="1" y="1" width="50" height="22" /><text x="25" y="17" font-size="12pt" font-family="Arial" font-weight="bold" text-anchor="middle" fill="white">Start</text></svg>',_l=new H$1.map.Icon(_s),Ap=new H$1.map.Marker(o,{icon:_l});_.current.addObject(Ap),_n.forEach(_h=>{console.log(_h);const _p=`<h2>${_h.title}</h2><h4>${_h.address.houseNumber} ${_h.address.street}</h4>`;let ty=new H$1.map.Marker({lat:_h.position.lat,lng:_h.position.lng});ty.setData(_p);try{_.current.addObject(ty)}catch(ry){console.log(ry)}})},_e=_n=>{_.current.addEventListener("tap",_s=>{if(console.log(_s),_s.target instanceof H$1.map.Marker){const _l=new H$1.ui.InfoBubble(_s.target.getGeometry(),{content:_s.target.getData()});_n.addBubble(_l)}},!1)},_r=_n=>{_n.forEach(_s=>{setTimeout(()=>{_i(_s)},1e3)}),setTimeout(()=>{s()},2e3)},_i=_n=>{const _s=_h=>{const _p=_h.routes[0].sections,ty=[];_p.forEach(py=>{ty.push(H$1.geo.LineString.fromFlexiblePolyline(py.polyline))});const ry=new H$1.geo.MultiLineString(ty),ly=ry.getBoundingBox(),uy=new H$1.map.Polyline(ry,{style:{lineWidth:5}});_.current.addObject(uy),_.current.getViewModel().setLookAtData({bounds:ly})},_l=j.current.getRoutingService(null,8),Ap={origin:`${o.lat},${o.lng}`,destination:`${_n.position.lat},${_n.position.lng}`,transportMode:"car",return:"polyline"};_l.calculateRoute(Ap,_s,console.error)};return jsxRuntimeExports.jsx("div",{className:"map-area flex-c-c flex-dir-row",ref:g})}),loadingWheel="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGUAAABpCAYAAAAjvu20AAAABmJLR0QA/wD/AP+gvaeTAAAF+klEQVR4nO3dSYwVRQDG8a9GBAU0owyKgAgoggomxsSFRKOIaCAh6sE1uAUvuCXKhYvCAQ8qIQY9KVFciCQGjBgJHtAgwbhEHSMQWcYMEUaUsCsODPP3UDOyTc/rpfpV93v1u03e66qvX7033V1dVS2VGDAImA2sBdqAI8AO4HNgFjDQd8a6AjwN7KN3fwAP+M5a8wADvFmhMU41z3fumga8mLBBuj3uO3tNAsYCR1M2ykHgQt/7EEeD7wAJzZHUJ+W2AyU95TBLAPQB9qT8lXTb4Hs/4jC+A8QFjJG02UFR/Y0xhx2Uk5sy/fu6wFE5hT+ulKlRDjkq54CjcnKT9qDpw3ZJncr2Rdovaa+bOMcBZ0oaImm4pA5JOyTtMsYcc11X4QDrMh7olzrOMxX4ENjfQ11/AouBiS7rLBxgRsZGucVRjvHAVwnq/RgY7qLuwgEagG9SNshyRxmmYy9Ek2oDbnCRIU7IvsCDwFJgPfAD8AnwLODqjOnE+oYDOxN+IJuARgd13076HgWwjTnBxefQW8gpQEuFEM8DTq+HgJFAc8wP4kugyUGdl5D94hVgG3ndUgAeATpiBlmM+4bpCzxD9JdiQ1dGJ6f9wPtZWuIUc3urK9UHBVwvaa2kvgk2m22MWZCmvhh5JkgaI6lJ0i5JG40xWxyWf7mkTXJ3XXdI0jBjjLtrJuyxI6kD5HCMqQZgjsNfSbd7o+pL3PLA1ZJuTLFv50gq613AO3Io886oF9L8HCdlCHJbhm19GlnNMtM0yrD0OVTWC6jBOZQZ2TGaplGOZAjSnmFbn/LoxNwX9UKaRmnJEGRbhm192lnNMtM0yirZ3to0Pku5nW/rCl8m8F6KU8DfgH5Og1QJMMnluTDQCYxyHXIodiRiXB3AFKchqgg71ux7h43yUV5BryFex2A78GguIaoImIz9hmfVju0hyC3oUOBd4FhEgPXAdbkFqDLgJQeN8kSlepx0EgIXSZoqaZSksyW1SlpjjPnFRflFge3cfEvSY2k2lzTPGBOG0OYBeA44nODXsRe433fumgeMwN6S6O0u5G7gVWBQkrJLMxivqICzJN0qaaxsN9JRSW2SmiWtq4sRLUEQBEEQBEEQBEEQBEEQBIFDPXbdA4MlXdb151ZjzF/VixScBJgGfM3JAwQ6sffap/rOV1ewcwlfj3FbcxGOJuEEFZBslMZ833lrBXAz8AGwCphL97Q74AqSTa7sAK7yvD+lh13Z79ShWVuBJgFvJGiQbot871SZAaOAfyM+27cbZG/6J5Vl4lAgTZYUNa56WoOkoSkKTbNNcFxvI1w6GiQdTFFo4VcCKrjVil6VabmAlSmOKZ9Ucw9qEfAwdrD3iX4EzhV2CY+kyjrLt1CACcBC7HyfJ4G+3S80kGzuxbeEC8j8Ydcd2R6jQbYDI3znrRvAEOy6VFFWUJJ1fcvutF5i7Don0yR1zzbaLOnTWptrEgRBEARBEARBEARBEARBEARBEARB0QDXAu8AW4BdXQMxXgDO852tLnV9+FELXrZRQ2tIRgEGdn0xr/Q+0geYFWMEzO5aHQGDfbDOAk5eurAVuMtXoEZgX4xGAVjiJWTOgGUR+9sJ3O0j0EMxGwTgECVdvTsKdsJPb1pJ+a8sy/+/cQneO0DSxRnqKqLIh9J0GSEp1eSqLI2SdMHKjgx1FdEAR+85TZZG+TnBe/dI+j1DXUXUXOH1I5I2ViPI/4D+xH8I5mtVDVcFXfvfWrh9Bu6h8qL8LcD5XgLmDDuVoaeGWY5dr9hbsBnYs6ue/ASM9hauCoABwEzsOgSvAJnng7p8AMFMSRMlNco+gGClpGXGmFo7wAdBEAQ9q4mnQgA3yS4YMEj2eLbCGLPVb6o6BTQBq3s46zsKvAyc4TtjXQH6Ad9VuEZa6DtnXcGuAlTJMWC876xJlXk+/H0x3tMgKfK570VV5kaJ21NQuh6FMjfKfsfvK4wyN8oXMd+3JtcUwXHAaODvCgf65nBaXGXAdOCfiAZpAS71nbEuAeOAJdinfrcDvwLzgUbf2dL6D14jHj01TwpEAAAAAElFTkSuQmCC",AppContent=e=>{const[o,s]=reactExports.useState(""),h=ly=>{s(ly.target.value)},[d,g]=reactExports.useState(0),_=ly=>{g(ly.target.value)},[j,$]=reactExports.useState(!1),_t=()=>{$(!1)},[_e,_r]=reactExports.useState({lat:21,lng:61.144}),[_i,_n]=reactExports.useState(0),_s=["Please ensure you have entered an address","Your address does not exist in our database"],_l=()=>{if(o){$(!0),_n(0);let ly=`https://geocode.search.hereapi.com/v1/geocode?q=${o}&apiKey=${e.apiKey}`;axios.get(ly).then(uy=>{let py=uy.data.items[0].position;_r(py),ty(py)}).catch(uy=>{console.error("Address does not exist in database!"+uy),_n(2),$(!1)})}else console.warn("Address is likely to be empty!"),_n(1)},[Ap,_h]=reactExports.useState([]);let _p=[];const ty=ly=>{let uy=`https://discover.search.hereapi.com/v1/discover?at=${ly.lat},${ly.lng}&q=restaurants&apiKey=${e.apiKey}`;axios.get(uy).then(py=>{_p=py.data.items.filter(my=>my.distance/1e3<=d),_p.length>8&&(_p.length=8),_h(_p),ry.current.addRestaurantMarkers(_p),ry.current.handleRoutes(_p)}).catch(py=>{console.error(py)})},ry=reactExports.useRef();return jsxRuntimeExports.jsxs("div",{className:e.isMobile?"content-area flex-s-s flex-dir-col":"content-area flex-s-s flex-dir-row",children:[jsxRuntimeExports.jsxs("div",{className:"search-area flex-dir-col flex-c-c",children:[jsxRuntimeExports.jsxs("div",{className:"address-container flex-dir-col flex-c-c",children:[jsxRuntimeExports.jsx("h1",{children:"Enter Your Address"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"e.g. 3 Jo Road, Nelson, New Zealand",onChange:h})]}),jsxRuntimeExports.jsxs("div",{className:"distance-container flex-dir-col flex-c-c",children:[jsxRuntimeExports.jsx("h1",{children:"Maximum Travel Distance (KM)"}),jsxRuntimeExports.jsx("input",{type:"number",placeholder:"e.g. 35",min:0,onChange:_})]}),jsxRuntimeExports.jsx("button",{onClick:_l,title:"Finds the nearest 8 restaurants!",children:"Find Restaurants"}),!!_i&&jsxRuntimeExports.jsx("div",{className:"error-message-container flex-c-c",children:jsxRuntimeExports.jsx("h3",{children:_s[_i-1]})})]}),j&&jsxRuntimeExports.jsx("div",{className:"loading-container",children:jsxRuntimeExports.jsx("div",{className:"loading-screen",children:jsxRuntimeExports.jsx("img",{src:loadingWheel,alt:"Loading wheel",className:"loading-wheel"})})}),jsxRuntimeExports.jsx(Map$1,{apiKey:e.apiKey,userCoord:_e,finishLoading:_t,isMobile:e.isMobile,ref:ry})]})};function App(){const e="KQfiAv_6Iy90vvbhCCMvOt_rK3kmtC_YWP9Kt-laftg",[o,s]=reactExports.useState(window.innerWidth),[h,d]=reactExports.useState(window.innerWidth<750);reactExports.useEffect(()=>{const _=()=>s(window.innerWidth);window.addEventListener("resize",_);const j=window.innerWidth<750;return d(j),()=>window.removeEventListener("resize",_)},[window.innerWidth]);const g=reactExports.useRef(null);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:jsxRuntimeExports.jsx("div",{className:h?"app flex-s-s flex-dir-col":"app flex-s-s flex-dir-row",ref:g,children:jsxRuntimeExports.jsx(AppContent,{apiKey:e,isMobile:h})})})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}))});export default j1();
